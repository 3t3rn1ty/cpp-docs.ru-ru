---
title: __hook | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-language
ms.topic: language-reference
f1_keywords:
- __hook_cpp
dev_langs:
- C++
helpviewer_keywords:
- __hook keyword [C++]
- event handlers [C++], connecting events to
ms.assetid: f4cabb10-d293-4c0e-a1d2-4745ef9cc22c
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: af8470d0ae45d1075fa8b35585225ee0c48db80b
ms.sourcegitcommit: 2b9e8af9b7138f502ffcba64e2721f7ef52af23b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/01/2018
ms.locfileid: "39406511"
---
# <a name="hook"></a>__hook
Связывает метод обработчика с событием.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
long __hook(  
   &SourceClass::EventMethod,  
   source,  
   &ReceiverClass::HandlerMethod  
   [, receiver = this]  
);  
long __hook(  
   interface,  
   source  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 **&** *SourceClass* `::` *EventMethod*  
 Указатель на метод события, к которому присоединяется метод обработчика событий.  
  
-   События неуправляемого C++: *SourceClass* является исходным классом и *EventMethod* — это событие.  
  
-   События COM: *SourceClass* является исходного интерфейса событий и *EventMethod* — один из его методов.  
  
-   Управляемые события: *SourceClass* является исходным классом и *EventMethod* — это событие.  
  
 *interface*  
 Имя интерфейса, присоединяемого с *получателя*, только для приемников событий COM, в котором *layout_dependent* параметр [event_receiver](../windows/event-receiver.md) атрибут является **true**.  
  
 *source*  
 Указатель на экземпляр источника события. В зависимости от кода `type` указано в `event_receiver`, *источника* может принимать одно из следующих:  
  
-   Собственный указатель на объект источника события.  
  
-   `IUnknown`-На основе указателя (источник COM).  
  
-   Указатель на управляемый объект (для управляемых событий).  
  
 **&** *ReceiverClass* `::` `HandlerMethod`  
 Указатель на метод обработчика событий, который необходимо присоединить к событию. Обработчик определяется как метод класса или ссылку на тот же; Если вы не укажете имя класса **__hook** предполагается, что класс, который требуется, в котором он вызывается.  
  
-   События неуправляемого C++: *ReceiverClass* является классом приемника событий и `HandlerMethod` является обработчиком.  
  
-   События COM: *ReceiverClass* является интерфейсом приемника событий и `HandlerMethod` является одним из его обработчиков.  
  
-   Управляемые события: *ReceiverClass* является классом приемника событий и `HandlerMethod` является обработчиком.  
  
 *получатель*(необязательно)  
 Указатель на экземпляр класса приемника событий. Если получатель не указан, по умолчанию используется класс приемника или структура, в которой **__hook** вызывается.  
  
## <a name="usage"></a>Использование  
 Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.  
  
## <a name="remarks"></a>Примечания  
 Встроенная функция **__hook** в приемнике событий можно связать или присоединить метод обработчика с методом события. Затем, когда этот источник вызывает указанное событие, вызывается указанный обработчик. Можно подключить несколько обработчиков к одному событию или несколько событий к одному обработчику.  
  
 Существует два вида **__hook**. Можно использовать первую форму (четыре аргумента) в большинстве случаев, в частности, для приемников событий COM, в котором *layout_dependent* параметр [event_receiver](../windows/event-receiver.md) атрибут **false** .  
  
 В таких случаях не требуется присоединять все методы в интерфейсе перед порождением события в одном из методов; достаточно присоединить только метод, обрабатывающий событие. Можно использовать второй формы (с двумя аргументами) **__hook** только для приемника событий COM, в котором * layout_dependent ***= true**.  
  
 **__hook** возвращает значение типа long. Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создают исключение).  
  
 Компилятор проверяет наличие события и соответствие сигнатур события и делегата.  
  
 За исключением событий COM **__hook** и **__unhook** можно вызвать вне приемника событий.  
  
 Альтернативой использованию **__hook** можно использовать оператор +=.  
  
 Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [событий](../windows/event-cpp-component-extensions.md).  
  
> [!NOTE]
>  Класс-шаблон или структура не могут содержать события.  
  
## <a name="example"></a>Пример  
 См. в разделе [обработка событий в неуправляемом коде C++](../cpp/event-handling-in-native-cpp.md) и [обработка событий в COM](../cpp/event-handling-in-com.md) примеры.  
  
## <a name="see-also"></a>См. также  
 [Ключевые слова](../cpp/keywords-cpp.md)   
 [Обработка событий](../cpp/event-handling.md)   
 [event_source](../windows/event-source.md)   
 [event_receiver](../windows/event-receiver.md)   
 [__unhook](../cpp/unhook.md)   
 [__raise](../cpp/raise.md)