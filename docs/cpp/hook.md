---
title: "__hook | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "language-reference"
f1_keywords: 
  - "__hook_cpp"
  - "__hook"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "__hook - ключевое слово [C++]"
  - "обработчики событий, подключение событий"
ms.assetid: f4cabb10-d293-4c0e-a1d2-4745ef9cc22c
caps.latest.revision: 10
caps.handback.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# __hook
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Связывает метод обработчика с событием.  
  
## Синтаксис  
  
```  
  
      long __hook(  
   &SourceClass::EventMethod,  
   source,  
   &ReceiverClass::HandlerMethod  
   [, receiver = this]  
);  
long __hook(  
   interface,  
   source  
);  
```  
  
#### Параметры  
 **&** *SourceClass* `::` *EventMethod*  
 Указатель на метод события, к которому присоединяется метод обработчика событий.  
  
-   События неуправляемого C\+\+: *SourceClass* является исходным классом, а *EventMethod* — событием.  
  
-   События COM: *SourceClass* является исходным интерфейсом, а *EventMethod* — одним из его методов.  
  
-   Управляемые события: *SourceClass* является исходным классом, а *EventMethod* — событием.  
  
 `interface`  
 Имя интерфейса, присоединяемого с помощью `receiver`, только для приемников событий COM, в которых параметр *layout\_dependent* атрибута [event\_receiver](../windows/event-receiver.md) имеет значение **true**.  
  
 *source*  
 Указатель на экземпляр источника события.  В зависимости от кода `type`, указанного в атрибуте **event\_receiver**, *source* может быть одним из следующих элементов.  
  
-   Собственный указатель на объект источника события.  
  
-   Указатель на базе **IUnknown** \(источник COM\).  
  
-   Указатель на управляемый объект \(для управляемых событий\).  
  
 **&** *ReceiverClass* `::` `HandlerMethod`  
 Указатель на метод обработчика событий, который необходимо присоединить к событию.  Обработчик определяется как метод класса или ссылка на этот класс, и если не указать имя класса, `__hook` считает классом тот класс, в котором он вызван.  
  
-   События неуправляемого C\+\+: *ReceiverClass* является классом приемника событий, а `HandlerMethod` — обработчиком.  
  
-   События COM: *ReceiverClass* является интерфейсом приемника событий, а `HandlerMethod` — одним из его обработчиков.  
  
-   Управляемые события: *ReceiverClass* является классом приемника событий, а `HandlerMethod` — обработчиком.  
  
 `receiver` \(необязательно\)  
 Указатель на экземпляр класса приемника событий.  Если не указать приемник, по умолчанию используется класс приемника или структура, в которой вызван `__hook`.  
  
## Использование  
 Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.  
  
## Заметки  
 С помощью встроенной функции `__hook` в приемнике событий можно связать или присоединить метод обработчика к методу события.  Затем, когда этот источник вызывает указанное событие, вызывается указанный обработчик.  Можно подключить несколько обработчиков к одному событию или несколько событий к одному обработчику.  
  
 Существует две формы `__hook`.  В большинстве случаев можно использовать первую форму \(с четырьмя аргументами\), в частности, для приемников событий COM, в которых параметр *layout\_dependent* атрибута [event\_receiver](../windows/event-receiver.md) имеет значение **false**.  
  
 В таких случаях не требуется присоединять все методы в интерфейсе перед порождением события в одном из методов; достаточно присоединить только метод, обрабатывающий событие.  Вторую форму \(с двумя аргументами\) функции `__hook` можно использовать только для приемника событий COM, в котором параметр *layout\_dependent***\=true**.  
  
 Функция `__hook` возвращает значение long.  Ненулевое возвращаемое значение указывает на наличие ошибки \(управляемые события создают исключение\).  
  
 Компилятор проверяет наличие события и соответствие сигнатур события и делегата.  
  
 За исключением событий COM `__hook` и `__unhook` можно вызвать вне приемника событий.  
  
 Вместо `__hook` можно использовать оператор \+\=.  
  
 Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [event](../windows/event-cpp-component-extensions.md).  
  
> [!NOTE]
>  Класс\-шаблон или структура не могут содержать события.  
  
## Пример  
 Примеры см. в разделах [Обработка событий в неуправляемом C\+\+](../Topic/Event%20Handling%20in%20Native%20C++.md) и [Обработка событий в COM](../cpp/event-handling-in-com.md).  
  
## См. также  
 [Ключевые слова в C\+\+](../cpp/keywords-cpp.md)   
 [Обработка событий](../cpp/event-handling.md)   
 [event\_source](../windows/event-source.md)   
 [event\_receiver](../windows/event-receiver.md)   
 [\_\_unhook](../cpp/unhook.md)   
 [\_\_raise](../cpp/raise.md)