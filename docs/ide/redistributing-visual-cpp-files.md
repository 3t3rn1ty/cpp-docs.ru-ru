---
title: Распространение файлов Visual C++ | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- application deployment [C++], file redistributing
- redistributing applications [C++]
- deploying applications [C++], file redistributing
- file redistribution [C++]
- redistributing applications [C++], about redistributing applications
ms.assetid: d201b2ce-36f1-44e5-a96c-0db81a1ba652
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: e67ad87f1dce47f3d02dcbe907285cf0513a8ce9
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="redistributing-visual-c-files"></a>Распространение файлов Visual C++

> [!NOTE]
> Вы здесь так, как вы ищете загрузки одного из файлов среды выполнения Visual C++? Последовательно выберите пункты [Microsoft](http://www.microsoft.com/) веб-сайта и введите **распространяемый пакет Visual C++** в поле поиска. Загрузите и установите распространяемый пакет для архитектуры вашего компьютера (например, x64 при запуске 64-разрядной версии Windows) и версии Visual c++ (например, 2015 г.), который необходимо.

При развертывании приложения необходимо также развернуть файлы, поддерживающие это приложение. Если какие-либо из этих файлов предоставляются Майкрософт, убедитесь в наличии разрешений на их повторное распространение. Чтобы просмотреть условия лицензионного соглашения на использование Visual Studio, см. по ссылке условия лицензии в диалоговом окне о Microsoft Visual Studio в Интегрированной среде разработки, или загрузите [условия лицензионного соглашения на использование программного обеспечения Майкрософт](http://go.microsoft.com/fwlink/p/?LinkId=831114) файла. Ознакомиться со «списком REDIST», упоминаемый в разделе «Распространяемый код» лицензионного соглашения программного обеспечения корпорации Майкрософт для некоторых выпусков Visual Studio, можно [распространяемый код для Microsoft Visual Studio, 2017 г и 2017 г. Microsoft Visual Studio Пакет SDK (включает служебные программы и файлы BuildServer)](http://go.microsoft.com/fwlink/p/?LinkId=823098), или для Visual Studio 2015, см. раздел [распространяемый код для Microsoft Visual Studio 2015 и Microsoft Visual Studio 2015 SDK](http://go.microsoft.com/fwlink/p/?LinkId=523763). Дополнительные сведения о повторно распространяемых файлах см. в разделе [определение библиотек DLL для распространения](../ide/determining-which-dlls-to-redistribute.md) и [примеры развертывания](../ide/deployment-examples.md).

Чтобы развернуть распространяемые файлы Visual C++, можно использовать распространяемые пакеты Visual C++ (VCRedist\_x86.exe VCRedist\_x64.exe или VCRedist\_arm.exe), которые входят в Visual Studio. В Visual Studio 2017 г., эти файлы можно найти в файлах программы [(x86)]\\Microsoft Visual Studio\\2017 г.\\_edition_\\VC\\Redist\\ Параметры MSVC\\_lib-version_ папку, где _edition_ выпуск Visual Studio установлена, и _lib-version_ версия библиотеки для распространения. В Visual Studio 2015, эти файлы находятся в каталоге установки Visual Studio в Program Files [(x 86)] \Microsoft Visual Studio *версии*\VC\redist\\*языкового стандарта* \\. Другой вариант — использовать распространяемые модули слияния (MSM-файлы), которые можно найти в Program Files [(x 86)] в Visual Studio 2017 г\\Microsoft Visual Studio\\2017 г.\\_edition_ \\ VC\\Redist\\параметры MSVC\\_lib-version_\\MergeModules\\ папки. В Visual Studio 2015 они находятся в Program Files [(x 86)] \common модулей\\. Это также можно напрямую установить распространяемые библиотеки DLL Visual C++ в *локальную папку приложения*, — это папка, которая содержит исполняемый файл приложения. По причинам, связанным с обслуживанием, не рекомендуется использовать это расположение установки.

Распространяемые пакеты Visual C++ позволяют устанавливать и регистрировать все библиотеки Visual C++. Если такой пакет используется, необходимо задать его выполнение в целевой системе в качестве обязательного требования к установке приложения. Рекомендуется использовать эти пакеты для развертываний, поскольку они включают функцию автоматического обновления библиотек Visual C++. Пример о том, как использовать эти пакеты см. в разделе [Пошаговое руководство: развертывание Visual C++ приложения с помощью распространяемого пакета Visual C++](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md).

Каждый распространяемый пакет Visual C++ проверяет наличие более новой версии на компьютере. Если найдена более новая версия, пакет не устанавливается. Начиная с Visual Studio 2015, в распространяемых пакетах отображается сообщение о сбое установки. Если пакет выполняется с использованием **/quiet** флаг, сообщение об ошибке не отображается. В любом случае ошибка записывается установщиком Майкрософт, а результат ошибки возвращается вызывающему объекту. Начиная с Visual Studio 2015 пакетов, можно избежать этой ошибки, проверьте реестр, чтобы узнать, установлена ли более новая версия. Установленная версия сохраняется в \Microsoft\VisualStudio HKEY_LOCAL_MACHINE\SOFTWARE [\Wow6432Node]\\_vs версии_\VC\Runtimes\\{x86 | x64 | Ключ ARM}, где _vs версии_ является номером версии для Visual Studio (14.0 для Visual Studio 2015 и Visual Studio 2017 г., так как обновленный распространяемый 2017 г совместимый на двоичном версии 2015), и где ключ — ARM, x 86, или x64 в зависимости от версии установленного vcredist для платформы. (Не требуется для проверки подраздел Wow6432Node, если вы не используете RegEdit для просмотра версии установленного x86 пакет на x64 платформы.) Номер версии хранится в строковом значении REG_SZ **версии** и также в наборе **основных**, **дополнительный**, **Bld**и **Rbld** значения REG_DWORD. Во избежание ошибки во время установки, необходимо пропустить установки распространяемого пакета, если установленная версия является более новой.

При использовании модуля слияния, содержащего библиотеку DLL Visual C++, необходимо включить его в пакет установщика Windows (или аналогичный пакет установки), используемый для развертывания приложения. Дополнительные сведения см. в разделе [распространение с помощью модулей слияния](../ide/redistributing-components-by-using-merge-modules.md). Пример см. в разделе [Пошаговое руководство: развертывание Visual C++ приложения с помощью проекта установки](../ide/walkthrough-deploying-a-visual-cpp-application-by-using-a-setup-project.md), который также показывает, как использовать InstallShield Limited Edition для создания пакета установки.

## <a name="potential-run-time-errors"></a>Возможные ошибки во время выполнения

Если Windows не может найти распространяемая библиотека DLL, необходимый для приложения, может отображаться сообщение примерно следующего вида: «приложение не было запущено, поскольку *библиотеки*DLL-файл не найден. Повторная установка приложения может решить данную проблему.»

Для устранения ошибок, убедитесь, что установщик приложения правильность сборки и распространяемых библиотек правильно ли развернуты в целевой системе. Дополнительные сведения см. в разделе [основные сведения о зависимостях приложения Visual C++](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Распространение с использованием модулей слияния](../ide/redistributing-components-by-using-merge-modules.md)|Описывает, как использовать распространяемые модули слияния Visual C++ для установки библиотек времени выполнения Visual C++ в качестве общих библиотек DLL в папке %windir%\system32\.|
|[Распространение элементов ActiveX Visual C++](../ide/redistributing-visual-cpp-activex-controls.md)|Описание процедуры повторного распространения приложения, которое использует элементы управления ActiveX.|
|[Распространение файлов поддержки базы данных](../ide/redistributing-database-support-files.md)|Описание процедуры повторного распространения файлов поддержки для объектов доступа к данным (DAO) и технологиям баз данных в пакете Microsoft Data Access SDK.|
|[Распространение библиотеки MFC](../ide/redistributing-the-mfc-library.md)|Описание процедуры повторного распространения приложения, которое использует MFC.|
|[Распространение приложения ATL](../ide/redistributing-an-atl-application.md)|Описание способа распространения приложения, которое использует ATL. Начиная с Visual Studio 2012, распространяемая библиотека для ATL не требуется.|
|[Примеры развертывания](../ide/deployment-examples.md)|Ссылки на примеры, демонстрирующие развертывание приложений Visual C++.|
|[Развертывание приложений для настольных систем](../ide/deploying-native-desktop-applications-visual-cpp.md)|Представлены технологии развертывания Visual C++ и связанные понятия.|