---
title: Распространение файлов Visual C++ | Документы Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- application deployment [C++], file redistributing
- redistributing applications [C++]
- deploying applications [C++], file redistributing
- file redistribution [C++]
- redistributing applications [C++], about redistributing applications
ms.assetid: d201b2ce-36f1-44e5-a96c-0db81a1ba652
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: e67ad87f1dce47f3d02dcbe907285cf0513a8ce9
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33337552"
---
# <a name="redistributing-visual-c-files"></a>Распространение файлов Visual C++

> [!NOTE]
> Вы попали сюда, так хотите скачать один из файлов среды выполнения Visual C++? Перейдите на веб-сайт [Майкрософт](http://www.microsoft.com/) и введите **Visual C++ Redistributable** (Распространяемый C++) в поле поиска. Скачайте и установите распространяемый пакет для архитектуры своего компьютера (например, x64, если у вас 64-разрядная версия Windows) и нужную версию Visual C++ (например, 2015).

При развертывании приложения необходимо также развернуть файлы, поддерживающие это приложение. Если какие-либо из этих файлов предоставляются Майкрософт, убедитесь в наличии разрешений на их повторное распространение. Чтобы просмотреть условия лицензионного соглашения для Visual Studio, воспользуйтесь ссылкой "Условия лицензии" в диалоговом окне "О Microsoft Visual Studio" в интегрированной среде разработки или скачайте файл [Условия лицензионного соглашения на использование программного обеспечения корпорации Майкрософт](http://go.microsoft.com/fwlink/p/?LinkId=831114). Для просмотра "списка REDIST", на который ссылается раздел "Распространяемый код" условий лицензионного соглашения на использование программного обеспечения корпорации Майкрософт для некоторых выпусков Visual Studio, см. раздел [Распространяемый код для Microsoft Visual Studio 2017 и Microsoft Visual Studio 2017 SDK (включает служебные программы и файлы BuildServer)](http://go.microsoft.com/fwlink/p/?LinkId=823098), а для Visual Studio 2015 см. раздел [Распространяемый код для Microsoft Visual Studio 2015 и Microsoft Visual Studio 2015 SDK](http://go.microsoft.com/fwlink/p/?LinkId=523763). Дополнительные сведения о повторно распространяемых файлах см. в разделах [Определение библиотек DLL для распространения](../ide/determining-which-dlls-to-redistribute.md) и [Примеры развертывания](../ide/deployment-examples.md).

Чтобы развернуть распространяемые файлы Visual C++, можно использовать распространяемые пакеты Visual C++ (VCRedist\_x86.exe, VCRedist\_x64.exe или VCRedist\_arm.exe), которые включены в Visual Studio. В Visual Studio 2017 эти файлы находятся в папке Program Files[ (x86)]\\Microsoft Visual Studio\\2017\\_выпуск_\\VC\\Redist\\MSVC\\_версия_библиотеки_, где _выпуск_ — это установленный выпуск Visual Studio, а _версия_библиотеки_ — это версия библиотек для распространения. В Visual Studio 2015 эти файлы находятся в каталоге установки Visual Studio — Program Files [(x86)]\Microsoft Visual Studio *версия*\VC\redist\\*языковой_стандарт*\\. Другой вариант — использовать распространяемые модули слияния (файлы MSM), которые в Visual Studio 2017 находятся в папке Program Files [(x86)]\\Microsoft Visual Studio\\2017\\_выпуск_\\VC\\Redist\\MSVC\\_версия_библиотеки_\\MergeModules\\. В Visual Studio 2015 они находятся в папке Program Files [(x86)]\Common Files\Merge Modules\\. Кроме того, можно напрямую установить распространяемые библиотеки DLL Visual C++ в *локальной папке приложений*, где содержится исполняемый файл приложения. По причинам, связанным с обслуживанием, не рекомендуется использовать это расположение установки.

Распространяемые пакеты Visual C++ позволяют устанавливать и регистрировать все библиотеки Visual C++. Если такой пакет используется, необходимо задать его выполнение в целевой системе в качестве обязательного требования к установке приложения. Рекомендуется использовать эти пакеты для развертываний, поскольку они включают функцию автоматического обновления библиотек Visual C++. Пример использования этих пакетов см. в разделе [Пошаговое руководство. Развертывание приложения Visual C++ с помощью распространяемого пакета Visual C++](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md).

Каждый распространяемый пакет Visual C++ проверяет наличие более новой версии на компьютере. Если найдена более новая версия, пакет не устанавливается. Начиная с Visual Studio 2015, в распространяемых пакетах отображается сообщение о сбое установки. Если пакет выполняется с использованием флага **/quiet**, сообщение об ошибке не отображается. В любом случае ошибка записывается установщиком Майкрософт, а результат ошибки возвращается вызывающему объекту. Начиная с пакетов Visual Studio 2015 вы можете избежать этой ошибки, проверив реестр, чтобы узнать, установлена ли более новая версия. Установленная сейчас версия хранится в разделе HKEY_LOCAL_MACHINE\SOFTWARE[\Wow6432Node]\Microsoft\VisualStudio\\_версия_vs_\VC\Runtimes\\{x86|x64|ARM}, где _версия_vs_ — это номер версии Visual Studio (14.0 для обеих версий Visual Studio 2015 и Visual Studio 2017, так как обновленный распространяемый компонент 2017 является двоично совместимым с версией 2015), а использование значения ARM, x86 или x64 зависит от установленных версий vcredist для платформы. (Подраздел Wow6432Node нужно проверять только при использовании RegEdit для просмотра версии установленного пакета x86 на платформе x64.) Номер версии хранится в строковом значении REG_SZ **Версия**, а также в наборе значений **Major**, **Minor**, **Bld** и **Rbld** REG_DWORD. Чтобы избежать ошибки во время установки, нужно пропустить установку распространяемого пакета, если только что установленная версия является более новой.

При использовании модуля слияния, содержащего библиотеку DLL Visual C++, необходимо включить его в пакет установщика Windows (или аналогичный пакет установки), используемый для развертывания приложения. Дополнительные сведения см. в разделе [Распространение с использованием модулей слияния](../ide/redistributing-components-by-using-merge-modules.md). Пример см. в разделе [Пошаговое руководство. Развертывание приложения Visual C++ с помощью проекта установки](../ide/walkthrough-deploying-a-visual-cpp-application-by-using-a-setup-project.md), в котором также демонстрируется использование InstallShield Limited Edition для создания пакета установки.

## <a name="potential-run-time-errors"></a>Возможные ошибки во время выполнения

Если Windows не удается найти одну из распространяемых библиотек DLL, необходимых приложению, может появиться сообщение, аналогичное следующему: "Не удалось запустить приложение, так как *library*.dll не был найден. Повторная установка приложения может решить данную проблему".

Чтобы разрешить эту ошибку, нужно проверить, правильно ли выполняется сборка установщика приложения и правильно ли развернуты распространяемые библиотеки в целевой системе. Дополнительные сведения см. в разделе [Основные сведения о зависимостях приложения Visual C++](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание:|
|-----------|-----------------|
|[Распространение с помощью модулей слияния](../ide/redistributing-components-by-using-merge-modules.md)|Здесь приводится описание использования распространяемых модулей слияния Visual C++ для установки библиотек времени выполнения Visual C++ в качестве общих библиотек DLL в папке %windir%\system32\.|
|[Распространение элементов ActiveX Visual C++](../ide/redistributing-visual-cpp-activex-controls.md)|Описание процедуры повторного распространения приложения, которое использует элементы управления ActiveX.|
|[Распространение файлов поддержки базы данных](../ide/redistributing-database-support-files.md)|Описание процедуры повторного распространения файлов поддержки для объектов доступа к данным (DAO) и технологиям баз данных в пакете Microsoft Data Access SDK.|
|[Распространение библиотеки MFC](../ide/redistributing-the-mfc-library.md)|Описание процедуры повторного распространения приложения, которое использует MFC.|
|[Распространение приложения ATL](../ide/redistributing-an-atl-application.md)|Описание способа распространения приложения, которое использует ATL. Начиная с Visual Studio 2012, распространяемая библиотека для ATL не требуется.|
|[Примеры развертывания](../ide/deployment-examples.md)|Ссылки на примеры, демонстрирующие развертывание приложений Visual C++.|
|[Развертывание классических приложений](../ide/deploying-native-desktop-applications-visual-cpp.md)|Представлены технологии развертывания Visual C++ и связанные понятия.|