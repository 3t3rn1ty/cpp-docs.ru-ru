---
title: "Извлечь функцию | Документы Microsoft"
ms.custom: 
ms.date: 11/16/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-ide
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: e31d1249-9705-4511-acbd-9f6fe73bdf2d
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: dbcd323292e301857c65d908047ab14948b86573
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="extract-function"></a>Извлечь функцию
**Что:** позволяет преобразовать фрагмент кода в его собственную функцию.

**Когда:** имеется фрагмент кода, существующие в некоторые функции, которая должна вызываться из другой функции.  

**Почему:** вам удалось скопировать и вставить этот код, но это приведет к дублированию.  Лучшим решением является оптимизация фрагменте в его собственную функцию, который может быть вызван свободно любой функцией.

**Как:**

1. Выделите код для извлечения:

   ![Выделенный код](images/extractfunction_highlight.png)

1. Затем выполните одно из следующих действий.
   * **Клавиатура**
     * Нажмите клавишу **Ctrl + R**, затем **Ctrl + M**.  (Обратите внимание, что сочетание клавиш может отличаться в зависимости от выбранного профиля.)
     * Нажмите клавишу **Ctrl +.** для запуска **Быстрые действия и рефакторинг** и выбрать пункт **извлечение функции (экспериментально)** в контекстном меню.
   * **Мышь**
     * Выберите **Правка > рефакторинг > извлечь функцию (экспериментальная функция)**.
     * Щелкните его правой кнопкой мыши, выберите **Быстрые действия и рефакторинг** и выбрать пункт **извлечение функции (экспериментально)** в контекстном меню.
     * Нажмите кнопку ![Lightbulb](images/bulb.png) значок, который отображается в левом поле и выберите **извлечение функции (экспериментально)** в контекстном меню.

1. В **извлечения функции или метода (экспериментально)** окно, введите новое имя функции, выберите, где код будет размещен и нажмите кнопку **ОК** кнопки.  

   ![Извлечь функцию функции](images/extractfunction_dialog.png)

1. Будет создана новая функция там, где указано, прототип функции в соответствующий файл заголовка и исходный код будет изменено для вызова этой функции.

   ![Результат функции извлечения](images/extractfunction_result.png)