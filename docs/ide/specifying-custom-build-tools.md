---
title: Задание пользовательских средств построения | Документы Microsoft
ms.custom: ''
ms.date: 12/28/2017
ms.technology:
- cpp-ide
ms.topic: conceptual
f1_keywords:
- VC.Project.VCCustomBuildTool.CustomBuildToolBeforeTargets
- VC.Project.VCCustomBuildTool.Outputs
- VC.Project.VCCustomBuildTool.Command
- VC.Project.VCCustomBuildTool.CommandLine
- VC.Project.VCCustomBuildTool.AdditionalDependencies
- VC.Project.VCCustomBuildTool.Message
- VC.Project.VCCustomBuildTool.CustomBuildToolAfterTargets
- VC.Project.VCCustomBuildTool.Description
- VC.Project.VCCustomBuildTool.AdditionalInputs
dev_langs:
- C++
helpviewer_keywords:
- build tools (C++), specifying
- custom build tools (C++), specifying
- builds (C++), custom build tools
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 1b8fc10d2a94ab4b26a47991d3dc8923afb28ca3
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="specify-custom-build-tools"></a>Укажите пользовательские средства построения

Объект *настраиваемого инструмента сборки* предоставляет системе построения сведения, необходимые для построения определенных входных файлов. Настраиваемый инструмент построения указывает команду для выполнения, список входных файлов, список выходных файлов, которые создаются с помощью команды и необязательное описание средства.

Общие сведения о пользовательских средств построения и пользовательские шаги построения см. в разделе [понимание пользовательские шаги построения и события построения](../ide/understanding-custom-build-steps-and-build-events.md).

### <a name="to-specify-a-custom-build-tool"></a>Чтобы задать пользовательскому средству сборки

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [задание свойств проекта Visual C++](../ide/working-with-project-properties.md).

1. Выберите **свойства конфигурации** для включения **конфигурации** поле. В **конфигурации** выберите конфигурацию, для которого требуется задать пользовательскому средству сборки.

1. В **обозревателе решений**, выберите входной файл для настраиваемого инструмента сборки.

   Если **пользовательский инструмент сборки** папка не отображается, расширение файла выбранный файл связан с инструментом по умолчанию. Например средство по умолчанию для файлов c и CPP является компилятором. Чтобы переопределить инструмент по умолчанию, в **свойства конфигурации** узла в **Общие** папки в **тип элемента** свойства, выберите **настраиваемого построения Средство**. Выберите **применить** и **пользовательский инструмент сборки** отображается узел.

1. В **инструмент настраиваемого построения** узла в **Общие** папки, укажите свойства, связанные с пользовательский инструмент сборки:

   - В **Дополнительные зависимости**, укажите дополнительные файлы, кроме того, для которого определен настраиваемого инструмента сборки (файл, связанный с инструментом настраиваемого построения неявно рассматривается входной файл для инструмента). Наличие дополнительных входных файлов не является обязательным для настраиваемого инструмента сборки. Если у вас есть несколько дополнительных входных данных, разделяйте их точкой с запятой.

      Если **Дополнительные зависимости** файла дата является более поздней, чем входного файла, а затем запустить настраиваемого инструмента сборки. Если все из **Дополнительные зависимости** файлы являются более старыми, чем у входного файла и входной файл является более ранней, чем **выходов** свойства файла, а затем настраиваемого инструмента сборки не выполняется.

      Например, предположим, что у вас есть средства настраиваемого построения, которая принимает файл MyInput.x как входной и создает файл MyInput.cpp, а MyInput.x включает файл заголовка MyHeader.h. Можно указать в качестве входных зависимостей, чтобы MyInput.x MyHeader.h и система построения строит файл MyInput.cpp при устаревшей по отношению к MyInput.x или MyHeader.h.

      Входные зависимости могут также гарантировать, что инструменты настраиваемого построения выполняются в порядке, их потребуется. В приведенном выше примере предположим, что MyHeader.h является фактически выходные данные средства настраиваемого построения. Поскольку MyHeader.h является зависимостью от MyInput.x, система построения вначале построить Myheader.h перед запуском средства настраиваемого построения на файле MyInput.x.

   - В **командной строки**, указать команду, как если бы она использовалась в командной строке. Укажите допустимую команду или пакетного файла и любые нужные входные данные или выходные файлы. Укажите **вызовите** пакетной команды перед именем пакетного файла, чтобы обеспечить выполнение всех последующих команд.

      Несколько входных и выходных файлов можно указать с помощью макросов MSBuild символически. Сведения о том, как указать расположение файлов и имен наборов файлов см. в разделе [общие макросы для команд и свойств построения](../ide/common-macros-for-build-commands-and-properties.md).

      Так как при указании переменной среды необходимо заменить каждый символ «%» зарезервирован MSBuild, **%** escape-символ **% 25** Шестнадцатеричная escape-последовательность. Например, замените **% WINDIR %** с **% 25WINDIR % 25**. MSBuild заменяет каждый **% 25** последовательность с **%** символов перед обращением к переменной среды.

   - В **описание**, введите его краткое описание настраиваемого инструмента построения. Это сообщение будет выводиться для **вывода** окна при обработке этого инструмента системой построения.

   - В **выходов**, укажите имя выходного файла. Это необходимая запись; без указания значения для этого свойства настраиваемого инструмента сборки не запустится. Если пользовательскому средству сборки имеет более чем один выход, разделите их имена точкой с запятой.

      Имя выходного файла должно совпадать с указанным в **командной строки** свойство. Система построения проекта будет произведен поиск файла и проверять дату его создания. Если выходной файл новее, чем входного файла или выходной файл не найден, то выполняется настраиваемого инструмента сборки. Если все из **Дополнительные зависимости** файлы являются более старыми, чем у входного файла, а входной файл был создан раньше файла, указанного в **выходов** свойства настраиваемого инструмента сборки не выполняется.

Если требуется, чтобы система сборки для работы с выходным файлом, созданным с помощью средства настраиваемого построения, необходимо вручную добавить его в проект. Средства настраиваемого построения обновляет файл во время построения.

## <a name="example"></a>Пример

Предположим, что для включения в файл с именем parser.l в своем проекте. У вас есть лексический анализатор **lexer.exe**, на ваш путь к исполняемому файлу. Вы хотите использовать ее для обработки parser.l для создания c-файла с тем же базовым именем (parser.c).

Сначала добавьте parser.l и parser.c в проект. Если файлы еще не существует, добавьте ссылки на файлы. Можно создать инструмент настраиваемого построения для parser.l и введите следующие значения в **команды** свойство:

> **%(FullPath) лексического анализатора. \%.C (имя файла)**

Эта команда запускает лексический анализатор для файла parser.l и выдает parser.c в каталог проекта.

В **выходов** свойство, введите следующее:

> **. \%.C (имя файла)**

При построении проекта система построения сравнивает метки времени parser.l и parser.c. Если parser.l является более новым, или если parser.c не существует, система построения выполняет значение **командной строки** свойство переведите parser.c в актуальном состоянии. Поскольку parser.c также добавлен в проект, система построения компилирует файл parser.c.

## <a name="see-also"></a>См. также

[Стандартные макросы для команд и свойств сборки](../ide/common-macros-for-build-commands-and-properties.md)  
[Устранение неполадок настроек сборки](../ide/troubleshooting-build-customizations.md)  
