---
title: "Мастер добавления метода | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.method.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "мастер добавления метода [C++]"
  - "методы [C++], добавление использования мастеров"
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Мастер добавления метода
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Этот мастер служит для добавления метода в интерфейс.  В зависимости от типа проекта или интерфейса, к которому добавляется метод, мастер отображает различные параметры.  
  
## Имена  
 **Тип возвращаемого значения**  
 Тип данных, возвращаемый методом.  Рекомендуется использовать тип `HRESULT` для интерфейсов всех типов, поскольку он обеспечивает стандартный способ возврата ошибок.  
  
|Тип интерфейса|Описание|  
|--------------------|--------------|  
|Сдвоенный интерфейс|`HRESULT`.  Неизменяемый.|  
|Пользовательский интерфейс|`HRESULT`.  Неизменяемый.|  
|Локальный пользовательский интерфейс|Введите собственный тип возвращаемых данных или выберите из списка.|  
|Диспетчерский интерфейс|Введите собственный тип возвращаемых данных или выберите из списка.|  
|Диспетчерский интерфейс элемента управления MFC ActiveX.|Если реализуется стандартный метод, типу возвращаемых данных присваивается соответствующее значение и этот тип является неизменяемым.  Если выбрать метод из списка **Имя метода** и щелкнуть **Пользовательский** в разделе **Выберите тип метода**, необходимо выбрать тип возвращаемых данных из списка.|  
  
 **Название метода**  
 Задает имя метода.  
  
|Тип интерфейса|Описание|  
|--------------------|--------------|  
|Сдвоенный интерфейс ATL, пользовательский интерфейс, локальный пользовательский интерфейс|Введите собственное имя метода.|  
|Диспетчерский интерфейс MFC|Введите собственное имя метода или выберите одно из предлагаемых имен метода из списка.  При выборе имени метода из списка, соответствующее значение появляется в окне **Тип возвращаемых данных** и этот тип является неизменяемым.|  
|Диспетчерский интерфейс элемента управления MFC ActiveX.|Введите собственный метод или выберите один из стандартных методов [DoClick](../Topic/COleControl::DoClick.md) и [Refresh](../Topic/COleControl::Refresh.md).  Дополнительные сведения см. в разделе [Элементы управления MFC ActiveX: добавление стандартных методов](../mfc/mfc-activex-controls-adding-stock-methods.md).|  
  
 **Тип метода**  
 Доступно только для элементов управления MFC ActiveX.  Если имя метода вводится в поле **Имя метода** вместо того, чтобы выбрать его из списка, данное поле будет недоступным.  
  
 Если выбран один из методов в списке **Имя метода**, выберите либо стандартную реализацию, либо пользовательскую реализацию.  
  
|Тип метода|Описание|  
|----------------|--------------|  
|**Стандартное**|Это значение используется по умолчанию.  Вставляет стандартную реализацию выбранного метода в список **Имя метода**.  Если выбран тип **Стандартный**, **тип возвращаемых данных** является неизменяемым.|  
|**Пользовательское**|Вставляет реализацию\-заглушку выбранного метода в список **Имя метода**.  Для пользовательских типов метода можно указать собственный тип возвращаемых данных либо выбрать его из списка **Тип возвращаемых данных**.|  
  
 **Внутреннее имя**  
 Доступно только для пользовательских методов, добавленных в диспетчерский интерфейс MFC.  Задает имя, используемое в схеме диспетчеризации, файл заголовка \(H\) и файл реализации \(CPP\).  По умолчанию данное имя совпадает с **Именем метода**.  Можно изменить имя метода, если используется диспетчерский интерфейс MFC или добавляется пользовательский метод в диспетчерский интерфейс элемента управления MFC ActiveX.  
  
|Тип интерфейса|Описание|  
|--------------------|--------------|  
|Сдвоенный интерфейс ATL, пользовательский интерфейс, локальный пользовательский интерфейс|Недоступно|  
|Диспетчерский интерфейс MFC|Задает имя метода по умолчанию.  Внутреннее имя можно редактировать.|  
|Диспетчерский интерфейс элемента управления MFC ActiveX.|Внутреннее имя можно задать только для пользовательских методов.  Для стандартных методов внутренние имена не используются.|  
  
 **Атрибуты параметра**  
 Задает любые дополнительные атрибуты для параметра, указанного в поле **Имя параметра**.  
  
|Атрибут параметра|Описание|Допустимые сочетания|  
|-----------------------|--------------|--------------------------|  
|**В**|Указывает, что данный параметр передается от вызывающей процедуры к вызываемой процедуре.|Только **in**<br /><br /> **in** и **out**|  
|**Out**|Указывает на то, что параметр\-указатель возвращается от вызываемой процедуры к вызывающей \(от сервера к клиенту\).|Только **out**<br /><br /> **in** и **out**<br /><br /> **out** и **retval**|  
|**Retval**|Указывает на то, что параметр получает возвращаемое значение члена.|**retval** и Out|  
  
 **Тип параметра**  
 Задает тип данных параметра.  Выберите тип из списка.  
  
 **Имя параметра**  
 Задает имя параметра для передачи через метод.  После ввода имени нужно нажать кнопку **Добавить**, чтобы добавить параметр в список параметров, которые передаются через метод.  Если не ввести имя параметра, мастер пропускает любые атрибуты параметра \(только ATL\) или выбранные **типы параметров**.  
  
 После нажатия кнопки **Добавить** в **Списке параметров** появляется имя параметра.  
  
 **Примечание**.   Если ввести имя параметра и затем нажать кнопку **Готово** до нажатия кнопки **Добавить**, параметр не добавится в метод.  Необходимо найти метод и вставить параметр вручную.  
  
 **Добавить**  
 Добавляет параметр, который указан в поле **Имя параметра**, его тип и атрибуты в **Список параметров**.  Чтобы добавить параметр в список, нажмите кнопку **Добавить**.  
  
 **Удалить**  
 Удаляет выбранный параметр из **списка параметров**.  
  
 **Список параметров**  
 Отображает все параметры, их модификаторы и типы, добавленные в метод в настоящий момент.  После добавления параметров мастер обновляет **Список параметров** и отображает каждый параметр вместе с его модификатором и типом.  
  
## См. также  
 [Добавление метода](../ide/adding-a-method-visual-cpp.md)   
 [Атрибуты IDL, мастер добавления метода](../ide/idl-attributes-add-method-wizard.md)