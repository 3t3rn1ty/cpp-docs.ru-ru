---
title: "Реализация точки подключения (Visual C++) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "точки подключения [C++], реализация"
  - "мастер реализации точек подключения [C++]"
ms.assetid: 5b37e4f9-73c9-4bef-b26d-365bc0662260
caps.latest.revision: 6
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Реализация точки подключения (Visual C++)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Чтобы реализовать точку подключения с помощью мастера реализации точек подключения, необходимо создать проект как COM\-приложение ATL или как приложение MFC, содержащее поддержку ATL.  Можно использовать [мастер проектов ATL](../Topic/ATL%20Project%20Wizard.md) для создания приложения ATL или [добавить объект ATL в приложение MFC](../mfc/reference/adding-atl-support-to-your-mfc-project.md) для реализации поддержки ATL в приложении MFC.  
  
> [!NOTE]
>  Сведения о реализации точек подключения для проекта MFC см. в разделе [точки подключения](../mfc/connection-points.md).  
  
 После того как проект будет создан, для реализации точки подключения необходимо предварительно добавить объект ATL.  Список мастеров для добавления объектов в проекты ATL см. в разделе [Добавление объектов и элементов управления в проект ATL](../atl/reference/adding-objects-and-controls-to-an-atl-project.md).  
  
> [!NOTE]
>  Мастер не поддерживает диалоговые окна ATL, веб\-службы XML, созданные с помощью сервера ATL, объекты и счетчики производительности.  
  
 Подключаемый объект \(то есть, источник\) может предоставлять точку подключения для каждого из исходящих интерфейсов.   Каждый исходящий интерфейс можно реализовать с помощью клиента в объекте \(то есть приемника\).  Дополнительные сведения см. в разделе [точки подключения ATL](../atl/atl-connection-points.md).  
  
### Реализация точки подключения  
  
1.  В окне классов щелкните правой кнопкой мыши имя класса объекта ATL.  
  
2.  В появившемся контекстном меню выберите команду **Добавить** и затем выберите **Добавить точку подключения**, чтобы открыть [Мастер реализации точек подключения](../ide/implement-connection-point-wizard.md).  
  
3.  Из соответствующих библиотек типов выберите реализуемые интерфейсы точки подключения и нажмите кнопку **Готово**.  
  
4.  В окне классов проверьте классы прокси, создаваемые для каждой точки подключения.  Эти классы имеют вид CProxy*Имя\_интерфейса*\<T\> и являются производными от интерфейса [IConnectionPointImpl](../Topic/IConnectionPointImpl%20Class.md).  
  
5.  Дважды щелкните класс точки подключения, чтобы просмотреть его определение.  
  
    -   Если реализуется точка подключения для интерфейса собственного проекта, появится следующее определение:  
  
        ```  
        template< class T >  
        class CProxyInterfaceName :  
           public IConnectionPointImpl< T, &IID_InterfaceName >  
        {  
        public:  
        };  
        ```  
  
         Если реализуется локальный интерфейс, методы и свойства отображаются в теле класса.  
  
    -   Если реализуется точка подключения для другого интерфейса, определение будет включать методы интерфейса, перед каждым из которых будет стоять `Fire_`.  
  
## См. также  
 [Добавление функциональных возможностей с помощью мастеров кода](../ide/adding-functionality-with-code-wizards-cpp.md)   
 [Adding Connection Points to an Object](../atl/adding-connection-points-to-an-object.md)