---
title: Объявление массива CLR | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-cli
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- array keyword [C++]
ms.assetid: 36a8883c-2663-43f0-a90c-28f27035e036
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- dotnet
ms.openlocfilehash: c3de17bb293e10c4e1a2287ef12b934633b1fe21
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46426462"
---
# <a name="declaration-of-a-clr-array"></a>Объявление массива CLR

Синтаксис объявления, создания экземпляра и инициализации управляемого массива отличается от управляемых расширений для C++ в Visual C++.

Объявление массива объекта CLR в управляемых расширениях был расширение объявления обычный массив, в котором `__gc` между именем объекта массива и его измерения, возможно заполнением запятыми, как показано в следующей паре помещалась ключевое слово Примеры:

```
void PrintValues( Object* myArr __gc[]);
void PrintValues( int myArr __gc[,,]);
```

Это был упрощен в новом синтаксисе, в котором мы используем шаблон объявления, аналогичную стандартной библиотеки C++ `vector` объявления. Первый параметр указывает тип элемента. Второй параметр указывает размер массива (значение по умолчанию 1, это только несколько измерений требуют второй аргумент). Объект массива представляет собой дескриптор отслеживания и должен сопровождаться hat. Если тип элемента также является ссылочным типом, его также необходимо использовать знак крышки. Например приведенном выше примере, если выражено в новом синтаксисе, выглядит следующим образом:

```
void PrintValues( array<Object^>^ myArr );
void PrintValues( array<int,3>^ myArr );
```

Поскольку ссылочный тип дескриптора отслеживания, а не к объекту, можно определить массив CLR в качестве возвращаемого типа функции. (В противоположность этому, он не можно указать собственный массив в качестве возвращаемого типа функции.) Синтаксис для этого в управляемых расширениях была довольно сложными. Пример:

```
Int32 f() [];
int GetArray() __gc[];
```

В Visual C++ объявление является гораздо проще. Например, примененная к объекту директива

```
array<Int32>^ f();
array<int>^ GetArray();
```

Сокращенная форма инициализации локального управляемого массива поддерживается в обеих версиях языка. Пример:

```
int GetArray() __gc[] {
   int a1 __gc[] = { 1, 2, 3, 4, 5 };
   Object* myObjArray __gc[] = {
      __box(26), __box(27), __box(28), __box(29), __box(30)
   };
   return a1;
}
```

существенно упрощены в новом синтаксисе (Обратите внимание, что, так как упаковка является неявной в новом синтаксисе `__box` была исключена оператор — см. в разделе [их поведение и типы значений (C + +/ CLI)](../dotnet/value-types-and-their-behaviors-cpp-cli.md) обсуждение):

```
array<int>^ GetArray() {
   array<int>^ a1 = {1,2,3,4,5};
   array<Object^>^ myObjArray = {26,27,28,29,30};
   return a1;
}
```

Так как массив является ссылочным типом CLR, объявление каждого объекта массива представляет собой дескриптор отслеживания. Таким образом массив объектов должен быть выделен в куче среды CLR. (Сокращенную нотацию скрывает выделения памяти в куче). Ниже приведен явная форма инициализации объекта массива в управляемых расширениях.

```
Object* myArray[] = new Object*[2];
String* myMat[,] = new String*[4,4];
```

В новом синтаксисе `new` выражение заменяется `gcnew`. Размеры измерений передаются как параметры для `gcnew` выражения, как показано ниже:

```
array<Object^>^ myArray = gcnew array<Object^>(2);
array<String^,2>^ myMat = gcnew array<String^,2>(4,4);
```

В новом синтаксисе, можно выполнить список явной инициализации `gcnew` выражения; это не поддерживается в управляемых расширений. Пример:

```
// explicit initialization list following gcnew
// was not supported in Managed Extensions
array<Object^>^ myArray =
   gcnew array<Object^>(4){ 1, 1, 2, 3 };
```

## <a name="see-also"></a>См. также

[Управляемые типы (C + +/ CL)](../dotnet/managed-types-cpp-cl.md)<br/>
[Массивы](../windows/arrays-cpp-component-extensions.md)