---
title: "Поддержка многобайтовых кодировок | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "_mbcs"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "кодировки [C++], многобайтовый"
  - "MBCS [C++]"
  - "MBCS [C++], сведения о MBCS"
  - "многобайтовая кодировка [C++]"
ms.assetid: b498733c-a1e1-45e3-8f26-d6da3cb5f2dd
caps.latest.revision: 11
author: "ghogen"
ms.author: "ghogen"
manager: "ghogen"
caps.handback.revision: 11
---
# Поддержка многобайтовых кодировок
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Многобайтовые кодировки \(MBCS\) — это более старый подход к поддержке кодировок, подобных японской и китайской, которые не могут быть представлены одним байтом.  Для разработки новых приложений следует использовать Юникод для всех текстовых строк, за исключением, возможно, системных строк, которые не видны пользователям.  MBCS — это устаревшая технология, которая не рекомендуется для разработки новых приложений.  
  
 Наиболее распространенная реализация многобайтовой кодировки — двухбайтовая кодировка \(DBCS\).  Visual C\+\+ в целом и MFC в частности полностью поддерживают DBCS.  
  
> [!WARNING]
>  В Visual Studio 2013 и более поздних версиях библиотеки MFC для MBCS будут представлены в виде надстройки Visual Studio и будут доступны пользователям Visual Studio бесплатно \(только выпуски Professional и Enterprise\) на сайте загрузки MSDN.  
>   
>  Эти библиотеки занимают примерно 440 МБ на диске, а установка включает все локализованные версии библиотек.  Их можно установить на любом компьютере с установленной версией Visual Studio Community, Professional или Enterprise, на котором включена платформа MFC.  
>   
>  Если удалить или восстановить Visual Studio, библиотеки MBCS также будут удалены и восстановлены.  Тем не менее, если удалить MFC, в системе останутся только библиотеки MBCS.  При восстановлении библиотек MBCS Visual Studio никоим образом не изменяется.  
>   
>  Распространяемые пакеты для Visual Studio 2013 и более поздних версий по\-прежнему будут содержать DLL\-библиотеки MFC для MBCS.  Никаких дополнительных действий для распространения их клиентам не нужно.  
  
 Примеры см. в файлах исходного кода MFC.  
  
 Для платформ, использующих объемные кодировки, наилучшая альтернатива Юникоду — это MBCS.  MFC поддерживает MBCS с помощью интернациализируемых типов данных и функций времени выполнения C.  То же следует сделать и в вашем коде.  
  
 В MBCS символы кодируются одним или двумя байтами.  В двухбайтовых символах первый или старший байт указывает, что он и следующий байт должны интерпретироваться как один символ.  Первый байт относится к диапазону кодов, зарезервированных для использования в качестве старших байтов.  То, какие диапазоны байтов могут быть старшими байтами, зависит от используемой кодовой страницы.  Например, японская кодовая страница 932 использует в качестве старших байтов диапазон 0x81–0x9F, но корейская кодовая страница 949 использует другой диапазон.  
  
 Учитывайте следующие аспекты при программировании с использованием MBCS.  
  
 Символы MBCS в среде  
 Символы MBCS могут использоваться в таких строках, как имена файлов и каталогов.  
  
 Операции редактирования  
 Операции редактирования в приложениях с MBCS должны работать с символами, а не байтами.  Каретка должна быть неразделенным символом, клавиша со стрелкой вправо должна перемещать указатель на один символ вправо и т. д.  Функция **удаления** должна удалить символ, а функция **Отменить** должна вставлять его повторно.  
  
 Обработка строк  
 В приложении, использующем MBCS, обработка строк вызывает особые проблемы.  Символы из одного и двух байтов могут быть перемешаны в одной строке. Поэтому необходимо всегда проверять старшие байты.  
  
 Поддержка библиотеки времени выполнения  
 Библиотеки времени выполнения языка C и MFC поддерживают однобайтовые и многобайтовые кодировки, а также Юникод.  Однобайтовые строки обрабатываются с помощью семейства функций времени выполнения `str`, строки MBSC обрабатываются с помощью соответствующих функций `_mbs`, а строки Юникода обрабатываются с помощью соответствующих функций *wcs*.  В реализациях функций\-членов классов MFC используются переносимые функции времени выполнения, которые в некоторых обстоятельствах сопоставляются с обычным семейством функций `str`, функциями MBSC или функциями Юникода, как описано в разделе "Переносимость MBSC и Юникода".  
  
 Переносимость MBSC и Юникода  
 С помощью файла заголовка Tchar.h можно создавать приложения, работающие с однобайтовыми, многобайтовыми кодировками и Юникодом из одних источников.  В файле Tchar.h определяются макросы с префиксом *\_tcs* , которые сопоставляются с функциями `str`, `_mbs` и *wcs* соответственно.  Для использования MBSC определите символ **\_MBCS**.  Для использования Юникода определите символ **\_UNICODE**.  По умолчанию для приложений MFC определяется **\_MBCS**.  Подробнее: [Универсальные текстовые сопоставления в файле Tchar.h](../Topic/Generic-Text%20Mappings%20in%20Tchar.h.md).  
  
> [!NOTE]
>  Поведение не определено, если указать одновременно **\_UNICODE** и **\_MBCS**.  
  
 Файлы заголовков Mbctype.h и Mbstring.h определяют функции и макросы MBCS, которые могут понадобиться в некоторых случаях.  Например, `_ismbblead` сообщает, является ли указанный байт в строке старшим.  
  
 Для международной переносимости используйте в приложении [Юникод](../text/support-for-unicode.md) или многобайтовую кодировку \(MBCS\).  
  
## Выберите действие  
  
-   [Реализация многобайтовой кодировки в приложениях](../text/international-enabling.md)  
  
-   [Одновременное использование Юникода и многобайтовых кодировок в программе](../text/internationalization-strategies.md)  
  
-   [Использование MBSC для создания многоязыковых программ](../Topic/MBCS%20Programming%20Tips.md)  
  
-   [См. сводную информация о программировании с использованием MBCS](../Topic/MBCS%20Programming%20Tips.md)  
  
-   [Сведения о переносимости обычного текста в байтовый формат](../Topic/Generic-Text%20Mappings%20in%20Tchar.h.md)  
  
## См. также  
 [Текст и строки](../text/text-and-strings-in-visual-cpp.md)   
 [Поддержка многобайтовой кодировки MBCS в Visual C\+\+](../text/mbcs-support-in-visual-cpp.md)