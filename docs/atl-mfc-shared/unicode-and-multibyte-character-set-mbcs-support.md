---
title: Юникода и многобайтовой кодировки (MBCS) поддержка набора | Документы Microsoft
ms.custom: ''
ms.date: 1/09/2017
ms.technology:
- cpp-mfc
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- MFC [C++], character set support
- MBCS [C++], strings and MFC support
- strings [C++], MBCS support in MFC
- character sets [C++], multibyte
- Unicode [C++], MFC strings
- Unicode [C++], string objects
- strings [C++], Unicode
- strings [C++], character set support
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 8492e4a6777e4d609e3b457cfc77d1b8a691eed3
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32361679"
---
# <a name="unicode-and-multibyte-character-set-mbcs-support"></a>Поддержка Юникода и многобайтовой кодировки

Некоторые языки, например, японский и китайский имеют объемные кодировки. Для поддержки программирования для этих рынков, библиотеки классов Microsoft Foundation (MFC) обеспечивает два различных подхода к обработке объемные кодировки:

- [Юникод](#mfc-support-for-unicode-strings), `wchar_t` на основе расширенных символов и строк в кодировке UTF-16.

- [Многобайтовые наборов символов (MBCS)](#mfc-support-for-mbcs-strings), `char` на основе одного или двухбайтовые символы и строки, закодированы в набор символов определенного языкового стандарта.

Корпорация Майкрософт рекомендовала библиотеки MFC Юникода для всех новых разработках и устаревшие библиотеки MBCS в Visual Studio 2013 и Visual Studio 2015. Этот режим больше не используется. Предупреждения об устаревании MBCS будут удалены в Visual Studio 2017 г.

## <a name="mfc-support-for-unicode-strings"></a>Поддержка MFC для строки в Юникоде

Условно всей библиотеки классов MFC включена для символов Юникода или строки, хранящиеся в расширенные символы как UTF-16. В частности, класс [CString](../atl-mfc-shared/reference/cstringt-class.md) поддержкой Юникода.

Поддержка Юникода в MFC используются эти библиотеки, отладчик и DLL-файлы:

|||||
|-|-|-|-|
|UAFXCW. LIB|UAFXCW. PDB-ФАЙЛ|UAFXCWD. LIB|UAFXCWD. PDB-ФАЙЛ|
|MFC*версии*U.LIB|MFC*версии*U.PDB|MFC*версии*U.DLL|MFC*версии*UD. LIB|
|MFC*версии*UD. PDB-ФАЙЛ|MFC*версии*UD. БИБЛИОТЕКИ DLL|MFCS*версии*U.LIB|MFCS*версии*U.PDB|
|MFCS*версии*UD. LIB|MFCS*версии*UD. PDB-ФАЙЛ|MFCM*версии*U.LIB|MFCM*версии*U.PDB|
|MFCM*версии*U.DLL|MFCM*версии*UD. LIB|MFCM*версии*UD. PDB-ФАЙЛ|MFCM*версии*UD. БИБЛИОТЕКИ DLL|

(*версии* представляет номер версии файла, например, "140" означает версии 14.0.)

`CString` на основе `TCHAR` тип данных. Если символ `_UNICODE` определен для построения программы, `TCHAR` определен как тип `wchar_t`, 16-разрядный символ, тип кодировки. В противном случае `TCHAR` определяется как `char`, обычный 8-разрядное кодировку. Таким образом, в Юникод `CString` состоит из 16-битовых символов. Без Юникода, он состоит из символов типа `char`.

Для завершения Юникод программирование приложения, необходимо также:

- Используйте `_T` макрос условно код строковых литералов переносить в Юникод.

- При передаче строки, обратите внимание на ли аргументов функции требуется длина в символах или длина в байтах. Различие очень важно, если вы используете строки в Юникоде.

- Использование переносимой версии функций C во время выполнения обработки строк.

- Используйте следующие типы данных для символов и указатели на расширенные символы:

   - Используйте `TCHAR` где использовалась бы `char`.

   - Используйте `LPTSTR` где использовалась бы `char*`.

   - Используйте `LPCTSTR` где использовалась бы `const char*`. `CString` предоставляет оператор `LPCTSTR` для преобразования между `CString` и `LPCTSTR`.

`CString` также предоставляет конструкторы поддерживают Юникод, операторы присваивания и операторы сравнения.

[Справочник по библиотеке времени выполнения](../c-runtime-library/c-run-time-library-reference.md) определяет переносимой версии всех функций обработки строк. Дополнительные сведения см. в разделе категории [интернационализации](../c-runtime-library/internationalization.md).

## <a name="mfc-support-for-mbcs-strings"></a>Поддержка MFC для Многобайтовой строки

Библиотека классов включена для многобайтовых кодировок, но только для двухбайтовых символов задает (DBCS).

В многобайтовой кодировки может содержать один или два байта. Если это два байта, его первый байт является специальной «старший байт», выбранный из определенного диапазона, в зависимости от того, какой код страницы уже используется. В совокупности открывающий и «младший байт» укажите уникальный кодировка.

Если символ `_MBCS` определен для построения программы, тип `TCHAR`, на котором `CString` основывается, сопоставляется `char`. Можно определить, какие байты в `CString` является старшие байты, а какая — младший байт. Библиотеки времени выполнения C предоставляет функции, чтобы определить это.

В кодировке DBCS заданной строке может содержать все однобайтовых знаков ANSI, все символы двухбайтовой или сочетание двух. Эти возможности требуется особое внимание при синтаксическом анализе строки. Сюда входят `CString` объектов.

> [!NOTE]
> Сериализацию строки Юникода в MFC можно считать Юникод и многобайтовая Кодировка строки, независимо от того, какая версия приложения, которое выполняется. Файлы данных могут переноситься между Юникод и многобайтовая Кодировка версии программы.

`CString` функции-члены используются специальные «универсальный текст» версии функций времени выполнения C, которые вызываются или использовании функции поддерживают Юникод. Таким образом, например если `CString` обычно вызывается функция `strcmp`, она вызывает соответствующий универсальная текстовая функция `_tcscmp` вместо него. В зависимости от того, как символы `_MBCS` и `_UNICODE` определены, `_tcscmp` сопоставляет следующим образом:

|||
|-|-|
|`_MBCS` определенные|`_mbscmp`|
|`_UNICODE` определенные|`wcscmp`|
|Ни один символ определен|`strcmp`|

> [!NOTE]
> Символы `_MBCS` и `_UNICODE` являются взаимоисключающими.

Сопоставления универсальных текстовых функций для всех подпрограммы обработки строк во время выполнения рассматриваются в [Справочник по библиотеке времени выполнения C](../c-runtime-library/c-run-time-library-reference.md). Список см. в разделе [интернационализации](../c-runtime-library/internationalization.md).

Аналогичным образом `CString` методы реализуются с помощью сопоставления типов универсальных данных. Чтобы включить многобайтовой Кодировки и Юникода, MFC использует `TCHAR` для `char` или `wchar_t`, `LPTSTR` для `char*` или `wchar_t*`, и `LPCTSTR` для `const char*` или `const wchar_t*`. Это обеспечивает правильного сопоставления для MBCS или Юникод.

## <a name="see-also"></a>См. также

[Строки (ATL и MFC)](../atl-mfc-shared/strings-atl-mfc.md)  
[Операции со строками](../c-runtime-library/string-manipulation-crt.md)  
