---
title: Библиотека шаблонов C++ среды выполнения Windows (WRL) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-windows
ms.topic: reference
dev_langs:
- C++
ms.assetid: b915afce-553b-44a7-b8dc-0ab601758eb0
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- uwp
ms.openlocfilehash: 40d2ecbcfcd4121727bfe34bf2ffd571722b8a68
ms.sourcegitcommit: d55ac596ba8f908f5d91d228dc070dad31cb8360
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2018
ms.locfileid: "33891627"
---
# <a name="windows-runtime-c-template-library-wrl"></a>Библиотека шаблонов C++ среды выполнения Windows (WRL)
Библиотека шаблонов C++ среды выполнения Windows (WRL) — это библиотека шаблонов, которая предлагает низкоуровневый способ создания и использования компонентов среды выполнения Windows.

> [!NOTE]
> WRL теперь заменен в C + +/ WinRT, стандартная C ++ 17 языковых проекции для API среды выполнения Windows. C + +/ WinRT доступен в пакете SDK для Windows 10 версии 1803 и далее. C + +/ WinRT реализованы полностью в файлах заголовков и позволят вам с первого класса доступа на современных API Windows.

> С помощью C + +/ WinRT, можно использовать и создавать с помощью любой совместимый со стандартами C ++ 17 компилятор API среды выполнения Windows. C + +/ WinRT обычно работает быстрее и создает меньше двоичные файлы, чем любой другой параметр языка для среды выполнения Windows. Мы продолжим для поддержки C + +/ CX и WRL, но настоятельно рекомендуется, используют новые приложения C + +/ WinRT. Дополнительные сведения см. в разделе [C + +/ WinRT](https://docs.microsoft.com/windows/uwp/cpp-and-winrt-apis/index).   
  
## <a name="benefits"></a>Преимущества  
 Библиотека шаблонов C++ среды выполнения Windows дает возможность упрощает реализацию и использование модели объектов компонентов (COM). Она предоставляет такие методы обслуживания, как подсчет ссылок для управления временем существования объектов и проверка значений `HRESULT` для определения успеха или сбоя операции. Для успешного использования библиотека шаблонов C++ среды выполнения Windows, необходимо строго следовать следующим правила и методам.  
  
 C + +/ CX —, основанный на языке высокоуровневый способ использования компонентов среды выполнения Windows. Библиотека шаблонов C++ среды выполнения Windows и C + +/ CX упрощают создание кода для среды выполнения Windows путем автоматического выполнения задач обслуживания от вашего имени.  
  
 Библиотека шаблонов C++ среды выполнения Windows и C + +/ CX предоставляют различные преимущества. Ниже приведены некоторые причины, может потребоваться использовать библиотека шаблонов C++ среды выполнения Windows вместо C + +/ CX:  
  
-   Библиотека шаблонов C++ среды выполнения Windows добавляет небольшую абстракцию через Windows среда выполнения приложения двоичного интерфейса (ABI), что дает вам возможность управлять базовым кодом для повышения эффективности или использования API среды выполнения Windows.  
  
-   C + +/ CX представляет COM `HRESULT` значения как исключения. Если вы наследуете базу кода, которая использует модель COM или не использует исключения, может оказаться, что библиотека шаблонов C++ среды выполнения Windows является более естественным способом для работы со средой выполнения Windows, так как нет необходимости в использовании исключений.  
  
    > [!NOTE]
    >  Библиотека шаблонов C++ среды выполнения Windows использует `HRESULT` значений и не вызывает исключения. Кроме того библиотека шаблонов C++ среды выполнения Windows использует интеллектуальные указатели и шаблон RAII, которые позволяют гарантировать, что правильно уничтожения объектов при создании исключения кодом приложения. Дополнительные сведения об интеллектуальных указателях и RAII см. в разделе [интеллектуальные указатели](../cpp/smart-pointers-modern-cpp.md) и [объектов собственные ресурсы (RAII)](../cpp/objects-own-resources-raii.md).  
  
-   Назначение и разработки библиотеки шаблонов C++ среды выполнения Windows расширений по Active Template Library (ATL), который представляет собой набор основанных на шаблонах классов C++, упрощающих написание объектов COM. Поскольку библиотека шаблонов C++ среды выполнения Windows использует стандартный язык C++ программы-оболочки для среды выполнения Windows, можно более просто порт и взаимодействовать с многими существующими COM компонентами, написанными в библиотеке ATL для среды выполнения Windows. Если вы уже знаете ATL, может оказаться, что библиотека шаблонов C++ среды выполнения Windows писать программы стало проще.  
  
## <a name="getting-started"></a>Начало работы  
 Ниже приведены некоторые ресурсы, которые помогут вам начать работу прямо сейчас с библиотека шаблонов C++ среды выполнения Windows.  
  
 [Библиотека среды выполнения Windows (WRL)](http://channel9.msdn.com/Events/Windows-Camp/Developing-Windows-8-Metro-style-apps-in-Cpp/The-Windows-Runtime-Library-WRL-)  
 В этом видео Channel 9 Дополнительные сведения о том, как библиотека шаблонов C++ среды выполнения Windows помогает записи приложения универсальной платформы Windows (UWP) и как создавать и использовать компоненты среды выполнения Windows.  
  
 [Как: активация и использование компонента среды выполнения Windows](../windows/how-to-activate-and-use-a-windows-runtime-component-using-wrl.md)  
 Показано, как использовать библиотека шаблонов C++ среды выполнения Windows для инициализации среды выполнения Windows и активация и использование компонента среды выполнения Windows.  
  
 [Как: завершение асинхронных операций](../windows/how-to-complete-asynchronous-operations-using-wrl.md)  
 Показано, как использовать библиотека шаблонов C++ среды выполнения Windows для запуска асинхронных операций и выполнения работы при завершении операций.  
  
 [Как: обработка событий](../windows/how-to-handle-events-using-wrl.md)  
 Показано, как использовать библиотека шаблонов C++ среды выполнения Windows для подписки и обрабатывать события объекта среды выполнения Windows.  
  
 [Пошаговое руководство. Создание приложения UWP с использованием WRL и Media Foundation](../windows/walkthrough-creating-a-windows-store-app-using-wrl-and-media-foundation.md)  
 Сведения о создании приложения UWP, в котором используется [Microsoft Media Foundation](http://msdn.microsoft.com/library/windows/apps/ms694197).  
  
 [Как: создание классического компонента COM](../windows/how-to-create-a-classic-com-component-using-wrl.md)  
 Показано, как использовать библиотека шаблонов C++ среды выполнения Windows для создания базового COM-компонента и описание простого способа регистрации и использования COM-компонент из классического приложения.  
  
 [Практическое руководство. Непосредственное создание экземпляра компонентов WRL](../windows/how-to-instantiate-wrl-components-directly.md)  
 Сведения об использовании [Microsoft::wrl:: make](../windows/make-function.md) и [Microsoft::WRL::Details::MakeAndInitialize](../windows/makeandinitialize-function.md) функции для создания экземпляра компонента из определяющего его модуля.  
  
 [Практическое руководство. Использование winmdidl.exe и midlrt.exe для создания H-файлов из метаданных Windows](../windows/use-winmdidl-and-midlrt-to-create-h-files-from-windows-metadata.md)  
 Демонстрация использования пользовательских компонент среды выполнения Windows из WRL путем создания IDL-файла из метаданных WINMD.  
  
 [Пошаговое руководство. Подключение с использованием задач и HTTP-запросов XML](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md)  
 Показано, как использовать [IXMLHTTPRequest2](http://msdn.microsoft.com/en-us/bbc11c4a-aecf-4d6d-8275-3e852e309908) и [IXMLHTTPRequest2Callback](http://msdn.microsoft.com/en-us/aa4b3f4c-6e28-458b-be25-6cce8865fc71) интерфейсы вместе с задачами отправки запросов HTTP GET и POST к веб-службе в приложении UWP.  
  
 [Пример приложения Bing Maps Trip Optimizer](http://code.msdn.microsoft.com/Bing-Maps-trip-optimizer-c4e037f7)  
 Использует `HttpRequest` класс, который определен в [Пошаговое руководство: подключение с использованием задач и HTTP-запросов XML](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md) в контексте завершения приложения UWP.  
  
 [Создание компонента DLL среды выполнения Windows с использованием примера C++](http://code.msdn.microsoft.com/windowsapps/Creating-a-Windows-Runtime-6c399797)  
 Показано, как использовать библиотека шаблонов C++ среды выполнения Windows для создания внутрипроцессного компонента библиотеки DLL и его использования в C + +/ CX, JavaScript и C#.  
  
 [Пример игры DirectX marble maze](http://code.msdn.microsoft.com/windowsapps/DirectX-Marble-Maze-Game-e4806345)  
 Демонстрирует использование библиотека шаблонов C++ среды выполнения Windows для управления временем существования COM-компонентов, таких как DirectX и Media Foundation в контексте полностью созданной трехмерной игры.  
  
 [Отправка всплывающих уведомлений из примера классического приложения](http://code.msdn.microsoft.com/windowsdesktop/Sending-toast-notifications-71e230a2)  
 Демонстрирует использование библиотека шаблонов C++ среды выполнения Windows для работы с всплывающими уведомлениями из классического приложения.  
  
## <a name="windows-runtime-c-template-library-compared-to-atl"></a>Библиотека шаблонов C++ среды выполнения Windows, по сравнению с библиотекой ATL  
 Библиотека шаблонов C++ среды выполнения Windows напоминает Active Template Library (ATL), поскольку его можно использовать для создания небольших, быстрых COM-объектов. Библиотека шаблонов C++ среды выполнения Windows и ATL также используются общие понятия, например определение объектов в модулях, явная регистрация интерфейсов и открытое создание объектов с помощью фабрик. Могут быть уверены, что справитесь с библиотека шаблонов C++ среды выполнения Windows, если вы знакомы с ATL.  
  
 Библиотека шаблонов C++ среды выполнения Windows поддерживает функциональные возможности модели COM, который требуется для приложений UWP. Поэтому она отличается от библиотеки ATL, поскольку в последней нет непосредственной поддержки таких функций модели COM, как:  
  
-   статистическая обработка  
  
-   стандартные реализации  
  
-   сдвоенные интерфейсы (`IDispatch`)  
  
-   стандартные интерфейсы перечислителя  
  
-   точки подключения  
  
-   перемещаемые интерфейсы  
  
-   внедрение OLE  
  
-   Элементы управления ActiveX  
  
-   COM+  
  
## <a name="concepts"></a>Основные понятия  
 Библиотека шаблонов C++ среды выполнения Windows предоставляет типы, представляющие несколько основных понятий. Эти типы описаны в следующих разделах.  
  
### <a name="comptr"></a>ComPtr  
 [ComPtr](../windows/comptr-class.md) — *интеллектуального указателя* тип, представляющий интерфейс, который задается параметром шаблона. Тип `ComPtr` используется для объявления переменной, которая может получить доступ к членам объекта, производного от интерфейса. `ComPtr` автоматически поддерживает счетчик ссылок для указателя базового интерфейса и освобождает интерфейс, когда счетчик ссылок становится равен нулю.  
  
### <a name="runtimeclass"></a>RuntimeClass  
 [RuntimeClass](../windows/runtimeclass-class.md) представляет собой экземпляр класса, который наследуется от набора указанных интерфейсов. Объект `RuntimeClass` объект может обеспечить поддержку одного или нескольких интерфейсов COM среды выполнения Windows или слабую ссылку на компонент.  
  
### <a name="module"></a>Module  
 [Модуль](../windows/module-class.md) представляет коллекцию связанных объектов. Объект `Module` управляет фабриками класса, создающими объекты, и регистрацией, которая позволяет другим приложениям использовать объект.  
  
### <a name="callback"></a>Callback  
 [Обратного вызова](../windows/callback-function-windows-runtime-cpp-template-library.md) функция создает объект, функция-член которого является обработчиком событий (метод обратного вызова). Функция `Callback` используется для записи асинхронных операций.  
  
### <a name="eventsource"></a>EventSource  
 [EventSource](../windows/eventsource-class.md) используется для управления *делегировать* обработчики событий. Использование библиотека шаблонов C++ среды выполнения Windows для реализации делегата и использование `EventSource` для добавления, удаления и вызова делегатов.  
  
### <a name="asyncbase"></a>AsyncBase  
 [AsyncBase](../windows/asyncbase-class.md) предоставляет виртуальные методы, которые представляют асинхронной модели программирования среды выполнения Windows. Переопределите члены этого класса для создания пользовательского класса, который может запускать и останавливать асинхронную операцию, а также проверять ход ее выполнения.  
  
### <a name="ftmbase"></a>FtmBase  
 [FtmBase](../windows/ftmbase-class.md) представляет объект маршаллера в режиме свободного потока. `FtmBase` создает общую таблицу интерфейса (GIT) и помогает управлять маршалингом и прокси-объектами.  
  
### <a name="weakref"></a>WeakRef  
 [WeakRef](../windows/weakref-class.md) — тип интеллектуального указателя, который представляет *слабой ссылки*, который ссылается на объект, который может или не может быть доступен. Объект `WeakRef` объект может использоваться только в среде выполнения Windows, а не в классической модели COM.  
  
 Объект `WeakRef` обычно представляет объект, наличием которого управляет внешний поток или приложение. Например, объект `WeakRef` может ссылаться на объект файла. При открывании файла `WeakRef` является допустимым и файл, на который он ссылается, доступен. Однако после закрытия файла `WeakRef` перестает быть допустимым и файл становится недоступным.  
  
## <a name="related-topics"></a>См. также  
  
|||  
|-|-|  
|[Основные API по категориям](../windows/key-wrl-apis-by-category.md)|Выделяет основной типов, функций и макросов библиотека шаблонов C++ среды выполнения Windows.|  
|[Ссылки](../windows/wrl-reference.md)|Содержит справочную информацию для библиотека шаблонов C++ среды выполнения Windows.|  
|[Краткий справочник (среда выполнения Windows и Visual C++)](http://go.microsoft.com/fwlink/p/?linkid=229180)|Краткое описание C + +/ CX компоненты, которые поддерживают среды выполнения Windows.|  
|[Использование компонентов среды выполнения Windows в Visual C++](http://go.microsoft.com/fwlink/p/?linkid=229155)|Показано, как использовать C + +/ CX для создания базового компонента среды выполнения Windows.|