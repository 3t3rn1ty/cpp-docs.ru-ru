---
title: "Пошаговое руководство. Создание и использование статической библиотеки (C++) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "библиотеки [C++], статические"
  - "статические библиотеки [C++]"
ms.assetid: 3cc36411-7d66-4240-851e-dacb9a8fd6ac
caps.latest.revision: 38
caps.handback.revision: 38
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
---
# Пошаговое руководство. Создание и использование статической библиотеки (C++)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этом пошаговом руководстве описывается создание статической библиотеки \(LIB\-файла\) для использования с приложениями C\+\+. Статические библиотеки являются хорошим способом повторного использования кода. Вместо того чтобы каждый раз реализовывать одни и те же подпрограммы для обеспечения той или иной функциональности в каждом создаваемом приложении, их можно создать единожды и затем вызывать из приложений. Код, подключенный из статической библиотеки, становится частью вашего приложения — для использования кода не нужно устанавливать еще какой\-либо файл.  
  
 В этом пошаговом руководстве рассматриваются следующие задачи:  
  
-   [Creating a static library project](#BKMK_CreateLibProject)  
  
-   [Adding a class to the static library](#BKMK_AddClassToLib)  
  
-   [Creating a console app that references the static library](#BKMK_CreateAppToRefTheLib)  
  
-   [Using the functionality from the static library in the app](#BKMK_UseLibInApp)  
  
-   [Running the app](#BKMK_RunApp)  
  
## Обязательные компоненты  
 Для работы необходимо владеть основами языка C\+\+.  
  
##  <a name="BKMK_CreateLibProject"></a> Создание проекта статической библиотеки  
  
#### Создание проекта статической библиотеки  
  
1.  В строке меню выберите **Файл**, **Создать**, **Проект**.  
  
2.  В левой области диалогового она **Создать проект** разверните **Установленные**, **Шаблоны**, **Visual C\+\+** и затем выберите **Win32**.  
  
3.  В центральной области выберите **Консольное приложение Win32**.  
  
4.  Укажите имя для проекта, например **MathFuncsLib**, в поле **Имя**. Укажите имя для решения, например **StaticLibrary**, в поле **Имя решения**. Нажмите кнопку **ОК**.  
  
5.  На странице **Обзор** диалогового окна **Мастер приложений Win32** нажмите кнопку **Далее**.  
  
6.  На странице **Параметры приложения** в разделе **Тип приложения** выберите **Статическая библиотека**.  
  
7.  На странице **Параметры приложения** в разделе **Дополнительные параметры** снимите флажок **Предкомпилированный заголовок**.  
  
8.  Нажмите кнопку **Готово**, чтобы создать проект.  
  
##  <a name="BKMK_AddClassToLib"></a> Добавление класса в статическую библиотеку  
  
#### Добавление класса в статическую библиотеку  
  
1.  Для создания файла заголовка для нового класса откройте контекстное меню проекта **MathFuncsLib** в **обозревателе решений**, а затем выберите **Добавить**, **Новый элемент**. В диалоговом окне **Добавление нового элемента** в левой области в разделе **Visual C\+\+** выберите **Код**. В центральной области выберите **Заголовочный файл \(.h\)**. Укажите имя для файла заголовка, например **MathFuncsLib.h**, и нажмите кнопку **Добавить**. Отобразится пустой файл заголовка.  
  
2.  Добавьте класс с именем **MyMathFuncs**, осуществляющий обычные арифметические операции, такие как сложение, вычитание, умножение и деление. Код должен выглядеть примерно следующим образом:  
  
     [!CODE [NVC_Walkthrough_Create_Static_Lib#100](../CodeSnippet/VS_Snippets_Cpp/nvc_walkthrough_create_static_lib#100)]  
  
3.  Для создания исходного файла для нового класса откройте контекстное меню проекта **MathFuncsLib** в **обозревателе решений**, а затем выберите **Добавить**, **Новый элемент**. В диалоговом окне **Добавление нового элемента** в левой области в разделе **Visual C\+\+** выберите **Код**. В центральной области выберите **Файл C\+\+ \(.cpp\)**. Укажите имя исходного файла, например **MathFuncsLib.cpp**, и нажмите кнопку **Добавить**. Отобразится пустой исходный файл.  
  
4.  Используйте этот исходный файл для реализации функций **MyMathFuncs**. Код должен выглядеть примерно следующим образом:  
  
     [!CODE [NVC_Walkthrough_Create_Static_Lib#110](../CodeSnippet/VS_Snippets_Cpp/nvc_walkthrough_create_static_lib#110)]  
  
5.  Скомпилируйте статическую библиотеку, выбрав **Собрать решение** в меню **Сборка**. В результате будет создана статическая библиотека, которая может использоваться другими программами.  
  
    > [!NOTE]
    >  При выполнении сборки из командной строки Visual Studio программа собирается в два этапа. Сначала запустите **cl \/c \/EHsc MathFuncsLib.cpp**, чтобы скомпилировать код и создать файл объекта с именем **MathFuncsLib.obj**. \(Команда **cl** вызывает компилятор Cl.exe, а параметр **\/c** дает указание компилировать без компоновки. Дополнительные сведения см. в разделе [Параметр \/c \(компиляция без связывания\)](../build/reference/c-compile-without-linking.md).\) Затем запустите файл **lib MathFuncsLib.obj**, чтобы связать код и создать статическую библиотеку **MathFuncsLib.lib**. \(Команда **lib** вызывает диспетчер библиотек, Lib.exe. Дополнительные сведения см. в разделе [Справочник по LIB](../build/reference/lib-reference.md).\)  
  
##  <a name="BKMK_CreateAppToRefTheLib"></a> Создание консольного приложения C\+\+, ссылающегося на статическую библиотеку  
  
#### Создание консольного приложения C\+\+, ссылающегося на статическую библиотеку  
  
1.  В строке меню выберите **Файл**, **Создать**, **Проект**.  
  
2.  В левой области в категории **Visual C\+\+** выберите **Win32**.  
  
3.  В центральной области выберите **Консольное приложение Win32**.  
  
4.  Укажите имя проекта, например **MyExecRefsLib**, в поле **Имя**. В раскрывающемся списке рядом с полем **Решение** выберите **Добавить в решение**. В результате новый проект будет добавлен в решение, содержащее статическую библиотеку. Нажмите кнопку **ОК**.  
  
5.  На странице **Обзор** диалогового окна **Мастер приложений Win32** нажмите кнопку **Далее**.  
  
6.  На странице **Параметры приложения** выберите в поле **Тип приложения** пункт **Консольное приложение**.  
  
7.  На странице **Параметры приложения** в разделе **Дополнительные параметры** снимите флажок **Предкомпилированный заголовок**.  
  
8.  Нажмите кнопку **Готово**, чтобы создать проект.  
  
##  <a name="BKMK_UseLibInApp"></a> Использование функциональности из статической библиотеки в приложении  
  
#### Использование функциональности из статической библиотеки в приложении  
  
1.  После создания консольного приложения будет создана пустая программа. Имя исходного файла будет совпадать с ранее выбранным именем. В этом примере он называется **MyExecRefsLib.cpp**.  
  
2.  Для использования математических процедур из статической библиотеки необходимо сослаться на эту библиотеку. Для этого откройте контекстное меню проекта **MyExecRefsLib** в **обозревателе решений**, а затем выберите пункт **Ссылки**. В диалоговом окне **Страницы свойствMyExecRefsLib** разверните узел **Общие свойства**, выберите **.NET Framework и ссылки** и нажмите кнопку **Добавить новую ссылку**. Дополнительные сведения о диалоговом окне **Ссылки** см. в разделе [Добавление ссылок](../ide/adding-references-in-visual-cpp-projects.md).  
  
3.  В диалоговом окне **Добавление ссылки** перечислены библиотеки, на которые можно создать ссылку. На вкладке **Проекты** перечислены все проекты текущего решения и включенные в них библиотеки, если они есть. На вкладке **Проекты** установите флажок **MathFuncsLib**, а затем нажмите кнопку **ОК**.  
  
4.  Для создания ссылки на файл заголовка **MathFuncsLib.h** необходимо изменить путь к каталогам включаемых файлов. Для этого в диалоговом окне **Окна свойств** библиотеки **MyExecRefsLib** последовательно разверните узлы **Свойства конфигурации**, **C\/C\+\+**, а затем выберите **Общие**. В поле **Дополнительные каталоги включаемых файлов** укажите путь к каталогу **MathFuncsLib** или найдите этот каталог.  
  
     Чтобы найти путь к каталогу, откройте раскрывающийся список значений свойства и выберите **Изменить**. В текстовом поле диалогового окна **Дополнительные каталоги включаемых файлов** выберите пустую строку и нажмите кнопку с многоточием \(**…**\) в конце строки. В диалоговом окне **Выбор каталога** выберите каталог **MathFuncsLib** и нажмите кнопку **Выбор папки**, чтобы сохранить выбранное значение и закрыть диалоговое окно. В диалоговом окне **Дополнительные каталоги включаемых файлов**, нажмите кнопку **ОК**, затем в диалоговом окне **Окна свойств** нажмите кнопку **ОК** для сохранения изменений в проект.  
  
5.  Теперь класс **MyMathFuncs** можно использовать в приложении. Для этого замените содержимое файла **MyExecRefsLib.cpp** следующим кодом:  
  
     [!CODE [NVC_Walkthrough_Create_Static_Lib#120](../CodeSnippet/VS_Snippets_Cpp/nvc_walkthrough_create_static_lib#120)]  
  
6.  Соберите исполняемый файл, выбрав команду **Собрать решение** в меню **Сборка**.  
  
##  <a name="BKMK_RunApp"></a> Запуск приложения  
  
#### Запуск приложения  
  
1.  Убедитесь, что проект **MyExecRefsLib** выбран в качестве проекта по умолчанию, открыв контекстное меню для **MyExecRefsLib** в **обозревателе решений** и выбрав пункт **Назначить запускаемым проектом**.  
  
2.  Чтобы запустить проект, в строке меню выберите **Отладка**, **Запуск без отладки**. Результат выполнения должен выглядеть примерно следующим образом:  
  
    ```Output  
    a + b = 106,4 a - b = -91,6 a * b = 732,6 a/b = 0,0747475  
    ```  
  
## См. также  
 [Обзор возможностей Visual C\+\+](http://msdn.microsoft.com/ru-ru/499cb66f-7df1-45d6-8b6b-33d94fd1f17c)   
 [Пошаговое руководство. Создание и использование библиотеки DLL \(C\+\+\)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)   
 [Классические приложения Windows \(Visual C\+\+\)](../windows/desktop-applications-visual-cpp.md)