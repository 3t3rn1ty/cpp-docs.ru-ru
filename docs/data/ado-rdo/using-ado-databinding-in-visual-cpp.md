---
title: "Использование привязки данных ADO в Visual C++ | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "ADO [C++], привязка данных"
  - "элементы управления с привязкой [C++], ADO"
  - "элементы управления с привязкой [C++], RDO"
  - "привязка данных [C++], ADO"
  - "привязка данных [C++], RDO"
ms.assetid: ad193919-3437-41ee-b41c-9d353f6274e5
caps.latest.revision: 7
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Использование привязки данных ADO в Visual C++
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Использование привязки данных ADO в Visual C\+\+ требует выполнения следующих шагов:  
  
-   Добавление элемента управления данными ADO.  
  
-   Указание источника данных.  
  
-   Указание источника записи \(SQL\-запрос или язык извлечения данных\).  
  
-   Добавление элемента управления привязки данных ADO.  
  
-   Подключение элемента управления привязки данных к элементу управления данными ADO.  
  
-   Выбор полей для связывания с источником записи элемента управления данными ADO.  
  
### Чтобы использовать привязку данных ADO в Visual C\+\+, выполните следующие действия:  
  
1.  C помощью мастера приложений MFC создайте приложение на базе диалогового окна MFC или представления формы MFC.  
  
2.  Добавьте в диалоговое окно элементы управления данными Microsoft ADO. Дополнительные сведения см. в разделе [Вставка элемента управления в приложение Visual C\+\+](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md).  
  
3.  Выберите элементы управления данными ADO для источника данных OLE DB.  
  
    1.  Щелкните правой кнопкой мыши элемент управления данными ADO и выберите пункт **Свойства**.  
  
    2.  На вкладке **Управление** выберите **Использовать строку подключения**.  Можно использовать предлагаемый поставщик или удалить его.  
  
    3.  Нажмите кнопку **Построить**.  Если поставщик ранее был удален из поля **Использовать строку подключения**, то можно задать поставщик сейчас.  После задания поставщика снова перейдите к свойствам элемента управления ADO и для продолжения повторно выберите команду **Построить**.  
  
         Если поставщик задан в поле **Использовать строку подключения** до нажатия кнопки **Построить**, то можно приступить к заданию свойств связи с данными.  Это показано в мастере DataLink.  
  
    4.  При необходимости измените значение поля **Поставщик** и задайте соответствующие значения в полях **Расположение** и **Источник** для требуемого поставщика.  Например, если используется поставщик SQL Server, то в поле **Расположение** необходимо задать сервер базы данных, а в поле **Источник данных** необходимо указать базу данных.  При использовании поставщика ODBC **Источником данных** является ODBC DSN.  
  
    5.  Выберите вкладку **Проверка подлинности** и задайте значения в полях **Имя пользователя** и **Пароль**, если этого требует источник данных.  
  
    6.  Выберите вкладку **Подключения** и затем нажмите кнопку **Проверить подключение** для проверки источника данных.  Прокрутите вниз окно "Результаты" для просмотра результатов прохождения теста.  При наличии ошибок проверьте конфигурацию источника данных.  Наиболее распространенные ошибки — это неправильно набранные пароли и неверные значения в полях **Расположение** и **Источник данных**.  
  
    7.  Завершите работу мастера и вернитесь на страницу свойств для элемента управления ADO.  
  
4.  На вкладке `RecordSource` введите в поле **Текст команды \(SQL\)** текст запроса.  К результатам этого запроса можно привязать элементы управления с привязкой данных.  Как правило для создания запроса используется язык SQL.  Однако некоторые поставщики OLE DB не используют язык SQL.  
  
5.  Задайте остальные требуемые свойства элемента управления данными ADO и закройте страницу свойств.  
  
6.  Добавьте элемент управления с привязкой данных.  Например, элемент управления DataGrid, который отличается от элемента управления RDO DBGrid.  
  
7.  Задайте свойства элемента управления DataGrid.  
  
    1.  Щелкните правой кнопкой мыши элемент управления DataGrid и выберите пункт **Свойства**.  
  
    2.  Щелкните вкладку **Все** и затем задайте свойство **DataSource** для элемента управления данными ADO.  Щелкните раскрывающийся список **DataSource** и найдите идентификатор элемента управления данными ADO.  По умолчанию имя идентификатора IDC\_ADODC1.  
  
8.  Для запуска в тестовом режиме нажмите сочетание клавиш CTRL\+T.  Данные можно прокручивать.  Для выхода из тестового режима нажмите клавишу ESC или закройте диалоговое окно.  
  
 В случае компиляции и запуска программы также возможна прокрутка данных.  
  
## См. также  
 [Привязка данных ADO](../../data/ado-rdo/ado-databinding.md)   
 [Привязка данных в Visual C\+\+ с помощью элементов управления ActiveX](../../data/ado-rdo/databinding-with-activex-controls-in-visual-cpp.md)