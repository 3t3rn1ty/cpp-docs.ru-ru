---
title: "Изменение поведения элемента управления во время выполнения | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "элементы управления ActiveX [C++], поведение во время выполнения"
ms.assetid: 78b44b0f-0d5a-4da0-8aa2-595f5789c634
caps.latest.revision: 10
caps.handback.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Изменение поведения элемента управления во время выполнения
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

После [вставки элемента управления](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md) и создания одного или нескольких [классов\-оболочек](../../data/ado-rdo/wrapper-classes.md) можно вызывать методы элемента управления и запрограммировать для него обработчики событий.  
  
 [Классы\-оболочки](../../data/ado-rdo/wrapper-classes.md) элемента управления указывают функции, которые можно использовать для изменения поведения элемента управления во время выполнения. Включите соответствующий файл заголовка класса\-оболочки и используйте методы. Чтобы задать свойство, найдите метод доступа с именем этого свойства и префиксом Set. Чтобы получить свойство, найдите метод доступа с именем этого свойства и префиксом Get. Обработчики событий можно написать позднее.  
  
 Поскольку элементы управления реализуются с помощью автоматизации, передаваемыми типами могут быть только типы, безопасные для автоматизации, такие как BSTR и VARIANT. Хотя для выделения и задания типов BSTR и VARIANT можно использовать системные вызовы, может потребоваться использовать классы\-оболочки ATL \([CComBSTR](../../atl/reference/ccombstr-class.md), [CComVariant](../../atl/reference/ccomvariant-class.md)\), классы\-оболочки для поддержки компилятора COM Visual C\+\+ \([\_bstr\_t](../../cpp/bstr-t-class.md), [\_variant\_t](../../cpp/variant-t-class.md)\) или класс\-оболочку MFC \([COleVariant](../../mfc/reference/colevariant-class.md)\).  
  
 При добавлении элемента управления данными мастер вставки элемента управления ActiveX создает классы\-оболочки коклассов элемента управления данными, которые управляют его внутренними объектами данных. Эти классы не включают все объекты RDO или ADO, а скорее представляют внутренние объекты, объявленные в библиотеке типов.  
  
 Если требуется напрямую использовать объекты ADO и RDO, нужно подключиться к DLL\-библиотекам объектов ADO и RDO напрямую \(Msado15.dll или Msrdo20.dll\) с помощью [классов поддержки компилятора COM](../../cpp/compiler-com-support-classes.md), которые поддерживают [директиву \#import](../../preprocessor/preprocessor-directives.md), или соответствующего пакета SDK.  
  
## Задание свойств элемента управления во время выполнения  
 Обратите внимание, что некоторые свойства элемента управления ActiveX могут быть доступны только для чтения во время выполнения, что затрудняет динамическое создание. Режим конструктора для инициализации свойств можно временно имитировать путем переопределения обработчика контейнера элемента управления [OnAmbientPropertyChange](../Topic/COleControl::OnAmbientPropertyChange.md), как описано в статье базы знаний Q260744 How to: Set ActiveX Control Design\-Time Properties at Run Time \(Практическое руководство. Задание свойств времени разработки элемента управления ActiveX во время выполнения\). Статьи базы знаний можно найти на веб\-сайте [http:\/\/support.microsoft.com\/](http://support.microsoft.com/).  
  
## См. также  
 [Использование элементов управления ActiveX](../Topic/Using%20ActiveX%20Controls.md)