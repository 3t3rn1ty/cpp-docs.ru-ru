---
title: "Заполнение списка из второго набора записей (доступ к данным MFC) | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CComboBox - класс, заливка объектов из второго набора строк"
  - "CListCtrl - класс, заливка объектов из второго набора записей"
  - "поля со списком [C++], заливка объектов из второго набора записей"
  - "наборы записей DAO"
  - "наборы записей DAO, заливка списков или полей со списками"
  - "заливка списков или полей со списками"
  - "списки, заливка объектов из второго набора записей"
  - "несколько наборов записей в представлениях записей"
  - "наборы записей ODBC [C++], заливка списков или полей со списками"
  - "представления записей, заливка списков"
  - "наборы записей [C++], заливка списков или полей со списками"
ms.assetid: 360c0834-da6b-4dc0-bcea-80e9acd611f0
caps.latest.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 9
---
# Заполнение списка из второго набора записей (доступ к данным MFC)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

По умолчанию представление записей связано с одним объектом набора записей, поля которого сопоставляются элементам управления представления записей.  Иногда может возникнуть необходимость поместить элемента управления списком или полем со списком в представление записей и заполнить его значениями из второго объекта набора записей.  Можно использовать поле со списком для выбора новой категории сведений для отображения в представлении записей пользователя.  В этом разделе объясняется, как и когда это можно сделать.  
  
> [!TIP]
>  Имейте в виду, что заполнение поля со списком или списка из источника данных может быть медленным.  Учитывайте этот факт при заполнении элемента управления данными из набора с большим числом записей.  
  
 Модель для этого раздела состоит из основного набора записей для заполнения элементов управления формы, и вторичного набора для заполнения списка или поля со списком.  При выборе строки в списке вызывает повторный запрос первого набора записей на основании выбранной программе.  Следующая процедура использует поле со списком, но применяется одинаково и к списку.  
  
#### Чтобы заполнить поле со списком или список из второго набора записей  
  
1.  Создание объекта набора записей \([CRecordset](../Topic/CRecordset%20Class.md) для ODBC, [CDaoRecordset](../mfc/reference/cdaorecordset-class.md) для DAO\).  
  
2.  Получение указателя на объект [CComboBox](../mfc/reference/ccombobox-class.md) для элемента управления полем со списком.  
  
3.  Очистите поле со списком от любого предыдущего содержимого.  
  
4.  Перемещение по всем записям в наборе записей, вызов метода [CComboBox::AddString](../Topic/CComboBox::AddString.md) для каждой строки из текущей записи для добавления в поле со списком.  
  
5.  Инициализируйте выбор элементов в поле со списком.  
  
```  
void CSectionForm::OnInitialUpdate()  
{  
    // ...  
  
    // Fill the combo box with all of the courses  
    CENROLLDoc* pDoc = GetDocument();  
    if (!pDoc->m_courseSet.Open())  
        return;  
  
    // ...  
  
    m_ctlCourseList.ResetContent();  
    if (pDoc->m_courseSet.IsOpen())  
    {   
        while (!pDoc->m_courseSet.IsEOF() )  
        {  
            m_ctlCourseList.AddString(  
                pDoc->m_courseSet.m_CourseID);  
            pDoc->m_courseSet.MoveNext();  
        }  
    }  
    m_ctlCourseList.SetCurSel(0);  
}  
```  
  
 В этой функции используется второй набор записей, `m_courseSet`, который содержит записи по всем предлагаемым курсам и элемент управления `CComboBox` , `m_ctlCourseList`, который хранится в классе представления записей.  
  
 Функция получает `m_courseSet` из документа и открывает его.  Затем она очищает `m_ctlCourseList` и совершается прокрутку по `m_courseSet`.  Для каждой записи,  функция вызывает для поля со списком функцию\-член `AddString`, чтобы добавить идентификатор курса из записи.  И, наконец, код задает для поля со списком выбранный элемент.  
  
## См. также  
 [Представления записей \(доступ к данным MFC\)](../data/record-views-mfc-data-access.md)   
 [Список драйверов ODBC](../data/odbc/odbc-driver-list.md)