---
title: "MFC. Использование классов базы данных с документами и представлениями | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CDaoRecordView - класс, использование в приложениях баз данных"
  - "CDaoRecordView - класс, использование в формах баз данных"
  - "CRecordView - класс, использование в формах баз данных"
  - "DAO [C++], формы (приложения баз данных)"
  - "наборы записей DAO [C++]"
  - "наборы записей DAO [C++], документы и представления"
  - "приложения баз данных [C++], формы"
  - "классы баз данных [C++], MFC - библиотека"
  - "архитектура документа/обзора [C++], в базе данных"
  - "документы [C++], приложения баз данных"
  - "формы [C++], приложения баз данных"
  - "ODBC [C++], формы"
  - "наборы записей ODBC [C++], документы и представления"
  - "представления записей [C++], приложения, основанные на формах"
  - "наборы записей [C++], документы и представления"
  - "представления [C++], приложения баз данных"
ms.assetid: 83979974-fc63-46ac-b162-e8403a572e2c
caps.latest.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 8
---
# MFC. Использование классов базы данных с документами и представлениями
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Классы MFC базы данных — DAO или ODBC — можно использовать как с документами и представлениями, так и без них.  В этом разделе будет уделено особое внимание работе с документами и представлениями.  В нем поясняются следующие вопросы:  
  
-   [Как написать приложение на основе форм](#_core_writing_a_form.2d.based_application) с помощью объекта `CRecordView` или `CDaoRecordView` в качестве основного представления документа.  
  
-   [Как использовать объекты наборов данных в документах и представлениях](#_core_using_recordsets_in_documents_and_views).  
  
-   [Другие вопросы](#_core_other_factors).  
  
 Кроме того, альтернативные варианты представлены в разделе [MFC: Использование классов базы данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md).  
  
##  <a name="_core_writing_a_form.2d.based_application"></a> Создание приложений на основе форм  
 Многие приложения, осуществляющие доступ к данным, созданы на основе форм.  Пользовательский интерфейс представляет собой форму, на которой размещены элементы управления процессами анализа, ввода и редактирования данных.  Чтобы создать приложение на основе формы, используйте класс `CRecordView` или `CDaoRecordView`.  При запуске Мастера приложений MFC и выборе типа клиента **ODBC** на странице **Поддержка баз данных** в проекте будет использоваться класс представления `CRecordView`.  Мастеры больше не поддерживают DAO, поэтому если требуется использование `CDaoRecordView`, необходимо написать к нему код вручную.  
  
 В приложении, создаваемом на основе форм, каждый объект представления записей сохраняет указатель в объект `CRecordset` или `CDaoRecordset`.  Механизм обмена данными с полями записей \(RFX\) обеспечивает обмен данными между набором записей и источником данных.  Механизм обмена данными с диалоговым окном \(DDX\) обеспечивает обмен данными между элементами полей данных объекта набора записей и элементами управления на форме.  Классы `CRecordView` и `CDaoRecordView` также предоставляют функции обработчиков команд по умолчанию для перемещения между записями на форме.  
  
 Описание процесса создания приложения на основе форм с помощью мастера приложений приведено в разделах [Создание приложений MFC на основе форм](../Topic/Creating%20a%20Forms-Based%20MFC%20Application.md) и [Поддержка баз данных, Мастер приложений MFC](../mfc/reference/database-support-mfc-application-wizard.md).  
  
 Подробное обсуждение форм представлено в разделе [Просмотр записей](../data/record-views-mfc-data-access.md).  
  
##  <a name="_core_using_recordsets_in_documents_and_views"></a> Использование наборов записей в документах и представлениях  
 Во многих простых приложениях, созданных на основе форм, не требуется создание документов.  Если ваше приложение более сложное, возможно вам потребуется использовать документ в качестве посредника между базой данных, а также хранить объекты `CDatabase` или `CDaoDatabase`, подключающиеся к источнику данных.  Приложения, создаваемые на основе форм, обычно сохраняют указатель на объект набора записей в представлении.  Другие приложения баз данных сохраняют наборы записей и объекты `CDatabase` или `CDaoDatabase` в документе.  Далее рассматриваются некоторые возможности использования документов в приложениях баз данных:  
  
-   Если вы обращаетесь к набору записей в локальном контексте, создайте объект `CRecordset` или `CDaoRecordset` локально в функциях\-членах документа или представления по мере необходимости.  
  
     Объявите объект набора записей как локальную переменную в функции.  Передайте **NULL** конструктору, после чего платформа создаст и откроет временный объект `CDatabase` или `CDaoDatabase`.  Как альтернативный вариант, передайте указатель объекту `CDatabase` или `CDaoDatabase`.  Используйте этот набор записей в функции и задайте его автоматическое удаление по прекращении выполнения функции.  
  
     При передаче **NULL** конструктору набора записей платформа использует информацию, возвращаемую функцией\-членом `GetDefaultConnect` этого набора записей, для создания и открытия объекта `CDatabase` или `CDaoDatabase`.  Мастер выполнит реализацию `GetDefaultConnect`.  
  
-   Если вы обращаетесь к набору записей во время существования документа, внедрите в документ один или более объектов `CRecordset` или `CDaoRecordset`.  
  
     Создайте объекты набора записей либо при инициализации документа, либо по мере необходимости.  Можно написать функцию, возвращающую указатель в набор записей, если он уже существует, либо создающую и открывающую набор записей, если он еще не существует.  Закройте, удалите или повторно создайте набор записей по мере необходимости, либо вызовите его функцию\-член **Requery** для обновления записей.  
  
-   Если вы обращаетесь к источнику данных во время существования документа, внедрите объект `CDatabase` или `CDaoDatabase`, либо сохраните указатель в объект `CDatabase` или `CDaoDatabase` внутри него.  
  
     Объект `CDatabase` или `CDaoDatabase` управляет подключением к источнику данных.  Объект будет создан автоматически во время создания документа. Вызовите его функцию\-член **Open** при инициализации документа.  При создании объектов наборов записей в функциях\-членах документа передайте указатель объекту `CDatabase` или `CDaoDatabase` этого документа.  Тем самым каждый набор записей будет ассоциирован со своим источником данных.  Объект базы данных обычно удаляется при закрытии документа.  Объекты набора записей обычно удаляются при выходе за пределы области действия функции.  
  
##  <a name="_core_other_factors"></a> Прочие факторы  
 В приложениях, созданных на основе форм, обычно не требуется механизм сериализации документа, предоставляемый платформой, поэтому может потребоваться удаление, отключение или замена команд `New` и **Открыть** в меню **Файл**.  См. статью [Сериализация и ввод\/вывод в базы данных](../mfc/serialization-serialization-vs-database-input-output.md).  
  
 Вам также могут потребоваться многие возможности пользовательского интерфейса, поддерживаемые платформой.  Например, можно использовать несколько объектов `CRecordView` или `CDaoRecordView` в разделяемом окне, открыть несколько наборов записей в разных дочерних окнах многодокументного интерфейса \(MDI\) и т. д.  
  
 Вам может потребоваться реализация функций печати содержимого окна представления, будь то форма, реализованная с помощью `CRecordView` или `CDaoRecordView`, либо другие возможности.  Классы, производные от `CFormView`, `CRecordView` и `CDaoRecordView`, не поддерживают печать. Но вы можете переопределить функцию\-член `OnPrint`, чтобы разрешить печать.  Дополнительные сведения см. в описании класса [CFormView](../mfc/reference/cformview-class.md).  
  
 Возможно, что вам совсем не потребуются документы и представления.  В этом случае см. раздел [MFC: Использование классов базы данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md).  
  
## См. также  
 [Классы баз данных MFC \(ODBC и DAO\)](../Topic/MFC%20Database%20Classes%20\(ODBC%20and%20DAO\).md)