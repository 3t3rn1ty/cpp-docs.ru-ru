---
title: Транзакция (ODBC) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- ODBC recordsets [C++], updating
- transactions [C++], MFC ODBC classes
- ODBC [C++], transactions
- recordsets [C++], updating
- databases [C++], transactions
- recordsets [C++], transactions
- ODBC recordsets [C++], transactions
ms.assetid: a2ec0995-2029-45f2-8092-6efd6f2a77f4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 3acd47746d3a920b679fb5509c34e5978ad43eed
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="transaction-odbc"></a>Транзакция (ODBC)
Этот раздел относится к классам MFC ODBC.  
  
 Транзакции — способ группирования или пакета, последовательность обновлений [источника данных](../../data/odbc/data-source-odbc.md) таким образом, все будут зафиксированы за один раз или не завершаются при откате транзакции. Если не используется транзакция, изменения в источник данных фиксируются автоматически, а по требованию.  
  
> [!NOTE]
>  Не все драйверы базы данных ODBC поддерживает транзакции. Вызовите `CanTransact` функцию-член вашей [CDatabase](../../mfc/reference/cdatabase-class.md) или [CRecordset](../../mfc/reference/crecordset-class.md) объектом, чтобы определить, поддерживает ли драйвер транзакций для базы данных. Обратите внимание, что `CanTransact` не показывает, является ли источник данных предоставляет полную поддержку транзакции. Необходимо также вызвать `CDatabase::GetCursorCommitBehavior` и `CDatabase::GetCursorRollbackBehavior` после **CommitTrans** и **отката** для проверки эффекта транзакции на открытом `CRecordset` объекта.  
  
 Вызовы `AddNew` и **изменить** функциями-членами `CRecordset` отразиться на источник данных, немедленно при вызове **обновление**. **Удалить** вызовы вступают в силу немедленно. В отличие от этого, можно использовать транзакцию, состоящую из нескольких вызовов `AddNew`, **изменить**, **обновление**, и **удалить**, которой будет выполнена, но не фиксируется до можно вызвать **CommitTrans** явным образом. Устанавливая транзакцию, можно выполнить ряд такие вызовы сохранением возможности отката. Если критический ресурс недоступен или другое условие, препятствует выполнению всей транзакции, можно выполнить откат транзакции, а его фиксации. В этом случае ни одно из изменений, относящихся к транзакции влияет на источник данных.  
  
> [!NOTE]
>  В настоящее время класса `CRecordset` не поддерживает обновления к источнику данных, если применяется выборка строк. Это означает, что нельзя выполнять вызовы `AddNew`, **изменить**, **удаление**, или **обновление**. Тем не менее можно написать собственные функции для выполнения обновлений и затем вызывать эти функции в транзакции. Дополнительные сведения о массовой выборке строк см. в разделе [набор записей: групповая выборка записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  
  
> [!NOTE]
>  Кроме того, изменяя набор записей, транзакции изменяют инструкции SQL, которые выполняются непосредственно, пока используется ODBC **HDBC** связанный с вашей `CDatabase` объекта или ODBC **HSTMT** на основе **HDBC**.  
  
 Операции особенно полезны при наличии нескольких записей, которые должны обновляться одновременно. В этом случае вы хотите избежать частичное завершение транзакции, такие как может произойти, если возникло исключение до последнего обновления. Группировка обновлений в транзакцию, которая позволяет отказаться от изменений (rollback) и возвращает записи в предыдущее состояние. Например если банк переводит деньги со счета A на счет B, как снятие с и зачисление на B должны успешно завершиться, чтобы корректно обработать денежные средства или вся транзакция должна закончиться откатом.  
  
 В классах баз данных транзакции реализуются с помощью `CDatabase` объектов. Объект `CDatabase` представляет подключение к источнику данных и один или несколько наборов записей, связанных с данным `CDatabase` объекта работающим с таблицей базы данных через функции членов набора записей.  
  
> [!NOTE]
>  Поддерживается только один уровень транзакций. Нельзя создавать вложенные транзакции, а также распространить транзакцию на несколько объектов базы данных.  
  
 Следующие разделы содержат сведения о выполнение транзакции:  
  
-   [Транзакция. Выполнение транзакции в наборе записей (ODBC)](../../data/odbc/transaction-performing-a-transaction-in-a-recordset-odbc.md)  
  
-   [Транзакция. Влияние транзакций на обновления (ODBC)](../../data/odbc/transaction-how-transactions-affect-updates-odbc.md)  
  
## <a name="see-also"></a>См. также  
 [Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)