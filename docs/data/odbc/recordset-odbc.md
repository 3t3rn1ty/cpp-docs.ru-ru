---
title: "Набор записей (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "динамические наборы записей"
  - "динамические наборы"
  - "наборы записей с последовательным доступом"
  - "наборы записей ODBC"
  - "наборы записей ODBC, CRecordset - объекты"
  - "наборы записей, сведения о наборах записей"
  - "наборы записей, создание"
  - "наборы записей, динамические наборы"
  - "наборы записей, снимки"
  - "снимки, наборы записей ODBC"
ms.assetid: 333337c5-575e-4d26-b5f6-47166ad7874d
caps.latest.revision: 8
caps.handback.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Набор записей (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 Объект [CRecordset](../Topic/CRecordset%20Class.md) представляет собой набор записей, выбранных из источника данных.  Для выборки записей могут использоваться следующие объекты:  
  
-   Таблица.  
  
-   Запрос.  
  
-   Хранимая процедура, в которой выполняется обращение к нескольким таблицам.  
  
 Например, на базе таблицы можно создать набор записей, содержащий всех клиентов, в котором выполняется обращение к таблице клиентов.  На базе запроса можно создать набор записей, содержащий, например, все счета конкретного лица. На базе хранимой процедуры, которая иногда называется предопределенным запросом, можно создать набор записей, содержащий все неоплаченные счета, в котором вызывается хранимая процедура серверной базы данных.  В наборе записей допускается объединение нескольких таблиц только из одного источника данных.  
  
> [!NOTE]
>  Дополнительные сведения о создании производных классов наборов записей см. в разделах [Добавление объекта\-получателя ODBC MFC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) и [Поддержка баз данных. Мастер приложений MFC](../../mfc/reference/database-support-mfc-application-wizard.md).  
  
> [!NOTE]
>  Некоторые драйвера ODBC поддерживают представления баз данных.  В этом контексте представление — это запрос, изначально создаваемый с помощью инструкции `CREATE VIEW` языка SQL.  В текущей версии представления не поддерживаются мастерами, однако при необходимости можно написать код поддержки представлений самостоятельно.  
  
##  <a name="_core_recordset_capabilities"></a> Возможности наборов записей  
 Все объекты наборов записей обладают следующими возможностями:  
  
-   Если источник данных доступен для записи, можно разрешить [обновление](../../data/odbc/recordset-adding-updating-and-deleting-records-odbc.md) набора и [добавление](../../data/odbc/recordset-adding-updating-and-deleting-records-odbc.md) записей в него, а также определить набор записей как доступный только для чтения.  Если разрешено обновление набора записей, можно выбрать пессимистический или оптимистический режим [блокировки](../../data/odbc/recordset-locking-records-odbc.md) \(если соответствующий режим поддерживается драйвером\).  Набор записей, основанный на доступном только для чтения источнике данных, также доступен только для чтения.  
  
-   Поддерживается вызов функций\-членов для [прокрутки](../Topic/Recordset:%20Scrolling%20\(ODBC\).md) выбранных записей.  
  
-   Поддерживается [фильтрация](../../data/odbc/recordset-filtering-records-odbc.md) выбранных записей.  
  
-   Поддерживается [сортировка](../../data/odbc/recordset-sorting-records-odbc.md) записей в порядке возрастания и убывания по одному или нескольким столбцам.  
  
-   Поддерживается [параметризация](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) набора записей, что позволяет задавать выбранные в наборе записи во время выполнения.  
  
##  <a name="_core_snapshots_and_dynasets"></a> Моментальные снимки и динамические наборы  
 Существует два основных типа наборов записей: [моментальные снимки](../Topic/Snapshot.md) и [динамические наборы](../../data/odbc/dynaset.md).  В классе `CRecordset` поддерживаются наборы обоих типов.  Наборы каждого типа обладают всеми общими характеристиками наборов записей и дополняют их собственными специализированными возможностями.  Моментальный снимок представляет собой статическое представление данных, которое используется для составления отчетов и в других ситуациях, в которых необходимо получить данные по состоянию на определенный момент времени.  Динамические наборы предназначены для отображения изменения, вносимых в набор записей другими пользователями, без выполнения запроса или обновления набора.  Моментальные снимки и динамические наборы могут быть доступны для обновления или только для чтения.  Чтобы отобразить добавление или удаление записей другими пользователями, вызовите метод [CRecordset::Requery](../Topic/CRecordset::Requery.md).  
  
 В классе `CRecordset` также поддерживаются другие типы наборов записей: динамические наборы записей и наборы последовательного доступа.  В отличие от динамических наборов, в динамических наборах записей отображается добавление или удаление любых записей без вызова метода `CRecordset::Requery`.  В связи с этим динамические наборы записей обычно требуют большего времени на обработку со стороны СУБД и не поддерживаются многими драйверами ODBC.  Наборы записей последовательного доступа предоставляют наиболее эффективный способ доступа к данным для наборов записей, не требующих обновления или обратной прокрутки.  Например, такие наборы можно использовать для переноса данных из одного источника в другой, при котором просмотр данных осуществляется только в прямом направлении.  Чтобы использовать набор данных последовательного доступа, выполните следующие действия:  
  
-   Передайте **CRecordset::forwardOnly** в качестве параметра `nOpenType` функции\-члена [Open](../Topic/CRecordset::Open.md).  
  
-   Установите значение **CRecordset::readOnly** для параметра `dwOptions` функции\-члена **Open**.  
  
    > [!NOTE]
    >  Дополнительные сведения о требованиях, предъявляемых к драйверу ODBC для поддержки динамических наборов, см.в разделе [ODBC](../../data/odbc/odbc-basics.md).  Список драйверов ODBC, поставляемых с данной версией Visual C\+\+, а также сведения о приобретении дополнительных драйверов см. в разделе [Список драйверов ODBC](../../data/odbc/odbc-driver-list.md).  
  
##  <a name="_core_your_recordsets"></a> Работа с наборами записей  
 Для всех отдельных таблиц, представлений или хранимых процедур, к которым выполняется обращение, обычно определяется класс, производный от класса `CRecordset`. \(Исключением является ситуация объединения баз данных, в которой один набор записей представляет столбцы нескольких таблиц.\) При создании производного класса необходимо включить механизмы стандартного или пакетного обмена полями записей \(RFX и Bulk RFX соответственно\), которые аналогичны механизму обмена данными диалогового окна \(DDX\).  Функции RFX и Bulk RFX позволяют упростить передачу данных из источника в набор записей. Функция RFX также поддерживает передачу данных из набора записей в источник.  Дополнительные сведения см. в разделах [Обмен полями записей \(RFX\)](../../data/odbc/record-field-exchange-rfx.md) и [Набор записей. Пакетная выборка строк \(ODBC\)](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md).  
  
 Объект набора записей обеспечивает доступ ко всем выбранным записям.  Для прокрутки между выбранными записями используйте такие функции\-члены класса `CRecordset`, как `MoveNext` и `MovePrev`.  В любой момент времени в объекте набора записей может быть представлена только одна из выбранных записей — текущая запись.  Чтобы просмотреть поля текущей записи, объявите переменные\-члены класса набора записей, которые соответствуют столбцам таблицы или записям, полученным в результате выполнения запроса базы данных.  Дополнительные сведения о членах данных набора записей см. в разделе [Набор записей. Архитектура \(ODBC\)](../../data/odbc/recordset-architecture-odbc.md).  
  
 Дополнительные сведения об использовании объектов наборов записей см. в следующих разделах.  Разделы приведены по функциональным категориям в порядке, обеспечивающем их последовательное изучение.  
  
### Открытие, чтение и закрытие наборов записей  
  
-   [Набор записей. Архитектура \(ODBC\)](../../data/odbc/recordset-architecture-odbc.md)  
  
-   [Набор записей. Объявление класса таблицы \(ODBC\)](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)  
  
-   [Набор записей. Создание и закрытие наборов записей \(ODBC\)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)  
  
-   [Набор записей. Прокрутка \(ODBC\)](../Topic/Recordset:%20Scrolling%20\(ODBC\).md)  
  
-   [Набор записей. Закладки и абсолютное позиционирование \(ODBC\)](../../data/odbc/recordset-bookmarks-and-absolute-positions-odbc.md)  
  
-   [Набор записей. Фильтрация записей \(ODBC\)](../../data/odbc/recordset-filtering-records-odbc.md)  
  
-   [Набор записей. Сортировка записей \(ODBC\)](../../data/odbc/recordset-sorting-records-odbc.md)  
  
-   [Набор записей. Параметризация набора записей \(ODBC\)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)  
  
### Изменение наборов записей  
  
-   [Набор записей. Добавление, обновление и удаление записей \(ODBC\)](../../data/odbc/recordset-adding-updating-and-deleting-records-odbc.md)  
  
-   [Набор записей. Блокировка записей \(ODBC\)](../../data/odbc/recordset-locking-records-odbc.md)  
  
-   [Набор записей. Выполнение запросов наборов записей \(ODBC\)](../../data/odbc/recordset-requerying-a-recordset-odbc.md)  
  
### Дополнительные возможности  
  
-   [Набор записей. Объединение \(ODBC\)](../Topic/Recordset:%20Performing%20a%20Join%20\(ODBC\).md)  
  
-   [Набор записей. Объявление класса для предопределенного запроса \(ODBC\)](../../data/odbc/recordset-declaring-a-class-for-a-predefined-query-odbc.md)  
  
-   [Набор записей. Динамическая привязка столбцов данных \(ODBC\)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)  
  
-   [Набор записей. Пакетная выборка строк \(ODBC\)](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md)  
  
-   [Набор записей. Работа с большими элементами данных \(ODBC\)](../../data/odbc/recordset-working-with-large-data-items-odbc.md)  
  
-   [Набор записей. Определение сумм и других статистических результатов \(ODBC\)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)  
  
### Принципы работы наборов записей  
  
-   [Набор записей. Порядок выборки записей в наборе \(ODBC\)](../Topic/Recordset:%20How%20Recordsets%20Select%20Records%20\(ODBC\).md)  
  
-   [Набор записей. Порядок обновления записей в наборе \(ODBC\)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)  
  
## См. также  
 [Интерфейс ODBC \(ODBC\)](../Topic/Open%20Database%20Connectivity%20\(ODBC\).md)   
 [Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)   
 [Транзакция \(ODBC\)](../../data/odbc/transaction-odbc.md)