---
title: "Набор записей. Добавление нескольких записей (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "пакетное добавление записей в наборы записей"
  - "наборы записей ODBC, добавление записей"
  - "наборы записей, добавление записей"
ms.assetid: 4685f656-14b9-4f10-a1c5-147b2b89a0b4
caps.latest.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 9
---
# Набор записей. Добавление нескольких записей (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 Класс [CRecordset](../Topic/CRecordset%20Class.md) библиотеки MFC позволяет повысить эффективность при добавлении нескольких новых записей в таблицу.  
  
> [!NOTE]
>  В этом разделе приведены сведения, относящиеся к объектам, производным от класса `CRecordset`, в котором групповая выборка строк не реализована.  При использовании групповой выборки строк следует ознакомиться с разделом [Набор записей: групповая выборка записей \(ODBC\)](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md).  
  
 Новый вариант параметра **dwOptions** функции\-члена [CRecordset::Open](../Topic/CRecordset::Open.md) — **optimizeBulkAdd** — повышает производительность при последовательном добавлении нескольких записей без вызова **Requery** или **Close**.  Поля, которые являются "грязными" до первого вызова **Update**, помечаются как "грязные" при последующих вызовах `AddNew`\/**Update**.  
  
 При использовании классов базы данных, чтобы воспользоваться преимуществами функции **::SQLSetPos** ODBC API для добавления, изменения и удаления записей, эта оптимизация является необходимой.  
  
 Если загружается библиотека курсоров ODBC или драйвер ODBC не поддерживает добавление, изменение и удаление с помощью функции **::SQLSetPos**, эта оптимизация повысит производительность при групповом добавлении.  Чтобы включить данную оптимизацию, задайте для параметра **dwOptions** в вызове **Open** для набора записей следующее значение:  
  
```  
appendOnly | optimizeBulkAdd  
```  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)   
 [Набор записей. Добавление, обновление и удаление записей \(ODBC\)](../../data/odbc/recordset-adding-updating-and-deleting-records-odbc.md)   
 [Набор записей: блокировка \(ODBC\)](../../data/odbc/recordset-locking-records-odbc.md)