---
title: 'Набор записей: Фильтрация записей (ODBC) | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- data [MFC], filtering
- recordsets [C++], filtering
- filtering recordsets
- ODBC recordsets [C++], filtering records
- filters [C++], recordset object
ms.assetid: 5c075f37-c837-464d-90c1-d028a9d1c175
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 4b4860726fa77d7b852290d8ea4680fe1bbbd86f
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33091807"
---
# <a name="recordset-filtering-records-odbc"></a>Набор записей. Фильтрация записей (ODBC)
Этот раздел относится к классам MFC ODBC.  
  
 В этом разделе объясняется, как для фильтрации набора записей, который позволяет определенного подмножества доступных записей. Например можно выбрать только те разделы класса для определенного курса, например MATH101. Фильтр является условием поиска, определяется содержимым SQL **ГДЕ** предложения. Если платформа добавляет его в инструкции SQL набора записей, **ГДЕ** предложение ограничивает выбор.  
  
 Установите фильтр для объекта набора записей после создания объекта, но перед вызовом его **откройте** функция-член (или перед вызовом метода **Requery** функции-члена для существующего набора записей которого **откройте** функция-член вызван ранее).  
  
#### <a name="to-specify-a-filter-for-a-recordset-object"></a>Чтобы определить фильтр для объекта набора записей  
  
1.  Создайте новый объект набора записей (или вызовите **Requery** для существующего объекта).  
  
2.  Значение объекта [m_strFilter](../../mfc/reference/crecordset-class.md#m_strfilter) члена данных.  
  
     Фильтр — это строка, оканчивающаяся нулем, с содержимым SQL **ГДЕ** предложения, но не ключевое слово **ГДЕ**. Например используйте:  
  
    ```  
    m_pSet->m_strFilter = "CourseID = 'MATH101'";  
    ```  
  
     not  
  
    ```  
    m_pSet->m_strFilter = "WHERE CourseID = 'MATH101'";  
    ```  
  
    > [!NOTE]
    >  Строковый литерал «MATH101» отображается в одинарные кавычки выше. В спецификации ODBC SQL одинарные кавычки используются для обозначения символа строкового литерала. Обратитесь к документации драйвера ODBC для кавычек требования СУБД в этой ситуации. Этот синтаксис также рассматривается далее в конце этого раздела.  
  
3.  Задайте другие параметры, которые необходимо, например, порядок сортировки, режим блокировки или параметры. Указание параметра особенно полезно. Сведения о параметризации фильтра см. в разделе [набор записей: Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  
  
4.  Вызовите **откройте** для нового объекта (или **Requery** для уже открытого объекта).  
  
> [!TIP]
>  Использование параметров в фильтре потенциально является самым эффективным методом для получения записей.  
  
> [!TIP]
>  Фильтры набора записей необходимы для [объединение](../../data/odbc/recordset-performing-a-join-odbc.md) таблиц и для использования [параметры](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) основании полученных данных или вычисленных во время выполнения.  
  
 Набор записей выбирает только те записи, которые удовлетворяют условию поиска, указанного. Например, чтобы задать фильтр курса описанные выше (при условии, что переменная `strCourseID` в настоящий момент значение для экземпляра «MATH101»), выполните следующие действия:  
  
```  
// Using the recordset pointed to by m_pSet  
  
// Set the filter  
m_pSet->m_strFilter = "CourseID = " + strCourseID;   
  
// Run the query with the filter in place  
if ( m_pSet->Open( CRecordset::snapshot, NULL, CRecordset::readOnly ) )  
  
// Use the recordset  
```  
  
 В наборе записей для всех разделов класса для MATH101.  
  
 Обратите внимание на то, как строку фильтра был задан в приведенном выше примере, строковую переменную с помощью. Это широко распространенный способ. Однако предположим, что необходимо задать значение литерала 100 для идентификатора курса. Ниже показано, как установка строки фильтра правильно с литеральным значением:  
  
```  
m_strFilter = "StudentID = '100'";   // correct  
```  
  
 Обратите внимание на использование одинарных кавычек; Если строка фильтра задан непосредственно, строка фильтра является **не**:  
  
```  
m_strFilter = "StudentID = 100";   // incorrect for some drivers  
```  
  
 Функция кавычек, представленная выше, соответствует спецификации ODBC, но некоторые СУБД требуют других символов кавычек. Дополнительные сведения см. в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  
  
> [!NOTE]
>  Если требуется переопределить строку SQL набора записей по умолчанию, передав строку SQL для **откройте**, не следует устанавливать фильтр, если Настраиваемая строка имеет **ГДЕ** предложения. Дополнительные сведения о переопределении SQL по умолчанию см. в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  
  
## <a name="see-also"></a>См. также  
 [Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)   
 [Набор записей: Сортировка записей (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md)   
 [Набор записей: Порядок выборки записей в наборе (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md)   
 [Набор записей: Порядок обновления записей в наборе записей (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)   
 [Набор записей. Блокировка (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)