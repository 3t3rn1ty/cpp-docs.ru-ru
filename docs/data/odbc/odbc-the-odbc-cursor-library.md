---
title: "ODBC: Библиотека курсоров ODBC | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- cursor library [ODBC]
- snapshots, support in ODBC
- timestamps, ODBC timestamp columns
- ODBC cursor library [ODBC]
- static cursors
- ODBC drivers, Level 1
- ODBC drivers, cursor support
- positioned updates
- cursors, ODBC cursor library
- Level 1 ODBC drivers
- cursor library [ODBC], snapshots
- ODBC, timestamp
- positioning cursors
ms.assetid: 6608db92-82b1-4164-bb08-78153c227be3
caps.latest.revision: "9"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: a704a4904683d2b1a448e9f5f327723b7681c96b
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="odbc-the-odbc-cursor-library"></a>ODBC. Библиотека курсоров ODBC
В этом разделе описывается библиотека курсоров ODBC и объясняется, как использовать его. Дополнительные сведения:  
  
-   [Библиотека курсоров и уровня 1 драйверы ODBC](#_core_the_cursor_library_and_level_1_odbc_drivers)  
  
-   [Позиционированные обновления и столбцы типа Timestamp](#_core_positioned_updates_and_timestamp_columns)  
  
-   [Использование библиотеки курсоров](#_core_using_the_cursor_library)  
  
 Библиотека курсоров ODBC является библиотеки динамической компоновки (DLL), расположенный между диспетчером драйверов ODBC и драйвером. В условиях ODBC драйвер поддерживает курсор для отслеживания его позиции в наборе записей. Курсор отмечает позицию в наборе записей, к которой была выполнена прокрутка — текущая запись.  
  
##  <a name="_core_the_cursor_library_and_level_1_odbc_drivers"></a>Библиотека курсоров и уровня 1 драйверы ODBC  
 Библиотека курсоров ODBC предоставляет драйверам первого уровня следующие новые возможности:  
  
-   Прямая и обратная прокрутка. Драйверы уровня 2 не требуется библиотека курсоров, так как они уже могут быть прокручены.  
  
-   Поддержка моментальных снимков. Библиотека курсоров управляет буфером, содержащим записи моментальных снимков. Этот буфер отражает программы удаления и изменения записей, но не дополнения, удаления или изменения других пользователей. Таким образом моментальный снимок только менее актуальны, чем библиотека курсоров буфера. Также буфер не отражает добавления пользователя до вызова **Requery**. Динамические наборы следует использовать библиотеку курсоров.  
  
 Библиотека курсоров предоставляет моментальные снимки (статические курсоры), даже если обычно они не поддерживается драйвером. Если драйвер поддерживает статические курсоры, вам не нужно загружать библиотеку курсоров для поддержки моментальных снимков. При использовании библиотеки курсоров, можно использовать только моментальные снимки и наборы последовательного доступа. Если драйвер поддерживает динамические подмножества данных (курсоры KEYSET_DRIVEN), и вы хотите использовать их, не должны использовать библиотеку курсоров. Если вы хотите использовать моментальные снимки и динамические подмножества данных, необходимо основываться на двух разных `CDatabase` объектов (подключения), если драйвер не поддерживает оба.  
  
##  <a name="_core_positioned_updates_and_timestamp_columns"></a>Позиционированные обновления и столбцы типа Timestamp  
  
> [!NOTE]
>  Источники данных ODBC доступны через классы MFC ODBC, как описано в этом разделе, или с помощью классов MFC объекта доступа к данным (DAO).  
  
> [!NOTE]
>  Если драйвер ODBC поддерживает **SQLSetPos**, какие MFC использует, если он доступен, в этом разделе не относиться к вам.  
  
 Большинство драйверов первого уровня не поддерживают позиционированные обновления. Такие драйверы основываются на библиотеку курсоров для эмуляции возможности драйверов второго уровня в этом отношении. Библиотека курсоров имитирует поддержку позиционированного обновления, выполняя поисковое обновление на неизменных полях.  
  
 В некоторых случаях набор записей может содержать столбец отметок времени как один из неизменных полей. С помощью набора записей MFC с таблицами, содержащими столбцы типа timestamp, возникают две проблемы.  
  
 Первая касается обновляемых моментальных снимков для таблиц со столбцами отметок времени. Если таблица, к которой привязан моментальный снимок содержит столбец типа timestamp, необходимо вызвать **Requery** после вызова метода **изменить** и **обновление**. В противном случае может не появиться возможность изменять одну запись еще раз. При вызове **изменить** и затем **обновление**, записи в источнике данных и обновить столбец отметки времени. Если вы не вызываете **Requery**, значение отметки времени для записи в моментальном снимке больше не соответствует соответствующей временной меткой в источнике данных. При попытке обновить запись еще раз, источник данных может запретить обновление из-за несоответствия.  
  
 Вторая проблема касается ограничений класса [CTime](../../atl-mfc-shared/reference/ctime-class.md) при использовании с `RFX_Date` функции для передачи сведений о дате и времени в таблицу или из нее. Обработка `CTime` объекта накладывает некоторые издержки в виде лишние промежуточной обработки во время передачи данных. Диапазон дат `CTime` объектов может также оказаться слишком ограничивающим для некоторых приложений. Доступна новая версия `RFX_Date` функция принимает ODBC **TIMESTAMP_STRUCT** вместо `CTime` объекта. Дополнительные сведения см. в разделе `RFX_Date` в [макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md) в *Справочник по библиотеке MFC*.  

  
##  <a name="_core_using_the_cursor_library"></a>Использование библиотеки курсоров  
 При подключении к источнику данных — путем вызова [CDatabase::OpenEx](../../mfc/reference/cdatabase-class.md#openex) или [CDatabase::Open](../../mfc/reference/cdatabase-class.md#open) — можно указать, следует ли использовать библиотеку курсоров для источника данных. Если вы создадите моментальных снимков от этого источника данных, укажите **CDatabase::useCursorLib** в диалоговом окне `dwOptions` параметр `OpenEx` или указать **TRUE** для  **bUseCursorLib** параметр **откройте** (значение по умолчанию — **TRUE**). Если драйвер ODBC поддерживает динамические подмножества данных и требуется открыть динамических подмножеств данных в источнике данных, не используйте библиотеку курсоров (поскольку она скрывает некоторые функциональные возможности драйвера, необходимые для динамических подмножеств данных). В этом случае не следует указывать **CDatabase::useCursorLib** в `OpenEx` или указать **FALSE** для **bUseCursorLib** параметр в **откройте**.  
  
## <a name="see-also"></a>См. также  
 [Основы ODBC](../../data/odbc/odbc-basics.md)