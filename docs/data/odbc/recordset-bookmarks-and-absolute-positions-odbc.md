---
title: "Набор записей. Закладки и абсолютное позиционирование (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SetAbsolutePosition"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "абсолютное позиционирование, наборы записей ODBC"
  - "закладки"
  - "закладки, CDBVariant"
  - "закладки, наборы записей ODBC"
  - "CDBVariant - класс, закладки"
  - "курсоры [ODBC], абсолютное позиционирование в наборах данных"
  - "GetBookmark - метод"
  - "наборы записей ODBC, абсолютное позиционирование"
  - "наборы записей ODBC, закладки"
  - "позиционирование записей"
  - "позиционирование записей"
  - "наборы записей, абсолютное позиционирование"
  - "наборы записей, закладки"
  - "SetAbsolutePosition - метод"
  - "SetAbsolutePosition - метод, закладки"
  - "SetBookmark - метод"
ms.assetid: 189788d6-33c1-41c5-9265-97db2a5d43cc
caps.latest.revision: 9
caps.handback.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Набор записей. Закладки и абсолютное позиционирование (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 При перемещении по набору записей часто необходимо иметь возможность вернуться к определенной записи.  Для этого существуют два метода: использование закладок и абсолютного позиционирования.  
  
 Содержание раздела:  
  
-   [Способы использования закладок](#_core_bookmarks_in_mfc_odbc).  
  
-   [Способы задания текущей записи при помощи абсолютного позиционирования](#_core_absolute_positions_in_mfc_odbc).  
  
##  <a name="_core_bookmarks_in_mfc_odbc"></a> Использование закладок для ODBC в библиотеке MFC  
 Закладка уникально идентифицирует запись.  При перемещении по набору записей нельзя всегда полагаться на абсолютную позицию записи, поскольку записи могут быть удалены из набора.  Надежным способом отслеживания позиции записи является использование закладок.  Класс `CRecordset` предоставляет функции\-члены для выполнения следующих задач.  
  
-   Установка закладки для текущей записи и сохранение этой закладки в переменной \([GetBookmark](../Topic/CRecordset::GetBookmark.md)\).  
  
-   Быстрое перемещение к определенной записи с помощью указания ее закладки, ранее сохраненной в переменной \([SetBookmark](../Topic/CRecordset::SetBookmark.md)\).  
  
 В следующем примере показаны способы использования этих функций\-членов для пометки текущей записи и последующего возврата к ней.  
  
```  
// rs is a CRecordset or  
// CRecordset-derived object  
  
CDBVariant varRecordToReturnTo;  
rs.GetBookmark( varRecordToReturnTo );  
  
// More code in which you  
// move to other records  
  
rs.SetBookmark( varRecordToReturnTo );  
```  
  
 Нет необходимости извлекать базовый тип данных из объекта [CDBVariant Class](../Topic/CDBVariant%20Class.md).  Следует задать значение закладки с помощью функции `GetBookmark`, а затем вернуться к закладке с помощью функции `SetBookmark`.  
  
> [!NOTE]
>  Закладки могут не поддерживаться при использовании определенных драйверов и типов наборов записей.  Определить, поддерживаются ли закладки, можно с помощью вызова функции [CRecordset::CanBookmark](../Topic/CRecordset::CanBookmark.md).  Кроме того, если закладки поддерживаются, необходимо явно реализовывать их, указывая параметр **CRecordset::useBookmarks** в функции [CRecordset::Open](../Topic/CRecordset::Open.md).  Также следует проверять сохранность закладок после выполнения определенных операций с наборами записей.  Например, если применить к набору записей метод **Requery** \(повторный запрос\), закладки могут не сохраниться.  Следует вызвать функцию [CDatabase::GetBookmarkPersistence](../Topic/CDatabase::GetBookmarkPersistence.md), чтобы проверить, имеется ли возможность безопасного вызова функции `SetBookmark`.  
  
##  <a name="_core_absolute_positions_in_mfc_odbc"></a> Абсолютное позиционирование ODBC в библиотеке MFC  
 Помимо закладок класс `CRecordset` позволяет использовать текущую запись, указав ее порядковый номер.  Данный способ называется абсолютным позиционированием.  
  
> [!NOTE]
>  Абсолютное позиционирование недоступно для наборов записей с последовательным доступом.  Дополнительные сведения о наборах записей с последовательным доступом см. в разделе [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md).  
  
 Чтобы переместить указатель текущей записи с помощью ее абсолютной позиции, следует вызвать функцию [CRecordset::SetAbsolutePosition](../Topic/CRecordset::SetAbsolutePosition.md).  При передаче значения в функцию `SetAbsolutePosition` запись, соответствующая указанному порядковому номеру, становится текущей.  
  
> [!NOTE]
>  Абсолютное позиционирование записи может оказаться потенциально ненадежным.  Если пользователь удалит записи из набора, порядковый номер всех последующих записей изменится.  Для перемещения к текущей записи рекомендуется использовать закладки.  Дополнительные сведения см. в разделе [Использование закладок для ODBC в библиотеке MFC](#_core_bookmarks_in_mfc_odbc).  
  
 Дополнительные сведения о перемещении по набору записей см. в разделе [Набор записей. Прокрутка \(ODBC\)](../Topic/Recordset:%20Scrolling%20\(ODBC\).md).  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)