---
title: "Набор записей: Выполнение обновления наборов записей (ODBC) | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- recordsets, requerying
- requerying recordsets
- Requery method
- ODBC recordsets, requerying
- refreshing recordsets
ms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 1445273d29fc521b24fbf04ffc5abec1fadd4e59
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="recordset-requerying-a-recordset-odbc"></a>Набор записей. Выполнение обновления наборов записей (ODBC)
Этот раздел относится к классам MFC ODBC.  
  
 В этом разделе объясняется, как можно использовать объект набора записей для запроса (обновления) сам из базы данных и в случае, когда может потребоваться сделать с [Requery](../../mfc/reference/crecordset-class.md#requery) функции-члена.  
  
 — Основной причины обновление набора записей.  
  
-   Открыть набор записей в актуальном состоянии по отношению к записи, добавленные вами или другими пользователями и записи, удаленные другим пользователям (те, которые можно удалить, уже отражаются в наборе записей).  
  
-   Обновление набора записей, основываясь на изменяющихся значений параметров.  
  
##  <a name="_core_bringing_the_recordset_up_to_date"></a>Обновление набора записей для даты  
 Как правило требуется объекта набора записей для перевода ее в актуальном состоянии. В среде с сетевой базе данных другие пользователи могут вносить изменения в данные во время существования набора записей. Дополнительные сведения о при набор записей отражает изменения, внесенные другими пользователями, и наборы записей других пользователей отражают изменения см. в разделе [набор записей: как наборы записей обновления записей (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) и [динамический набор](../../data/odbc/dynaset.md).  
  
##  <a name="_core_requerying_based_on_new_parameters"></a>Обновление на основе новых параметров  
 Часто и столь же важно — использование [Requery](../../mfc/reference/crecordset-class.md#requery) можно выбрать новый набор записей на основе изменения значений параметров.  
  
> [!TIP]
>  Скорость обработки запросов может быть значительно выше, при вызове метода **Requery** с измененными параметрами, по сравнению с вызовом **откройте** еще раз.  
  
##  <a name="_core_requerying_dynasets_vs.._snapshots"></a>Требуемые vs динамических подмножеств данных. Моментальные снимки  
 Так как динамические наборы предназначены для представления набора записей с динамическими данными в актуальном состоянии, следует выполнить повторный запрос динамических подмножеств данных, часто в том случае, если вы хотите отражает добавления других пользователей. Моментальные снимки, с другой стороны, полезны, поскольку полагаться на статическое содержимое во время подготовки отчетов, вычисление итоговых значений и т. д. Тем не менее иногда может потребоваться повторный запрос и моментальные снимки. В многопользовательской среде данных моментального снимка может потерять синхронизацию с источником данных другим пользователям изменить базу данных.  
  
#### <a name="to-requery-a-recordset-object"></a>Повторный запрос объекта набора записей  
  
1.  Вызовите [Requery](../../mfc/reference/crecordset-class.md#requery) функции-члена объекта.  
  
 Кроме того можно закрыть и повторно открыть первоначальный набор записей. В любом случае новый набор записей представляет текущее состояние источника данных.  
  
 Пример см. в разделе [представления записей: заполнение списка из второго набора записей](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md).  
  
> [!TIP]
>  Для оптимизации **Requery** производительности, следует избегать изменения набора записей [фильтра](../../data/odbc/recordset-filtering-records-odbc.md) или [сортировки](../../data/odbc/recordset-sorting-records-odbc.md). Измените значение параметра перед вызовом **Requery**.  
  
 Если **Requery** вызов завершается ошибкой, можно повторить вызов; в противном случае приложение должно быть прекращено надлежащим образом. Вызов **Requery** или **откройте** может завершиться с ошибкой по нескольким причинам. Возможно произошла сетевая ошибка; или во время вызова, после выпуска существующих данных, но до получения новых данных, другой пользователь мог получить монопольный доступ; или могут быть удалены таблицы, от которого зависит набор записей.  
  
## <a name="see-also"></a>См. также  
 [Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)   
 [Набор записей: Динамическая привязка столбцов данных (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)   
 [Набор записей. Создание и закрытие наборов записей (ODBC)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)