---
title: "Набор записей. Выполнение обновления наборов записей (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "наборы записей ODBC, требование"
  - "наборы записей, требование"
  - "обновление наборов записей"
  - "Requery - метод"
  - "требуемые наборы записей"
ms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1
caps.latest.revision: 8
caps.handback.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Набор записей. Выполнение обновления наборов записей (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 В этом разделе рассматриваются способы использования объекта набора записей для запроса \(обновления\) набора записей из базы данных, а также случаи, когда для этого может потребоваться функция\-член [Requery](../Topic/CRecordset::Requery.md).  
  
 К основным причинам обновления запросов наборов записей относятся:  
  
-   обновление набора записей в соответствии с записями, добавленными и удаленными пользователями;  
  
-   обновление набора записей в соответствии с измененными значениями параметров.  
  
##  <a name="_core_bringing_the_recordset_up_to_date"></a> Обновление набора записей  
 Зачастую запрос объекта набора записей выполняется для его обновления.  Если базой данных пользуется несколько пользователей, другие пользователи могут вносить изменения в данные во время существования набора записей.  Дополнительные сведения о случаях, когда собственный набор записей отражает изменения, внесенные другими пользователями, и наборы записей других пользователей отражают собственные изменения, см. в разделах [Набор записей. Способы обновления записей в наборе записей \(ODBC\)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) и [Динамическое подмножество данных](../../data/odbc/dynaset.md).  
  
##  <a name="_core_requerying_based_on_new_parameters"></a> Обновление на основе новых параметров  
 Функция [Requery](../Topic/CRecordset::Requery.md) также часто используется для получения нового набора записей на основе изменения значений параметров.  
  
> [!TIP]
>  Скорость запроса может быть значительно выше, если использовать функцию **Requery** с измененными параметрами, по сравнению с повторным вызовом функции **Open**.  
  
##  <a name="_core_requerying_dynasets_vs.._snapshots"></a> Обновление динамические подмножества данных и снимков  
 Поскольку динамические подмножества данных предназначены для представления набора записей с динамически обновленными данными, чтобы изменения, внесенные другими пользователями, отображались в наборе данных, необходимо часто обновлять эти подмножества.  Моментальные снимки, с другой стороны, позволяют полагаться на статическое содержимое при подготовке отчетов, подсчете конечных результатов и т. д.  Тем не менее, иногда требуется обновлять и моментальные снимки.  В многопользовательской среде данные моментального снимка могут утратить синхронизацию с источником данных при изменении базы данных другими пользователями.  
  
#### Обновление объекта набора записей  
  
1.  Следует вызвать функцию\-член [Requery](../Topic/CRecordset::Requery.md) объекта.  
  
 Вместо этого можно также закрыть и повторно открыть первоначальный набор записей.  В обоих случаях новый набор записей будет представлять текущее состояние источника данных.  
  
 Пример см. в разделе [Представления записей. Заполнение списка из второго набора записей](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md).  
  
> [!TIP]
>  Чтобы повысить производительность функции **Requery**, следует избегать изменения параметров [filter](../../data/odbc/recordset-filtering-records-odbc.md) или [sort](../../data/odbc/recordset-sorting-records-odbc.md) набора записей.  Следует изменять значение параметра только до вызова функции **Requery**.  
  
 Если вызов функции **Requery** завершается с ошибкой, можно попытаться вызвать ее еще раз, в противном случае приложение следует закрыть.  Вызов функции **Requery** или **Open** может завершиться с ошибкой по нескольким причинам.  Возможно, произошла сетевая ошибка; или во время вызова \(после выпуска существующих данных и до получения новых\) другой пользователь мог получить монопольный доступ; или таблица, от которой зависит набор записей, могла быть удалена.  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)   
 [Набор записей. Динамическая привязка столбцов данных \(ODBC\)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)   
 [Набор записей. Создание и закрытие наборов записей \(ODBC\)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)