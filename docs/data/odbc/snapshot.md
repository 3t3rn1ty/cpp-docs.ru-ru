---
title: "Моментальный снимок | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- ODBC cursor library [ODBC], snapshots
- cursors [ODBC], static
- recordsets, snapshots
- snapshots, support in ODBC
- static cursors
- ODBC recordsets, snapshots
- cursor library [ODBC], snapshots
- snapshots
ms.assetid: b5293a52-0657-43e9-bd71-fe3785b21c7e
caps.latest.revision: "8"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: c31e08fdda3cef526f46946e45ef956f9ad1adaa
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="snapshot"></a>Снимок
Моментальный снимок — это набор записей, которое отражает статическое представление данных на момент создания моментального снимка. При открытии моментального снимка и переходу ко всем записям, набор записей и их значения не изменяются, пока вновь моментального снимка путем вызова **Requery**.  
  
> [!NOTE]
>  Этот раздел относится к классам MFC ODBC. При использовании классов MFC DAO вместо классы MFC ODBC. в разделе [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#open) описание записей типа снимка.  
  
 С классами баз данных можно создавать моментальные снимки обновляемые или только для чтения. В отличие от подмножества обновляемый моментальный снимок не отражает изменений для записи значений, сделанные другими пользователями, но устанавливает обновления и удаления, выполненные в программе. Записи, добавленные к моментальному снимку не становятся видимыми для моментального снимка, пока не будет вызван **Requery**.  
  
> [!TIP]
>  Моментальный снимок является статическим курсором ODBC. Статические курсоры не получают строку данных пока не переместится к этой записи. Чтобы убедиться, что немедленно извлекаются все записи, можно в конце набора записей и затем прокрутите до первой записи, которую вы хотите просмотреть. Обратите внимание, что перемещение в конец влечет за собой дополнительные издержки и может снизить производительность.  
  
 Моментальные снимки наиболее полезны, если вам требуются данные не изменялись во время операций, например при создании отчета или выполнения вычислений. Даже в том случае источник данных может расходятся значительно из снимка, поэтому может потребоваться перестроить его время от времени.  
  
 Поддержка моментальных снимков основана на библиотеку курсоров ODBC, предоставляющей статические курсоры и позиционированные обновления (необходимые для возможности обновления данных) для всех драйверов уровня 1. DLL-библиотека курсоров должна загружаться в памяти для этой поддержки. При построении `CDatabase` и вызовите его `OpenEx` функция-член, необходимо указать **CDatabase::useCursorLib** параметр `dwOptions` параметр. При вызове метода **откройте** функция-член, библиотека курсоров загружается по умолчанию. При использовании динамических подмножеств данных вместо моментальные снимки библиотеку курсоров для загрузки не требуется.  
  
 Моментальные снимки доступны только в том случае, если библиотека курсоров ODBC загружена `CDatabase` объект был создан, или вы используете драйвер ODBC поддерживает статические курсоры.  
  
> [!NOTE]
>  Для некоторых драйверов ODBC моментальные снимки (статические курсоры) может быть обновляемым. Проверьте документации драйверов для поддерживаемых типов курсоров и типы параллелизма, которые они поддерживают. Чтобы гарантировать обновляемых моментальных снимков, убедитесь, что загружает библиотеку курсоров в память при создании `CDatabase` объекта. Дополнительные сведения см. в разделе [ODBC: библиотека курсоров ODBC](../../data/odbc/odbc-the-odbc-cursor-library.md).  
  
> [!NOTE]
>  Если вы хотите использовать моментальные снимки и динамические подмножества данных, необходимо основываться на двух разных `CDatabase` объектов (подключения).  
  
 Дополнительные сведения о папке моментальных снимков свойства со всеми наборами см. в разделе [записей (ODBC)](../../data/odbc/recordset-odbc.md). Дополнительные сведения об ODBC и моментальных снимков, включая библиотеку курсоров ODBC. в разделе [ODBC](../../data/odbc/odbc-basics.md).  
  
## <a name="see-also"></a>См. также  
 [Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)