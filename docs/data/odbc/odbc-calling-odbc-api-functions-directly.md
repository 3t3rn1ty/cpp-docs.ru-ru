---
title: "ODBC. Прямой вызов функций ODBC API | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "API - интерфейсы [C++], вызов"
  - "функции каталогов (ODBC)"
  - "функции каталогов (ODBC), вызов"
  - "прямые вызовы ODBC API"
  - "ODBC [C++], функции API"
  - "ODBC [C++], функции каталогов"
  - "функции ODBC библиотек API [C++]"
  - "функции ODBC библиотек API [C++], вызов"
  - "классы ODBC [C++], или ODBC API"
ms.assetid: 4295f1d9-4528-4d2e-bd6a-c7569953c7fa
caps.latest.revision: 8
caps.handback.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# ODBC. Прямой вызов функций ODBC API
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Классы базы данных предоставляют более простой интерфейс для [источника данных](../../data/odbc/data-source-odbc.md) по сравнению с ODBC.  Поэтому классы не могут инкапсулировать все интерфейсы API ODBC.  Чтобы использовать любую функцию за пределами возможностей классов, необходимо непосредственно вызывать функции API ODBC.  Например, напрямую необходимо вызывать функции каталогов ODBC \(**::SQLColumns**, **::SQLProcedures**, **::SQLTables** и др.\).  
  
> [!NOTE]
>  Источники данных ODBC доступны с помощью классов ODBC MFC, как описано в данном разделе, или с помощью классов DAO MFC.  
  
 Чтобы вызвать функцию API ODBC напрямую, необходимо выполнить те же действия, что и для вызова функции без поддержки платформы.  К ним относятся:  
  
-   Выделение памяти для хранения всех результатов, возвращаемых функцией.  
  
-   Передача дескриптора **HDBC** или **HSTMT** ODBC в зависимости от подписи параметров функции.  Следует использовать макрос [AFXGetHENV](../Topic/AfxGetHENV.md), чтобы извлечь дескриптор ODBC.  
  
     Переменные членов **CDatabase::m\_hdbc** и **CRecordset::m\_hstmt** являются доступными, поэтому нет необходимости самостоятельно выделять для них память и инициализировать.  
  
-   Возможный вызов дополнительных функций ODBC, предваряющих вызов основной функции или следующих за ним.  
  
-   Отмена выделения памяти по окончании.  
  
 Дополнительные сведения об этих действиях см. в документации MSDN по SDK [Open Database Connectivity \(ODBC\)](https://msdn.microsoft.com/en-us/library/ms710252.aspx).  
  
 Кроме этого необходимо выполнить дополнительные действия, чтобы проверить возвращаемые значения функции, убедиться, что программа не ожидает асинхронного вызова для завершения и т. д.  Эти действия можно упростить с помощью макросов `AFX_SQL_ASYNC` и `AFX_SQL_SYNC`.  Дополнительные сведения см. в разделе [Макросы и глобальные объекты](../Topic/Macros,%20Global%20Functions,%20and%20Global%20Variables.md) в *Справочнике по MFC*.  
  
## См. также  
 [Основы ODBC](../../data/odbc/odbc-basics.md)