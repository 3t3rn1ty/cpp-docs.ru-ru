---
title: 'Набор записей: Порядок выборки записей в наборе (ODBC) | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- recordsets, selecting records
- record selection, ODBC recordsets
- SQL statements, recordset
- records, selecting
- recordsets, constructing SQL statements
- ODBC recordsets, selecting records
ms.assetid: 343a6a91-aa4c-4ef7-b21f-2f2bfd0d3787
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: a9ff2f1e9946eb32356eb09fa2ee216aa636a351
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33093234"
---
# <a name="recordset-how-recordsets-select-records-odbc"></a>Набор записей. Порядок выборки записей в наборе (ODBC)
Этот раздел относится к классам MFC ODBC.  
  
 Содержание раздела:  
  
-   [Роль пользователя и варианты выбора записей](#_core_your_options_in_selecting_records).  
  
-   [Как набор инструкций SQL и выбирает записи](#_core_how_a_recordset_constructs_its_sql_statement).  
  
-   [Что можно сделать для настройки выделения](#_core_customizing_the_selection).  
  
 Наборы записей для выбора записей из источника данных с помощью драйвера ODBC, драйвер отправки инструкций SQL. SQL зависят от порядка разработки и открытия класса набора записей.  
  
##  <a name="_core_your_options_in_selecting_records"></a> Варианты выбора записей  
 Ниже приведены варианты выбора записей.  
  
### <a name="how-and-when-you-can-affect-a-recordset"></a>Как и когда влияет на набор записей  
  
|Если вы|Можно|  
|--------------|-------------|  
|Объявите класс набора записей с **добавить класс** мастера|Укажите, какую таблицу для выбора.<br /><br /> Укажите столбцы для включения.<br /><br /> В разделе [Добавление потребителя MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md).|  
|Завершить реализации класса набора записей|Переопределение функции-члены, такие как `OnSetOptions` (Дополнительно) задайте параметры данного приложения или изменить значения по умолчанию. Указание элементов данных параметров необходимо параметризированные наборы записей.|  
|Создайте объект набора записей (перед вызовом метода **откройте**)|Условие поиска (числе составных) для использования в **ГДЕ** предложение, которое выполняет фильтрацию записей. В разделе [набор записей: фильтрация записей (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md).<br /><br /> Задать порядок сортировки для использования в **ORDER BY** записей предложения. В разделе [набор записей: сортировка записей (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md).<br /><br /> Укажите значения параметров для любые параметры, которые вы добавили в класс. В разделе [набор записей: Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).|  

| Выполнение запроса набора записей посредством вызова метода **откройте**| Укажите пользовательская строка для замены строки SQL по умолчанию, с помощью мастера настройки. В разделе [CRecordset::Open](../../mfc/reference/crecordset-class.md#open) в *Справочник по библиотеке классов* и [SQL: Настройка инструкции SQL набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md). |  

| Вызовите **Requery** для запроса последних значений в источнике данных | Укажите новые параметры фильтрации и сортировки. В разделе [набор записей: выполнение обновления наборов записей (ODBC)](../../data/odbc/recordset-requerying-a-recordset-odbc.md). |  
  
##  <a name="_core_how_a_recordset_constructs_its_sql_statement"></a> Способ создания инструкций SQL в наборе записей  
 При вызове объекта набора записей [откройте](../../mfc/reference/crecordset-class.md#open) функции-члена **откройте** создает инструкцию SQL, с помощью некоторые или все из следующих компонентов:  
  
-   **LpszSQL** передан параметр **откройте**. В противном случае **NULL**, этот параметр задает пользовательскую строку SQL или входит в него. Платформа выполняет синтаксический анализ строки. Если строка SQL **ВЫБЕРИТЕ** инструкции или ODBC **ВЫЗОВИТЕ** инструкции, платформа используется в качестве инструкции SQL набора записей. Если строка начинается с «SELECT» или «{CALL», платформа используется для создания SQL **FROM** предложения.  
  
-   Строка, возвращаемая функцией [GetDefaultSQL](../../mfc/reference/crecordset-class.md#getdefaultsql). По умолчанию это имя таблицы, указанное для набора записей в мастере, но можно изменить, возвращаемого функцией. Платформа вызывает функцию `GetDefaultSQL` , если строка не начинается с «SELECT» или «{CALL», оно полагается равным имени таблицы, которая используется для создания строки SQL.  
  

-   Элементами данных полей в наборе записей, которые связываются с определенными столбцами таблицы. Столбцы записей автоматически связываются с адресами этих членов, используя их как буферов. Платформа определяет корреляции поля элементов данных столбцам таблицы из [RFX](../../data/odbc/record-field-exchange-using-rfx.md) или вызовы функций Bulk RFX в наборе записей [DoFieldExchange](../../mfc/reference/crecordset-class.md#dofieldexchange) или [DoBulkFieldExchange ](../../mfc/reference/crecordset-class.md#dofieldexchange) функции-члена.  
  
-   [Фильтра](../../data/odbc/recordset-filtering-records-odbc.md) для набора записей, если таковые имеются, содержащихся в [m_strFilter](../../mfc/reference/crecordset-class.md#m_strfilter) члена данных. Эта строка используется платформа для создания SQL **ГДЕ** предложения.  
  
-   [Сортировки](../../data/odbc/recordset-sorting-records-odbc.md) порядок набора записей, если таковые имеются, содержащихся в [m_strSort](../../mfc/reference/crecordset-class.md#m_strsort) члена данных. Эта строка используется платформа для создания SQL **ORDER BY** предложения.  

  
    > [!TIP]
    >  Чтобы использовать SQL **GROUP BY** предложение (и, возможно, **HAVING** предложение), добавьте предложения в конец строки фильтра.  
  
-   Значения любого [параметризованные члены данных](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) определенные для класса. Задать значения параметров непосредственно перед вызовом метода **откройте** или **Requery**. Платформа связывает значения параметров «?» заполнители в строке SQL. Во время компиляции укажите строку, с помощью заполнителей. Во время выполнения платформа заполнит сведения на основе значений параметров, которые можно передать.  
  
 **Откройте** создает SQL **ВЫБЕРИТЕ** инструкции этих компонентов с помощью метода. В разделе [Настройка выборки](#_core_customizing_the_selection) для получения сведений об использовании этих компонентов в .NET framework.  
  
 После построения инструкции, **откройте** SQL передает диспетчер драйверов ODBC (и библиотека курсоров ODBC, если он находится в памяти), который отправляет передается в драйвер ODBC для конкретной СУБД. Драйвер взаимодействует с СУБД для выборки в источнике данных и извлекает первую запись. Платформа запись загружается в члены данных полей в наборе записей.  
  
 Сочетание этих способов можно использовать для открытия [таблиц](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md) и для создания запросов на основе [соединения](../../data/odbc/recordset-performing-a-join-odbc.md) нескольких таблиц. После дополнительной настройки можно вызвать [предопределенные запросы](../../data/odbc/recordset-declaring-a-class-for-a-predefined-query-odbc.md) (хранимые процедуры), выберите столбцы, не известна во время разработки таблицы и [привязки](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md) их к полям набора записей или выполнять большей части прочих задачи доступа к данным. Не удается выполнить наборов записей задачи могут выполняться по-прежнему путем [вызов функций ODBC API](../../data/odbc/odbc-calling-odbc-api-functions-directly.md) или непосредственного выполнения инструкций SQL с [помощью функции CDatabase::ExecuteSQL](../../mfc/reference/cdatabase-class.md#executesql).  
  
##  <a name="_core_customizing_the_selection"></a> Настройка выборки  
 Помимо определения фильтра, порядок сортировки или параметры, можно выполнять следующие действия для настройки выбора набора записей:  
  
-   Передача пользовательской строки SQL в **lpszSQL** при вызове [откройте](../../mfc/reference/crecordset-class.md#open) для набора записей. Что-либо передать **lpsqSQL** имеет приоритет над тем, какие [GetDefaultSQL](../../mfc/reference/crecordset-class.md#getdefaultsql) функция-член возвращает.  
  
     Дополнительные сведения см. в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md), описывающей типы инструкций SQL (или частичной инструкции) можно передать в **откройте** и платформа делает с ними.  
  
    > [!NOTE]
    >  Если передаваемые пользовательская строка начинается с «SELECT» или «{CALL», MFC предполагается, что он содержит имя таблицы. Это также относится к следующему элементу маркированного списка.  
  
-   Изменение строки, которая мастер осуществляет запись в наборе записей `GetDefaultSQL` функции-члена. Измените код функции для изменения его возвращает. По умолчанию мастер создает `GetDefaultSQL` функция, возвращающая имя одиночной таблицы.  
  
     Может иметь `GetDefaultSQL` возвращать все элементы, которые можно передать в **lpszSQL** параметр **откройте**. Если вы не передаете пользовательской строки SQL в **lpszSQL**, платформа использует строку, `GetDefaultSQL` возвращает. Как минимум `GetDefaultSQL` должен возвращать имя одной таблицы. Но можно возвращать имена нескольких таблиц, полная **ВЫБЕРИТЕ** инструкции ODBC **ВЫЗОВИТЕ** инструкции и т. д. Список можно передать в **lpszSQL** — или иметь `GetDefaultSQL` возвращают — в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  
  
     Если объединение двух или более таблиц, перепишите `GetDefaultSQL` Чтобы настроить список таблиц, используемых в инструкции SQL, **FROM** предложения. Дополнительные сведения см. в разделе [набор записей: выполнение Join (ODBC)](../../data/odbc/recordset-performing-a-join-odbc.md).  
  

-   Вручную связать дополнительные поля элементов данных, возможно, основываясь на сведениях, вы получите о схеме из источника данных во время выполнения. Добавить члены данных полей в классе набора записей, [RFX](../../data/odbc/record-field-exchange-using-rfx.md) или вызовы функций Bulk RFX для них [DoFieldExchange](../../mfc/reference/crecordset-class.md#dofieldexchange) или [DoBulkFieldExchange](../../mfc/reference/crecordset-class.md#dobulkfieldexchange) функции-члена и Инициализация элементов данных в конструкторе класса. Дополнительные сведения см. в разделе [набор записей: динамическая привязка столбцов данных (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md).  
  
-   Переопределение функций-членов набора записей, таких как `OnSetOptions`, чтобы задать параметры конкретного приложения или переопределить значения по умолчанию.  
  
 Если вы хотите базы сложные инструкции SQL набора записей, необходимо использовать сочетание описанных выше способов настройки. Например это может потребоваться использовать предложений SQL и ключевые слова, которые не поддерживаются напрямую в наборах записей или таким образом можно объединять несколько таблиц.  
  
## <a name="see-also"></a>См. также  
 [Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)   
 [Набор записей: Порядок обновления записей в наборе записей (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)   
 [Основы ODBC](../../data/odbc/odbc-basics.md)   
 [SQL](../../data/odbc/sql.md)   
 [Набор записей. Блокировка (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)