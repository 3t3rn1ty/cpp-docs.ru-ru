---
title: "Набор записей. Архитектура (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "члены данных полей"
  - "члены данных полей, набор записей - архитектура"
  - "m_nFields - элемент данных"
  - "m_nFields - элемент данных, наборы записей"
  - "m_nParams - элемент данных"
  - "m_nParams - элемент данных, наборы записей"
  - "наборы записей ODBC, архитектура"
  - "параметризованные члены данных в наборах записей"
  - "наборы записей, архитектура"
  - "наборы записей, члены данных"
ms.assetid: 47555ddb-11be-4b9e-9b9a-f2931764d298
caps.latest.revision: 8
caps.handback.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Набор записей. Архитектура (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 В этом разделе описаны элементы данных, составляющие архитектуру объекта набора записей.  
  
-   [Элементы данных полей](#_core_field_data_members)  
  
-   [Элементы данных параметров](#_core_parameter_data_members)  
  
-   [Использование элементов данных m\_nFields и m\_nParams](#_core_using_m_nfields_and_m_nparams)  
  
> [!NOTE]
>  В этом разделе приведены сведения, относящиеся к объектам, производным от класса `CRecordset`, в котором групповая выборка строк не реализована.  Если групповая операция со строками реализуется, архитектура определяется аналогичным образом.  Описание различий см. в разделе [Набор записей: групповая выборка записей ODBC](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md).  
  
##  <a name="_core_a_sample_class"></a> Образец класса  
 При использовании [мастера потребителей ODBC библиотеки MFC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) в **Мастере добавления класса** для объявления класса набора записей, производного от класса `CRecordset`, результирующий класс в общем виде будет иметь структуру, как показано в следующем образце класса:  
  
```  
class CCourse : public CRecordset  
{  
public:  
   CCourse(CDatabase* pDatabase = NULL);  
   ...  
   CString m_strCourseID;  
   CString m_strCourseTitle;  
   CString m_strIDParam;  
};  
```  
  
 В начале класса мастер записывает набор [элементов данных полей](#_core_field_data_members).  При создании класса необходимо указать один или несколько элементов данных полей.  Если класс является параметризованным, как и образец класса \(с помощью элемента данных `m_strIDParam`\), необходимо вручную добавить [элементы данных параметров](#_core_parameter_data_members).  Добавление параметров в класс с помощью мастера не поддерживается.  
  
##  <a name="_core_field_data_members"></a> Элементы данных полей  
 Самыми важными элементами в классе набора записей являются элементы данных полей.  Для каждого столбца, выбранного в источнике данных, класс содержит элемент данных соответствующего для этого столбца типа.  Например, [образец класса](#_core_a_sample_class), показанный в начале данного раздела, имеет два элемента данных полей, относящихся к типу `CString`. Это элементы данных `m_strCourseID` и `m_strCourseTitle`.  
  
 При выборе набора записей платформа автоматически связывает столбцы текущей записи \(после вызова функции **Open** первая запись становится текущей\) и элементы данных полей объекта.  Таким образом, платформа использует соответствующий элемент данных полей в качестве буфера, в котором хранится содержимое столбца записи.  
  
 При переходе пользователя к новой записи платформа использует элементы данных полей для представления текущей записи.  Платформа обновляет элементы данных полей, заменяя значения предыдущей записи.  Элементы данных полей также используются для обновления текущей и добавления новых записей.  В процессе обновления записи необходимо указать значения для обновления. Для этого необходимо присвоить значения непосредственно элементу или элементам данных полей.  
  
##  <a name="_core_parameter_data_members"></a> Элементы данных параметров  
 Класс является параметризованным, если он имеет один или несколько элементов данных параметров.  Параметризованный класс позволяет делать в набор записей запросы на информацию, полученную или рассчитанную во время выполнения.  
  
 Как правило, параметр помогает сузить выбор, как показано в следующем примере.  На основе [образца класса](#_core_a_sample_class), рассмотренного в начале данного раздела, объект набора записей может выполнить следующую инструкцию SQL:  
  
```  
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = ?  
```  
  
 "?" является местозаполнителем для значения параметра, предоставляемого во время выполнения.  При создании набора записей и задании для его элемента данных `m_strIDParam` значения MATH101 действующая инструкция SQL для этого набора записей выглядит следующим образом:  
  
```  
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = MATH101  
```  
  
 С помощью определения элементов данных параметров платформа получает сведения о параметрах в строке SQL.  Платформа осуществляет связывание параметра, и таким образом ODBC узнает, на какие значения необходимо заменить местозаполнитель.  В приведенном примере результирующий набор записей содержит только запись из таблицы "Course", в которой столбцу "CourseID" было присвоено значение MATH101.  Выбираются все указанные столбцы для данной записи.  Можно задать такое количество параметров \(и местозаполнителей\), которое необходимо.  
  
> [!NOTE]
>  MFC не выполняет с параметрами никаких действий: в частности, в них не выполняется замена текста.  Вместо этого MFC только сообщает ODBC, откуда необходимо получить параметры, после чего ODBC извлекает данные и выполняет необходимую параметризацию.  
  
> [!NOTE]
>  Порядок следования параметров имеет значение.  Сведения о порядке следования параметров и другую информацию о параметрах см. в разделе [Набор записей. Использование параметров для наборов записей \(ODBC\)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  
  
##  <a name="_core_using_m_nfields_and_m_nparams"></a> Использование элементов данных m\_nFields и m\_nParams  
 Когда мастер создает конструктор для класса, он также инициализирует элемент данных [m\_nFields](../Topic/CRecordset::m_nFields.md), который указывает число [элементов данных полей](#_core_field_data_members) в классе.  При добавлении каких\-либо [параметров](#_core_parameter_data_members) в класс необходимо инициализировать элемент данных [m\_nParams](../Topic/CRecordset::m_nParams.md), который указывает число элементов данных параметров.  Платформа использует эти значения при работе с элементами данных.  
  
 Дополнительные сведения и примеры см. в разделе [Обмен полями записей. Использование RFX](../../data/odbc/record-field-exchange-using-rfx.md).  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)   
 [Набор записей. Объявление класса таблицы \(ODBC\)](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)   
 [Обмен данными полями записей \(RFX\)](../../data/odbc/record-field-exchange-rfx.md)