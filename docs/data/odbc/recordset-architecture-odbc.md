---
title: "Набор записей: Архитектура (ODBC) | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- recordsets, data members
- field data members, recordset architecture
- field data members
- m_nParams data member, recordsets
- recordsets, architecture
- parameter data members in recordsets
- m_nFields data member
- ODBC recordsets, architecture
- m_nParams data member
- m_nFields data member, recordsets
ms.assetid: 47555ddb-11be-4b9e-9b9a-f2931764d298
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 169d371327137cf4f51ed10429eb5e9708a0e088
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="recordset-architecture-odbc"></a>Набор записей. Архитектура (ODBC)
Этот раздел относится к классам MFC ODBC.  
  
 В этом разделе описаны элементы данных, составляющие архитектуру объекта набора записей:  
  
-   [Члены данных полей](#_core_field_data_members)  
  
-   [Параметризованные члены данных](#_core_parameter_data_members)  
  
-   [С помощью m_nFields и m_nParams члены данных](#_core_using_m_nfields_and_m_nparams)  
  
> [!NOTE]
>  Этот раздел относится к объектам, производным от `CRecordset` в какой строке массовая выборка не был реализован. Если реализована массовая выборка строк, архитектура определяется аналогичным образом. О различиях в разделе [набор записей: групповая выборка записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  
  
##  <a name="_core_a_sample_class"></a>Пример класса  
 При использовании [мастер потребителей ODBC MFC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) из **добавить класс** мастер, чтобы объявить класс набора записей на основе `CRecordset`, результирующий класс имеет Общая структура показано в следующем простой класс:  
  
```  
class CCourse : public CRecordset  
{  
public:  
   CCourse(CDatabase* pDatabase = NULL);  
   ...  
   CString m_strCourseID;  
   CString m_strCourseTitle;  
   CString m_strIDParam;  
};  
```  
  
 В начале класса мастер записывает набор [полей с данными](#_core_field_data_members). При создании класса необходимо указать один или несколько элементов данных полей. Если класс является параметризованным, что и в примере класс является (с данными-членом `m_strIDParam`), необходимо вручную добавить [параметризованные члены данных](#_core_parameter_data_members). Мастер не поддерживает добавление параметров для класса.  
  
##  <a name="_core_field_data_members"></a>Члены данных полей  
 Наиболее важные члены класса набора записей являются элементами данных полей. Для каждого столбца, выбранного из источника данных класс содержит элемент данных из соответствующего типа данных для этого столбца. Например [пример класса](#_core_a_sample_class) показанный в начале этого раздела содержит два элемента данных поля, оба типа `CString`, который называется `m_strCourseID` и `m_strCourseTitle`.  
  
 При выборе набора записей, платформа автоматически связывает столбцы текущей записи (после **откройте** вызова, первая запись становится текущей) с элементами данных полей объекта. То есть платформа использует соответствующий элемент данных полей служит буфером, в котором будет храниться содержимое столбца записи.  
  
 При переходе пользователя на новую запись, платформа использует элементами данных полей для представления текущей записи. Платформа обновляет поля элементов данных, заменив значения предыдущей записи. Члены данных полей также используются для обновления текущей записи и добавления новых записей. В рамках процесса обновления записи необходимо указать значения обновления путем присвоения значений непосредственно для соответствующего элемента данных поля или членов.  
  
##  <a name="_core_parameter_data_members"></a>Параметризованные члены данных  
 Если класс является параметризованным, она имеет один или несколько элементов данных параметров. Параметризованный класс позволяет строить запрос набора записей на полученных данных или вычисленных во время выполнения.  
  
 Как правило параметр помогает сузить выбор, как показано в следующем примере. На основе [пример класса](#_core_a_sample_class) в начале этого раздела, объект набора записей может выполнить следующую инструкцию SQL:  
  
```  
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = ?  
```  
  
 «?» — Это заполнитель для значения параметра, который необходимо предоставить во время выполнения. При создании набора записей и задать его `m_strIDParam` данные-члены MATH101, становится эффективным инструкции SQL набора записей:  
  
```  
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = MATH101  
```  
  
 Определив параметризованные члены данных, сообщить платформе о параметрах в строке SQL. Платформа привязывает параметр, который позволяет ODBC знать, где можно получить значения для замены для заполнителя. В примере результирующий набор записей содержит только запись из таблицы со столбцом CourseID, значение которого является MATH101 курса. Выбираются все указанные столбцы для данной записи. Можно указать любое количество параметров (и местозаполнителей) при необходимости.  
  
> [!NOTE]
>  MFC не выполняет с параметрами, в частности, он не выполняет замену текста. Вместо этого MFC сообщает ODBC, где для получения параметров; ODBC извлекает данные и выполняет необходимые параметризации.  
  
> [!NOTE]
>  Важен порядок параметров. Сведения об этом и Дополнительные сведения о параметрах см. в разделе [набор записей: Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  
  
##  <a name="_core_using_m_nfields_and_m_nparams"></a>С помощью m_nFields и m_nParams  

 Когда мастер создает конструктор для класса, он также инициализирует [m_nFields](../../mfc/reference/crecordset-class.md#m_nfields) элемента данных, которое указывает количество [полей с данными](#_core_field_data_members) в классе. Если какие-либо добавляются [параметры](#_core_parameter_data_members) к классу, необходимо также добавить инициализацию для [m_nParams](../../mfc/reference/crecordset-class.md#m_nparams) элемент данных, который указывает число элементов данных параметров. Платформа использует эти значения для работы с элементами данных.  
  
 Дополнительные сведения и примеры см. в разделе [обмен полями записей: использование RFX](../../data/odbc/record-field-exchange-using-rfx.md).  
  
## <a name="see-also"></a>См. также  
 [Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)   
 [Набор записей: Объявление класса таблицы (ODBC)](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)   
 [Обмен данными полей записей (RFX)](../../data/odbc/record-field-exchange-rfx.md)