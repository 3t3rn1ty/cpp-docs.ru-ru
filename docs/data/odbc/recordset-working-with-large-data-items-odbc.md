---
title: "Набор записей. Работа с большими элементами данных (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "BLOB-объекты"
  - "BLOB-объект, наборы записей"
  - "CLongBinary - класс, использование в наборах записей"
  - "наборы записей ODBC, BLOB-объекты"
  - "наборы записей, BLOB-объекты"
ms.assetid: 3e80b5a8-b6e7-43c6-a816-e54befc513a3
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Набор записей. Работа с большими элементами данных (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Сведения, представленные в этом разделе, относятся как к классам MFC ODBC, так и к классам MFC DAO.  
  
> [!NOTE]
>  При работе с классами MFC DAO для управления большими элементами данных рекомендуется использовать класс [CByteArray](../../mfc/reference/cbytearray-class.md), а не класс [CLongBinary](../../mfc/reference/clongbinary-class.md).  При работе с классами MFC ODBC с групповой выборкой строк рекомендуется использовать класс `CLongBinary`, а не `CByteArray`.  Дополнительные сведения о групповой выборке строк см. в разделе [Набор записей. Групповая выборка строк \(ODBC\)](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md).  
  
 В базе данных могут храниться элементы данных большого объема, например растровые изображения \(фотографии сотрудников, карты, изображения продуктов, объекты OLE и т. д.\).  Объекты такого типа часто называются большими двоичными объектами \(BLOB\) по следующим причинам:  
  
-   Каждое поле содержит большое значение.  
  
-   В отличие от числовых и других простых типов данных, определить размер объекта заранее невозможно.  
  
-   С точки зрения программы данные таких объектов не имеют строгой формы.  
  
 В этом разделе описывается реализация поддержки таких объектов с использованием классов баз данных.  
  
##  <a name="_core_managing_large_objects"></a> Управление большими объектами  
 В наборах записей предусмотрено два способа устранения проблем, возникающих при работе с большими двоичными объектами.  Для этих целей можно использовать класс [CByteArray](../../mfc/reference/cbytearray-class.md) или класс [CLongBinary](../../mfc/reference/clongbinary-class.md).  В большинстве случаев для управления большими двоичными объектами рекомендуется использовать класс `CByteArray`.  
  
 При использовании класса `CByteArray` расходуется больший объем ресурсов, однако при этом обеспечивается более высокая функциональность по сравнению с классом `CLongBinary`. См. описание в разделе [Класс CByteArray](#_core_the_cbytearray_class).  Краткое описание класса `CLongBinary` см. в разделе [Класс CLongBinary](#_core_the_clongbinary_class).  
  
 Дополнительные сведения об использовании класса `CByteArray` для работы с большими элементами данных см. в разделе [Техническое примечание 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).  
  
##  <a name="_core_the_cbytearray_class"></a> Класс CByteArray  
 Класс `CByteArray` входит в состав коллекции классов MFC.  В объекте класса `CByteArray` хранится динамический массив байтов, который при необходимости может расширяться.  Как и во встроенных массивах C\+\+, в этом классе поддерживается быстрый доступ к элементам по индексу.  В целях диагностики для объектов класса `CByteArray` поддерживается сериализация и формирование дампа.  В этом классе поддерживаются функции получения и установки значений определенных байтов, вставки и добавления байтов, а также удаления одного или всех байтов.  Благодаря этим функциям упрощается анализ двоичных данных.  Например, если двоичный объект является объектом OLE, перед обращением к самому объекту необходимо выполнить обработку нескольких байтов заголовка.  
  
##  <a name="_core_using_cbytearray_in_recordsets"></a> Использование класса CByteArray для работы с наборами записей  
 Члену данных поля в наборе записей можно присвоить тип `CByteArray`. Это позволит использовать функции [RFX](../../data/odbc/record-field-exchange-rfx.md) для управления передачей таких объектов между набором записей и источником данных, а также управлять данными объектами.  При работе с функциями RFX необходимо использовать специальный узел для хранения извлеченных данных, а также механизм доступа к данным источника.  
  
 Дополнительные сведения об использовании класса `CByteArray` для работы с большими элементами данных см. в разделе [Техническое примечание 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).  
  
##  <a name="_core_the_clongbinary_class"></a> Класс CLongBinary  
 Объект класса [CLongBinary](../../mfc/reference/clongbinary-class.md) представляет собой простую оболочку для дескриптора `HGLOBAL`, определенного для выделенного в куче блока памяти.  В случае привязки к столбцу таблицы, содержащему большой двоичный объект, с помощью функции RFX выделяется дескриптор `HGLOBAL` \(используется при передаче данных из набора записей\), который сохраняется в поле класса `CLongBinary` набора записей.  
  
 В свою очередь, дескриптор `HGLOBAL` `m_hData` используется для работы с самими данными так же, как и с любыми другими данными дескриптора.  В этом случае используются дополнительные возможности класса [CByteArray](../../mfc/reference/cbytearray-class.md).  
  
> [!CAUTION]
>  Объекты класса CLongBinary не могут использоваться в качестве параметров при вызове функций.  Кроме того, если в реализацию такого объекта включен вызов функции **::SQLGetData**, во всех случаях снижается производительность при прокрутке моментальных снимков.  Производительность также снижается при вызове функции **::SQLGetData** для извлечения столбцов динамической схемы.  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)   
 [Набор записей. Определение сумм и других статистических результатов \(ODBC\)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)   
 [Обмен данными полями записей \(RFX\)](../../data/odbc/record-field-exchange-rfx.md)