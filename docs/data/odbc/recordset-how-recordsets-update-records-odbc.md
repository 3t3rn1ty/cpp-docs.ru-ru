---
title: "Набор записей. Порядок обновления записей в наборе (ODBC) | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "наборы записей ODBC, обновление"
  - "записи, обновление"
  - "наборы записей, изменение записей"
  - "наборы записей, обновление"
  - "обновление записей"
ms.assetid: 5ceecc06-7a86-43b1-93db-a54fb1e717c7
caps.latest.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 8
---
# Набор записей. Порядок обновления записей в наборе (ODBC)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Данный раздел относится к классам ODBC библиотеки MFC.  
  
 Помимо функции выбора записей в источнике данных, набор записей \(не обязательно\) может обновлять или удалять выбранные данные, а также добавлять новые записи.  Три фактора определяют способность набора записей к обновлению: способность к обновлению подключенного источника данных, заданные параметры во время создания объекта набора записей и созданная база данных SQL.  
  
> [!NOTE]
>  База данных SQL, в которой находится объект `CRecordset`, может воздействовать на способность набора записей к обновлению.  Например, если SQL имеет соединение или предложение **GROUP BY**, библиотека MFC устанавливает функцию обновления в **FALSE**.  
  
> [!NOTE]
>  В этом разделе приведены сведения, относящиеся к объектам, производным от класса `CRecordset`, в котором групповая выборка строк не реализована.  При использовании групповой выборки строк следует ознакомиться с разделом [Набор записей: групповая выборка записей \(ODBC\)](../Topic/Recordset:%20Fetching%20Records%20in%20Bulk%20\(ODBC\).md).  
  
 Содержание раздела:  
  
-   [Роль пользователя в обновлении набора записей](#_core_your_role_in_recordset_updating) и роль платформы.  
  
-   [Использование набора записей в качестве буфера редактирования](#_core_the_edit_buffer) и [различия между динамическими подмножествами данных и моментальными снимками](#_core_dynasets_and_snapshots).  
  
 Раздел [Набор записей: как выполняются функции\-члены AddNew, Edit и Delete \(ODBC\)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) рассматривает действия этих функций с позиции набора записей.  
  
 Раздел [Набор записей. Дополнительные сведения об обновлении \(ODBC\)](../../data/odbc/recordset-more-about-updates-odbc.md) завершает рассказ об обновлениях набора записей. В разделе рассматривается влияние транзакций на обновления, влияние закрытия или прокрутки набора записей на выполняющиеся обновления и взаимодействие обновлений одного пользователя с обновлениями других пользователей.  
  
##  <a name="_core_your_role_in_recordset_updating"></a> Роль пользователя в обновлении набора записей  
 В следующей таблице анализируется роль, которую выполняет пользователь во время добавления, изменения или удаления записей набором записей, а также важность работы платформы.  
  
### Обновление набора записей. Пользователь и платформа  
  
||.NET Framework|  
|-|--------------------|  
|Определение источника данных и его способность к обновлению \(или к присоединению\).|Предоставляет функции\-члены [CDatabase](../../mfc/reference/cdatabase-class.md) для тестирования способности источника данных к обновлению или к присоединению.|  
|Открытие обновляемого набора записей \(любого типа\).||  
|Определяет, является ли набор записей обновляемым, с помощью функций `CRecordset` `CanUpdate` или `CanAppend`.||  
|Вызов функций\-членов набора записей, для добавления, изменения и удаления записей.|Управляет механизмом обмена данных между объектом набора записей и источником данных.|  
|\(Дополнительно\) использование транзакции для управления процессом обновления.|Предоставляет функции\-члены `CDatabase` для поддерживания транзакций.|  
  
 Дополнительные сведения о транзакциях см. в разделе [Транзакции \(ODBC\)](../../data/odbc/transaction-odbc.md).  
  
##  <a name="_core_the_edit_buffer"></a> Буфер редактирования  
 Взятые все вместе, члены\-поля данных набора записей служат буфером редактирования, который хранит одну текущую запись.  Операции обновления используют этот буфер при операциях с текущей записью.  
  
-   Во время добавления записи буфер редактирования используется для создания новой записи.  После добавления записи, запись, которая была текущей до этого, снова становится текущей.  
  
-   Во время обновления \(изменения\) записи буфер редактирования используется для присваивания новых значений член\-полю данных набора данных.  После завершения обновления, обновленная запись по\-прежнему является текущей.  
  
 При вызове функции\-члена [AddNew](../Topic/CRecordset::AddNew.md) или [Edit](../Topic/CRecordset::Edit.md) текущая запись сохраняется для дальнейшего восстановления.  При вызове функции\-члена [Delete](../Topic/CRecordset::Delete.md) текущая запись не сохраняется, а помечается как удаленная, вынуждая пользователя перейти к другой записи.  
  
> [!NOTE]
>  Буфер редактирования не принимает участия в процессе удаления записи.  При удалении текущей записи, запись помечается как удаленная и ни одна другая запись в наборе записей не является активной до тех пор, пока пользователь не перейдет к другой записи.  
  
##  <a name="_core_dynasets_and_snapshots"></a> Динамические подмножества данных и моментальные снимки  
 [Динамические подмножества данных](../../data/odbc/dynaset.md) обновляют содержимое записей при переходе к новой записи.  [Моментальные снимки](../Topic/Snapshot.md) являются статическими представлениями записей, поэтому содержание записи обновляется только при вызове [Requery](../Topic/CRecordset::Requery.md).  Для того чтобы использовать все преимущества и функции динамических подмножеств данных, нужно использовать тот драйвер ODBC, который соответствует требуемому уровню поддержки API ODBC.  Дополнительные сведения см. разделах [ODBC](../../data/odbc/odbc-basics.md) и [Динамическое подмножество данных](../../data/odbc/dynaset.md).  
  
## См. также  
 [Набор записей \(ODBC\)](../../data/odbc/recordset-odbc.md)   
 [Наборы записей. Принципы работы функций AddNew, Edit и Delete \(ODBC\)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)