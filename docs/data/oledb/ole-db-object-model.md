---
title: "Объектная модель OLE DB | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "OLE DB, объектная модель"
  - "наборы строк, объектная модель OLE DB"
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
caps.latest.revision: 8
caps.handback.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Объектная модель OLE DB
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Объектная модель OLE DB содержит следующие объекты и компоненты.  Первые четыре объекта и компонента, перечисленные ниже \(источники данных, сеансы, команды и наборы строк\), позволяют подключаться к источнику данных и просматривать его.  Остальные, начиная с методов доступа, относятся к работе с данными во время их отображения.  
  
## Источники данных  
 Объекты источника данных позволяют подключаться к источнику данных, такому как файл или СУБД.  Объект источника данных создает подключение и управляет им, а также содержит разрешения и сведения для проверки подлинности \(такие как имя для входа в систему и пароль\).  Объект источника данных может создавать один или несколько сеансов.  
  
## Сеансы  
 Сеанс управляет определенным взаимодействием с источником данных для запроса и получения данных.  Каждый сеанс является единичной транзакцией.  Транзакция является неделимой единицей работы, определяемой с помощью теста ACID.  Определение ACID см. в разделе [Транзакции](#vcconoledbcomponents_transactions).  
  
 Сеансы выполняют важные задачи, такие как открытие наборов строк и возвращение объекта источника данных, который их создал.  Сеансы также могут возвращать метаданные или сведения о самом источнике данных \(например, табличную информацию\).  
  
 Сеанс может создавать одну или несколько команд.  
  
## Команды  
 Команды выполняют текстовые команды, такие как инструкции SQL.  Если в текстовой команде указан набор строк, например инструкция SQL **SELECT**, то команда создает набор строк.  
  
 Команда является простым контейнером для текстовой команды, которая представляет собой строку \(например, инструкцию SQL\), передаваемую от потребителя объекту источника данных для выполнения с помощью базового хранилища данных поставщика.  Обычно текстовая команда является инструкцией SQL **SELECT** \(в этом случае команда автоматически создает набор строк, поскольку в инструкции SQL **SELECT** указан набор строк\).  
  
## Наборы строк  
 Наборы строк предоставляют данные в табличной форме.  Частным случаем набора строк является индекс.  Наборы строк можно создавать из сеанса или команды.  
  
### Наборы строк схемы  
 Схемы содержат метаданные \(информацию о структуре\) базы данных.  Наборы строк схемы являются наборами строк, содержащими сведения о схеме.  Некоторые поставщики OLE DB для СУБД поддерживают объекты наборов строк схемы.  Дополнительные сведения о наборах строк схемы см. в разделах [Получение метаданных в схеме набора строк](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) и [Классы схемы Rowset и Typedef](../Topic/Schema%20Rowset%20Classes%20and%20Typedef%20Classes.md).  
  
### Объекты представления  
 Объект представления определяет подмножество строк и столбцов в наборе строк.  Он не содержит собственных данных.  Объекты представления не могут сочетать данные из различных наборов строк.  
  
## Методы доступа  
 Понятие методов доступа используется только для OLE DB.  Метод доступа описывает, каким образом данные сохраняются в потребителе.  Он содержит набор привязок \(называемый сопоставлением столбцов\) между полями набора строк \(столбцами\) и элементами данных, объявленными в потребителе.  
  
##  <a name="vcconoledbcomponents_transactions"></a> Транзакции  
 Объекты транзакции используются при фиксации или отмене вложенных транзакций на уровне, отличном от нижнего.  Транзакция является неделимой единицей работы, определяемой с помощью теста ACID.  ACID означает:  
  
-   атомарность \(atomicity\) — неделимость на более мелкие единицы работы;  
  
-   параллелизм \(concurrency\) — несколько транзакций могут выполняться одновременно;  
  
-   изоляция \(isolation\) — каждая транзакция имеет ограниченное знание об изменениях, выполненных другими транзакциями;  
  
-   продолжительность \(durability\) — транзакция выполняет окончательные изменения.  
  
## Перечислители.  
 Перечислители выполняют поиск доступных источников данных и других перечислителей.  Потребители, не настроенные для определенного источника данных, используют перечислители для поиска используемого источника данных.  
  
 Корневой перечислитель, поставляемый с пакетом Microsoft Data Access SDK, выполняет в реестре поиск источников данных и других перечислителей.  Другие перечислители также просматривают реестр или выполняют поиск определенным образом \(в зависимости от поставщика\).  
  
## Ошибки  
 Любой интерфейс любого объекта OLE DB может вызывать ошибки.  Сообщения об ошибках содержат дополнительные сведения об ошибке, включая необязательный объект настраиваемой ошибки.  Эти сведения содержатся в HRESULT.  
  
## Уведомления  
 Уведомления используются группами потребителей, совместно использующих набор строк \(причем совместное использование подразумевает, что потребители действуют в рамках одной и той же транзакции\).  Уведомления позволяют потребителям, совместно использующим набор строк, быть в курсе действий, выполняемых другими объектами\-получателями.  
  
## См. также  
 [Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)   
 [Общие сведения о программировании OLE DB](../../data/oledb/ole-db-programming-overview.md)