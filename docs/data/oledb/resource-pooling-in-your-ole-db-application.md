---
title: Создание пулов ресурсов в приложениях OLE DB | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- OLE DB services [OLE DB], resource pooling
- resource pooling [OLE DB], services
- OLE DB, resource pooling
- OLE DB providers, resource pooling
ms.assetid: 2ead1bcf-bbd4-43ea-a307-bb694b992fc1
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: ece7ce128251f66360566c9b1965466352c4e493
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="resource-pooling-in-your-ole-db-application"></a>Создание пулов ресурсов в приложениях OLE DB
Создание пулов в приложении необходимо проверить службы OLE DB, вызываются с помощью получения источника данных через **IDataInitialize** или **IDBPromptInitialize**. Если напрямую использовать `CoCreateInstance` для вызова поставщика на основе его CLSID, службы OLE DB не вызываются.  
  
 Службы OLE DB Ведение кластеров из подключенных источников данных при условии, что ссылку на **IDataInitialize** или **IDBPromptInitialize** занятые или при условии, что имеется подключение к использованию. Пулы также будут автоматически обновлены в среде служб COM + 1.0 или Internet Information Services (IIS). Если приложение использует пул за пределами среде служб COM + 1.0 или IIS, следует сохранить ссылку на **IDataInitialize** или **IDBPromptInitialize** или удерживать по крайней мере одну соединение. Чтобы убедиться в том, что пул не был уничтожен при освобождении последнего соединения в приложении, сохранять ссылку или удерживать подключение в течение времени существования приложения.  
  
 Службы OLE DB идентифицируют пул, из которого берется подключение, во время, `Initialize` вызывается. Нарисовав соединение из пула, ее нельзя переместить в другой пул. Таким образом, не следует изменять в приложении, изменить сведения об инициализации, например при вызове `UnInitialize` или вызов `QueryInterface` для интерфейса поставщика перед вызовом `Initialize`. Кроме того, подключений, установленных с значения запроса, отличный от **DBPROMPT_NOPROMPT** не помещаются в пул. Однако строка инициализации, полученных из установленного через запрос подключения можно установить дополнительные подключения к одному источнику данных в пуле.  
  
 Некоторым поставщикам необходимо создавать отдельное соединение для каждого сеанса. Эти дополнительные подключения должны отдельно включаться в распределенной транзакции, при наличии. Службы OLE DB кэширует и повторно использует один сеанс для одного источника данных, но если приложение запрашивает несколько сеансов одновременно из одного источника данных, поставщик может оказаться, что создание дополнительных подключений и выполнив прикреплений дополнительных транзакций, которые являются не в составе пула. Это гораздо более эффективный способ — создать отдельного источника данных для каждого сеанса в пуле среде, чем создание нескольких сеансов из одного источника данных.  
  
 Наконец поскольку ADO автоматически задействует OLE DB для служб, можно использовать ADO для установки соединений и пулы и прикрепление происходит автоматически.  
  
## <a name="see-also"></a>См. также  
 [Создание пулов ресурсов и служб OLE DB](../../data/oledb/ole-db-resource-pooling-and-services.md)