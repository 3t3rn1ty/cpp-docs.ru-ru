---
title: "Создание пулов ресурсов в приложениях OLE DB | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "поставщики OLE DB, создание пулов ресурсов"
  - "службы OLE DB [OLE DB], создание пулов ресурсов"
  - "OLE DB, создание пулов ресурсов"
  - "создание пулов ресурсов [OLE DB], службы"
ms.assetid: 2ead1bcf-bbd4-43ea-a307-bb694b992fc1
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Создание пулов ресурсов в приложениях OLE DB
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Чтобы воспользоваться в приложении преимуществами пулов, необходимо гарантировать, что вызываются службы OLE DB, обращаясь к данным через интерфейс **IDataInitialize** или **IDBPromptInitialize**.  Если напрямую использовать функцию `CoCreateInstance` для создания объекта поставщика на основе его CLSID, службы OLE DB не вызываются.  
  
 Службы OLE DB обслуживают пулы подключенных источников данных до тех пор, пока удерживается ссылка на интерфейс **IDataInitialize** или **IDBPromptInitialize**, либо пока существует подключение.  Также пулы автоматически поддерживаются в среде служб COM\+ 1.0 и служб IIS.  Если приложение использует пулы, не относящиеся к службам COM\+ 1.0 или IIS, необходимо сохранять ссылку на интерфейс **IDataInitialize** или **IDBPromptInitialize** либо поддерживать по крайней мере одно подключение.  Чтобы пул не был уничтожен при освобождении приложением последнего подключения, сохраняйте ссылку или поддерживайте подключение в течение всего времени работы приложения.  
  
 Службы OLE DB идентифицируют пул, из которого берется подключение, во время вызова функции `Initialize`.  После получения подключения из пула его нельзя переместить в другой пул.  Поэтому не следует изменять в приложении инициализационную информацию, например, вызывать функцию `UnInitialize` или использовать методы интерфейсов, специфичных для поставщика, например `QueryInterface`, до вызова функции `Initialize`.  Также необходимо учитывать, что подключения, установленные с иным значением атрибута запроса **DBPROMPT\_NOPROMPT**, не помещаются в пул.  Тем не менее, строку инициализации, извлеченную из установленного через запрос подключения, можно использовать для установки дополнительных подключений к тому же источнику данных, размещаемых в пуле.  
  
 Некоторым поставщикам необходимо создавать отдельное подключение для каждого сеанса.  Эти дополнительные подключения должны отдельно включаться в распределенную транзакцию, если таковая существует.  Службы OLE DB кэшируют и повторно используют по одному сеансу на каждый источник данных. Тем не менее, если приложение запрашивает за один раз несколько сеансов от одного источника данных, поставщик может прекратить создание дополнительных соединений и выполнение дополнительных транзакционных включений, которые не помещаются в пул.  В среде, поддерживающей пулы, создание отдельного источника данных для каждого сеанса более эффективно, чем создание нескольких сеансов для одного источника данных.  
  
 Наконец, поскольку ADO автоматически задействует службы OLE DB, можно использовать ADO для установки подключений, благодаря чему поддержка пулов и транзакционных включений будет выполняться автоматически.  
  
## См. также  
 [Создание пулов ресурсов и служб OLE DB](../../data/oledb/ole-db-resource-pooling-and-services.md)