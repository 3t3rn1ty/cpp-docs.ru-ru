---
title: Шаблоны поставщика OLE DB (C++) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- OLE DB providers [C++], about providers
- databases [C++], OLE DB templates
- OLE DB provider templates [C++], about OLE DB provider templates
- templates [C++], OLE DB
ms.assetid: fccff85f-2af8-4500-82bd-6312d28a74b8
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: a331e72433ca25d280d35edfd33a56402675aea9
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33112749"
---
# <a name="ole-db-provider-templates-c"></a>Шаблоны поставщика OLE DB (С++)
OLE DB является важной частью стратегии универсального доступа к данным Microsoft. Конструкция OLE DB позволяет доступ к данным высокой производительности из любого источника данных. Все табличные данные, можно просматривать через интерфейс OLE DB независимо от того, он поступает из базы данных. Эта гибкость дает большую производительность.  
  
 Как описано в статье [потребителей OLE DB и поставщики](../../data/oledb/ole-db-consumers-and-providers.md), используется концепция получатели и поставщики OLE DB. Потребитель выполняет запросы к данным; поставщик возвращает данные в табличном формате, потребителю. С точки зрения программиста наиболее важных эта модель имеет, поставщик должен реализовать любой вызов объекта-получателя.  
  
## <a name="what-is-a-provider"></a>Что такое поставщик?  
 Поставщик OLE DB — это набор COM-объектов, которые обслуживают вызовы интерфейса из пользовательского объекта, передача данных в табличном формате из долговременного источника (называемой хранилищем данных) объекту-получателю.  
  
 Поставщики могут быть простыми или сложными. Поставщик может поддерживать минимальное число функциональных возможностей или полнофункциональным поставщиком для производственного реализуя дополнительные интерфейсы. Поставщик может возвращать таблицу, позволяют клиенту определить формат этой таблицы и выполнения операций с этими данными.  
  
 Каждый поставщик реализует стандартный набор COM-объектов для обработки запросов от клиента, в результате чего значение standard, что любой потребитель OLE DB можно доступ к данным из любого поставщика, независимо от языка (например, C++, Basic).  
  
 Каждый COM-объект содержит несколько интерфейсов, некоторые из которых являются обязательными, и некоторые из которых являются необязательными. Путем реализации обязательные интерфейсы, поставщик гарантирует минимальный уровень функциональности (который называется совместимостью), который должен иметь возможность использовать любой клиент. Поставщик может реализовать необязательные интерфейсы, чтобы предоставлять дополнительные функциональные возможности. [Архитектура поставщика OLE DB шаблона](../../data/oledb/ole-db-provider-template-architecture.md) описаны подробно эти интерфейсы. Клиент должен всегда вызывать `QueryInterface` , чтобы определить, поддерживает ли поставщик данный интерфейс.  
  
## <a name="ole-db-specification-level-support"></a>Уровень поддержки спецификации OLE DB  
 Шаблоны поставщика OLE DB поддерживают спецификацию OLE DB версии 2.7. Использование шаблонов поставщика OLE DB, можно реализовать поставщик, совместимый с уровня 0. Образец поставщика, например, использует шаблоны для реализации управляющего сервера, который выполняет команду DOS DIR, чтобы обращаться к файловой системе. В образце поставщик возвращает сведения о каталоге в наборе строк, что является стандартным механизмом OLE DB для возвращения табличных данных.  
  
 Простейший тип поставщика, поддерживаемых шаблонов OLE DB является поставщиком только для чтения без команд. Поставщики с командами также поддерживаются, как является возможность создания закладок и чтения и записи. Чтение и запись поставщика можно реализовать путем создания дополнительного кода. Динамические наборы строк и транзакции не поддерживаются в текущей версии, но их можно добавить, если требуется.  
  
## <a name="when-do-you-need-to-create-an-ole-db-provider"></a>Если необходимо создать поставщика OLE DB?  
 Вы не всегда требуется для создания собственного поставщика; Корпорация Майкрософт предоставляет несколько стандартных поставщиков в **свойства связи данных** диалоговое окно в Visual C++. Чтобы воспользоваться преимуществами стратегии универсального доступа к данным является основной причиной для создания поставщика OLE DB. Некоторые преимущества перечислены ниже:  
  
-   Доступ к данным через любой язык C++, Basic и Visual Basic Scripting Edition. Она позволяет разным программистам организации для доступа к тем же данным таким же образом, независимо от того, какой язык они используют.  
  
-   Предоставление данных для других данных источников, таких как SQL Server, Excel и Access. Это может быть очень полезно использовать для передачи данных между разными форматами.  
  
-   Участие в операциях (разнородного) источника данных между. Это может быть очень эффективным способом хранения данных. С помощью поставщиков OLE DB, можно хранить данные в его собственном формате и по-прежнему иметь доступ к его с помощью одной операции.  
  
-   Добавление дополнительных возможностей к данным, таких как обработка запросов.  
  
-   Увеличение производительности доступа к данным, контролируя, как ими управлять.  
  
-   Повышение надежности. Если у вас есть собственный формат данных доступен, только один программист, подвержены риску. Используя поставщики OLE DB, можно открыть этот собственный формат для всех программистов.  
  
## <a name="read-only-and-updatable-providers"></a>Только для чтения и обновляемые поставщики  
 Поставщики может сильно различаться по сложности и функциональности. Имеет смысл разделить поставщиков на поставщики только для чтения и обновляемых поставщиков:  
  
-   Visual C++ 6.0 поддерживается только поставщики только для чтения. [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md) рассматривается процесс создания поставщика только для чтения.  
  
-   Visual C++ поддерживает обновляемых поставщиков, которые можно обновить (запись) в хранилище данных. Сведения об обновляемых поставщиках см. в разделе [Создание поставщика с возможностью записи](../../data/oledb/creating-an-updatable-provider.md); [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) пример приведен пример поставщика с возможностью записи.  
  
 Дополнительные сведения:  
  
-   [Архитектура шаблона поставщика OLE DB](../../data/oledb/ole-db-provider-template-architecture.md)  
  
-   [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md)  
  
-   [Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)  
  
## <a name="see-also"></a>См. также  
 [Доступ к данным](../data-access-in-cpp.md)   
 [OLE DB для документации по пакету SDK](https://msdn.microsoft.com/en-us/library/ms722784.aspx)   
 [Справочник программиста OLE DB](https://msdn.microsoft.com/en-us/library/ms713643.aspx)