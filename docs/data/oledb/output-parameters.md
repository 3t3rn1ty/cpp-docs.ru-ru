---
title: "Выходные параметры | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "OLE DB, хранимые процедуры"
  - "вызовы процедур"
  - "вызовы процедур, хранимые процедуры"
  - "хранимые процедуры, вызов"
  - "хранимые процедуры, параметры"
ms.assetid: 4f7c2700-1c2d-42f3-8c9f-7e83962b2442
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Выходные параметры
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Вызов хранимой процедуры похож на вызов команды SQL.  Главное отличие заключается в том, что хранимые процедуры используют выходные параметры и возвращаемые значения.  
  
 В следующей хранимой процедуре первый "?" является возвращаемым значением \(phone\), а второй — выходным параметром \(name\).  
  
```  
DEFINE_COMMAND(CMySProcAccessor, _T("{ ? = SELECT phone FROM shippers WHERE name = ? }")  
```  
  
 Необходимо указать параметры ввода\/вывода в сопоставлении параметров.  
  
```  
BEGIN_PARAM_MAP(CMySProcAccessor)  
   SET_PARAM_TYPE(DBPARAMIO_OUTPUT)  
   COLUMN_ENTRY(1, m_Phone)   // Phone is the return value  
   SET_PARAM_TYPE(DBPARAMIO_INPUT)  
   COLUMN_ENTRY(2, m_Name)   // Name is the input parameter  
END_PARAM_MAP()  
```  
  
 Приложение должно обрабатывать выходные данные, возвращаемые хранимыми процедурами.  Различные поставщики OLE DB возвращают выходные параметры и возвращаемые значения в различные моменты времени в процессе обработки результатов.  Например, поставщик Microsoft OLE DB для SQL Server \(SQLOLEDB\) не предоставляет выходные параметры и коды возвращения до тех пор, пока потребитель не получит или отменит получение результирующих наборов, возвращенных хранимой процедурой.  Выходные параметры возвращаются сервером в последнем пакете TDS.  
  
## Число строк  
 При использовании шаблонов потребителей OLE DB для выполнения хранимой процедуры, имеющей выходные параметры, счетчик строк не устанавливается до тех пор, пока набор строк не будет закрыт.  
  
 Для примера рассмотрим хранимую процедуру с набором строк и выходными параметрами.  
  
```  
create procedure sp_test  
   @_rowcount integer output  
as  
   select top 50 * from test  
   @_rowcount = @@rowcount  
return 0  
```  
  
 Выходной параметр @\_rowcount сообщает, сколько строк было фактически возвращено из тестовой таблицы.  Однако хранимая процедура ограничивает число строк до 50.  Например, если в тесте используется 100 строк, то счетчик строк выведет значение 50 \(поскольку код извлекает только 50 верхних строк\).  Если в таблице только 30 строк, то счетчик строк выведет значение 30.  Необходимо вызвать функцию **Close** или **CloseAll**, чтобы заполнить параметр до извлечения его значения.  
  
## См. также  
 [Использование хранимых процедур](../../data/oledb/using-stored-procedures.md)