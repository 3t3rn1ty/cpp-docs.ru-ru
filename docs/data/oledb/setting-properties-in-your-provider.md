---
title: "Установка свойств в поставщике | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "поставщики OLE DB, свойства"
  - "свойства [C++], поставщик OLE DB"
ms.assetid: 26a8b493-7ec4-4686-96d0-9ad5d2bca5ac
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Установка свойств в поставщике
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Определите группу и идентификатор требуемого свойства.  Дополнительные сведения см. в разделе [Свойства OLE DB](https://msdn.microsoft.com/en-us/library/ms722734.aspx) *Справочника программиста по OLE DB*.  
  
 В коде поставщика, сгенерированном мастером, найдите сопоставление свойства, соответствующее группе свойств.  Имя группы свойств, как правило, соответствует имени объекта.  Свойства команд и наборов строк можно найти в командах или наборах строк, свойства источников данных и инициализационные свойства — в объекте источника данных.  
  
 В сопоставлении свойств добавьте макрос [PROPERTY\_INFO\_ENTRY\_EX](../../data/oledb/property-info-entry-ex.md).  Макрос PROPERTY\_INFO\_ENTRY\_EX имеет четыре параметра:  
  
-   Идентификатор свойства, соответствующий свойству.  Необходимо удалить первые семь символов \("DBPROP\_"\) из имени свойства.  Например, если добавляется свойство **DBPROP\_MAXROWS**, передайте в качестве первого параметра `MAXROWS`.  Для пользовательских свойств необходимо передать полное GUID\-имя \(например, `DBMYPROP_MYPROPERTY`\).  
  
-   Значение типа variant свойства \(см. раздел [Свойства OLE DB](https://msdn.microsoft.com/en-us/library/ms722734.aspx) *справочника программиста по OLE DB*\).  Введите **VT\_**\-тип \(например, `VT_BOOL` или `VT_I2`\), соответствующий типу данных.  
  
-   Флаги, указывающие, будет ли свойство доступно для чтения и записи, и к какой группе оно принадлежит.  Например, следующий код определяет свойство, доступное для чтения и записи и принадлежащее группе набора строк:  
  
    ```  
    DBPROPFLAGS_ROWSET | DBPROPFLAGS_READ | DBPROPFLAGS_WRITE  
    ```  
  
-   Базовое значение свойства.  Например, для логического типа это может быть значение **VARIANT\_FALSE**, а для целого типа — ноль.  Свойство будет иметь это значение до тех пор, пока оно не будет изменено.  
  
    > [!NOTE]
    >  Некоторые свойства \(например, закладки или обновляющиеся свойства\) соединены \(сцеплены\) с другими свойствами.  Когда потребитель устанавливает значение одного свойства, при этом значение другого свойства также может быть изменено.  Шаблоны поставщиков OLE DB поддерживают эту функциональность с помощью метода [CUtlProps::OnPropertyChanged](../../data/oledb/cutlprops-onpropertychanged.md).  
  
## Свойства, игнорируемые поставщиками Microsoft OLE DB  
 Поставщики Microsoft OLE DB игнорируют следующие свойства OLE DB:  
  
-   Свойство **DBPROP\_MAXROWS** работает для тех поставщиков, которые позволяют только считывать данные \(то есть тех, у которых свойства DBPROP\_IRowsetChange и DBPROP\_IRowsetUpdate имеют значение false\); в противном случае это свойство не поддерживается.  
  
-   Свойство **DBPROP\_MAXPENDINGROWS** игнорируется; поставщик устанавливает собственное ограничение.  
  
-   Свойство **DBPROP\_MAXOPENROWS** игнорируется; поставщик устанавливает собственное ограничение.  
  
-   Свойство **DBPROP\_CANHOLDROWS** игнорируется; поставщик устанавливает собственное ограничение.  
  
## См. также  
 [Работа с шаблонами поставщика OLE DB](../../data/oledb/working-with-ole-db-provider-templates.md)