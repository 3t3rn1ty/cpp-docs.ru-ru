---
title: "Использование нескольких результирующих наборов одной хранимой процедуры | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "несколько результирующих наборов"
  - "хранимые процедуры, возвращение результирующих наборов"
ms.assetid: c450c12c-a76c-4ae4-9675-071a41eeac05
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Использование нескольких результирующих наборов одной хранимой процедуры
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Большинство хранимых процедур возвращают несколько результирующих наборов.  Подобные хранимые процедуры обычно включают одну или несколько инструкций select.  Это должно учитываться при обработке объектом\-получателем всех результирующих наборов.  
  
### Обработка нескольких результирующих наборов  
  
1.  Создайте класс `CCommand` с классом `CMultipleResults` в качестве аргумента шаблона и методом доступа на собственное усмотрение.  Как правило, это динамический метод доступа или метод доступа вручную.  При использовании методов доступа иных типов определение выходных столбцов для каждого набора строк может оказаться невозможным.  
  
2.  Запустите хранимую процедуру на выполнение обычным образом и произведите связывание столбцов \(см. раздел [Инструкции по выполнению выборки данных](../../data/oledb/fetching-data.md)\).  
  
3.  Используйте данные.  
  
4.  Вызовите метод `GetNextResult` для класса `CCommand`.  Если имеется еще один результирующий набор строк, метод `GetNextResult` вернет значение S\_OK и при использовании метода доступа вручную потребуется произвести повторное связывание столбцов.  Если метод `GetNextResult` возвращает ошибку, результирующих наборов больше нет.  
  
## См. также  
 [Использование хранимых процедур](../../data/oledb/using-stored-procedures.md)