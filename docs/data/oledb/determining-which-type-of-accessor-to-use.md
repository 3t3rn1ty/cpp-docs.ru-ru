---
title: Выбор подходящего метода доступа | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- rowsets [C++], data types
- accessors [C++], types
ms.assetid: 22483dd2-f4e0-4dcb-8e4d-cd43a9c1a3db
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 720a72406bec5672757c1b2c5713586b7fc7f1ca
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2018
ms.locfileid: "46086971"
---
# <a name="determining-which-type-of-accessor-to-use"></a>Выбор подходящего метода доступа

Можно определить типы данных для набора строк во время компиляции или во время выполнения.  
  
Если вам нужно определить типы данных во время компиляции, используйте статический метод доступа (такие как `CAccessor`). Можно определить типы данных, вручную или с помощью мастера потребителя ATL OLE DB.  
  
Если вам нужно определить типы данных во время выполнения, используйте динамический (`CDynamicAccessor` или его дочерних элементов) или метода доступа вручную (`CManualAccessor`). В этих случаях можно вызвать `GetColumnInfo` в наборе строк, чтобы вернуть сведения о привязке столбца, из которого можно определить типы.  
  
Ниже перечислены типы методов доступа, предоставленного в шаблонах потребителей. Каждый метод доступа имеет преимущества и недостатки. В зависимости от ситуации один тип метода доступа должны удовлетворить эту потребность.  
  
|Класс методов доступа|Привязка|Параметр|Комментарий|  
|--------------------|-------------|---------------|-------------|  
|`CAccessor`|Создайте запись пользователя с макросами COLUMN_ENTRY. Макросы привязать элемент данных в этой записи к методу доступа. При создании набора строк, столбцов не может быть свободной.|Да, с помощью записи макроса PARAM_MAP. После привязки параметров не может быть отменена.|Самый быстрый метод доступа, из-за небольшого кода.|  
|`CDynamicAccessor`|Автоматически.|Нет.|Полезно, если вы не знаете тип данных в наборе строк.|  
|`CDynamicParameterAccessor`|Автоматически, но может быть [переопределении](../../data/oledb/overriding-a-dynamic-accessor.md).|Да, если поставщик поддерживает `ICommandWithParameters`. Автоматическая привязка параметров.|Медленнее, чем `CDynamicAccessor` но полезен для вызова универсальных хранимых процедур.|  
|`CDynamicStringAccessor[A,W]`|Автоматически.|Нет.|Извлекает данные из хранилища данных в виде строковых данных.|  
|`CManualAccessor`|Вручную с помощью `AddBindEntry`.|Вручную с помощью `AddParameterEntry`.|Очень быстро; только один раз привязка параметров и столбцов. Можно определить тип данных для использования. (См. в разделе [DBVIEWER](https://github.com/Microsoft/VCSamples) образец пример.) Требует больше кода, чем `CDynamicAccessor` или `CAccessor`. Она больше напоминает прямой вызов OLE DB.|  
|`CXMLAccessor`|Автоматически.|Нет.|Извлекает данные из хранилища данных в виде строковых данных и форматирование данных в XML-тегами.|  
  
## <a name="see-also"></a>См. также  

[Использование методов доступа](../../data/oledb/using-accessors.md)