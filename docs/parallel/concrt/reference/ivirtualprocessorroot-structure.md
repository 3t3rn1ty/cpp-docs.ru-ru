---
title: "Структура IVirtualProcessorRoot | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- IVirtualProcessorRoot
- CONCRTRM/concurrency::IVirtualProcessorRoot
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::Activate
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::Deactivate
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::EnsureAllTasksVisible
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::GetId
dev_langs:
- C++
helpviewer_keywords:
- IVirtualProcessorRoot structure
ms.assetid: 5ef371b8-9e4f-4fef-bb0d-49099693dd2b
caps.latest.revision: 18
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 5faef5bd1be6cc02d6614a6f6193c74167a8ff23
ms.openlocfilehash: 2635f1c18dd61127360b8398ad1b0da03f1666d7
ms.lasthandoff: 03/17/2017

---
# <a name="ivirtualprocessorroot-structure"></a>Структура IVirtualProcessorRoot
Абстракция для аппаратного потока, в котором может выполняться прокси-поток.  
  
## <a name="syntax"></a>Синтаксис  
  
```
struct IVirtualProcessorRoot : public IExecutionResource;
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[IVirtualProcessorRoot::Activate](#activate)|Прокси-поток, связанный с интерфейсом контекста выполнения вызывает `pContext` для запуска выполнения на этот корневой виртуальный процессор.|  
|[IVirtualProcessorRoot::Deactivate](#deactivate)|Вызывает прокси-поток, выполняющийся на этот корневой виртуальный процессор прекращает управлять контекстом выполнения. Прокси-поток продолжит выполнение при вызове `Activate` метода.|  
|[IVirtualProcessorRoot::EnsureAllTasksVisible](#ensurealltasksvisible)|Вызывает данные, хранящиеся в иерархии памяти отдельных процессоров, становятся видимыми для всех процессоров в системе. Это гарантирует, что полная памяти граница была выполнена на всех процессорах перед возвратом метода.|  
|[IVirtualProcessorRoot::GetId](#getid)|Возвращает уникальный идентификатор для корневой виртуальный процессор.|  
  
## <a name="remarks"></a>Примечания  
 Каждый корень виртуального процессора имеет связанный ресурс выполнения. `IVirtualProcessorRoot` Интерфейс наследует от [IExecutionResource](iexecutionresource-structure.md) интерфейса. Несколько корней виртуальный процессор может соответствовать же базовый поток оборудования.  
  
 Диспетчер ресурсов предоставляет корни виртуального процессора планировщикам в ответ на запросы ресурсов. Планировщик может использовать корневой виртуальный процессор для выполнения работы, активировав его с контекстом выполнения.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [IExecutionResource](iexecutionresource-structure.md)  
  
 `IVirtualProcessorRoot`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** concrtrm.h  
  
 **Пространство имен:** concurrency  
  
##  <a name="activate"></a>Метод IVirtualProcessorRoot::Activate  
 Прокси-поток, связанный с интерфейсом контекста выполнения вызывает `pContext` для запуска выполнения на этот корневой виртуальный процессор.  
  
```
virtual void Activate(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Интерфейс для контекста выполнения, который будет передан на этот корневой виртуальный процессор.  
  
### <a name="remarks"></a>Примечания  
 Диспетчер ресурсов предоставит прокси-поток, если он не связан с интерфейсом контекста выполнения`pContext`  
  
 `Activate` Метод может использоваться для запуска выполнения работы на новый корневой виртуальный процессор, возвращаемому диспетчером ресурсов или возобновить прокси-поток на корневой виртуальный процессор, который отключен или будет отключен. В разделе [IVirtualProcessorRoot::Deactivate](#deactivate) Дополнительные сведения о деактивации. Когда Вы возобновляете отключенный корень виртуального процессора, параметр `pContext` должен быть таким же, как параметр, используемый для отключения корневой виртуальный процессор.  
  
 После активации корневой виртуальный процессор в первый раз последующие пары вызовов к `Deactivate` и `Activate` стремятся друг с другом. Это означает, что допустимо для диспетчера ресурсов получить вызов к `Activate` до получения `Deactivate` он был предназначен для вызова.  
  
 При активации корневой виртуальный процессор, сигнал диспетчеру ресурсов этот корневой виртуальный процессор в данный момент занята работы. Если ваш планировщик не может найти любую работу для выполнения на этом корне, ожидается вызов `Deactivate` способ информирования диспетчера ресурсов, что корень виртуального процессора простаивает. Диспетчер ресурсов использует эти данные для системы балансировки нагрузки.  
  
 `invalid_argument`возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation`возникает, если аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
 Процесс активации корня виртуальный процессор увеличивает уровень подписки базовой аппаратный поток на единицу. Дополнительные сведения об уровнях подписки см. в разделе [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  
  
##  <a name="deactivate"></a>Метод IVirtualProcessorRoot::Deactivate  
 Вызывает прокси-поток, выполняющийся на этот корневой виртуальный процессор прекращает управлять контекстом выполнения. Прокси-поток продолжит выполнение при вызове `Activate` метода.  
  
```
virtual bool Deactivate(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Контекст, который в настоящий момент осуществляемым этим корнем.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Логическое значение. Значение `true` указывает, что прокси-поток возвращен из `Deactivate` метода в ответ на вызов `Activate` метод. Значение `false` указывает, что прокси-поток, возвращенный из метода в ответ на событие уведомления в диспетчере ресурсов. В режиме пользователя планируемых (UMS) планировщике потоков это означает, что возникли элементы в список завершения планировщика и планировщику необходимо обработать.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот метод, чтобы временно остановить выполнение корня виртуального процессора, когда не удается найти какой-либо работы в планировщике. Вызов `Deactivate` метод должен инициироваться в `Dispatch` метод контекста выполнения, корневой виртуальный процессор последний раз была активирована с. Другими словами, прокси поток, вызывающий `Deactivate` метод должен быть тот, который в данный момент на корневой виртуальный процессор. Вызов метода на корневой виртуальный процессор, который не выполняется может привести к неопределенному поведению.  
  
 Отключенный корень виртуального процессора может быть активирован с помощью вызова `Activate` метод с тем же аргументом, который был передан в `Deactivate` метод. Планировщик отвечает за то, что при вызове метода `Activate` и `Deactivate` объединены в пару методов, но они не должны быть получены в определенном порядке. Диспетчер ресурсов может обрабатывать получение вызова к `Activate` метод, прежде чем получит вызов `Deactivate` метода, он был предназначен.  
  
 Если корневой виртуальный процессор длительностью пробуждения и возвращаемое значение `Deactivate` метод значение `false`, планировщик должен запросить список завершения UMS через `IUMSCompletionList::GetUnblockNotifications` метод, работы с ней, а затем вызывать `Deactivate` метод еще раз. Это должно повторяться до тех пор, как `Deactivate` метод возвращает значение `true`.  
  
 `invalid_argument`возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation`возникает, если корневой виртуальный процессор никогда не была активирована, или аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
 Процесс деактивации корня виртуальный процессор уменьшает уровень подписки базовой аппаратный поток на единицу. Дополнительные сведения об уровнях подписки см. в разделе [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  
  
##  <a name="ensurealltasksvisible"></a>Метод IVirtualProcessorRoot::EnsureAllTasksVisible  
 Вызывает данные, хранящиеся в иерархии памяти отдельных процессоров, становятся видимыми для всех процессоров в системе. Это гарантирует, что полная памяти граница была выполнена на всех процессорах перед возвратом метода.  
  
```
virtual void EnsureAllTasksVisible(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Контекст, который в настоящий момент осуществляемым этим корнем виртуального процессора.  
  
### <a name="remarks"></a>Примечания  
 Этот метод может оказаться полезным при необходимости синхронизации деактивации корня виртуального процессора с добавлением новой работы в планировщик. Для повышения производительности можно добавлять рабочие элементы на планировщик без выполнения барьера памяти, что означает рабочие элементы, добавленные потоком, выполняющимся на одном процессоре, не являются видимыми для всех процессоров. С помощью этого метода в сочетании с `Deactivate` метода, убедитесь, что планировщик не отключайте его виртуальный процессор корней, а рабочие элементы существуют в коллекциях на планировщике.  
  
 Вызов `EnsureAllTasksVisibleThe` метод должен инициироваться в `Dispatch` метод контекста выполнения, корневой виртуальный процессор последний раз была активирована с. Другими словами, прокси поток, вызывающий `EnsureAllTasksVisible` метод должен быть тот, который в данный момент на корневой виртуальный процессор. Вызов метода на корневой виртуальный процессор, который не выполняется может привести к неопределенному поведению.  
  
 `invalid_argument`возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation`возникает, если корневой виртуальный процессор никогда не была активирована, или аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
##  <a name="getid"></a>Метод IVirtualProcessorRoot::GetId  
 Возвращает уникальный идентификатор для корневой виртуальный процессор.  
  
```
virtual unsigned int GetId() const = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Целочисленный идентификатор.  
  
## <a name="see-also"></a>См. также  
 [Пространство имен concurrency](concurrency-namespace.md)

