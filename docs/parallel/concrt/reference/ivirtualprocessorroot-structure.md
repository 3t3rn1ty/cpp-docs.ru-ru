---
title: Структура IVirtualProcessorRoot | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-concrt
ms.topic: reference
f1_keywords:
- IVirtualProcessorRoot
- CONCRTRM/concurrency::IVirtualProcessorRoot
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::Activate
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::Deactivate
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::EnsureAllTasksVisible
- CONCRTRM/concurrency::IVirtualProcessorRoot::IVirtualProcessorRoot::GetId
dev_langs:
- C++
helpviewer_keywords:
- IVirtualProcessorRoot structure
ms.assetid: 5ef371b8-9e4f-4fef-bb0d-49099693dd2b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 9620ee391b525356bfdb50b00d7e76c03b480815
ms.sourcegitcommit: 7019081488f68abdd5b2935a3b36e2a5e8c571f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
---
# <a name="ivirtualprocessorroot-structure"></a>Структура IVirtualProcessorRoot
Абстракция для аппаратного потока, в котором может выполняться прокси-поток.  
  
## <a name="syntax"></a>Синтаксис  
  
```
struct IVirtualProcessorRoot : public IExecutionResource;
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[IVirtualProcessorRoot::Activate](#activate)|Вызывает прокси-поток, связанный с интерфейсом контекста выполнения `pContext` для начала выполнения на этот корневой виртуальный процессор.|  
|[IVirtualProcessorRoot::Deactivate](#deactivate)|В результате прокси-поток, выполняющийся на этот корневой виртуальный процессор, чтобы остановить управлять контекстом выполнения. Прокси-поток продолжит выполнение при вызове `Activate` метода.|  
|[IVirtualProcessorRoot::EnsureAllTasksVisible](#ensurealltasksvisible)|В результате данные, хранящиеся в иерархии памяти отдельных процессоров, становятся видимыми для всех процессоров в системе. Это гарантирует, что полная памяти граница выполнена на всех процессорах перед возвратом метода.|  
|[IVirtualProcessorRoot::GetId](#getid)|Возвращает уникальный идентификатор для корневого виртуального процессора.|  
  
## <a name="remarks"></a>Примечания  
 Каждый корень виртуального процессора имеет связанный ресурс выполнения. `IVirtualProcessorRoot` Интерфейс наследует от [IExecutionResource](iexecutionresource-structure.md) интерфейса. Несколько корневых виртуальных процессоров может соответствовать же базовый поток оборудования.  
  
 Диспетчер ресурсов предоставляет корни виртуального процессора планировщикам в ответ на запросы к ресурсам. Планировщик может использовать корневой виртуальный процессор для выполнения работы, активировав его с контекстом выполнения.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [IExecutionResource](iexecutionresource-structure.md)  
  
 `IVirtualProcessorRoot`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** concrtrm.h  
  
 **Пространство имен:** concurrency  
  
##  <a name="activate"></a>  Метод IVirtualProcessorRoot::Activate  
 Вызывает прокси-поток, связанный с интерфейсом контекста выполнения `pContext` для начала выполнения на этот корневой виртуальный процессор.  
  
```
virtual void Activate(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Интерфейс для контекста выполнения, который будет передан на этот корневой виртуальный процессор.  
  
### <a name="remarks"></a>Примечания  
 Диспетчер ресурсов предоставит прокси-поток, если он не связан с интерфейсом контекста выполнения `pContext`  
  
 `Activate` Метод может использоваться для запуска выполнения работы на новый корневой виртуальный процессор, возвращаемых диспетчером ресурсов или возобновить прокси-поток на корневой виртуальный процессор, который отключен или будет отключен. В разделе [IVirtualProcessorRoot::Deactivate](#deactivate) Дополнительные сведения о деактивации. Когда Вы возобновляете отключенный корень виртуального процессора, параметр `pContext` должен быть таким же, как параметр, используемый для отключения корневой виртуальный процессор.  
  
 После активации корневой виртуальный процессор в первый раз последующие пары вызовов к `Deactivate` и `Activate` стремятся друг с другом. Это означает, что он допустим для диспетчера ресурсов получить вызов к `Activate` до получения `Deactivate` он был предназначен для вызова.  
  
 При активации корневой виртуальный процессор, сигнал диспетчеру ресурсов этот корневой виртуальный процессор в данный момент занята работы. Если ваш планировщик не удается найти какой-либо работы для выполнения на этом корне, он должен вызывать `Deactivate` способ информирования диспетчера ресурсов, корневой виртуальный процессор простаивает. Диспетчер ресурсов использует эти данные для системы балансировки нагрузки.  
  
 `invalid_argument` возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation` возникает, если аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
 Процесс активации корневой виртуальный процессор увеличивает уровень подписки базовой аппаратный поток на единицу. Дополнительные сведения об уровнях подписки см. в разделе [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  
  
##  <a name="deactivate"></a>  Метод IVirtualProcessorRoot::Deactivate  
 В результате прокси-поток, выполняющийся на этот корневой виртуальный процессор, чтобы остановить управлять контекстом выполнения. Прокси-поток продолжит выполнение при вызове `Activate` метода.  
  
```
virtual bool Deactivate(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Контекст, который в настоящий момент осуществляемым этим корнем.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Логическое значение. Значение `true` указывает, что прокси-поток возвращен из `Deactivate` метода в ответ на вызов `Activate` метод. Значение `false` указывает, что прокси-поток, возвращенный из метода в ответ на событие уведомления в диспетчере ресурсов. Для пользовательского режима планируемых (UMS) потока планировщика это означает, что возникли элементы в список завершения планировщика и планировщик, необходимые для их обработки.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот метод, чтобы временно остановить выполнение корневого виртуального процессора, когда не удается найти какой-либо работы в вашем планировщике. Вызов `Deactivate` метода должны находиться в пределах `Dispatch` метод контекста выполнения, корневой виртуальный процессор последний раз была активирована с. Другими словами, прокси-поток вызова `Deactivate` метод должен быть того, который в данный момент на корневой виртуальный процессор. Вызов метода для корневого виртуального процессора, которые не выполняются на может привести к неопределенному поведению.  
  
 Отключенный корень виртуального процессора может быть активирован с помощью вызова `Activate` метод с тем же аргументом, который был передан в `Deactivate` метод. Планировщик отвечает за то, что при вызове метода `Activate` и `Deactivate` объединены в пару методов, но они не должны быть получены в определенном порядке. Диспетчер ресурсов может обрабатывать получение вызова `Activate` метода, прежде чем получит вызов `Deactivate` метод, он был предназначен.  
  
 Если корневой виртуальный процессор пробуждающий режима сна и возвращаемое значение `Deactivate` метод значение `false`, планировщик должен запросить список выполнения UMS через `IUMSCompletionList::GetUnblockNotifications` метода работы с ней, а затем вызвать `Deactivate`метод снова. Это должно повторяться до тех пор, как `Deactivate` метод возвращает значение `true`.  
  
 `invalid_argument` возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation` возникает, если корневой виртуальный процессор не был активирован, или аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
 Процесс деактивации корневой виртуальный процессор уменьшает уровень подписки базовой аппаратный поток на единицу. Дополнительные сведения об уровнях подписки см. в разделе [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  
  
##  <a name="ensurealltasksvisible"></a>  Метод IVirtualProcessorRoot::EnsureAllTasksVisible  
 В результате данные, хранящиеся в иерархии памяти отдельных процессоров, становятся видимыми для всех процессоров в системе. Это гарантирует, что полная памяти граница выполнена на всех процессорах перед возвратом метода.  
  
```
virtual void EnsureAllTasksVisible(_Inout_ IExecutionContext* pContext) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `pContext`  
 Контекст, который в настоящий момент осуществляемым этим корневой виртуальный процессор.  
  
### <a name="remarks"></a>Примечания  
 Этот метод может оказаться полезным для синхронизации с добавлением новой работы в планировщик деактивации корневой виртуальный процессор. Для повышения производительности можно добавлять рабочие элементы на планировщик без выполнения барьера памяти, что означает рабочие элементы, добавленные потоком, выполняющимся на одном процессоре не видны сразу для всех процессоров. С помощью этого метода в сочетании с `Deactivate` корней метод, убедитесь, что планировщик не отключить его виртуальный процессор, а рабочие элементы существуют в коллекциях на планировщике.  
  
 Вызов `EnsureAllTasksVisibleThe` метода должны находиться в пределах `Dispatch` метод контекста выполнения, корневой виртуальный процессор последний раз была активирована с. Другими словами, прокси-поток вызова `EnsureAllTasksVisible` метод должен быть того, который в данный момент на корневой виртуальный процессор. Вызов метода для корневого виртуального процессора, которые не выполняются на может привести к неопределенному поведению.  
  
 `invalid_argument` возникает, если аргумент `pContext` имеет значение `NULL`.  
  
 `invalid_operation` возникает, если корневой виртуальный процессор не был активирован, или аргумент `pContext` не представляет контекст выполнения, который был отправлен недавно этим корневой виртуальный процессор.  
  
##  <a name="getid"></a>  Метод IVirtualProcessorRoot::GetId  
 Возвращает уникальный идентификатор для корневого виртуального процессора.  
  
```
virtual unsigned int GetId() const = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Целочисленный идентификатор.  
  
## <a name="see-also"></a>См. также  
 [Пространство имен concurrency](concurrency-namespace.md)
