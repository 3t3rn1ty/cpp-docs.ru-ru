---
title: Класс Scheduler | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-concrt
ms.topic: reference
f1_keywords:
- Scheduler
- CONCRT/concurrency::Scheduler
- CONCRT/concurrency::Scheduler::Scheduler
- CONCRT/concurrency::Scheduler::Attach
- CONCRT/concurrency::Scheduler::Create
- CONCRT/concurrency::Scheduler::CreateScheduleGroup
- CONCRT/concurrency::Scheduler::GetNumberOfVirtualProcessors
- CONCRT/concurrency::Scheduler::GetPolicy
- CONCRT/concurrency::Scheduler::Id
- CONCRT/concurrency::Scheduler::IsAvailableLocation
- CONCRT/concurrency::Scheduler::Reference
- CONCRT/concurrency::Scheduler::RegisterShutdownEvent
- CONCRT/concurrency::Scheduler::Release
- CONCRT/concurrency::Scheduler::ResetDefaultSchedulerPolicy
- CONCRT/concurrency::Scheduler::ScheduleTask
- CONCRT/concurrency::Scheduler::SetDefaultSchedulerPolicy
dev_langs:
- C++
helpviewer_keywords:
- Scheduler class
ms.assetid: 34cf7961-048d-4852-8a5c-a32f823e3506
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 97abec33d5fa4b372bc26874fd37397a2b78bb29
ms.sourcegitcommit: 7019081488f68abdd5b2935a3b36e2a5e8c571f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
---
# <a name="scheduler-class"></a>Класс Scheduler
Представляет абстракцию для планировщика среды выполнения с параллелизмом.  
  
## <a name="syntax"></a>Синтаксис  
  
```
class Scheduler;
```  
  
## <a name="members"></a>Участники  
  
### <a name="protected-constructors"></a>Защищенные конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[Планировщик](#ctor)|Объект `Scheduler` класса можно создавать только с помощью методов фабрики или неявно.|  
|[~ Деструктор планировщика](#dtor)|Объект `Scheduler` при исчезают все внешние ссылки на него неявно уничтожения класса.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[Attach](#attach)|Присоединяет планировщика в вызывающий контекст. После возврата этого метода, вызывающий контекст управляется планировщиком и планировщик становится текущим планировщиком.|  
|[Создание](#create)|Создает новый планировщик, поведение которой описывается `_Policy` параметра, помещает исходную ссылку на планировщик и возвращает указатель на него.|  
|[CreateScheduleGroup](#createschedulegroup)|Перегружен. Создает новую группу расписания в планировщике. Версия, принимающая параметр `_Placement` случае задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.|  
|[GetNumberOfVirtualProcessors](#getnumberofvirtualprocessors)|Возвращает текущее число виртуальных процессоров для планировщика.|  
|[GetPolicy](#getpolicy)|Возвращает копию политики, созданные с планировщиком.|  
|[Id](#id)|Возвращает уникальный идентификатор для планировщика.|  
|[IsAvailableLocation](#isavailablelocation)|Определяет, доступно ли данное расположение в планировщике.|  
|[Ссылки](#reference)|Увеличивает значение счетчика ссылок планировщика.|  
|[RegisterShutdownEvent](#registershutdownevent)|Причины, переданный дескриптор события Windows `_Event` параметр сигнал, когда планировщик завершает работу и удаляет себя. Во время событие сигнализирует выполнена вся работа, запланированная планировщику. Таким способом можно зарегистрировать несколько событий завершения работы.|  
|[Релиз](#release)|Уменьшает значение счетчика ссылок планировщика.|  
|[ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy)|Восстанавливает политику по умолчанию планировщика среды выполнения по умолчанию. Далее время создания планировщик по умолчанию будет использовать параметры политики по умолчанию среды выполнения.|  
|[ScheduleTask](#scheduletask)|Перегружен. Назначает легкое задание в планировщике. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.|  
|[SetDefaultSchedulerPolicy](#setdefaultschedulerpolicy)|Разрешает определяемые пользователем политику, чтобы использовать для создания планировщик по умолчанию. Этот метод может вызываться только в том случае, когда планировщик по умолчанию существует внутри процесса. После задания политики по умолчанию остается в силе до следующего допустимого вызова либо `SetDefaultSchedulerPolicy` или [ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy) метод.|  
  
## <a name="remarks"></a>Примечания  
 Планировщик среды выполнения с параллелизмом использует контекстов выполнения, которые сопоставляются с контекстов выполнения операционной системы, такие как поток, для выполнения работы в очереди вашим приложением. В любое время уровень параллелизма выполнения планировщика равен номеру виртуальный процессор, предоставленные ему диспетчером ресурсов. Виртуальный процессор является абстракцией для обработки ресурсов и сопоставляется с аппаратным потоком в базовой системе. В определенный момент времени только один контекст планировщика может выполняться на виртуальный процессор.  
  
 Среда выполнения с параллелизмом создаст планировщик по умолчанию каждый процесс для выполнения параллельной работы. Кроме того можно создавать собственные планировщика экземпляры и управлять ими с помощью этого класса.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 `Scheduler`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** concrt.h  
  
 **Пространство имен:** concurrency  
  
##  <a name="attach"></a> Присоединение 

 Присоединяет планировщика в вызывающий контекст. После возврата этого метода, вызывающий контекст управляется планировщиком и планировщик становится текущим планировщиком.  
  
```
virtual void Attach() = 0;
```  
  
### <a name="remarks"></a>Примечания  
 Присоединение планировщик неявно помещает ссылку на планировщике.  
  
 В некоторый момент в будущем, необходимо вызвать [CurrentScheduler::Detach](currentscheduler-class.md#detach) метод, чтобы разрешить завершение работы планировщика.  
  
 Если этот метод вызывается из контекста, который уже присоединен к другому планировщику, существующий планировщик запоминается как предыдущий планировщик и вновь созданный планировщик становится текущим планировщиком. При вызове `CurrentScheduler::Detach` метода на более позднем этапе предыдущий планировщик восстанавливается как текущий планировщик.  
  
 Этот метод вызывает исключение [improper_scheduler_attach](improper-scheduler-attach-class.md) исключение, если данный планировщик является текущим планировщиком контекст вызова.  
  
##  <a name="create"></a> Создание 

 Создает новый планировщик, поведение которой описывается `_Policy` параметра, помещает исходную ссылку на планировщик и возвращает указатель на него.  
  
```
static Scheduler* __cdecl Create(const SchedulerPolicy& _Policy);
```  
  
### <a name="parameters"></a>Параметры  
 `_Policy`  
 Политики планировщика, описывающая поведение вновь созданного планировщика.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на вновь созданного планировщика. Это `Scheduler` объект имеет начальное значение счетчика ссылок к нему.  
  
### <a name="remarks"></a>Примечания  
 После создания планировщика с `Create` метод, необходимо вызвать метод `Release` метод в некоторый момент в будущем, чтобы удалить исходный значение счетчика ссылок и разрешить завершение работы планировщика.  
  
 Планировщик, созданный с помощью этого метода не присоединен к контексту вызова. Она может быть присоединена к контекст с помощью [присоединение](#attach) метод.  
  
 Этот метод можно вызвать ряд исключений, включая [scheduler_resource_allocation_error](scheduler-resource-allocation-error-class.md) и [invalid_scheduler_policy_value](invalid-scheduler-policy-value-class.md).  
  
##  <a name="createschedulegroup"></a> CreateScheduleGroup 

 Создает новую группу расписания в планировщике. Версия, принимающая параметр `_Placement` случае задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.  
  
```
virtual ScheduleGroup* CreateScheduleGroup() = 0;

virtual ScheduleGroup* CreateScheduleGroup(location& _Placement) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `_Placement`  
 Ссылка на расположение, где задачи в пределах группы расписаний будет склонна выполняться упрощенная.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на вновь созданное расписание группы. Это `ScheduleGroup` объект имеет начальное значение счетчика ссылок к нему.  
  
### <a name="remarks"></a>Примечания  
 Необходимо вызвать [выпуска](schedulegroup-class.md#release) метод в группе расписаний после завершения планирования работы для него. Планировщик уничтожит расписание группе, когда в очереди вся работа завершена.  
  
 Обратите внимание, что если явно создан данный планировщик, необходимо освободить все ссылки на группы, расписания, перед освобождением ссылок на планировщик.  
  
##  <a name="getnumberofvirtualprocessors"></a> GetNumberOfVirtualProcessors 

 Возвращает текущее число виртуальных процессоров для планировщика.  
  
```
virtual unsigned int GetNumberOfVirtualProcessors() const = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущее число виртуальных процессоров для планировщика.  
  
##  <a name="getpolicy"></a> GetPolicy 

 Возвращает копию политики, созданные с планировщиком.  
  
```
virtual SchedulerPolicy GetPolicy() const = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Копия политики, созданные с планировщиком.  
  
##  <a name="id"></a> Идентификатор 

 Возвращает уникальный идентификатор для планировщика.  
  
```
virtual unsigned int Id() const = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Уникальный идентификатор для планировщика.  
  
##  <a name="isavailablelocation"></a> IsAvailableLocation 

 Определяет, доступно ли данное расположение в планировщике.  
  
```
virtual bool IsAvailableLocation(const location& _Placement) const = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `_Placement`  
 Ссылка на расположение для запроса о планировщике.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Индикация того, является ли расположение, задаваемый параметром `_Placement` аргумент доступен в планировщике.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что возвращаемое значение является результатом проверки доступности указанного расположения в данный момент. При наличии нескольких планировщиков динамическое управление ресурсами может добавлять или забирать ресурсы у планировщиков в любой момент. Если это произошло, доступность заданного расположения может измениться.  
  
##  <a name="reference"></a> Ссылка 

 Увеличивает значение счетчика ссылок планировщика.  
  
```
virtual unsigned int Reference() = 0 ;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число увеличенное ссылку.  
  
### <a name="remarks"></a>Примечания  
 Обычно используется для управления временем жизни планировщика для композиции. Когда значение счетчика ссылок планировщика снижается до нуля, планировщик завершит работу и уничтожится после завершения всей работы, указанной в планировщике.  
  
 Метод вызывает исключение [improper_scheduler_reference](improper-scheduler-reference-class.md) исключение, если количество ссылок до вызова метода `Reference` метод равно нулю и вызов из контекста, который не принадлежит планировщику.  
  
##  <a name="registershutdownevent"></a> RegisterShutdownEvent 

 Причины, переданный дескриптор события Windows `_Event` параметр сигнал, когда планировщик завершает работу и удаляет себя. Во время событие сигнализирует выполнена вся работа, запланированная планировщику. Таким способом можно зарегистрировать несколько событий завершения работы.  
  
```
virtual void RegisterShutdownEvent(HANDLE _Event) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `_Event`  
 Дескриптор объекта события Windows, который будет оповещаться средой выполнения, когда планировщик завершает работу и удаляет себя.  
  
##  <a name="release"></a> выпуск 

 Уменьшает значение счетчика ссылок планировщика.  
  
```
virtual unsigned int Release() = 0;
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Счетчик ссылок уменьшается на единицу вновь.  
  
### <a name="remarks"></a>Примечания  
 Обычно используется для управления временем жизни планировщика для композиции. Когда значение счетчика ссылок планировщика снижается до нуля, планировщик завершит работу и уничтожится после завершения всей работы, указанной в планировщике.  
  
##  <a name="resetdefaultschedulerpolicy"></a> ResetDefaultSchedulerPolicy 

 Восстанавливает политику по умолчанию планировщика среды выполнения по умолчанию. Далее время создания планировщик по умолчанию будет использовать параметры политики по умолчанию среды выполнения.  
  
```
static void __cdecl ResetDefaultSchedulerPolicy();
```  
  
### <a name="remarks"></a>Примечания  
 Этот метод может вызываться во время планировщик по умолчанию существует внутри процесса. Не влияет на политику существующих планировщик по умолчанию. Однако если были планировщик по умолчанию для завершения работы, и новое значение по умолчанию был создан в более позднем этапе, новый планировщик будет использовать параметры политики по умолчанию среды выполнения.  
  
##  <a name="ctor"></a> Планировщик 

 Объект `Scheduler` класса можно создавать только с помощью методов фабрики или неявно.  
  
```
Scheduler();
```  
  
### <a name="remarks"></a>Примечания  
 Планировщик по умолчанию процесса создается неявно при использовании многих функции среды выполнения, которые требуют планировщик, присоединенный к контексту вызова. Методы в пределах `CurrentScheduler` класс и возможности PPL и уровни агентов обычно выполняют неявное вложение.  
  
 Можно также создать планировщика явно с помощью либо `CurrentScheduler::Create` метода или `Scheduler::Create` метод.  
  
##  <a name="dtor"></a> ~ Планировщика 

 Объект `Scheduler` при исчезают все внешние ссылки на него неявно уничтожения класса.  
  
```
virtual ~Scheduler();
```  
  
##  <a name="scheduletask"></a> ScheduleTask 

 Назначает легкое задание в планировщике. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.  
  
```
virtual void ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data) = 0;

virtual void ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data,
    location& _Placement) = 0;
```  
  
### <a name="parameters"></a>Параметры  
 `_Proc`  
 Указатель на функцию, выполняемую для выполнения основной части задачи недоступно.  
  
 `_Data`  
 Указатель void к данным, которая будет передана в качестве параметра в теле задачи.  
  
 `_Placement`  
 Ссылка на расположение, где будет склонна выполняться упрощенная задача.  
  
##  <a name="setdefaultschedulerpolicy"></a> SetDefaultSchedulerPolicy 

 Разрешает определяемые пользователем политику, чтобы использовать для создания планировщик по умолчанию. Этот метод может вызываться только в том случае, когда планировщик по умолчанию существует внутри процесса. После задания политики по умолчанию остается в силе до следующего допустимого вызова либо `SetDefaultSchedulerPolicy` или [ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy) метод.  
  
```
static void __cdecl SetDefaultSchedulerPolicy(const SchedulerPolicy& _Policy);
```  
  
### <a name="parameters"></a>Параметры  
 `_Policy`  
 Политика в качестве политики планировщика по умолчанию.  
  
### <a name="remarks"></a>Примечания  
 Если `SetDefaultSchedulerPolicy` метод вызывается, когда планировщик по умолчанию уже существует внутри процесса, среда выполнения создаст исключение [default_scheduler_exists](default-scheduler-exists-class.md) исключение.  
  
## <a name="see-also"></a>См. также  
 [пространство имен Concurrency](concurrency-namespace.md)   
 [Класс Scheduler](scheduler-class.md)   
 [PolicyElementKey](concurrency-namespace-enums.md)   
 [Планировщик задач](../../../parallel/concrt/task-scheduler-concurrency-runtime.md)



