---
title: Класс CurrentScheduler | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-concrt
ms.topic: reference
f1_keywords:
- CurrentScheduler
- CONCRT/concurrency::CurrentScheduler
- CONCRT/concurrency::CurrentScheduler::Create
- CONCRT/concurrency::CurrentScheduler::CreateScheduleGroup
- CONCRT/concurrency::CurrentScheduler::Detach
- CONCRT/concurrency::CurrentScheduler::Get
- CONCRT/concurrency::CurrentScheduler::GetNumberOfVirtualProcessors
- CONCRT/concurrency::CurrentScheduler::GetPolicy
- CONCRT/concurrency::CurrentScheduler::Id
- CONCRT/concurrency::CurrentScheduler::IsAvailableLocation
- CONCRT/concurrency::CurrentScheduler::RegisterShutdownEvent
- CONCRT/concurrency::CurrentScheduler::ScheduleTask
dev_langs:
- C++
helpviewer_keywords:
- CurrentScheduler class
ms.assetid: 31c20e0e-4cdf-49b4-8220-d726130aad2b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 71ca69f645e548b1913904f692eb1c5fae167a9a
ms.sourcegitcommit: 7019081488f68abdd5b2935a3b36e2a5e8c571f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
ms.locfileid: "33693761"
---
# <a name="currentscheduler-class"></a>Класс CurrentScheduler
Представляет абстракцию для текущего планировщика, связанного с вызывающим контекстом.  
  
## <a name="syntax"></a>Синтаксис  
  
```
class CurrentScheduler;
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[Создание](#create)|Создает новый планировщик, поведение которой описывается `_Policy` параметра и присоединяет его к вызывающему контексту. Вновь созданного планировщика станет текущего планировщика для контекст вызова.|  
|[CreateScheduleGroup](#createschedulegroup)|Перегружен. Создает новую группу расписаний внутри планировщика, связанного с вызывающим контекстом. Версия, принимающая параметр `_Placement` случае задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.|  
|[Detach](#detach)|Отсоединяет текущий планировщик от вызывающего контекста и восстанавливает ранее присоединенный планировщик как текущий планировщик в том случае, если он существует. После возврата этого метода, вызывающий контекст затем управляется планировщика, который ранее был присоединен к контексту с помощью `CurrentScheduler::Create` или `Scheduler::Attach` метод.|  
|[Get](#get)|Возвращает указатель на планировщик, связанный с вызывающим контекстом, также называют текущего планировщика.|  
|[GetNumberOfVirtualProcessors](#getnumberofvirtualprocessors)|Возвращает текущее число виртуальных процессоров для планировщика, связанного с вызывающим контекстом.|  
|[GetPolicy](#getpolicy)|Возвращает копию политики, созданные с текущего планировщика.|  
|[Id](#id)|Возвращает уникальный идентификатор для текущего планировщика.|  
|[IsAvailableLocation](#isavailablelocation)|Определяет, доступно ли данное расположение в текущем планировщике.|  
|[RegisterShutdownEvent](#registershutdownevent)|Причины, переданный дескриптор события Windows `_ShutdownEvent` параметр сигнал, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя. Во время событие сигнализирует выполнена вся работа, запланированная планировщику. Таким способом можно зарегистрировать несколько событий завершения работы.|  
|[ScheduleTask](#scheduletask)|Перегружен. Назначает легкое задание внутри планировщика, связанного с вызывающим контекстом. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.|  
  
## <a name="remarks"></a>Примечания  
 Если отсутствует планировщик (см. [планировщика](scheduler-class.md)) связанный с вызывающим контекстом многие методы в `CurrentScheduler` класса приведет к подключение планировщик по умолчанию для данного процесса. Это также означает, что планировщик по умолчанию процесса создается во время такого вызова.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 `CurrentScheduler`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** concrt.h  
  
 **Пространство имен:** concurrency  
  
##  <a name="create"></a> Создание 

 Создает новый планировщик, поведение которой описывается `_Policy` параметра и присоединяет его к вызывающему контексту. Вновь созданного планировщика станет текущего планировщика для контекст вызова.  
  
```
static void __cdecl Create(const SchedulerPolicy& _Policy);
```  
  
### <a name="parameters"></a>Параметры  
 `_Policy`  
 Политики планировщика, описывающая поведение вновь созданного планировщика.  
  
### <a name="remarks"></a>Примечания  
 Вложение планировщик к контексту вызова неявно помещает значение счетчика ссылок планировщика.  
  
 После создания планировщика с `Create` метод, необходимо вызвать [CurrentScheduler::Detach](#detach) метод в некоторый момент в будущем, чтобы разрешить завершение работы планировщика.  
  
 Если этот метод вызывается из контекста, который уже присоединен к другому планировщику, существующий планировщик запоминается как предыдущий планировщик и вновь созданный планировщик становится текущим планировщиком. При вызове `CurrentScheduler::Detach` метода на более позднем этапе предыдущий планировщик восстанавливается как текущий планировщик.  
  
 Этот метод можно вызвать ряд исключений, включая [scheduler_resource_allocation_error](scheduler-resource-allocation-error-class.md) и [invalid_scheduler_policy_value](invalid-scheduler-policy-value-class.md).  
  
##  <a name="createschedulegroup"></a> CreateScheduleGroup 

 Создает новую группу расписаний внутри планировщика, связанного с вызывающим контекстом. Версия, принимающая параметр `_Placement` случае задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.  
  
```
static ScheduleGroup* __cdecl CreateScheduleGroup();

static ScheduleGroup* __cdecl CreateScheduleGroup(location& _Placement);
```  
  
### <a name="parameters"></a>Параметры  
 `_Placement`  
 Ссылка на расположение, где задачи в пределах группы расписаний будет стремиться к выполнению в.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на вновь созданное расписание группы. Это `ScheduleGroup` объект имеет начальное значение счетчика ссылок к нему.  
  
### <a name="remarks"></a>Примечания  
 В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.  
  
 Необходимо вызвать [выпуска](schedulegroup-class.md#release) метод в группе расписаний после завершения планирования работы для него. Планировщик уничтожит расписание группе, когда в очереди вся работа завершена.  
  
 Обратите внимание, что если явно создан данный планировщик, необходимо освободить все ссылки на группы, расписания, перед освобождением ссылки в планировщике путем отсоединения текущего контекста из него.  
  
##  <a name="detach"></a> Отсоединение 

 Отсоединяет текущий планировщик от вызывающего контекста и восстанавливает ранее присоединенный планировщик как текущий планировщик в том случае, если он существует. После возврата этого метода, вызывающий контекст затем управляется планировщика, который ранее был присоединен к контексту с помощью `CurrentScheduler::Create` или `Scheduler::Attach` метод.  
  
```
static void __cdecl Detach();
```  
  
### <a name="remarks"></a>Примечания  
 `Detach` Метод неявно удаляет значение счетчика ссылок из планировщика.  
  
 Если планировщик присоединен к вызывающему контексту, вызов этого метода приведет к [scheduler_not_attached](scheduler-not-attached-class.md) вызываемом исключении.  
  
 Вызов этого метода из контекста, который является внутренним для и управляемый с помощью планировщика или контекст, который был подключен с помощью метода, отличного от [Scheduler::Attach](scheduler-class.md#attach) или [CurrentScheduler::Create](#create) методы, приведет к [improper_scheduler_detach](improper-scheduler-detach-class.md) вызываемом исключении.  
  
##  <a name="get"></a> Получить 

 Возвращает указатель на планировщик, связанный с вызывающим контекстом, также называют текущего планировщика.  
  
```
static Scheduler* __cdecl Get();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на планировщик, связанный с вызывающим контекстом (текущий планировщик).  
  
### <a name="remarks"></a>Примечания  
 В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом. Дополнительные ссылки будет располагаться на `Scheduler` объект, возвращаемый этим методом.  
  
##  <a name="getnumberofvirtualprocessors"></a> GetNumberOfVirtualProcessors 

 Возвращает текущее число виртуальных процессоров для планировщика, связанного с вызывающим контекстом.  
  
```
static unsigned int __cdecl GetNumberOfVirtualProcessors();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если планировщик связан с вызывающим контекстом, текущее число виртуальных процессоров для данного планировщика; в противном случае — значение `-1`.  
  
### <a name="remarks"></a>Примечания  
 Этот метод не приведет к вложению планировщика, если вызывающий контекст не связан с планировщиком.  
  
 Возвращаемое значение из этого метода является результатом число виртуальных процессоров для планировщика, связанного с вызывающим контекстом. Это значение может быть устаревшим в момент возврата.  
  
##  <a name="getpolicy"></a> GetPolicy 

 Возвращает копию политики, созданные с текущего планировщика.  
  
```
static SchedulerPolicy __cdecl GetPolicy();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Копия политики, который был создан текущий планировщик.  
  
### <a name="remarks"></a>Примечания  
 В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.  
  
##  <a name="id"></a> Идентификатор 

 Возвращает уникальный идентификатор для текущего планировщика.  
  
```
static unsigned int __cdecl Id();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если планировщик связан с вызывающим контекстом уникальный идентификатор для данного планировщика; в противном случае — значение `-1`.  
  
### <a name="remarks"></a>Примечания  
 Этот метод не приведет к вложению планировщика, если вызывающий контекст не связан с планировщиком.  
  
##  <a name="isavailablelocation"></a> IsAvailableLocation 

 Определяет, доступно ли данное расположение в текущем планировщике.  
  
```
static bool __cdecl IsAvailableLocation(const location& _Placement);
```  
  
### <a name="parameters"></a>Параметры  
 `_Placement`  
 Ссылка на расположение, о котором необходимо отправить запрос текущему планировщику.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Индикация доступности расположения, указанного параметром `_Placement`, в текущем планировщике.  
  
### <a name="remarks"></a>Примечания  
 Этот метод не приведет к вложению планировщика, если вызывающий контекст не связан с планировщиком.  
  
 Обратите внимание, что возвращаемое значение является результатом проверки доступности указанного расположения в данный момент. При наличии нескольких планировщиков динамическое управление ресурсами может добавлять или забирать ресурсы у планировщиков в любой момент. Если это произошло, доступность заданного расположения может измениться.  
  
##  <a name="registershutdownevent"></a> RegisterShutdownEvent 

 Причины, переданный дескриптор события Windows `_ShutdownEvent` параметр сигнал, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя. Во время событие сигнализирует выполнена вся работа, запланированная планировщику. Таким способом можно зарегистрировать несколько событий завершения работы.  
  
```
static void __cdecl RegisterShutdownEvent(HANDLE _ShutdownEvent);
```  
  
### <a name="parameters"></a>Параметры  
 `_ShutdownEvent`  
 Дескриптор объекта события Windows, который будет сигнал средой выполнения, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя.  
  
### <a name="remarks"></a>Примечания  
 Если планировщик присоединен к вызывающему контексту, вызов этого метода приведет к [scheduler_not_attached](scheduler-not-attached-class.md) вызываемом исключении.  
  
##  <a name="scheduletask"></a> ScheduleTask 

 Назначает легкое задание внутри планировщика, связанного с вызывающим контекстом. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.  
  
```
static void __cdecl ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data);

static void __cdecl ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data,
    location& _Placement);
```  
  
### <a name="parameters"></a>Параметры  
 `_Proc`  
 Указатель на функцию, выполняемую для выполнения основной части задачи недоступно.  
  
 `_Data`  
 Указатель void к данным, которая будет передана в качестве параметра в теле задачи.  
  
 `_Placement`  
 Ссылка на расположение, где будет склонна выполняться упрощенная задача.  
  
### <a name="remarks"></a>Примечания  
 В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.  
  
## <a name="see-also"></a>См. также  
 [пространство имен Concurrency](concurrency-namespace.md)   
 [Класс Scheduler](scheduler-class.md)   
 [PolicyElementKey](concurrency-namespace-enums.md)   
 [Планировщик задач](../../../parallel/concrt/task-scheduler-concurrency-runtime.md)



