---
title: "Асинхронные агенты | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "агенты [среда выполнения с параллелизмом]"
  - "асинхронные агенты"
ms.assetid: 6cf6ccc6-87f1-4e14-af15-ea8ba58fef1a
caps.latest.revision: 15
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 14
---
# Асинхронные агенты
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

*Асинхронный агент* \(или просто *агент*\) — это компонент приложения, работающий асинхронно с другими агентами для решения более крупных вычислительных задач.  Агент можно рассматривать как задачу с заданным жизненным циклом.  Например, один агент может считывать данные с устройства ввода\/вывода \(например, клавиатуры, файла на диске или сетевого подключения\), а другой агент — выполнять действия с данными по мере их поступления.  Первый агент с помощью передачи сообщений сообщает второму агенту о поступлении новых данных.  Планировщик задач среды выполнения с параллелизмом предоставляет агентам эффективный механизм совместного блокирования и разрешения, что позволяет не прибегать к менее эффективному сценарию с вытеснением.  
  
 Библиотека агентов определяет класс [concurrency::agent](../../parallel/concrt/reference/agent-class.md), который представляет асинхронный агент.  `agent` — это абстрактный класс, объявляющий виртуальный метод [concurrency::agent::run](../Topic/agent::run%20Method.md).  Метод `run` выполняет задачу, за которую отвечает агент.  Поскольку `run` является абстрактным, необходимо реализовать этот метод в каждом классе, унаследованном от `agent`.  
  
## Жизненный цикл агента  
 Агенты имеют заданный жизненный цикл.  Перечисление [concurrency::agent\_status](../Topic/agent_status%20Enumeration.md) определяет различные состояния агента.  Следующий рисунок представляет собой схему состояний, на которой показан переход агентов из одного состояния в другое.  На этом рисунке сплошные линии представляют методы, которые вызываются из приложения; пунктирные линии представляют методы, вызываемые из среды выполнения.  
  
 ![Схема состояния агента](../../parallel/concrt/media/agentstate.png "AgentState")  
  
 В следующей таблице описывается каждое состояние перечисления `agent_status`.  
  
|Состояние агента|Описание|  
|----------------------|--------------|  
|`agent_created`|Выполнение агента не запланировано.|  
|`agent_runnable`|Среда выполнения планирует агент для выполнения.|  
|`agent_started`|Агент был запущен и работает.|  
|`agent_done`|Выполнение агента завершено.|  
|`agent_canceled`|Агент был отменен до перехода в состояние `started`.|  
  
 `agent_created` — это начальное состояние агента, `agent_runnable` и `agent_started` — активные состояния, а `agent_done` и `agent_canceled` — конечные состояния.  
  
 Для получения текущего состояния объекта `agent` используется метод [concurrency::agent::status](../Topic/agent::status%20Method.md).  Хотя метод `status` можно безопасно использовать в режиме параллелизма, состояние агента может измениться к моменту возвращения метода `status`.  Например, агент может находиться в состоянии `agent_started`, когда вызывается метод `status`, а сразу после возвращения метода `status` перейти в состояние `agent_done`.  
  
## Методы и свойства  
 В следующей таблице показаны некоторые важные методы, принадлежащие к классу `agent`.  Дополнительные сведения о всех методах класса `agent` см. в разделе [Класс agent](../../parallel/concrt/reference/agent-class.md).  
  
|Метод|Описание|  
|-----------|--------------|  
|[start](../Topic/agent::start%20Method.md)|Планирует объект `agent` для выполнения и задает для него состояние `agent_runnable`.|  
|[run](../Topic/agent::run%20Method.md)|Выполняет задачу, которая должна быть выполнена объектом `agent`.|  
|[done](../Topic/agent::done%20Method.md)|Переводит агент в состояние `agent_done`.|  
|[отменить](../Topic/agent::cancel%20Method.md)|Если агент не был запущен, этот метод отменяет выполнение агента и задает для него состояние `agent_canceled`.|  
|[status](../Topic/agent::status%20Method.md)|Извлекает текущее состояние объекта `agent`.|  
|[wait](../Topic/agent::wait%20Method.md)|Ожидает перехода объекта `agent` в состояние `agent_done` или `agent_canceled`.|  
|[wait\_for\_all](../Topic/agent::wait_for_all%20Method.md)|Ожидает перехода всех предоставленных объектов `agent` в состояние `agent_done` или `agent_canceled`.|  
|[wait\_for\_one](../Topic/agent::wait_for_one%20Method.md)|Ожидает перехода в состояние `agent_done` или `agent_canceled` хотя бы одного из предоставленных объектов `agent`.|  
  
 После создания объекта агента следует вызвать метод [concurrency::agent::start](../Topic/agent::start%20Method.md), чтобы запланировать его выполнение.  Среда выполнения вызывает метод `run` после планирования агента и задания для него состояния `agent_runnable`.  
  
 Среда выполнения не управляет исключениями, созданными асинхронными агентами.  Дополнительные сведения об обработке исключений и агентах см. в разделе [Обработка исключений](../Topic/Exception%20Handling%20in%20the%20Concurrency%20Runtime.md).  
  
## Пример  
 Пример, в котором показано, как создать основное приложение на основе агентов, см. в разделе [Пошаговое руководство. Создание приложения на основе агента](../../parallel/concrt/walkthrough-creating-an-agent-based-application.md).  
  
## См. также  
 [Библиотека асинхронных агентов](../../parallel/concrt/asynchronous-agents-library.md)