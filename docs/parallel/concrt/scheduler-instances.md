---
title: "Экземпляры планировщика | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- scheduler instances
ms.assetid: 4819365f-ef99-49cc-963e-50a2a35a8d6b
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 1688a2b689b3fc3391e617f3d65d3c681f05a84f
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="scheduler-instances"></a>Экземпляры планировщика
В этом документе описывается роль экземпляров планировщика в среде выполнения с параллелизмом и способ использования [concurrency::Scheduler](../../parallel/concrt/reference/scheduler-class.md) и [concurrency::CurrentScheduler](../../parallel/concrt/reference/currentscheduler-class.md) классы для создания и управления экземпляры планировщика. Экземпляры планировщика полезны в тех случаях, когда требуется связать явные политики планирования с определенными типами рабочих нагрузок. Например, можно создать один экземпляр планировщика для выполнения некоторых задач с повышенным приоритетом потока и использовать планировщик по умолчанию для выполнения задач с обычным приоритетом потока.  
  
> [!TIP]
>  Среда выполнения с параллелизмом предоставляет планировщик по умолчанию, и таким образом не требуется создавать планировщик в приложении. Поскольку планировщик задач помогает оптимизировать производительность приложений, рекомендуется начать с [библиотеки параллельных шаблонов (PPL)](../../parallel/concrt/parallel-patterns-library-ppl.md) или [библиотеки асинхронных агентов](../../parallel/concrt/asynchronous-agents-library.md) при наличии новые и среда выполнения с параллелизмом.  
  
##  <a name="top"></a> Разделы  
  
-   [Планировщик и классы CurrentScheduler](#classes)  
  
-   [Создание экземпляра планировщика](#creating)  
  
-   [Управление временем существования экземпляра планировщика](#managing)  
  
-   [Методы и свойства](#features)  
  
-   [Пример](#example)  
  
##  <a name="classes"></a>Планировщик и классы CurrentScheduler  
 Планировщик заданий позволяет приложениям использовать один или несколько *экземпляры планировщика* для планирования работы. [Concurrency::Scheduler](../../parallel/concrt/reference/scheduler-class.md) класс представляет экземпляр планировщика и содержит функциональные возможности, связанные с планированием задач.  
  
 Поток, который присоединен к планировщику известен как *контекст выполнения*, или просто *контекста*. В любое время может быть активными в текущий контекст один планировщик. Активный планировщик называется также *текущего планировщика*. Среда выполнения с параллелизмом использует [concurrency::CurrentScheduler](../../parallel/concrt/reference/currentscheduler-class.md) для предоставления доступа к текущему планировщику. Текущий планировщик для одного контекста может отличаться от текущего планировщика для другого контекста. Среда выполнения не предоставляет представление уровня процесса текущего планировщика.  
  
 Как правило `CurrentScheduler` класс используется для доступа к текущему планировщику. `Scheduler` Класс полезен при необходимости управлять планировщиком, не является текущей.  
  
 В следующих разделах описаны способы создания и управление экземпляром планировщика. Полный пример, иллюстрирующий эти задачи, в разделе [как: управление экземпляром планировщика](../../parallel/concrt/how-to-manage-a-scheduler-instance.md).  
  
 [[В начало](#top)]  
  
##  <a name="creating"></a>Создание экземпляра планировщика  
 Существует три способа создания `Scheduler` объекта:  
  
-   Если планировщика не существует, среда выполнения создает планировщик по умолчанию при использовании функции среды выполнения, например, параллельный алгоритм, для выполнения работы. Планировщик по умолчанию становится текущим планировщиком для контекста, инициирующего параллельную работу.  
  

-   [Concurrency::CurrentScheduler:: CREATE](reference/currentscheduler-class.md#create) создает метод `Scheduler` , использующий конкретную политику и связывающий этот планировщик с текущим контекстом.  
  
-   [Concurrency::Scheduler:: CREATE](reference/scheduler-class.md#create) метод создает `Scheduler` объект, использующий конкретную политику, но не связывает его с текущим контекстом.  

  
 Разрешение выполнения создает планировщик по умолчанию включает все параллельные задачи могут совместно использовать тот же планировщик. Обычно функциональные возможности, предоставляемые [библиотеки параллельных шаблонов](../../parallel/concrt/parallel-patterns-library-ppl.md) (PPL) или [библиотеки асинхронных агентов](../../parallel/concrt/asynchronous-agents-library.md) используется для выполнения параллельной работы. Таким образом не нужно работать непосредственно с планировщиком, чтобы контролировать политику или время существования. При использовании библиотеки параллельных Шаблонов или библиотеки агентов, среда выполнения создает планировщик по умолчанию, если он не существует и делает его текущим планировщиком для каждого контекста. При создании планировщика и задать его в качестве текущего планировщика, среда выполнения использует этот планировщик заданий по расписанию. Создайте дополнительные экземпляры планировщика, только в том случае, когда требуется определенная политика планирования. Дополнительные сведения о политиках, которые связаны с планировщиком см. в разделе [политики планировщика](../../parallel/concrt/scheduler-policies.md).  
  
 [[В начало](#top)]  
  
##  <a name="managing"></a>Управление временем существования экземпляра планировщика  
 Среда выполнения использует механизм подсчета ссылок для управления временем существования `Scheduler` объектов.  
  

 При использовании `CurrentScheduler::Create` метода или `Scheduler::Create` метод для создания `Scheduler` объекта, среда выполнения задает начальное число ссылок этого планировщика в один. Среда выполнения увеличивает число ссылок при вызове [Concurrency::Scheduler:: Attach](reference/scheduler-class.md#attach) метод. `Scheduler::Attach` Связывает метод `Scheduler` объект с текущим контекстом. В результате текущего планировщика. При вызове `CurrentScheduler::Create` метода, среда выполнения создает `Scheduler` и прикрепляет его к текущему контексту (и устанавливает счетчик ссылок к одному). Можно также использовать [Concurrency::Scheduler:: Reference](reference/scheduler-class.md#reference) метод для увеличения значения счетчика ссылок `Scheduler` объекта.  
  
 Среда выполнения уменьшает счетчик ссылок при вызове [concurrency::CurrentScheduler::Detach](reference/currentscheduler-class.md#detach) метод для отсоединения текущего планировщика или вызвать [Concurrency::Scheduler:: Release](reference/scheduler-class.md#release) метод. Когда число ссылок достигает нуля, среда выполнения уничтожает `Scheduler` объект после завершения всех запланированных задач. Выполняемая задача может увеличивать число ссылок текущего планировщика. Таким образом, если число ссылок достигает нуля и задача увеличивает счетчик ссылок, среда выполнения не уничтожает `Scheduler` объект пока еще раз, число ссылок достигает нуля и не завершатся все задачи.  

  
 Среда выполнения поддерживает внутренний стек `Scheduler` объекты для каждого контекста. При вызове `Scheduler::Attach` или `CurrentScheduler::Create` метод среды выполнения помещает `Scheduler` объект стек для текущего контекста. В результате текущего планировщика. При вызове `CurrentScheduler::Detach`, среда выполнения извлекает текущий планировщик из стека текущего контекста и задает в качестве текущего планировщика предыдущий.  
  
 Среда выполнения предоставляет несколько способов управления временем существования экземпляра планировщика. Следующая таблица показывает соответствующий метод, который освобождает или отсоединяется планировщика в текущем контексте для каждого метода, который создает и присоединяет к текущему контексту планировщика.  
  
|Метод создания или присоединения|Метод освобождения или отсоединения|  
|-----------------------------|------------------------------|  
|`CurrentScheduler::Create`|`CurrentScheduler::Detach`|  
|`Scheduler::Create`|`Scheduler::Release`|  
|`Scheduler::Attach`|`CurrentScheduler::Detach`|  
|`Scheduler::Reference`|`Scheduler::Release`|  
  
 Вызов неподходящего освобождения или отсоединения создает метод непредсказуемому поведению во время выполнения.  
  
 При использовании функции, например, PPL, которая заставляет среду выполнения создавать планировщик по умолчанию, не освобождения или отсоединения данным планировщиком. Среда выполнения управляет временем существования планировщиков, который создает.  
  

 Так как среда выполнения не уничтожает `Scheduler` до завершения всех задач, можно использовать [Concurrency::Scheduler:: registershutdownevent](reference/scheduler-class.md#registershutdownevent) метода или [concurrency::CurrentScheduler:: RegisterShutdownEvent](reference/currentscheduler-class.md#registershutdownevent) метод для получения уведомлений при `Scheduler` объект удаляется. Это полезно, если необходимо подождать для каждой задачи, запланированной `Scheduler` завершения.  
  
 [[В начало](#top)]  
  
##  <a name="features"></a>Методы и свойства  
 В этом разделе представлены важные методы `CurrentScheduler` и `Scheduler` классы.  
  
 Представьте `CurrentScheduler` класса в качестве вспомогательного класса для создания планировщика для использования в текущем контексте. `Scheduler` Позволяет контролировать планировщик, принадлежащий к другому контексту.  
  
 В следующей таблице показаны важные методы, которые определены в `CurrentScheduler` класса.  
  
|Метод|Описание:|  
|------------|-----------------|  
|[Создание](reference/currentscheduler-class.md#create)|Создает `Scheduler` объект, который использует заданную политику и связывает его с текущим контекстом.|  
|[Get](reference/currentscheduler-class.md#get)|Извлекает указатель на `Scheduler` объект, связанный с текущим контекстом. Этот метод не увеличивает число ссылок `Scheduler` объекта.|  
|[Detach](reference/currentscheduler-class.md#detach)|Отсоединяет текущий планировщик из текущего контекста и задает в качестве текущего планировщика предыдущий.|  
|[RegisterShutdownEvent](reference/currentscheduler-class.md#registershutdownevent)|Регистрирует событие, которое среда выполнения задает при уничтожении текущего планировщика.|  
|[CreateScheduleGroup](reference/currentscheduler-class.md#createschedulegroup)|Создает [concurrency::ScheduleGroup](../../parallel/concrt/reference/schedulegroup-class.md) объекта в текущем планировщике.|  
|[ScheduleTask](reference/currentscheduler-class.md#scheduletask)|Добавляет упрощенную задачу в очередь планирования текущего планировщика.|  
|[GetPolicy](reference/currentscheduler-class.md#getpolicy)|Извлекает копию политики, связанный с текущим планировщиком.|  
  
 В следующей таблице показаны важные методы, которые определены в `Scheduler` класса.  
  
|Метод|Описание:|  
|------------|-----------------|  
|[Создание](reference/scheduler-class.md#create)|Создает `Scheduler` объекта с помощью указанной политики.|  
|[Attach](reference/scheduler-class.md#attach)|Связывает `Scheduler` объект с текущим контекстом.|  
|[Ссылки](reference/scheduler-class.md#reference)|Увеличивает счетчик ссылок объекта `Scheduler` объекта.|  
|[Релиз](reference/scheduler-class.md#release)|Уменьшает счетчик ссылок для `Scheduler` объекта.|  
|[RegisterShutdownEvent](reference/scheduler-class.md#registershutdownevent)|Регистрирует событие, которое задает среду выполнения, когда `Scheduler` объект удаляется.|  
|[CreateScheduleGroup](reference/scheduler-class.md#createschedulegroup)|Создает [concurrency::ScheduleGroup](../../parallel/concrt/reference/schedulegroup-class.md) объекта в `Scheduler` объекта.|  
|[ScheduleTask](reference/scheduler-class.md#scheduletask)|Планирует упрощенную задачу из `Scheduler` объекта.|  
|[GetPolicy](reference/scheduler-class.md#getpolicy)|Извлекает копию политики, связанные с `Scheduler` объекта.|  
|[SetDefaultSchedulerPolicy](reference/scheduler-class.md#setdefaultschedulerpolicy)|Задает политику для среды выполнения для использования при создании планировщик по умолчанию.|  
|[ResetDefaultSchedulerPolicy](reference/scheduler-class.md#resetdefaultschedulerpolicy)|Восстанавливает политику по умолчанию на тот, который был активным до вызова `SetDefaultSchedulerPolicy`. Если планировщик по умолчанию создается после этого вызова, среда выполнения использует параметры политики по умолчанию для создания планировщика.|  

  
 [[В начало](#top)]  
  
##  <a name="example"></a> Пример  
 Простые примеры того, как создание и управление экземпляром планировщика в разделе [как: управление экземпляром планировщика](../../parallel/concrt/how-to-manage-a-scheduler-instance.md).  
  
## <a name="see-also"></a>См. также  
 [Планировщик задач](../../parallel/concrt/task-scheduler-concurrency-runtime.md)   
 [Как: управление экземпляром планировщика](../../parallel/concrt/how-to-manage-a-scheduler-instance.md)   
 [Политики планировщика](../../parallel/concrt/scheduler-policies.md)   
 [Группы планирования](../../parallel/concrt/schedule-groups.md)

