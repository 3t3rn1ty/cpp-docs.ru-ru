---
title: "Практическое руководство. Выбор среди завершенных задач | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "выбор из завершенных задач [среда выполнения с параллелизмом]"
  - "завершенные задачи, выбор из [среда выполнения с параллелизмом]"
ms.assetid: c8ccc160-043f-4599-847b-32ed270bb257
caps.latest.revision: 17
caps.handback.revision: 14
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Практическое руководство. Выбор среди завершенных задач
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

В это примере показано, как с помощью классов [concurrency::choice](../../parallel/concrt/reference/choice-class.md) и [concurrency::join](../Topic/join%20Class.md) выбрать первую задачу для завершения алгоритма поиска.  
  
## Пример  
 В следующем примере параллельно выполняются два алгоритма поиска, для завершения выбирается первый алгоритм.  В этом примере определяется тип `employee`, который содержит числовой идентификатор и зарплату сотрудника.  С помощью функции `find_employee` осуществляется поиск первого сотрудника, имеющего предоставленный идентификатор или зарплату.  Функция `find_employee` также обрабатывает случай, когда ни один из сотрудников не имеет предоставленный идентификатор или зарплату.  Функция `wmain` создает массив объектов `employee` и выполняет поиск нескольких значений идентификатора и зарплаты.  
  
 В этом примере объект `choice` используется для выбора одного из следующих случаев.  
  
1.  Сотрудник с предоставленным идентификатором существует.  
  
2.  Сотрудник с предоставленной зарплатой существует.  
  
3.  Сотрудника с предоставленным идентификатором или зарплатой не существует.  
  
 Для первых двух случаев в этом примере объект [concurrency::single\_assignment](../../parallel/concrt/reference/single-assignment-class.md) содержит идентификатор, а другой объект `single_assignment` — зарплату.  В этом примере для третьего случая используется объект `join`.  Объект `join` состоит из двух дополнительных объектов `single_assignment`: один для случая, когда не существует сотрудника с предоставленным идентификатором, другой — для случая, когда не существует сотрудника с предоставленной зарплатой.  Объект `join` отправляет сообщение, когда каждый из его членов получает сообщение.  В этом примере объект `join` отправляет сообщение, если не существует сотрудника с предоставленным идентификатором или зарплатой.  
  
 В этом примере объект [concurrency::structured\_task\_group](../../parallel/concrt/reference/structured-task-group-class.md) используется для параллельного выполнения обоих алгоритмов поиска.  Каждая задача поиска записывает данные в один из объектов `single_assignment`, чтобы указать, существует ли заданный сотрудник.  В примере для получения индекса первого буфера, который содержит сообщение и блок `switch` для вывода результата, используется функция [concurrency::receive](../Topic/receive%20Function.md).  
  
 [!code-cpp[concrt-find-employee#1](../../parallel/concrt/codesnippet/CPP/how-to-select-among-completed-tasks_1.cpp)]  
  
 В результате выполнения примера получается следующий результат:  
  
  **Сотрудник с идентификатором 14758 имеет зарплату 27780.00.**  
**Сотрудник с зарплатой 29150.00 имеет идентификатор 84345.**  
**Сотрудник с идентификатором 61935 имеет зарплату 29905.00.**  
**Ни один из сотрудников не имеет идентификатор 899 или зарплату 31223.00.** В этом примере вспомогательная функция [concurrency::make\_choice](../Topic/make_choice%20Function.md) используется для создания объектов `choice`, а вспомогательная функция [concurrency::make\_join](../Topic/make_join%20Function.md) — для создания объектов `join`.  
  
## Компиляция кода  
 Скопируйте код примера и вставьте его в проект Visual Studio или в файл с именем `find-employee.cpp`, затем выполните в окне командной строки Visual Studio следующую команду.  
  
 **cl.exe \/EHsc find\-employee.cpp**  
  
## См. также  
 [Библиотека асинхронных агентов](../../parallel/concrt/asynchronous-agents-library.md)   
 [Асинхронные блоки сообщений](../../parallel/concrt/asynchronous-message-blocks.md)   
 [Функции передачи сообщений](../../parallel/concrt/message-passing-functions.md)   
 [Класс choice](../../parallel/concrt/reference/choice-class.md)   
 [Класс join](../Topic/join%20Class.md)