---
title: "Многопоточность. Создание потоков пользовательского интерфейса | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "CREATE_SUSPENDED"
  - "SECURITY_ATTRIBUTES"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "многопоточность [C++], потоки пользовательского интерфейса"
  - "работа с потоками [C++], создание потоков"
  - "работа с потоками [C++], потоки пользовательского интерфейса"
  - "работа с потоками [MFC], потоки пользовательского интерфейса"
  - "потоки пользовательского интерфейса [C++]"
ms.assetid: 446925c1-db59-46ea-ae5b-d5ae5d5b91d8
caps.latest.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 9
---
# Многопоточность. Создание потоков пользовательского интерфейса
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Потоки пользовательского интерфейса обычно используются для обработки введенных пользователем данных и ответа на пользовательские события независимо от потоков, в которых выполняется остальная часть приложения.  Основной поток приложения \(предоставляемый классом, производным от класса `CWinApp`\) создается и запускается автоматически.  В этом разделе описаны действия, необходимые для создания дополнительных потоков пользовательского интерфейса.  
  
 Первое, что необходимо сделать при создании потока пользовательского интерфейса, это создать класс, производный от [CWinThread](../mfc/reference/cwinthread-class.md).  Необходимо объявить и реализовать этот класс с помощью макросов [DECLARE\_DYNCREATE](../Topic/DECLARE_DYNCREATE.md) и [IMPLEMENT\_DYNCREATE](../Topic/IMPLEMENT_DYNCREATE.md).  Этот класс обязательно переопределяет несколько функций и может переопределить некоторые другие.  Переопределяемые функции и задачи, которые они выполняют, представлены в следующей таблице.  
  
### Переопределяемые функции при создании потока пользовательского интерфейса  
  
|Функция|Назначение|  
|-------------|----------------|  
|[ExitInstance](../Topic/CWinThread::ExitInstance.md)|Выполняет очистку при завершении потока.  Обычно переопределяется.|  
|[InitInstance](../Topic/CWinThread::InitInstance.md)|Выполняет инициализацию экземпляра для потока.  Должна быть переопределена.|  
|[OnIdle](../Topic/CWinThread::OnIdle.md)|Выполняет обработку времени простоя для конкретного потока.  Обычно не переопределяется.|  
|[PreTranslateMessage](../Topic/CWinThread::PreTranslateMessage.md)|Фильтрует сообщения перед их передачей в **TranslateMessage** и **DispatchMessage**.  Обычно не переопределяется.|  
|[ProcessWndProcException](../Topic/CWinThread::ProcessWndProcException.md)|Перехватывает необработанные исключения, вызываемые обработчиком команд и сообщений в потоке.  Обычно не переопределяется.|  
|[Запуск](../Topic/CWinThread::Run.md)|Контролирующая функция для потока.  Содержит механизм обработки сообщений.  Переопределяется редко.|  
  
 MFC предоставляет версии 2 `AfxBeginThread` через перегружать параметра: — это функция, которая может только создать рабочие потоки и одно, может создать потоки или рабочие потоки интерфейса пользователя.  Чтобы запустить поток пользовательского интерфейса, вторая вызовите перегруженный метод [AfxBeginThread](../Topic/AfxBeginThread.md), предоставив следующие сведения:  
  
-   [RUNTIME\_CLASS](../Topic/RUNTIME_CLASS.md) класса, производного от `CWinThread`.  
  
-   \(Необязательно\) Желаемый уровень приоритета потока.  По умолчанию используется обычный приоритет.  Дополнительные сведения о доступных уровнях приоритета см. в разделе [SetThreadPriority](http://msdn.microsoft.com/library/windows/desktop/ms686277) в [!INCLUDE[winsdkshort](../atl/reference/includes/winsdkshort_md.md)].  
  
-   Желаемый размер стека для потока. \(Необязательно\)  По умолчанию используется тот же размер стека, что и для создающего потока.  
  
-   **CREATE\_SUSPENDED**,если необходимо создать поток в состоянии приостановки. \(Необязательно\)  Значением по умолчанию является "0", то есть поток запускается в обычном режиме.  
  
-   \(необязательно\) Желаемые атрибуты безопасности.  По умолчанию используются те же параметры доступа, что и для родительского потока.  Дополнительные сведения о формате информации о безопасности см. в разделе [SECURITY\_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) в [!INCLUDE[winsdkshort](../atl/reference/includes/winsdkshort_md.md)].  
  
 Функция `AfxBeginThread` выполняет большинство необходимых действий.  Она создает новый объект класса, инициализирует его с предоставляемой информацией и вызывает функцию [CWinThread::CreateThread](../Topic/CWinThread::CreateThread.md) для запуска выполнения потока.  Для подтверждения того, что в случае возникновения ошибки освобождение выделяемой для всех объектов памяти осуществляется должным образом, во время создания выполняются специальные проверки.  
  
## Дополнительные сведения  
  
-   [Многопоточность. Завершение потоков](../parallel/multithreading-terminating-threads.md)  
  
-   [Многопоточность. Создание рабочих потоков](../parallel/multithreading-creating-worker-threads.md)  
  
-   [\<caps:sentence id\="tgt49" sentenceid\="d446961ca833a037f83b141ec4859428" class\="tgtSentence"\>Процессы и потоки\<\/caps:sentence\>](http://msdn.microsoft.com/library/windows/desktop/ms684841)  
  
## См. также  
 [Реализация многопоточности на языке C\+\+ с помощью классов MFC](../parallel/multithreading-with-cpp-and-mfc.md)