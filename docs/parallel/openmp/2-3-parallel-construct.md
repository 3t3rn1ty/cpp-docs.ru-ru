---
title: "2.3 parallel Construct | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
ms.assetid: 190eacdf-2c16-4c06-8cb7-ac60eb211425
caps.latest.revision: 7
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# 2.3 parallel Construct
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Следующая директива указывает параллельной области, которая область программы, которая должна выполняться несколькими потоками одновременно.  Это базовая структура, которая запускает параллельное выполнение.  
  
```  
#pragma omp parallel [clause[ [, ]clause] ...] new-line  
   structured-block  
```  
  
 *предложение* одно из следующих действий:  
  
 **если \(**скаляр\-выражение**\)**  
  
 **private \(**список переменных**\)**  
  
 **\(firstprivate**список переменных**\)**  
  
 **общее значение по умолчанию &#124; нет\)**  
  
 **shared \(**список переменных**\)**  
  
 **\(copyin**список переменных**\)**  
  
 **снижение \(**Оператор**.** список переменных**\)**  
  
 **\(num\_threads**целое число\-выражение**\)**  
  
 При обнаружении потока параллельной конструкции, команда потоков создана, если одно из следующих вариантов условий:  
  
-   Нет If предложение отсутствует.  
  
-   If выражение оценивается как значение значению.  
  
 Этот поток будет мастерским потоком группы, с номером потока 0, и все потоки в рабочей группе, в том числе главный поток, область выполняются параллельно.  Если значение  If выражение равно нулю, область сериализовано.  
  
 Запрашивается указанное количество потоков, которые следующие правила будут учитываться, что в указанном порядке.  Первое правило будет применено условие которого выполняется.  
  
1.  Если num\_threads предложение присутствует, то значение выражения целого числа запрошенное число потоков.  
  
2.  Если omp\_set\_num\_threads функция библиотеки была вызвана, тогда значение аргумента в последнем вызове выполненном запрошенное число потоков.  
  
3.  Если переменная среды OMP\_NUM\_THREADS определяет, а затем значение этой переменной среды запрошенное число потоков.  
  
4.  Если ни одна из приведенных выше методов использовались, реализация\-определен запрошенное число потоков.  
  
 Если **num\_threads** предложение присутствует затем он заменяет запрошенное число потоков  **omp\_set\_num\_threads** функция библиотеки или  **OMP\_NUM\_THREADS** переменная среды только для параллельной области она применяется.  Последующие параллельные области не повлияет на них.  
  
 Количество потоков, которые выполняются параллельно область также зависит от того, включена ли или динамическую настройку числа потоков.  Если динамическая корректировка заблокирована, запрошенное число потоков выполняет параллельную область.  Если динамическая корректировка включена, то запрошенное число потоков максимальное количество потоков, которые могут выполняться параллельно область.  
  
 При параллельной области обнаружена, пока заблокирована динамическую настройку числа потоков и запрошенное число потоков для параллельной области превышает число, система среды выполнения может предоставить, расширения функциональности программы реализация\-определена.  Реализация может, например, прерывание выполнения программы или она может сериализовать параллельной области.  
  
 **omp\_set\_dynamic** функция библиотеки и  **OMP\_DYNAMIC** переменная среды можно использовать для включения и отключения динамическую корректировку числа потоков.  
  
 Реализация\-определено количества физических процессоров, фактически при размещении потоков в любой момент времени.  После создания количество потоков в рабочей группе остается постоянным на длительность этой параллельной области.  Он может быть изменен либо явно пользователем или автоматически системой среды выполнения из одной параллельной области в другую.  
  
 Выписки, содержащихся в динамической экстенты параллельной области выполняются каждым потоком, а каждый поток может выполняться путь выписок, который отличается от других потоков.  Директивы, возникшие за пределами лексической области памяти параллельной области называются потерянных guidelines.  
  
 Неявный барьера в конце параллельной области.  Только главный поток продолжает выполнение команды в конце параллельной области.  
  
 Если поток в команде при выполнении параллельной области обнаруживает другой параллельной конструкции, он создает новую рабочую группу и становится образцом этой новой рабочей группы.  Вложенные параллельные области сериализованное по умолчанию.  В результате по умолчанию вложенные параллельной области выполняется командой, состоящей из одного потока.  По умолчанию функциональности можно изменить с помощью того, функции библиотеки времени выполнения **omp\_set\_nested** или переменная среды  **OMP\_NESTED**.  Однако реализация\-определено количество потоков в рабочей группе, которые выполняются вложенных параллельной области.  
  
 Ограничения **Параллельно** директива выглядит следующим образом:  
  
-   Максимум одно If предложение может появиться в директиву.  
  
-   Он не определен ли все побочные эффекты в если выражение или num\_threads выражение.  
  
-   A **throw** при выполнении в параллельной области вызвать выполнение продолжения за динамической области памяти одного и того же структурированного блока, и он должен быть уловлен одним потоком, который вызвал исключение.  
  
-   Только одного num\_threads предложение может появиться в директиву.   Num\_threads выражение вычисляется вне контекста параллельной области и должен иметь значение, являющееся положительным целым числом.  
  
-   Порядок вычисления **If** и  **num\_threads** предложения неспецифицированны.  
  
## Перекрестные ссылки:  
  
-   **private**"  **firstprivate**"  **значение по умолчанию**"  **shared**"  **copyin**и  **сокращение** предложения см. в разделе  [Раздел 2.7.2](../Topic/2.7.2%20Data-Sharing%20Attribute%20Clauses.md) на странице 25.  
  
-   **OMP\_NUM\_THREADS** переменная среды  [Раздел 4.2](../../parallel/openmp/4-2-omp-num-threads.md) на странице 48.  
  
-   **omp\_set\_dynamic** функция библиотеки см. в разделах  [Раздел 3.1.7](../../parallel/openmp/3-1-7-omp-set-dynamic-function.md) на странице 39.  
  
-   **OMP\_DYNAMIC** переменная среды выполнения, см. в разделе  [Шаг 4.3](../../parallel/openmp/4-3-omp-dynamic.md) на странице 49.  
  
-   **omp\_set\_nested** функция см. в разделе  [Раздел 3.1.9](../../parallel/openmp/3-1-9-omp-set-nested-function.md) на странице 40.  
  
-   **OMP\_NESTED** переменная среды выполнения, см. в разделе  [Раздел 4.4](../Topic/4.4%20OMP_NESTED.md) на странице 49.  
  
-   **omp\_set\_num\_threads** функция библиотеки см. в разделах  [Раздел 3.1.1](../../parallel/openmp/3-1-1-omp-set-num-threads-function.md) на странице 36.