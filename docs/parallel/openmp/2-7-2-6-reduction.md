---
title: "2.7.2.6 уменьшение | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
ms.assetid: e7630a15-2978-4dbe-a29b-3a46371a0151
caps.latest.revision: "6"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 684067eae668398e71ca4ace0cc136e3210e0dbf
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="2726-reduction"></a>2.7.2.6 reduction

Это предложение выполняет уменьшение скалярные переменные, которые отображаются в *списка переменной*, с помощью оператора *op*. Синтаксис `reduction` предложение является следующим образом:

> Уменьшение (*op*: *списка переменной*)

Уменьшение обычно задается для инструкции с одним из следующих форм:

> *x* = *x* *op* *expr*  
> *x* *binop* = *expr*  
> *x* = *expr* *op* *x* (за исключением вычитания)  
> *x*++  
> ++*x*  
> *x*--  
> --*x*  

Здесь:

*x*  
Одной из переменных сокращения, указанный в `list`.

*Список переменной*  
Список разделенных запятыми скалярная редукция переменных.

*expr*  
Выражение с скалярный тип, который не ссылается на *x*.

*Хозяин операций*  
Не перегруженного оператора, кроме одного +, &#42; -, &amp;, ^, &#124; &amp; &amp;, или &#124; &#124;.

*binop*  
Не перегруженного оператора, кроме одного +, &#42; -, &amp;, ^, или &#124;.

Ниже приведен пример `reduction` предложения:  
  
```cpp  
#pragma omp parallel for reduction(+: a, y) reduction(||: am)  
for (i=0; i<n; i++) {  
   a += b[i];  
   y = sum(y, c[i]);  
   am = am || b[i] == c[i];  
}  
```  
  
Как показано в примере, оператор может быть скрыт при вызове функции. Пользователю следует соблюдать осторожность, что оператор, указанный в `reduction` предложение соответствует операции редукции.

Несмотря на то что правого операнда оператора &#124; &#124; оператор не имеет побочных эффектов в этом примере, они допускаются, но следует использовать с осторожностью. В этом контексте побочный эффект, который гарантированно не происходит во время последовательного выполнения цикла может возникать при параллельном выполнении. Это различие может происходить, поскольку порядок выполнения итерации не определен.

Оператор, используемый для определения начального значения все закрытые переменные, используемый компилятором для сокращения и определить оператор финализации. Явное указание оператора позволяет инструкцию reduction должна быть вне лексическая область конструкции. Любое количество `reduction` предложений, которые могут быть указаны в директиве, но переменную может отображаться не более одного `reduction` предложение для этой директивы.

Закрытая копия каждой переменной в *списка переменной* создается, один для каждого потока, как если бы `private` использовать предложение. Частной копии инициализируется в соответствии с оператором (см. ниже).

В конце области, для которого `reduction` указано предложение, исходный объект обновляется для отражения результат объединения исходное значение с конечное значение каждого из закрытых копий, с помощью указанного оператора. Операторы уменьшения имеют все ассоциативность (за исключением вычитание) и компилятор свободно повторно связать вычисления итогового значения. (Частичные результаты сокращения вычитания добавляются для формирования конечного значения).

Значение исходного объекта становится неопределенным, когда первый поток достигает содержащего предложения и поэтому остается до завершения вычисления сокращения.  Как правило выполняется вычисление будет выполнена в конце конструкции; Однако если `reduction` на конструкции, к которой используется предложение `nowait` является также применяется значение исходного объекта остается неопределенным до синхронизации барьера выполнены, чтобы убедиться, что все потоки завершили `reduction`предложения.

В следующей таблице перечислены операторы, которые являются допустимыми и их значения канонические инициализации. Значение фактического инициализации будет согласовано с типом данных переменной сокращения.

|Оператор|Инициализация|
|--------------|--------------------|
|+|0|
|&#42;|1|
|-|0|
|&amp;|~0|
|&#124;|0|
|^|0|
|&amp;&amp;|1|
|&#124;&#124;|0|

Ограничения, `reduction` предложение, следующим образом:

- Тип переменных в `reduction` предложение должно быть допустимым для оператором редукции, но никогда не допускаются типы указателей и ссылочные типы.

- Переменной, указанной в `reduction` предложение не должно быть **const**-полное.

- Переменные, которые закрытый внутри параллельной области или, входящие в `reduction` предложения **параллельных** директива не может быть указана в `reduction` предложение в директиве совместной работы, который привязывается к параллельной конструкции.

   ```cpp
   #pragma omp parallel private(y)
   { /* ERROR - private variable y cannot be specified
                in a reduction clause */
      #pragma omp for reduction(+: y)
      for (i=0; i<n; i++)
         y += b[i];
   }
   
   /* ERROR - variable x cannot be specified in both
              a shared and a reduction clause */
   #pragma omp parallel for shared(x) reduction(+: x)
   ```
