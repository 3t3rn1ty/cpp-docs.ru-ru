---
title: Добавление элемента управления (ATL учебника, часть 2) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.reviewer: ''
ms.suite: ''
ms.technology:
- cpp-windows
ms.tgt_pltfrm: ''
ms.topic: get-started-article
dev_langs:
- C++
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
caps.latest.revision: ''
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 6bedc0fbe4cd1e4a612bcb329071668e783b3de8
ms.sourcegitcommit: 604907f77eb6c5b1899194a9877726f3e8c2dabc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2018
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>Добавление элемента управления (учебник ATL, часть 2)
На этом шаге будет добавить элемент управления в проект, выполните его построение и проверить его на веб-странице.  
  
## <a name="procedures"></a>Процедуры  
  
#### <a name="to-add-an-object-to-an-atl-project"></a>Чтобы добавить объект в проект ATL  
  
1.  В представлении классов щелкните правой кнопкой мыши проект многоугольника.  
  
2.  Пункты **добавить** в контекстном меню, а затем нажмите кнопку **новый элемент** в подменю.  
  
     Откроется диалоговое окно **Добавление нового элемента**. В структуре дерева слева перечислены категории другому объекту.  
  
3.  Нажмите кнопку **ATL** папки.  
  
4.  В списке шаблонов справа выберите **управления ATL**. Нажмите кнопку **Добавить**. Будет открыт мастер элементов управления ATL, и можно настроить элемент управления.  
  
5.  Тип `PolyCtl` как короткое имя и обратите внимание, что другие поля заполняются автоматически. Не нажимайте кнопку **Готово** , но, поскольку необходимо внести некоторые изменения.  
  
 Мастер элементов управления ATL **имена** страница содержит следующие поля:  
  
|Поле|Описание|  
|-----------|--------------|  
|**Краткое имя**|Имя, введенное для элемента управления.|  
|**Класс**|Имя класса C++, созданном для реализации элемента управления.|  
|**h-файл**|Файл, созданный для содержат определение класса C++.|  
|**CPP-файл**|Файл, созданный в реализацию класса C++.|  
|**Компонентный класс**|Имя класса компонента для этого элемента управления.|  
|**Interface**|Имя интерфейса, на котором этот элемент управления будет реализовывать его пользовательские методы и свойства.|  
|**Type**|Описание для элемента управления.|  
|**ProgID**|Для чтения имя, которое может использоваться для поиска CLSID элемента управления.|  
  
 Необходимо внести в мастер элементов управления ATL несколько дополнительных параметров.  
  
#### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>Чтобы включить поддержку сведения об ошибке и подключение точки  
  
1.  Нажмите кнопку **параметры** Открытие **параметры** страницы.  
  
2.  Выберите **точки подключения** флажок. Поддержка исходящий интерфейс будет создано в IDL-файле.  
  
 Также можно сделать элемент управления вставляемые, это означает, что его можно внедрять в приложения, которые поддерживают внедренные объекты, например Excel или Word.  
  
#### <a name="to-make-the-control-insertable"></a>Чтобы сделать элемент управления вставляемые  
  
1.  Нажмите кнопку **внешний вид** Открытие **внешний вид** страницы.  
  
2.  Выберите **Insertable** флажок.  
  
 Многоугольник, отображаемых в объекте будут иметь цвет сплошной заливки, поэтому следует добавить `Fill Color` stock свойство.  
  
#### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>Чтобы добавить стандартное свойство цвет заливки и создание элемента управления  
  
1.  Нажмите кнопку **свойства набора** Открытие **свойства набора** страницы.  
  
2.  В разделе **не поддерживается**, прокрутите вниз список возможных стандартных свойств. Дважды щелкните `Fill Color` для перемещения его в **поддерживаемые** списка.  
  
3.  На этом завершается параметры для элемента управления. Нажмите кнопку **Готово**.  
  
 Мастер создания элемента управления, как произошло несколько изменений кода и добавление файлов. Были созданы следующие файлы:  
  
|Файл|Описание|  
|----------|-----------------|  
|PolyCtl.h|Содержит большую часть реализации класса C++ `CPolyCtl`.|  
|PolyCtl.cpp|Содержит оставшиеся части `CPolyCtl`.|  
|PolyCtl.rgs|Текстовый файл, содержащий скрипт реестра, используемые для регистрации элемента управления.|  
|PolyCtl.htm|Веб-страница, содержащая ссылку на только что созданный элемент управления.|  
  
 Мастер также выполнены следующие изменения кода:  
  
-   Добавлен `#include` инструкции в файл stdafx.h и stdafx.cpp для включения библиотеки ATL файлы, необходимые для поддержки элементов управления.  
  
-   Измененные Polygon.idl для включения сведений о нового элемента управления.  
  
-   Добавить новый элемент управления в карте объектов в Polygon.cpp.  
  
 Теперь можно создать элемент управления, чтобы просмотреть его в действие.  
  
## <a name="building-and-testing-the-control"></a>Построение и тестирование элемента управления  
  
#### <a name="to-build-and-test-the-control"></a>Сборка и тестирование элемента управления  
  
1.  На **построения** меню, нажмите кнопку **построения многоугольника**.  
  
     После завершения создания элемента управления щелкните правой кнопкой мыши файл PolyCtl.htm в **обозревателе решений** и выберите **Просмотр в браузере**. Появится веб-страницу, содержащую элемент управления. Должна отобразиться страница с названием «Страница тестирования 8.0 ATL для объекта PolyCtl» и текст **PolyCtl**. Это элемент управления.  
  
> [!NOTE]
>  При изучении этого руководства, если появляется сообщение об ошибке, когда не удается создать файл DLL, закройте файл файл PolyCtl.htm и контейнер теста элемент управления ActiveX и повторной сборки решения. Если по-прежнему не удается создать библиотеку DLL, перезагрузить компьютер или выйти из системы (при использовании служб терминалов).  
  
 Далее вы добавите пользовательского свойства элемента управления.  
  
 [Вернитесь к шагу 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [к действию 3](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  
  
## <a name="see-also"></a>См. также  
 [Учебник](../atl/active-template-library-atl-tutorial.md)

