---
title: "Добавление элемента управления (учебник ATL, часть 2) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
dev_langs: 
  - "C++"
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
caps.latest.revision: 15
caps.handback.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Добавление элемента управления (учебник ATL, часть 2)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

На этом шаге вам предстоит добавить элемент управления в проект, собрать его и протестировать на веб\-странице.  
  
## Процедуры  
  
#### Добавление объекта в проект ATL  
  
1.  В окне "Представление классов" щелкните правой кнопкой мыши проект Polygon.  
  
2.  Укажите на **Добавить** в контекстном меню и щелкните **Класс** в подменю.  
  
     Откроется диалоговое окно **Добавление класса**.  Разные категории объектов перечислены в структуре дерева слева.  
  
3.  Щелкните папку **ATL**.  
  
4.  В списке шаблонов справа выберите **Элемент управления ATL**.  Нажмите кнопку **Добавить**.  Мастер элементов управления ATL откроется, и вы сможете настроить элемент управления.  
  
5.  Введите `PolyCtl` в качестве короткого имени и обратите внимание, что другие поля заполняются автоматически.  Пока не нажимайте **Готово**, поскольку необходимо внести некоторые изменения.  
  
 Страница **Имена** мастера управления ATL содержит следующие поля:  
  
|Поле|Содержимое|  
|----------|----------------|  
|**Краткое имя**|Имя, введенное для элемента управления.|  
|**Класс**|Имя класса C\+\+ для реализации элемента управления.|  
|**H\-файл**|Созданный файл, который содержит определение класса C\+\+.|  
|**CPP\-файл**|Созданный файл, который содержит определение класса C\+\+.|  
|**CoClass**|Возвращает имя класса для указанного компонента.|  
|**Интерфейс**|Имя интерфейса, в котором элемент управления будет реализовывать его пользовательских методов и свойств.|  
|**Тип**|Описание элемента управления.|  
|**ProgID**|Читаемое имя, которое можно использовать для поиска CLSID элемента управления.|  
  
 Необходимо выполнить несколько дополнительных действий в мастере элементов управления ATL.  
  
#### Включение поддержки разнообразных сведений об ошибке и точках подключения  
  
1.  Щелкните **Параметры**, чтобы открыть страницу **Параметры**.  
  
2.  Установите флажок **Точки подключения**.  При этом создается поддержка исходящего интерфейса в файле IDL.  
  
 Можно также сделать элемент управления пригодным для вставки; это означает, что его можно встраивать в приложения, которые поддерживают внедренные объекты, например Excel или Word.  
  
#### Преобразование элемента управления во вставляемый  
  
1.  Щелкните **Внешний вид**, чтобы открыть страницу **Внешний вид**.  
  
2.  Установите флажок **Insertable**.  
  
 Многоугольник, отображаемый объектом, будет иметь плотный цвет заполнения, поэтому потребуется добавить свойство склада `Fill Color`.  
  
#### Добавление стандартного свойства цвета заливки и создание элемента управления  
  
1.  Щелкните **Стандартные свойства**, чтобы открыть страницу **Стандартные свойства**.  
  
2.  В области **Не поддерживается** прокрутите вниз список возможных стандартных свойств.  Дважды щелкните `Fill Color`, чтобы переместить его в список **Поддерживается**.  
  
3.  Создание элемента управления завершено.  Нажмите кнопку **Готово**.  
  
 После создания мастером элемента управлений произошло несколько изменений в коде и появились новые файлы.  Были созданы следующие файлы:  
  
|Файл|Описание|  
|----------|--------------|  
|PolyCtl.h|Содержит большую часть реализации класса `CPolyCtl` C\+\+.|  
|PolyCtl.cpp|Содержит оставшиеся части `CPolyCtl`.|  
|PolyCtl.rgs|Текстовый файл, содержащий скрипт реестра, используемый для регистрации элемента управления.|  
|PolyCtl.htm|Веб\-страница, содержащая ссылку на вновь созданный элемент управления.|  
  
 Кроме того, мастер выполняет следующие изменения кода.  
  
-   Добавлен оператор `#include` в файлы stdafx.h и stdafx.cpp для включения ATL\-файлов, необходимых для поддержки элементов управления.  
  
-   Polygon.idl изменен для включения сведений о новом элементе управления.  
  
-   Добавлен новый элемент управления в сопоставление объекта в Polygon.cpp.  
  
 Теперь можно собрать элемент управления, чтобы посмотреть на него в действии.  
  
## Сборка и тестирование элемента управления  
  
#### Сборка и тестирование элемента управления  
  
1.  В меню **Сборка** выберите **Собрать полигон**.  
  
     По окончании сборки элемента управления щелкните PolyCtl.htm правой кнопкой мыши в **Обозреватель решений** и выберите **Просмотреть в браузере**.  Изображение, которое будет отображено на элементе управления.  Должна отображаться страница с заголовком «Тестовая страница ATL 8.0 для объекта PolyCtl» и текст **PolyCtl**.  Это ваш элемент управления.  
  
> [!NOTE]
>  Если при прохождении этого руководства выводится сообщение о невозможности создания файла DLL, закройте файл PolyCtl.htm и тестовый контейнер элементов управления ActiveX, затем снова выполните сборку решения.  Если создать библиотеку DLL все равно не удается, перезагрузите компьютер или выполните выход \(если используются службы терминалов\).  
  
 Далее следует добавить в элемент управления пользовательское свойство.  
  
 [Назад к шагу 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [Перейти к шагу 3](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  
  
## См. также  
 [Учебник](../Topic/Active%20Template%20Library%20\(ATL\)%20Tutorial.md)