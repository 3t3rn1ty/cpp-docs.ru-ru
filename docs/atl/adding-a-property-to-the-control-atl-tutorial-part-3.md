---
title: "Добавление свойства в элемент управления (учебник ATL, часть 3) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
dev_langs: 
  - "C++"
ms.assetid: f775fe34-103b-4f07-9999-400e987ee030
caps.latest.revision: 15
caps.handback.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Добавление свойства в элемент управления (учебник ATL, часть 3)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

`IPolyCtl` интерфейс, содержащий методы и свойства элемента управления пользовательские и добавить свойство к нему.  
  
### Добавление свойства с помощью мастера добавления свойства  
  
1.  В представлении классов разверните ветвление многоугольника.  
  
2.  Щелкните правой кнопкой мыши IPolyCtl.  
  
3.  В контекстном меню выберите **Добавить**, а затем нажмите кнопку **Добавить свойство**.  
  
     Мастер добавления свойства.  
  
4.  В раскрывающемся списке типов свойства выберите `SHORT`.  
  
5.  Введите `стороны` как **имя свойства.**  
  
6.  Нажмите кнопку **Готово**, который необходимо завершить добавить свойство.  
  
 При добавлении свойства к интерфейсу, MIDL \(программа, будет компилироваться idl\-файлы\) определяет метод `Get` для восстановления имеет значение, а метод `Put` для установки нового значения.  Методы называются `put_` и `get_` путем добавления к имени свойства.  
  
 Мастер добавления свойства добавляет необходимые линии в idl\-файл.  Он также добавляет прототипы функций `Get` и `Put` к определению класса в PolyCtl.h и добавляет пустая реализация в PolyCtl.cpp.  Можно проверить это, откройте PolyCtl.cpp и поиска функции `get_Sides` и `put_Sides`.  
  
 Несмотря на то что теперь имеется каркасные функции для задания и извлечения свойства, необходимо место хранения.  Создается переменная для хранения свойство и обновления функции соответственно.  
  
#### Создать переменную для хранения свойство и обновления помещения и получение методы  
  
1.  В обозревателе решений откройте PolyCtl.h и добавьте следующую линия после определения `m_clrFillColor`:  
  
     [!code-cpp[NVC_ATL_Windowing#44](../atl/codesnippet/CPP/adding-a-property-to-the-control-atl-tutorial-part-3_1.h)]  
  
2.  Установите значение по умолчанию `m_nSides`.  Сделайте формой по умолчанию треугольника путем добавления линии в конструктор в PolyCtl.h:  
  
     [!code-cpp[NVC_ATL_Windowing#45](../atl/codesnippet/CPP/adding-a-property-to-the-control-atl-tutorial-part-3_2.h)]  
  
3.  Реализуйте методы `Get` и `Put`.  В объявлении функции `get_Sides` и `put_Sides` были добавлены к PolyCtl.h.  Замените код в PolyCtl.cpp для `get_Sides` и `put_Sides` следующим кодом:  
  
     [!code-cpp[NVC_ATL_Windowing#46](../atl/codesnippet/CPP/adding-a-property-to-the-control-atl-tutorial-part-3_3.cpp)]  
  
 Метод `get_Sides` возвращает текущее значение свойства `Sides` посредством указателя `pVal`.  В методе `put_Sides` код проверяет, что пользователь устанавливает свойство `Sides` к приемлемому значение.  Минимум должно иметь значение 2 и так как массив точек будет использоваться для каждой стороны, 100 разумное ограничение максимального значения.  
  
 Теперь имеется свойство `Sides`.  В следующем шаге вы измените код документа, чтобы использовать его.  
  
 [Возвращается к шагу 2](../atl/adding-a-control-atl-tutorial-part-2.md) &#124; [В шаге 4 на](../atl/changing-the-drawing-code-atl-tutorial-part-4.md)  
  
## См. также  
 [Учебник](../Topic/Active%20Template%20Library%20\(ATL\)%20Tutorial.md)