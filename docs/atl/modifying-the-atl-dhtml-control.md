---
title: "Modifying the ATL DHTML Control | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "DHTML controls"
  - "DHTML controls, изменение"
  - "элементы управления HTML, изменение"
ms.assetid: c053f35f-8629-4600-9595-721f5956777a
caps.latest.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 6
---
# Modifying the ATL DHTML Control
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Мастер элементов управления ATL предоставляет начальный код библиотеки, поэтому можно выполнить построение и запуск элемент управления, и поэтому можно посмотреть, как методы записаны в файлах проекта и вызовы DHTML в коде C\+\+ элемента управления, используя методы распределения.  Можно добавить любой метод диспетчера к интерфейсу.  После этого можно вызывать методы в ресурсе HTML.  
  
#### Изменить элемент управления DHTML библиотеки ATL  
  
1.  В представлении классов разверните проект элемента управления.  
  
     Обратите внимание, что интерфейс, который заканчивается на "пользовательском интерфейсе" имеет один метод, `OnClick`.  Интерфейс, который не заканчивается на "пользовательском интерфейсе" не имеет никаких методов.  
  
2.  Добавьте метод, вызванный `MethodInvoked`  к интерфейсу, который не заканчивается на "пользовательском интерфейсе."  
  
     Этот метод будет добавлен к интерфейсу, который используется в контейнере элемента управления для совместной работы контейнера, а не к интерфейсу, используемому DHTML для взаимодействия с элементом управления.  Только контейнер может вызвать этот метод.  
  
3.  Найдите заштырить \- вне метода в cpp\-файле, и добавьте код для отображения окна сообщения, например:  
  
     [!code-cpp[NVC_ATL_COM#5](../atl/codesnippet/CPP/modifying-the-atl-dhtml-control_1.cpp)]  
  
4.  Добавьте еще один метод с именем `HelloHTML`, но это время, добавляет его к интерфейсу, который заканчивается на "пользовательском интерфейсе." Найдите заштырить \- out \- метод `HelloHTML` в cpp\-файле, и добавьте код для отображения окна сообщения, например:  
  
     [!code-cpp[NVC_ATL_COM#6](../atl/codesnippet/CPP/modifying-the-atl-dhtml-control_2.cpp)]  
  
5.  Добавьте третий метод, `GoToURL`, на интерфейс, который не заканчивается на "пользовательском интерфейсе." Этот метод реализуется путем вызова [IWebBrowser2::Navigate](https://msdn.microsoft.com/en-us/library/aa752133.aspx) следующим образом:  
  
     [!code-cpp[NVC_ATL_COM#7](../atl/codesnippet/CPP/modifying-the-atl-dhtml-control_3.cpp)]  
  
     Можно использовать методы **IWebBrowser2** поскольку библиотека ATL предоставляет указатель этот интерфейс в файле .h.  
  
 Далее измените ресурс HTML для вызова методов создания.  Добавляется 3 кнопки для вызова этих методов.  
  
#### Изменять ресурс HTML  
  
1.  В обозревателе решений дважды щелкните файл .htm, чтобы отобразить ресурса HTML.  
  
     Просмотрите HTML, особенно вызовов внешних методам диспетчера Windows.  HTML вызывает метод `OnClick` проекта и параметры отображает текст элемента управления \(`theBody`\) и цвет к присвоить `red`\(" "\).  Текст следует за вызовом метода метку, которая отображается на кнопку.  
  
2.  Добавьте еще один метод `OnClick` только изменение цвета.  Примеры.  
  
    ```  
    <br>  
    <br>  
    <BUTTON onclick='window.external.OnClick(theBody, "white");'>Refresh</BUTTON>  
    ```  
  
     Этот метод создает кнопку, **Обновить**, которое пользователь может щелкнуть, чтобы вернуть элемент управления к фону первоначально белому.  
  
3.  Добавьте вызов метода `HelloHTML` создания.  Примеры.  
  
    ```  
    <br>  
    <br>  
    <BUTTON onclick='window.external.HelloHTML();'>HelloHTML</BUTTON>  
    ```  
  
     Этот метод создает кнопку, **HelloHTML**, которое пользователь может щелкнуть для отображения в окне сообщения `HelloHTML`.  
  
 Теперь можно выполнить построение и [проверьте измененный элемент управления DHTML](../atl/testing-the-modified-atl-dhtml-control.md).  
  
## См. также  
 [Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)