---
title: "Макросы отладки и отчеты об ошибках | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- macros, error reporting
ms.assetid: 4da9b87f-ec5c-4a32-ab93-637780909b9d
caps.latest.revision: 18
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 112b43c325d4b73d2cc15ba41d9aac255c74da8a
ms.lasthandoff: 02/24/2017

---
# <a name="debugging-and-error-reporting-macros"></a>Макросы отладки и сообщения об ошибках
Эти макросы предоставляют полезные средства отладки и трассировки.  
  
|||  
|-|-|  
|[_ATL_DEBUG_INTERFACES](#_atl_debug_interfaces)|Записывает, в окне вывода утечек любой интерфейс, при обнаружении `_Module.Term` вызывается.|  
|[_ATL_DEBUG_QI](#_atl_debug_qi)|Записывает все вызовы `QueryInterface` в окно вывода.|  
|[ATLASSERT](#atlassert)|Выполняет те же функции, как [_ASSERTE](../../c-runtime-library/reference/assert-asserte-assert-expr-macros.md) макрос найти в библиотеке времени выполнения C.|  
|[ATLENSURE](#atlensure)|Выполняет проверку параметров. Вызов `AtlThrow` при необходимости|  
|[ATLTRACENOTIMPL](#atltracenotimpl)|Отправляет сообщение устройства дампа, что указанная функция не реализована.|  
|[ATLTRACE](http://msdn.microsoft.com/library/c796baa5-e2b9-4814-a27d-d800590b102e)|Выводит предупреждения для выходного устройства, например окна отладчика, в соответствии с указанной флаги и уровни. Включено для обеспечения обратной совместимости.|  
|[ATLTRACE2](#atltrace2)|Выводит предупреждения для выходного устройства, например окна отладчика, в соответствии с указанной флаги и уровни.|  
  
##  <a name="a-nameatldebuginterfacesa--atldebuginterfaces"></a><a name="_atl_debug_interfaces"></a>_ATL_DEBUG_INTERFACES  
 Определить этот макрос перед включением каких-либо файлов заголовка библиотеки ATL трассировки все `AddRef` и **выпуска** вызывает на интерфейсах свои компоненты в окно вывода.  
  
```
#define _ATL_DEBUG_INTERFACES
```  
  
### <a name="remarks"></a>Примечания  
 Выходные данные трассировки отображаются, как показано ниже:  
  
 `ATL: QIThunk - 2008         AddRef  :   Object = 0x00d81ba0   Refcount = 1   CBug - IBug`  
  
 Первая часть каждой трассировки всегда будет `ATL: QIThunk`. Далее следует значение, идентифицирующее конкретного *интерфейс преобразователя* используется. Преобразователь интерфейса — это объект, который поддерживает счетчик ссылок и предоставляют возможность трассировки, используемый здесь. При каждом вызове создается новый интерфейс преобразователя `QueryInterface` за исключением запросов для **IUnknown** интерфейса (в данном случае же преобразователь возвращается каждый раз соответствуют правилам идентификаторов COM).  
  
 Далее вы увидите `AddRef` или **версии** , указывающее, какой метод был вызван. После этого вы увидите значение, идентифицирующее объект был изменен, счетчик ссылок интерфейса. Трассировка значение **это** указатель объекта.  
  
 Счетчик ссылок, который отслеживается имеет счетчик ссылок на этот преобразователь после `AddRef` или **выпуск** был вызван. Отметим, что этот счетчик ссылок не может соответствовать счетчик ссылок для объекта. Каждый преобразователь ведется собственный счетчик ссылок для соблюдения правил подсчет ссылок на COM.  
  
 Заключительная часть сведений — имя объекта и интерфейса, затронутой `AddRef` или **выпуска** вызова.  
  
 Любой интерфейс утечки, обнаруженные при выключении сервера и `_Module.Term` вызывается будет регистрироваться следующим образом:  
  
 `ATL: QIThunk - 2005         LEAK    :   Object = 0x00d81ca0   Refcount = 1   MaxRefCount = 1   CBug - IBug`  
  
 Информация, отображаемая здесь прямо сопоставляется с информация, содержащаяся в предыдущей инструкции трассировки, чтобы можно было проанализировать счетчики ссылок на протяжении всего времени существования интерфейс преобразователя. Кроме того появляются указывает максимальное количество ссылок на этот преобразователь интерфейса.  
  
> [!NOTE]
> `_ATL_DEBUG_INTERFACES`используется в розничных сборках.  
  
##  <a name="a-nameatldebugqia--atldebugqi"></a><a name="_atl_debug_qi"></a>_ATL_DEBUG_QI  
 Записывает все вызовы `QueryInterface` в окно вывода.  
  
```
#define _ATL_DEBUG_QI
```  
  
### <a name="remarks"></a>Примечания  
 Если вызов `QueryInterface` сбой, будет отображаться в окне вывода:  
  
 *Имя интерфейса* - `failed`  
  
##  <a name="a-nameatlasserta--atlassert"></a><a name="atlassert"></a>ATLASSERT  
 `ATLASSERT` Макрос выполняет те же функции, как [_ASSERTE](../../c-runtime-library/reference/assert-asserte-assert-expr-macros.md) макрос найти в библиотеке времени выполнения C.  
  
```
ATLASSERT(booleanExpression);
```  
  
### <a name="parameters"></a>Параметры  
 `booleanExpression`  
 Выражение (включая указатели), результат вычисления которого отличен от нуля или равен нулю.  
  
### <a name="remarks"></a>Примечания  
 В отладочных построениях `ATLASSERT` оценивает `booleanExpression` и создает отчет об отладке, когда результат равен false.  

## <a name="requirements"></a>Требования  
 **Заголовок:** atldef.h  
    
##  <a name="a-nameatlensurea--atlensure"></a><a name="atlensure"></a>ATLENSURE  
 Этот макрос используется для проверки параметров, переданных в функцию.  
  
```
ATLENSURE(booleanExpression);
ATLENSURE_THROW(booleanExpression, hr);
```  
  
### <a name="parameters"></a>Параметры  
 `booleanExpression`  
 Указывает логическое выражение для тестирования.  
  
 `hr`  
 Указывает код ошибки для возврата.  
  
### <a name="remarks"></a>Примечания  
 Эти макросы обеспечивают механизм для обнаружения и уведомлять пользователя об использовании неверный параметр.  
  
 Звонки макрос `ATLASSERT` и, если условие не выполняется вызовов `AtlThrow`.  
  
 В **ATLENSURE** случае `AtlThrow` вызывается с E_FAIL.  
  
 В **ATLENSURE_THROW** случае `AtlThrow` вызывается с указанным HRESULT.  
  
 Разница между **ATLENSURE** и `ATLASSERT` является то, что **ATLENSURE** вызывает исключение в выпуске также создает как в отладочных сборках.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_ATL_Utilities&#108;](../../atl/codesnippet/cpp/debugging-and-error-reporting-macros_1.cpp)]  

## <a name="requirements"></a>Требования  
 **Заголовок:** afx.h  

##  <a name="a-nameatltracenotimpla--atltracenotimpl"></a><a name="atltracenotimpl"></a>ATLTRACENOTIMPL  
 В отладочных построениях ATL отправляет строку « `funcname` не реализован «устройство дампа и возвращает **E_NOTIMPL**.  
  
```
ATLTRACENOTIMPL(funcname);
```  
  
### <a name="parameters"></a>Параметры  
 `funcname`  
 [in] Строка, содержащая имя функции, которая не реализована.  
  
### <a name="remarks"></a>Примечания  
 В сборке выпуска возвращает **E_NOTIMPL**.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_ATL_Utilities&#127;](../../atl/codesnippet/cpp/debugging-and-error-reporting-macros_2.cpp)]  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** atltrace.h 

##  <a name="a-nameatla--atltrace"></a><a name="atl_"></a>ATLTRACE
 Выводит предупреждения для выходного устройства, например окна отладчика, в соответствии с указанной флаги и уровни. Включено для обеспечения обратной совместимости.  
  
```
ATLTRACE(exp);

ATLTRACE(  
    DWORD category,
    UINT  level,
    LPCSTR lpszFormat, ...);
```  
  
### <a name="parameters"></a>Параметры  
 `exp`  
 [in] Строки и переменные для отправки в окне вывода Visual C++ или любого приложения, который перехватывает эти сообщения.  
  
 `category`  
 [in] Тип события или метода, в котором отчет. Список категорий см.  
  
 `level`  
 [in] Уровень трассировки для отчета. Дополнительные сведения см.  
  
 `lpszFormat`  
 [in] Форматированная строка для отправки на устройство дампа.  
  
### <a name="remarks"></a>Примечания  
 В разделе [ATLTRACE2](#atltrace2) описание **ATLTRACE**. **ATLTRACE** и `ATLTRACE2` имеют одинаковое поведение **ATLTRACE** включена для обратной совместимости.  
  
##  <a name="a-nameatltrace2a--atltrace2"></a><a name="atltrace2"></a>ATLTRACE2  
 Выводит предупреждения для выходного устройства, например окна отладчика, в соответствии с указанной флаги и уровни.  
  
```
ATLTRACE2(exp);

ATLTRACE2(
    DWORD category,
    UINT level,
    LPCSTRlpszFormat,  ...);
```  
  
### <a name="parameters"></a>Параметры  
 `exp`  
 [in] Строка для отправки в окне вывода Visual C++ или любого приложения, который перехватывает эти сообщения.  
  
 `category`  
 [in] Тип события или метода, в котором отчет. Список категорий см.  
  
 `level`  
 [in] Уровень трассировки для отчета. Дополнительные сведения см.  
  
 `lpszFormat`  
 [in] `printf`-Стиль строки формата с помощью создать строку для отправки на устройство дампа.  
  
### <a name="remarks"></a>Примечания  
 Краткая форма `ATLTRACE2` записывает строку в отладчике выходных данных окна. Вторая форма `ATLTRACE2` также выводит данные в окне вывода, но применяются параметры инструмент трассировки ATL/MFC (см. [ATLTraceTool выполняется образец](../../visual-cpp-samples.md)). Например, если задать `level` 4 и инструмент трассировки ATL/MFC к уровню 0 не будет выведено сообщение. *уровень* может быть 0, 1, 2, 3 или 4. Значение по умолчанию 0, сообщает только наиболее серьезные проблемы.  
  
 `category` Флаги трассировки, чтобы задать списки параметров. Эти флаги соответствуют типы методов, для которых нужно включить в отчет. В приведенных ниже таблицах перечислены флаги трассировки можно использовать для `category` параметр.  
  
### <a name="atl-trace-flags"></a>Флаги трассировки ATL  
  
|Категории ATL|Описание|  
|------------------|-----------------|  
|`atlTraceGeneral`|Отчеты о всех ATL приложений. По умолчанию.|  
|`atlTraceCOM`|Отчеты о COM-методов.|  
|`atlTraceQI`|Отчеты на вызовы QueryInterface.|  
|`atlTraceRegistrar`|Отчеты о регистрации объектов.|  
|`atlTraceRefcount`|Отчеты об изменении счетчика ссылок.|  
|`atlTraceWindowing`|Отчеты о методы windows; Например отчеты неправильный код сообщения карты.|  
|`atlTraceControls`|Отчеты на элементы управления; Например отчеты, при удалении элемента управления или его окно.|  
|`atlTraceHosting`|Отчеты, размещение сообщений; Например отчеты при активации клиента в контейнере.|  
|`atlTraceDBClient`|Отчеты о шаблон потребителя OLE DB; Например при вызове метода GetData завершается ошибкой, выходных данных может содержать значение HRESULT.|  
|`atlTraceDBProvider`|Отчеты о шаблонов поставщика OLE DB; Например отчеты, если не удалось создать столбец.|  
|`atlTraceSnapin`|Отчеты для приложения оснастку MMC.|  
|`atlTraceNotImpl`|Сообщает, что указанный функция не реализована.|  
|**atlTraceAllocation**|Напечатанная памяти, средства отладки в atldbgmem.h сообщения отчетов.|  
  
### <a name="mfc-trace-flags"></a>Флаги трассировки MFC  
  
|Категория MFC|Описание|  
|------------------|-----------------|  
|**traceAppMsg**|Общее назначение сообщений MFC. Всегда рекомендуется.|  
|**traceDumpContext**|Сообщения от [CDumpContext](../../mfc/reference/cdumpcontext-class.md).|  
|**traceWinMsg**|Сообщения из кода обработки сообщений MFC.|  
|**traceMemory**|Сообщения от кода управления памяти в MFC.|  
|**traceCmdRouting**|Сообщения от MFC Windows команду код маршрута.|  
|**traceHtml**|Сообщения из диалогового окна DHTML доступной в MFC поддержки.|  
|**traceSocket**|Сообщения от доступной в MFC поддержки сокета.|  
|**traceOle**|Сообщения от службы поддержки MFC OLE.|  
|**traceDatabase**|Сообщения от поддержки баз данных MFC.|  
|**traceInternet**|Сообщения от Интернет-поддержку MFC.|  
  
 Чтобы объявить категория пользовательской трассировки, объявить глобальный экземпляр `CTraceCategory` следующим образом:  
  
 [!code-cpp[NVC_ATL_Utilities&#109;](../../atl/codesnippet/cpp/debugging-and-error-reporting-macros_3.cpp)]  
  
 Имя категории, `MY_CATEGORY` в этом примере — необходимо указать имя `category` параметр. Первый параметр — имя категории, которое будет отображаться в инструмент трассировки ATL/MFC. Второй параметр — уровень трассировки по умолчанию. Этот параметр является необязательным, и уровень трассировки по умолчанию — 0.  
  
 Использование определяемой пользователем категории.  
  
 [!code-cpp[NVC_ATL_Utilities&#110;](../../atl/codesnippet/cpp/debugging-and-error-reporting-macros_4.cpp)]  
  
 Чтобы указать, следует ли фильтровать сообщения трассировки, вставьте определения для этих макросов в Stdafx.h перед `#include <atlbase.h>` инструкции.  
  
 Кроме того, можно задать фильтр в директивах препроцессора в **страницы свойств** диалоговое окно. Щелкните **препроцессор** вкладку, а затем вставьте в глобальной **определения препроцессора** поле ввода.  
  
 Atlbase.h содержит определения по умолчанию `ATLTRACE2` макросы и эти определения будут использоваться, если эти символы не задать перед обработкой atlbase.h.  
  
 В сборке выпуска `ATLTRACE2` компилируется в `(void) 0`.  
  
 `ATLTRACE2`ограничивает содержимое строки должно отправляться устройства хранения не более 1023 знаков после форматирования.  
  
 **ATLTRACE** и `ATLTRACE2` имеют одинаковое поведение **ATLTRACE** включена для обратной совместимости.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_ATL_Utilities&#111;](../../atl/codesnippet/cpp/debugging-and-error-reporting-macros_5.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Макросы](../../atl/reference/atl-macros.md)   
 [Отладка и глобальные функции отчетов об ошибках](../../atl/reference/debugging-and-error-reporting-global-functions.md)

