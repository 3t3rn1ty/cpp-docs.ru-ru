---
title: Мастер потребителя ATL OLE DB | Документация Майкрософт
ms.custom: ''
ms.date: 06/25/2018
ms.technology:
- cpp-atl
ms.topic: reference
f1_keywords:
- vc.codewiz.class.atl.consumer.overview
dev_langs:
- C++
helpviewer_keywords:
- ATL projects, adding ATL OLE DB consumers
- connection strings [C++], OLE DB consumers
- ATL OLE DB Consumer Wizard
ms.assetid: dcb68ed1-2224-422f-9f7b-108a74864204
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 2a03e29ed5197d27b421135b1561f3edc88af596
ms.sourcegitcommit: a41c4d096afca1e9b619bbbce045b77135d32ae2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/14/2018
ms.locfileid: "42573367"
---
# <a name="atl-ole-db-consumer-wizard"></a>Мастер потребителя ATL OLE DB
Этот мастер устанавливает класс потребителя OLE DB с помощью привязки данных для доступа к указанному источнику данных через указанный поставщик OLE DB.  
  
> [!NOTE]
>  Этот мастер нужно нажать кнопку **источника данных** кнопку, чтобы выбрать источник данных перед вводом имен в `Class` и **h-файл** поля.  
  
## <a name="uielement-list"></a>Список элементов пользовательского интерфейса  
**Источник данных**  
**Источника данных** кнопку настраивать указанного источника данных с помощью указанного поставщика OLE DB. При нажатии этой кнопки **свойства канала передачи данных** откроется диалоговое окно. Дополнительные сведения о создании строк подключения и **свойства канала передачи данных** диалоговом окне см. в разделе [Обзор API связи данных](/previous-versions/windows/desktop/ms718102\(v=vs.85\)) в документации по Windows SDK.  
  
> [!NOTE]
>  В предыдущих выпусках, нажав Shift **источника данных** кнопки открывается диалоговое окно открытия файла для вы можете выбрать файл данных (udl). Эта функция больше не поддерживается.  
  
Диалоговое окно содержит четыре вкладки:  
  
 - **Поставщик** вкладку  
  
 - **Подключение** вкладку  
  
 - **Advanced** вкладку  
  
 - **Все** вкладку  
  
Следующие дополнительные сведения описаны вкладки **свойства канала передачи данных** диалоговое окно.  
  
Нажмите кнопку **ОК** до конца. **Выбор объектов базы данных** откроется диалоговое окно. В этом диалоговом окне выберите таблицу, представление или хранимую процедуру, используемую получателем.  
  
 **Поставщик**  
   Выберите соответствующего поставщика для управления подключением к источнику данных. Тип поставщика обычно определяется тип базы данных, к которому вы подключаетесь. Нажмите кнопку **Далее** кнопку или нажмите кнопку **подключения** вкладки.  
  
 **Подключение**  
   Содержимое на этой вкладке зависит от выбранного поставщика. Несмотря на то, что существует много типов поставщиков, в этом разделе рассматриваются подключения для двух наиболее распространенных: данные SQL и ODBC. Другие, на котором аналогично на полях, описанных здесь.  
  
  Для данных SQL:  
  
   1. **Выберите или введите имя сервера:** щелкните стрелку раскрывающегося списка меню, чтобы отобразить все данные в зарегистрированных серверов в сети, а затем выберите одну.  
  
   2. **Введите данные для входа сервер:** введите имя пользователя и пароль для входа на сервер данных.  
  
   3. **Выберите базу данных на сервере:** щелкните стрелку раскрывающегося списка меню для отображения всех зарегистрированных баз данных на сервере данных и выберите один.  
  
         - или -  
  
    **Добавить файл базы данных в качестве имени базы данных:** указать файл для использования в качестве базы данных; введите явное имя пути.  
  
    > [!NOTE]
    >  Возникла проблема безопасности с помощью функции «Разрешить сохранение пароля» диалогового окна Свойства канала передачи данных. В «Введите данные для входа на сервер», существует два переключателя:  
  
    **Используйте Windows встроенная система безопасности NT**  
  
    **Использовать указанные имя пользователя и пароль**  
  
     При выборе **использовать указанные имя пользователя и пароль**, имеется возможность сохранения пароля (с использованием флажок «Разрешить сохранение пароля»); тем не менее, этот параметр не является безопасным. Рекомендуется выбрать **встроенные средства безопасности Windows NT используйте**; этот параметр является безопасным, поскольку он шифрует пароль.  
  
     Могут возникнуть ситуации, в которых вы хотите выбрать «Разрешить сохранение пароля». К примеру Если вы выпускаете библиотеки для решения частного базы данных, вы должны не прямой доступ к базе данных, но вместо этого использовать приложения среднего уровня для проверки пользователя (с помощью любой схемы проверки подлинности, выбран) и затем ограничить порядок сортировки данных доступны пользователю.  
  
     Для данных ODBC:  
  
     1. **Укажите источник данных:** можно использовать имя источника данных или строку подключения.  
  
    **Имя источника данных для использования:** раскрывающегося списка список источников данных, зарегистрированных на компьютере. Можно настроить источники данных в любое время с помощью администратора источника данных ODBC- или -**использовать строку подключения:** либо введите строку подключения, вы уже получили, или щелкнуть **построения** меню; **Выбор источника данных** откроется диалоговое окно. Выберите источник данных файла или компьютера и нажмите кнопку **ОК**.  
  
     > [!NOTE]
     >  Строку подключения можно получить, просмотрев свойства существующего соединения в обозревателе серверов, или можно создать подключение, дважды щелкнув **добавить подключение** в обозревателе серверов.  
  
     2. **Введите данные для входа сервер:** введите имя пользователя и пароль для входа на сервер данных.  
  
     3. Введите исходный каталог для использования.  
  
     4. Нажмите кнопку **проверить подключение**; Если проверка пройдет успешно, нажмите кнопку **ОК**. Если нет, проверьте учетные данные для входа, попробуйте другой базы данных или другой сервер данных.  
  
**Дополнительно**  
  **Параметры сети:** укажите **уровень олицетворения** (уровень олицетворения, который сервер может использовать при олицетворении клиента; непосредственно соответствует уровни олицетворения RPC) и  **Уровень защиты** (уровень защиты данных, передаваемых между клиентом и сервером; непосредственно соответствует уровни защиты RPC).  
  
  **Прочее:** в **время ожидания подключения**, укажите количество секунд до истечения периода ожидания бездействия. В **разрешения доступа**, указать разрешения на доступ на подключение к данным.  
  
    For more information about advanced initialization properties, refer to the documentation provided with each specific OLE DB provider.  
  
**Все**  
     На этой вкладке отображается сводка свойств инициализации источника данных и подключение, которое вы указали. Эти значения можно изменить.  
  
     Click **OK** to finish. The **Select Database Object** dialog box appears. From this dialog box, select the table, view, or stored procedure that the consumer will use.  
  
 `Class`  
 После выбора источника данных, это поле заполняется на имя класса по умолчанию, исходя из таблицы или хранимой процедуры, который вы выбрали (см. в разделе **выбрать источник данных** ниже). Можно изменить имя класса.  
  
 **H-файл**  
 После выбора источника данных, это окно заполняется на основе таблицы или хранимой процедуры, который вы выбрали имя класса заголовка по умолчанию (см. в разделе **выбрать источник данных** ниже). Можно изменить имя файла заголовка, или выбрать имеющийся файл заголовка.  
  
 **С атрибутами**  
 Этот параметр указывает, будет ли мастер создавать классы потребителя с использованием атрибутов или определений шаблона. Если выбран этот параметр, мастер использует атрибуты вместо объявлений шаблона (это параметр по умолчанию). Если вы отключите этот параметр, мастер использует объявления шаблона вместо атрибутов.  
  
 -   При выборе потребителя **тип** таблицы, то мастер использует `db_source` и `db_table` атрибуты для объявления классов, создать таблицу и метода доступа к таблице и использует `db_column` создать сопоставление столбцов, например:  
  
```
 // Inject table class and table accessor class declarations  
 [db_source("<initialization_string>"), db_table("dbo.Orders")]  
 ... 
 // Column map  
 [ db_column(1, status=m_dwOrderIDStatus, length=m_dwOrderIDLength) ] LONG m_OrderID;  
 [ db_column(2, status=m_dwCustomerIDStatus, length=m_dwCustomerIDLength) ] TCHAR m_CustomerID[6];  
 ...
```
  
   Вместо использования `CTable` класс шаблона для объявления в таблице и таблице класса метода доступа и макросы BEGIN_COLUMN_MAP и END_COLUMN_MAP, чтобы создать сопоставление столбцов, например:  
  
``` 
 // Table accessor class  
    class COrdersAccessor; // Table class  
    class COrders : public CTable<CAccessor<COrdersAccessor>>;  
 ... 
 // Column map  
    BEGIN_COLUMN_MAP(COrderDetailsAccessor) 
    COLUMN_ENTRY_LENGTH_STATUS(1, m_OrderID, m_dwOrderIDLength, m_dwOrderIDStatus)  
    COLUMN_ENTRY_LENGTH_STATUS(2, m_CustomerID, m_dwCustomerIDLength, m_dwCustomerIDStatus)  
 ...  
    END_COLUMN_MAP() 
```  
  
-   При выборе потребителя **тип** команды, мастер использует `db_source` и `db_command` атрибуты и использует `db_column` создать сопоставление столбцов, например:  
  
```  
 [db_source("<initialization_string>"), db_command("SQL_command")]  
 ... 
 // Column map using db_column is the same as for consumer type of 'table'  
```  
  
   Вместо использования команды и объявлений класса метода доступа команды в h-файле класса команды, например:  
  
```  
    Command accessor class:  
    class CListOrdersAccessor;  
    Command class:  
    class CListOrders : public CCommand<CAccessor<CListOrdersAccessor>>;  
 ... 
 // Column map using BEGIN_COLUMN_MAP ... END_COLUMN_MAP is the same as
 // for consumer type of 'table'  
```  
  
 См. в разделе [основные механизмы атрибуты](../../windows/basic-mechanics-of-attributes.md) Дополнительные сведения.  
  
 **Type**  
 Выберите один из этих переключателей, чтобы указать, будет ли класс потребителя производным от `CTable` или `CCommand` (по умолчанию).  
  
 **Таблица**  
 Выберите этот параметр, если вы хотите использовать `CTable` или `db_table` для создания таблицы и метода доступа к таблице объявления классов.  
  
 **Команда**  
 Выберите этот параметр, если вы хотите использовать `CCommand` или `db_command` для создания команды и доступа к объявлениям. Это значение по умолчанию.  
  
 **Поддержка**  
 Установите флажки, чтобы указывать типы обновлений, которые должны поддерживаться в объекте-получателе (по умолчанию не используется). Каждое из перечисленных ниже задаст [DBPROP_IRowsetChange](/previous-versions/windows/desktop/ms715892\(v=vs.85\)) и соответствующие записи для [DBPROP_UPDATABILITY](/previous-versions/windows/desktop/ms722676\(v=vs.85\)) в наборе свойств карты.  
  
 **Изменение**  
 Указывает, что потребитель поддерживает обновления данных строки в наборе строк.  
  
 **Вставить**  
 Указывает, что потребитель поддерживает вставку строк в наборе строк.  
  
 **Удалить**  
 Указывает, что потребитель поддерживает удаление строк из набора строк.  
  
## <a name="see-also"></a>См. также  
 [Потребителя ATL OLE DB](../../atl/reference/adding-an-atl-ole-db-consumer.md)   
 [Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)   
 [Строки подключения и связи данных (OLE DB)](/previous-versions/windows/desktop/ms718376\(v=vs.85\))
