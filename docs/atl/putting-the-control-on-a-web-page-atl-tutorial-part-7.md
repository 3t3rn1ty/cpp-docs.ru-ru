---
title: Размещение элемента управления на веб-странице (ATL учебника, часть 7) | Документы Microsoft
ms.custom: get-started-article
ms.date: 11/04/2016
ms.technology:
- cpp-atl
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 50dc4c95-c95b-4006-b88a-9826f7bdb222
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 0cd4076ac34af6ee4b19687f401376265bf0e872
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="putting-the-control-on-a-web-page-atl-tutorial-part-7"></a>Размещение элемента управления на веб-странице (учебник ATL, часть 7)
Элемент управления завершена. Для просмотра элемента управления работают в реальной ситуации, поместите его на веб-странице. HTML-файл, содержащий элемент управления был создан при определении элемента управления. Открыть файл в файл PolyCtl.htm **обозревателе решений**, и вы увидите элемент управления на веб-странице.  
  
 На этом шаге будет скрипта веб-страницы для реагирования на события. Вы также измените элемент управления, чтобы знать, что элемент управления безопасные для использования Internet Explorer.  
  
## <a name="scripting-the-web-page"></a>Сценарии веб-страницы  
 Элемент управления выполнять никаких действий, еще не, поэтому изменение веб-страницы, чтобы реагировать на события, отправляемые.  
  
#### <a name="to-script-the-web-page"></a>Сценарий веб-страницы  
  
1.  Откройте файл PolyCtl.htm и выберите представление HTML. Добавьте следующие строки в HTML-код. Они должны быть добавлены после `</OBJECT>` перед вызовом `</BODY>`.  
  
 ```  
 
 <SCRIPT LANGUAGE="VBScript">  
 <!--  
    Sub PolyCtl_ClickIn(x, y)  
    PolyCtl.Sides = PolyCtl.Sides + 1  
    End Sub  
    Sub PolyCtl_ClickOut(x, y)  
    PolyCtl.Sides = PolyCtl.Sides - 1  
    End Sub  
 -->  
 </SCRIPT>  
 ```  
  
2.  Сохраните HTM-файла.  
  
 Вы добавили код VBScript, получает стороны свойство из элемента управления и увеличивается на единицу число сторон, если щелкнуть внутри элемента управления. Если щелкнуть вне элемента управления, можно снизить количество сторон на единицу.  
  
## <a name="indicating-that-the-control-is-safe-for-scripting"></a>Указывает, что элемент управления безопасный для сценариев  
 Веб-страницы с помощью элемента управления можно просмотреть в обозревателе Internet Explorer или более удобным образом, использовать веб-представление браузера, встроенные в Visual C++. Для просмотра элемента управления в режиме веб-браузере, щелкните правой кнопкой мыши файл PolyCtl.htm и нажмите кнопку **Просмотр в браузере**.  
  
 Зависимости текущие параметры безопасности Internet Explorer, может появиться предупреждение безопасности диалоговое окно с сообщением, элемент управления не может быть безопасно скрипта и потенциально может привести к повреждению. Например, если имеется элемент управления, который отображается файла, но также имеет `Delete` метод, который удален файл, можно с уверенностью Если вы только что просмотрели ее на странице. Было бы не безопасный для сценариев, однако, так как кто-то может вызвать `Delete` метод.  
  
> [!IMPORTANT]
>  В этом учебнике можно изменить параметры безопасности в Internet Explorer, чтобы запустить элементы управления ActiveX, не помеченных как безопасные. В панели управления выберите **свойства Интернета** и нажмите кнопку **безопасности** Чтобы изменить соответствующие параметры. После завершения работы с учебником, изменение настроек безопасности обратно в исходное состояние.  
  
 Вы можете программным образом оповестить Internet Explorer, его необходимо открыть диалоговое окно предупреждения системы безопасности для этого конкретного элемента управления. Можно сделать это с помощью `IObjectSafety` интерфейс и ATL предоставляет реализацию этого интерфейса в классе [IObjectSafetyImpl](../atl/reference/iobjectsafetyimpl-class.md). Чтобы добавить интерфейс в элемент управления, добавьте `IObjectSafetyImpl` к списку наследуемых классов и добавьте запись в сопоставление COM.  
  
#### <a name="to-add-iobjectsafetyimpl-to-the-control"></a>Добавление элемента управления IObjectSafetyImpl  
  
1.  Добавьте следующую строку в конец списка наследуемых классов в PolyCtl.h и добавьте запятую в предыдущей строке:  
  
 [!code-cpp[NVC_ATL_Windowing#62](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_1.h)]  
  
2.  Добавьте следующую строку к сопоставлению COM в PolyCtl.h:  
  
 [!code-cpp[NVC_ATL_Windowing#63](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_2.h)]  
  
## <a name="building-and-testing-the-control"></a>Построение и тестирование элемента управления  
 Создать элемент управления. После завершения построения, откройте файл PolyCtl.htm в представлении обозревателя еще раз. На этот раз напрямую без диалоговое окно предупреждение безопасности должны отображаться веб-страницы. Щелкните внутри многоугольника; число сторон увеличивается на единицу. Щелкните за пределами многоугольника, чтобы уменьшить число сторон. При попытке уменьшить число сторон три ниже, вы увидите сообщение об ошибке, которое можно задать.  
  
 [Вернитесь к шагу 6](../atl/adding-a-property-page-atl-tutorial-part-6.md)  
  
## <a name="next-steps"></a>Следующие шаги  
 Это заключительный шаг учебника ATL. Ссылки на дополнительные сведения об ATL см. в разделе [ATL начальная страница](../atl/active-template-library-atl-concepts.md).  
  
## <a name="see-also"></a>См. также  
 [Учебник](../atl/active-template-library-atl-tutorial.md)

