---
title: "Supporting IDispEventImpl | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "IDispEventImpl"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "ATL - библиотека, IDispEventImpl support in COM objects"
  - "BEGIN_SINK_MAP macro"
  - "event sink maps, объявление"
  - "IDispEventImpl class, advising and unadvising"
  - "IDispEventImpl class, объявление"
  - "SINK_ENTRY macro"
  - "библиотеки типов, импорт"
ms.assetid: b957f930-6a5b-4598-8e4d-8027759957e7
caps.latest.revision: 11
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Supporting IDispEventImpl
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Класс [IDispEventImpl](../atl/reference/idispeventimpl-class.md) шаблона можно использовать для предоставления поддержки приемников точки подключения в классе библиотеки ATL.  Приемник точки подключения позволяет класс для обработки событий инициированный из внешних COM\-объект.  Эти приемники точки подключения сопоставлены с сопоставлением приемника событий, предоставляемым пользовательским классом.  
  
 Для правильной реализации приемника точки подключения для класса, необходимо выполнить следующие действия:  
  
-   Импортировать библиотеку типов для каждого внешнего объекта  
  
-   Объявите интерфейсы `IDispEventImpl`  
  
-   Объявите сопоставление приемника событий  
  
-   Посоветуйте и unadvise точки подключения  
  
 Шаги, необходимые для реализации приемника все точки подключения выполняются путем изменения только файл заголовка \(h\) класса.  
  
## Импортирование библиотек типов  
 Для каждого внешнего объекта события которого нужно изменить, необходимо импортировать библиотеку типов.  Этот шаг определяет события, которые могут быть адресации и предоставляет сведения, используемые при объявлении сопоставление приемника событий.  Директивы [\#import](../Topic/%23import%20Directive%20\(C++\).md) можно использовать для выполнения этого.  Добавьте необходимые линии `#import` директивные для каждого интерфейса диспетчеризации, которые поддерживаются в файл заголовка \(h\) класса.  
  
 В следующем примере будет импортировать библиотеку типов внешних серверов COM \(`MSCAL.Calendar.7`\):  
  
 [!code-cpp[NVC_ATL_Windowing#141](../atl/codesnippet/CPP/supporting-idispeventimpl_1.h)]  
  
> [!NOTE]
>  Необходимо иметь отдельные выписку `#import` для каждой внешней библиотеки типов, которые поддерживаются.  
  
## Объявление интерфейсов IDispEventImpl  
 Теперь, когда были импортированы библиотеки типов каждого диспетчера взаимодействуют необходимо объявить интерфейсы `IDispEventImpl` отдельно для каждого внешнего интерфейса диспетчеризации.  Измените объявление класса, добавив объявление интерфейса `IDispEventImpl` для каждого внешнего объекта.  Дополнительные сведения о параметрах см. в разделе [IDispEventImpl](../atl/reference/idispeventimpl-class.md).  
  
 В следующем коде объявляется 2 приемников точки подключения для интерфейса `DCalendarEvents` для com\-объекта, предоставляемого классом `CMyCompositCtrl2`:  
  
 [!code-cpp[NVC_ATL_Windowing#142](../atl/codesnippet/CPP/supporting-idispeventimpl_2.h)]  
  
## Объявление сопоставление приемника событий  
 Для уведомления о событии, который будет решать нужную функцию, класс должен направлять каждое событие на правильный обработчик.  Это достигается путем объявления сопоставление приемника событий.  
  
 Библиотеки ATL предоставляет несколько макросов, [BEGIN\_SINK\_MAP](../Topic/BEGIN_SINK_MAP.md), [END\_SINK\_MAP](../Topic/END_SINK_MAP.md) и [SINK\_ENTRY\_EX](../Topic/SINK_ENTRY.md), которые делают это сопоставление.  Стандартный формат следующим образом:  
  
 `BEGIN_SINK_MAP(comClass)`  
  
 `SINK_ENTRY_EX(id, iid, dispid, func)`  
  
 `.  .  .  //additional external event entries`  
  
 `END_SINK_MAP()`  
  
 В следующем примере объявляется сопоставление приемника событий с 2 обработчиками событий:  
  
 [!code-cpp[NVC_ATL_Windowing#136](../atl/codesnippet/CPP/supporting-idispeventimpl_3.h)]  
  
 Реализация практически завершена.  Последний шаг касается advise и unadvising внешних интерфейсов.  
  
## Advise и Unadvising интерфейсы IDispEventImpl  
 На последнем этапе реализация метода, посоветует \(или unadvise\) всем точкам соединения в правильном время.  Это необходимо сделать до того как сообщение советуя между внешними клиентами и объектом может выполняться.  Прежде чем объект становится видимым, каждый внешний интерфейс диспетчеризации, поддерживаемые объектом запрашивается для исходящих интерфейсов.  Установления соединения и ссылки в исходящий интерфейс используется для обработки событий от объекта.  Эта процедура называется "советующ".  
  
 После того как объект завершен с внешними интерфейсами, исходящие интерфейсы должны быть уведомитьы, что они больше не используются данным классом.  Этот процесс называется "unadvising".  
  
 Из\-за особенностей unique com\-объекта, эта процедура изменяется, подробно и выполнение между реализациями.  Эти сведения за пределами возможностей данного раздела, а не обращатьсяы.  
  
## См. также  
 [Fundamentals of ATL COM Objects](../atl/fundamentals-of-atl-com-objects.md)