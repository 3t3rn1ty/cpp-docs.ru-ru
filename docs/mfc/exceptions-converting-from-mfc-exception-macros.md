---
title: "Исключения. Преобразование из макроса исключений MFC | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "catch - блоки, разделение"
  - "CException - класс, удаление объектов класса CException"
  - "преобразования, код, написанный с макросами MFC"
  - "преобразование исключений"
  - "обработка исключений, преобразование исключений"
  - "объекты исключения"
  - "объекты исключения, удаление"
  - "исключения, преобразование"
  - "исключения, удаление объектов исключения"
  - "ключевые слова [C++], макросы"
  - "макросы, ключевые слова C++"
ms.assetid: bd3ac3b3-f3ce-4fdd-a168-a2cff13ed796
caps.latest.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Исключения. Преобразование из макроса исключений MFC
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Это дополнительный раздел.  
  
 В этой статье описывается, как преобразовать существующий код, написанный с макросами Microsoft Foundation Class — **TRY**, **CATCH**, **THROW** и т. д. \), чтобы использовать ключевые слова **try**, **catch** и `throw` обработки исключений C\+\+.  Ниже приведен список разделов.  
  
-   [Преимущества преобразования](#_core_advantages_of_converting)  
  
-   [Преобразование код с макросами исключения для использования исключений C\+\+.](#_core_doing_the_conversion)  
  
##  <a name="_core_advantages_of_converting"></a> Преимущества преобразования  
 Вероятно, не следует преобразовать существующий код, хотя необходимо знать различий между реализациями макроса в MFC версии 3.0 и в более ранних версиях реализациями.  Эти различия и последующие изменения в расширении функциональности кода описаны в разделе [Исключения: Изменения в макросы исключения в версии 3.0](../mfc/exceptions-changes-to-exception-macros-in-version-3-0.md).  
  
 Основные преимущества преобразования:  
  
-   Код, который использует ключевые слова обработки исключений C\+\+ C компилируется в несколько более редко .EXE или DLL.  
  
-   Ключевые слова обработки исключений C\+\+ значительно превосходит C: Они могут обрабатывать исключения любого типа данных, которые можно скопировать \(`int`, **плавающее**`char` и т д\), тогда как макросы обрабатывают исключения только класса `CException` и классов, производных от него.  
  
 Основное отличие между макросами и ключевыми словами, что код с помощью макроса «автоматически» удаляет перехваченное исключение при возникновении исключения выходит за пределы области действия.  Код с помощью ключевого слова не найдено, поэтому необходимо явно удалять перехваченное исключение.  Дополнительные сведения см. в статье [Исключения: Улавливающ и удаление исключения](../mfc/exceptions-catching-and-deleting-exceptions.md).  
  
 Это различие синтаксис.  Синтаксис для макросов и ключевых слов отличается в отношениях 3:  
  
1.  Аргументы макроса и объявления исключения:  
  
     Вызовом макроса **CATCH** имеет следующий синтаксис:  
  
     *Exception\_class* **CATCH\(**,**\)***exception\_object\_pointer\_name*  
  
     Обратите внимание на запятую между именем класса и именем указателя объекта.  
  
     Объявление исключения для ключевого слова **catch** использует этот синтаксис:  
  
     **\) catch\(** *exception\_type* *exception\_name*  
  
     На этой оператора объявления исключения показан тип исключения дескрипторы блока catch.  
  
2.  Размежевывание блоков catch.  
  
     С помощью макросов, макрос **CATCH** \(\) начинается с соответствующими аргументами первый блок catch; макрос `AND_CATCH` начинается последующие блоки catch, и макрос `END_CATCH` завершает последовательность блоков catch.  
  
     С ключевыми словами, ключевое слово **catch** \(со своим объявления исключения\) начинается каждый блок catch.  Отсутствует эквивалент макросу `END_CATCH`; блок catch для выполнения со своей заключительной фигурной скобки.  
  
3.  Выражение хода:  
  
     Макросы используются повторно ход `THROW_LAST` текущее исключение.  Ключевое слово `throw`, без аргументов, приводит к тому же результату.  
  
##  <a name="_core_doing_the_conversion"></a> Это преобразование  
  
#### Преобразование кода с помощью макросов для использования ключевых слов обработки исключений C\+\+.  
  
1.  Найдите все вхождения макросов **TRY**, **CATCH**, `AND_CATCH`, `END_CATCH`, **THROW** и `THROW_LAST` MFC.  
  
2.  Удалите или замените все вхождения следующих макросов.  
  
     Замените его с **TRY** \( **try**\)  
  
     Замените его с **CATCH** \( **catch**\)  
  
     замените его с `AND_CATCH` \( **catch**\)  
  
     `END_CATCH` \(удалить его\)  
  
     **THROW** \(Замените его с `throw`\)  
  
     `THROW_LAST` \(замените его с `throw`\)  
  
3.  Изменяет аргументы макроса, чтобы они объявления исключения допустимые формы.  
  
     Например, изменение  
  
     [!code-cpp[NVC_MFCExceptions#6](../mfc/codesnippet/CPP/exceptions-converting-from-mfc-exception-macros_1.cpp)]  
  
     в  
  
     [!code-cpp[NVC_MFCExceptions#7](../mfc/codesnippet/CPP/exceptions-converting-from-mfc-exception-macros_2.cpp)]  
  
4.  Измените код в блоках catch таким образом, чтобы он удаляет объекты исключения по мере необходимости.  Дополнительные сведения см. в статье [Исключения: Улавливающ и удаление исключения](../mfc/exceptions-catching-and-deleting-exceptions.md).  
  
 Ниже приведен пример кода обработки исключений с помощью макросов MFC исключения.  Обратите внимание, что поскольку код в следующем примере используется макрос, исключение `e` удаляется автоматически.  
  
 [!code-cpp[NVC_MFCExceptions#8](../mfc/codesnippet/CPP/exceptions-converting-from-mfc-exception-macros_3.cpp)]  
  
 Код в следующем примере используются ключевые слова исключения C\+\+, поэтому необходимо явно удалять исключение:  
  
 [!code-cpp[NVC_MFCExceptions#9](../mfc/codesnippet/CPP/exceptions-converting-from-mfc-exception-macros_4.cpp)]  
  
 Дополнительные сведения см. в разделе [Исключения: С помощью макросов MFC исключения C\+\+](../mfc/exceptions-using-mfc-macros-and-cpp-exceptions.md).  
  
## См. также  
 [Обработка исключений](../mfc/exception-handling-in-mfc.md)