---
title: "Элементы управления ActiveX в MFC. Страницы свойств | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CPropertyPageDialog - класс"
  - "DDP_ - функции"
  - "DoDataExchange - метод"
  - "MFC ActiveX - элементы управления, свойства"
  - "MFC ActiveX - элементы управления, страницы свойств"
  - "OLEIVERB_PROPERTIES"
  - "страницы свойств, MFC ActiveX - элементы управления"
ms.assetid: 1506f87a-9fd6-4505-8380-0dbc9636230e
caps.latest.revision: 11
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Элементы управления ActiveX в MFC. Страницы свойств
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Страницы свойств позволяют пользователю элемента управления ActiveX просматривать и изменять свойства элемента управления ActiveX.  Доступ к этим свойствам осуществляется путем вызова диалогового окна свойств элемента управления, которое содержит одно или несколько страниц свойств, предоставляющих настраиваемый графический интерфейс для просмотра и редактирования свойств элемента управления.  
  
 Страницы свойств элемента управления ActiveX отображаются в 2 вариантах.  
  
-   Когда команда свойств элемента управления \(**OLEIVERB\_PROPERTIES**\), как элемент управления будет открыто модальное диалоговое окно, содержащее страницы свойств для элемента управления.  
  
-   Контейнер может указать собственное безрежимное диалоговое окно, в котором отображается страницы свойств выбранного элемента управления.  
  
 Диалоговое окно свойств \(показанное на следующем рисунке\) состоит из области для отображения текущей страницы свойств вкладок, для переключения между страницами свойства и коллекции кнопок, выполнять общие задачи, как закрыть диалоговое окно страницы свойств, отмена все изменения, или непосредственно применя все изменения элементов управления ActiveX.  
  
 ![Диалоговое окно “Свойства” Circ3](../mfc/media/vc373i1.png "vc373I1")  
Диалоговое окно " Свойства  
  
 В этой статье содержатся разделы, относящиеся к использованию страниц свойств в элемент управления ActiveX.  К ним относятся:  
  
-   [Реализация страницы свойств по умолчанию для элемента управления ActiveX](#_core_implementing_the_default_property_page)  
  
-   [Добавление элементов управления на страницу свойств](#_core_adding_controls_to_a_property_page)  
  
-   [Настраивать функции DoDataExchange](#_core_customizing_the_dodataexchange_function)  
  
 Дополнительные сведения об использовании страниц свойств в элемент управления ActiveX см. в следующих статьях.  
  
-   [Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)  
  
-   [Элементы управления ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)  
  
 Дополнительные сведения об использовании страниц свойств в приложении MFC, отличный от элементов управления ActiveX см. в разделе [Страницы свойств](../mfc/property-sheets-mfc.md).  
  
##  <a name="_core_implementing_the_default_property_page"></a> Реализация свойства по умолчанию страницы  
 При использовании мастера элементов управления ActiveX для создания проекта элемента управления, то мастер элемент управления ActiveX предоставляет класс страницы свойств по умолчанию для элемента управления, производного от [COlePropertyPage Class](../mfc/reference/colepropertypage-class.md).  Изначально, эта страница свойств пуста, но можно добавлять любые элемент управления или набора элементов управления диалогового окна на него.  Поскольку мастера элементов управления ActiveX создает только один класс страницы свойств по умолчанию, дополнительные страницы свойств \(также классы, производные от `COlePropertyPage`\) должен быть создан с помощью представления классов.  Дополнительные сведения об этой процедуре см. в разделе [Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств](../mfc/mfc-activex-controls-adding-another-custom-property-page.md).  
  
 Реализация страницы свойств \(в данном случае по умолчанию\) — двухступенчатый процесс 3:  
  
#### Реализация страницы свойств  
  
1.  Добавьте `COlePropertyPage`\- производного класса в проект элемента управления.  Если проект был создан с помощью мастера элементов управления ActiveX \(как в этом случае\), класс страницы свойств по умолчанию уже существует.  
  
2.  Использование редактора диалоговых окон, чтобы добавить все элементы управления в шаблон страницы свойств.  
  
3.  Настраивать функции `COlePropertyPage`\- производный класс `DoDataExchange` в меновым стоимостям между элементом управления и страницы свойств элемента управления ActiveX.  
  
 Например, следующие цели процедурами с самым простым примером элемента управления \(«»\).  Пример был создан с помощью мастера элементов управления ActiveX и содержит только свойство заголовка для хранения.  
  
##  <a name="_core_adding_controls_to_a_property_page"></a> Добавление элементов управления на страницу свойств  
  
#### Добавление элементов управления на страницу свойств  
  
1.  С проектом элемента управления открытым, откройте представление ресурсов.  
  
2.  Дважды щелкните Значок каталога **Диалоговое окно**.  
  
3.  Открытие диалогового окна **IDD\_PROPPAGE\_SAMPLE** .  
  
     Мастер элементов управления ActiveX добавляет имя проекта в конец идентификатор диалогового окна, в этом случае пример.  
  
4.  Перетаскивание выбранного элемента управления из панели элементов в область диалогового окна.  
  
5.  Для этого примера заголовок элемента управления текстовой подписи «: » и " поля ввода с идентификатором **IDC\_CAPTION** достаточно.  
  
6.  Щелкните **Сохранить** на панели инструментов для сохранения изменений.  
  
 Теперь, когда пользовательский интерфейс был изменен, необходимо связать поле ввода со свойством заголовка.  Это можно сделать в следующем разделе можно изменить с помощью функции `CSamplePropPage::DoDataExchange`.  
  
##  <a name="_core_customizing_the_dodataexchange_function"></a> Настраивать функции DoDataExchange  
 Чтобы функциональность [CWnd::DoDataExchange](../Topic/CWnd::DoDataExchange.md) страницы свойств позволяет производить страницы свойств ссылки с фактическими значениями свойств в элементе управления.  Чтобы задать ссылки, необходимо сопоставить соответствующие поля страницы свойств к соответствующим свойствам элемента управления.  
  
 Эти сопоставления реализуются с помощью функции **DDP\_** страницы свойств.  Функция **DDP\_** работает подобно функции **DDX\_**, используемые в стандартных диалоговых окнах MFC с одним исключением.  В дополнение к ссылке на переменные\-члену, функции **DDP\_** имеют имя свойства элемента управления.  Ниже представлена типичная запись в функции `DoDataExchange` для страницы свойств.  
  
 [!code-cpp[NVC_MFC_AxUI#31](../mfc/codesnippet/CPP/mfc-activex-controls-property-pages_1.cpp)]  
  
 Эта функция связывает переменную\-член `m_caption` страницы свойств с заголовком, с помощью функции `DDP_TEXT`.  
  
 После получения элемента управления страницы свойств intellisense, необходимо установить связь между элементом управления страницы свойств, `IDC_CAPTION` и фактическим свойством элемента управления, заголовком, с помощью функции **DDP\_Text**, как описано выше.  
  
 [Страницы свойств](../mfc/reference/property-pages-mfc.md) доступен для других типов элементов управления диалогового окна, например флажки, переключатели и списки.  В следующей таблице перечислены полный набор функций **DDP\_** страницы свойств и их целях.  
  
### Функции страницы свойств  
  
|Имя функции.|Используйте эту функцию для связывания|  
|------------------|--------------------------------------------|  
|`DDP_CBIndex`|Индекс выбранной строки в поле со списком со свойством элемента управления.|  
|`DDP_CBString`|Выбранная строка в поле со списком со свойством элемента управления.  Выделенной строке может начинаться с тем же значением свойства букв, но не обязательно должно соответствовать этим полностью.|  
|`DDP_CBStringExact`|Выбранная строка в поле со списком со свойством элемента управления.  Выбранная строка и строковое значение свойства должны в точности совпадать.|  
|`DDP_Check`|Флажок со свойством элемента управления.|  
|`DDP_LBIndex`|Индекс выбранной строки в списке со свойством элемента управления.|  
|`DDP_LBString`|Выбранная строка в списке со свойством элемента управления.  Выделенной строке может начинаться с тем же значением свойства букв, но не обязательно должно соответствовать этим полностью.|  
|`DDP_LBStringExact`|Выбранная строка в списке со свойством элемента управления.  Выбранная строка и строковое значение свойства должны в точности совпадать.|  
|`DDP_Radio`|Переключатель со свойством элемента управления.|  
|**DDP\_Text**|Текст со свойством элемента управления.|  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)   
 [COlePropertyPage Class](../mfc/reference/colepropertypage-class.md)