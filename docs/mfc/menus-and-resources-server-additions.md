---
title: 'Меню и ресурсы: Добавление серверов | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- IDP_OLE_INIT_FAILED
dev_langs:
- C++
helpviewer_keywords:
- OLE visual editing servers [MFC]
- accelerator tables [MFC], server applications
- visual editing [MFC], application menus and resources
- server applications [MFC], accelerator table
- string tables [MFC], visual editing applications
- servers [MFC], menu additions
- resources [MFC], server applications
- OLE server applications [MFC], menus and resources
- string editing [MFC], visual editing applications
- IDP_OLE_INIT_FAILED macro [MFC]
- server applications [MFC], OLE menus and resources
- OLE initialization failure [MFC]
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 86b941820b439afc8b914142b412995df30f109c
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="menus-and-resources-server-additions"></a>Меню и ресурсы. Добавление серверов
В этой статье описываются изменения, которые должны быть выполнены с меню и другими ресурсами в приложении сервера (компонент) визуального редактирования. Серверное приложение требует много добавлений к структуре меню и другие ресурсы, так как его можно запускать в одном из трех режимов: автономный отдельно внедренный, или на месте. Как описано в [меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md) статью, существует более четырех наборов меню. Все четыре используются для полный сервер MDI-приложения, то время как для miniserver используются только трех. Приложения будет создан макет меню необходимо, чтобы тип сервера, который требуется. Может потребоваться настройка некоторых.  
  
 Если не используется в мастере приложений, можно рассмотреть HIERSVR. Версия-Кандидат, сценарий ресурса для образца приложения MFC [HIERSVR](../visual-cpp-samples.md), чтобы увидеть, как реализованы следующие изменения.  
  
 В этой статье рассматриваются:  
  
-   [Добавление серверов меню](#_core_server_menu_additions)  
  
-   [Добавление таблицы сочетаний клавиш](#_core_server_application_accelerator_table_additions)  
  
-   [Строка таблицы дополнения](../mfc/menus-and-resources-container-additions.md)  
  
-   [Miniserver дополнения](#_core_mini.2d.server_additions)  
  
##  <a name="_core_server_menu_additions"></a> Добавление серверов меню  
 Приложения сервера (компонент) должны иметь ресурсов меню, добавленные для поддержки визуального редактирования OLE. Меню, используемые при запуске приложения в изолированном режиме не нужно изменить, но для создания приложения необходимо добавить два новых ресурсов меню: один для поддержки активации на месте и один для поддержки сервера полностью открытыми. Full и miniserver приложениях используются оба ресурса меню.  
  
-   Для поддержки активации на месте, необходимо создать ресурс меню, которая очень похожа на ресурс меню, используемые при запуске в изолированном режиме. Разница в это меню является файл и окно и элементы (и других пунктов меню, которые работают с приложением, а не данные) отсутствует. Приложения-контейнера предоставит этих пунктов меню. Дополнительные сведения о, и примером, этот способ слияния меню, см. в статье [меню и ресурсы: слияние меню](../mfc/menus-and-resources-menu-merging.md).  
  
-   Для поддержки активации полностью открытыми, необходимо создать ресурс меню почти идентична меню ресурса, используемого при работе в автономном режиме. Единственное изменение, этот ресурс меню —, чтобы отразить тот факт, что сервер работает на элемент, внедренных в составных документов изменена формулировка некоторые элементы.  
  
 Помимо изменений, описанных в этой статье должен включать AFXOLESV файла ресурсов. Версия-Кандидат, необходимый для реализации библиотеки классов Microsoft Foundation. Этот файл расположен в подкаталоге MFC\Include.  
  
##  <a name="_core_server_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш для серверов приложений  
 Необходимо добавить два новых ресурсов таблицы сочетаний клавиш для сервера приложений; они соответствуют непосредственно новые ресурсы меню описано выше. В первой таблице сочетаний клавиш используется при активации приложения сервера на месте. Он состоит из всех записей в таблице сочетаний клавиш для этого представления, за исключением тех, привязан к файлу и окно меню.  
  
 Во второй таблице является почти точную копию этого представления таблицы сочетаний клавиш. Все различия параллельных изменений, внесенных в полностью открыть меню, упомянутые в [меню Добавление серверов](#_core_server_menu_additions).  
  
 Пример эти изменения таблицы сочетаний клавиш, сравните **IDR_HIERSVRTYPE_SRVR_IP** и **IDR_HIERSVRTYPE_SRVR_EMB** таблицы сочетаний клавиш с **IDR_MAINFRAME** в HIERSVR. В примере MFC OLE RC-файле [HIERSVR](../visual-cpp-samples.md). Акселераторы файл и окна отсутствуют в таблице на месте и точные копии находятся в вложенную таблицу.  
  
##  <a name="_core_string_table_additions_for_server_applications"></a> Строка таблицы дополнения для серверных приложений  
 Добавление только одна строка таблицы необходим в серверном приложении — строку для обозначения того, что не удалось выполнить инициализацию OLE. Например вот запись таблицу строк, сформированному мастером приложений.  
  
|ID|String|  
|--------|------------|  
|**IDP_OLE_INIT_FAILED**|Не удалось выполнить инициализацию OLE. Убедитесь в наличии правильной версии библиотек OLE.|  
  
##  <a name="_core_mini.2d.server_additions"></a> Miniserver дополнения  
 Применить же дополнения для miniservers от описанного выше для серверов full. Поскольку miniserver не может выполняться в автономном режиме, его главного меню намного меньше. В главном меню, созданные с помощью мастера приложений есть только меню файл, содержащий только элементы, выхода и о. Внедренные и на месте меню и сочетания клавиш для miniservers совпадают для серверов full.  
  
## <a name="see-also"></a>См. также  
 [Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)   
 [Меню и ресурсы. Слияние меню](../mfc/menus-and-resources-menu-merging.md)

