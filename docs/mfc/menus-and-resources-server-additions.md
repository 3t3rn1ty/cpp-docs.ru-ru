---
title: "Меню и ресурсы. Добавление серверов | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "IDP_OLE_INIT_FAILED"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "таблицы сочетаний клавиш [C++], серверные приложения"
  - "IDP_OLE_INIT_FAILED - макрос"
  - "сбой инициализации OLE"
  - "приложения сервера OLE, меню и ресурсы"
  - "серверы визуального редактирования OLE"
  - "ресурсы [MFC], серверные приложения"
  - "серверные приложения, таблица сочетаний клавиш"
  - "серверные приложения, Меню и ресурсы OLE"
  - "серверы, добавления меню"
  - "редактирование строк, приложения визуального редактирования"
  - "таблицы строк, приложения визуального редактирования"
  - "визуальное редактирование, меню и ресурсы приложений"
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
caps.latest.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Меню и ресурсы. Добавление серверов
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этой статье описывается изменения, которые необходимо выполнить в меню и другим ресурсам в приложении сервера визуального редактирования \(компонента\).  Серверное приложение требует много добавлений к структуре меню и другие ресурсы, поскольку его можно запустить в одном из режимов: 3 автономный, внедренный на месте.  Как описано в статье [Меню и ресурсы \(OLE\)](../mfc/menus-and-resources-ole.md), максимум 4 наборов меню.  Все 4 используются для приложения с сервера MDI, а только 3 используются для miniserver.  Мастер приложений создается макет меню необходимый для типа сервера требуется.  Некоторые настройки может быть необходима.  
  
 Если мастер не используется приложений, может понадобиться просмотреть HIERSVR.RC скрипт ресурсов, пример приложения MFC [HIERSVR](../top/visual-cpp-samples.md), чтобы посмотреть, как этих изменений.  
  
 Разделы описанные в этой статье:  
  
-   [Добавление меню сервера](#_core_server_menu_additions)  
  
-   [Добавление таблицы сочетаний клавиш](#_core_server_application_accelerator_table_additions)  
  
-   [Добавление строк таблицы](../mfc/menus-and-resources-container-additions.md)  
  
-   [Добавление Miniserver](#_core_mini.2d.server_additions)  
  
##  <a name="_core_server_menu_additions"></a> Добавление меню сервера  
 Приложения сервера \(компонента\) должны иметь ресурсов меню, добавляемые в поддержки OLE визуального редактирования.  Используемые меню при запуске приложения в изолированном режиме не должны быть изменены, но необходимо добавить 2 новых ресурсов меню до построения приложения. одно для поддержки встроенной активации и один для поддержки сервер может полностью открыты.  Оба ресурсов меню используются приложениями \(и miniserver.  
  
-   Для поддержки встроенной активации необходимо создать ресурс меню, очень похож на ресурс меню, используемые при запуске в изолированном режиме.  Различие в этом меню, что элементы файла и окна \(и все остальные пункты меню, которые работают с приложением, а не данные\) отсутствует.  Контейнерное приложение будет эти пункты меню.  Дополнительные сведения о и примеры, этот метод возврата слияния см. в статье [Меню и ресурсы: Слияния меню](../mfc/menus-and-resources-menu-merging.md).  
  
-   Для поддержки полностью открытую активацию необходимо создать ресурс меню практически аналогична ресурс меню, используемые при запуске в изолированном режиме.  Единственное изменение в этот ресурс меню, некоторые элементы reworded, чтобы отразить факт, сервер работает в составном элементе встроенной в документе.  
  
 Помимо изменения из этого раздела, представленный в файл ресурсов необходимо включить AFXOLESV.RC, что необходимо для реализации библиотеки Microsoft Foundation Class.  Этот файл находится в подкаталоге MFC\\Include.  
  
##  <a name="_core_server_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш серверного приложения  
 2 Новых ресурсов таблицы сочетаний клавиш для добавления к серверным приложениям. они соответствуют непосредственно к новым ранее описанным ресурсам меню.  Первая таблица сочетаний клавиш используется, когда серверное приложение активировано на месте.  Он состоит из всех записей в таблице сочетаний клавиш представления, кроме тех связанной в файл и меню окна.  
  
 Вторая таблица почти точное копии таблицы сочетаний клавиш представления.  Любые изменения, внесенные в открытом различий параллельных полностью меню упомянутом в [Добавление меню сервера](#_core_server_menu_additions).  
  
 Пример эти изменения таблицы сочетаний клавиш, сравнение таблицы сочетаний клавиш **IDR\_HIERSVRTYPE\_SRVR\_IP** и **IDR\_HIERSVRTYPE\_SRVR\_EMB** с **IDR\_MAINFRAME** в файле HIERSVR.RC включенного в примере MFC [HIERSVR](../top/visual-cpp-samples.md) OLE.  Сочетания клавиш файла и окна отсутствует в на месте таблицы и точные копии их внедренной в таблице.  
  
##  <a name="_core_string_table_additions_for_server_applications"></a> Добавление таблицы строк для серверных приложений  
 Только одно добавление строк таблицы требуется в серверном приложении — строки, чтобы знаменовать, что инициализация OLE завершается ошибкой.  Например, ниже запись со строками таблицы, мастер создает приложений:  
  
|Идентификатор|Строковое|  
|-------------------|---------------|  
|**IDP\_OLE\_INIT\_FAILED**|Не удалось выполнить инициализацию OLE.  Убедитесь в том, что используются правильные версии библиотек OLE.|  
  
##  <a name="_core_mini.2d.server_additions"></a> Добавление Miniserver  
 Те же дополнения применяются для miniservers их перечисленные выше для всего сервера.  Поскольку miniserver не может быть выполнено в изолированном режиме свое главное меню меньшего.  Главное меню, созданное мастером приложений имеет только меню Файл, содержащий только выход элементов и происходит.  Встроенный и на месте меню и сочетаний клавиш для miniservers одинаково их для всего сервера.  
  
## См. также  
 [Меню и ресурсы \(OLE\)](../mfc/menus-and-resources-ole.md)   
 [Меню и ресурсы. Слияние меню](../mfc/menus-and-resources-menu-merging.md)