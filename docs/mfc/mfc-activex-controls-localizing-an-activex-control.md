---
title: "Элементы управления ActiveX MFC: Локализация элемента управления ActiveX | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- LocaleID
- AfxOleRegisterTypeLib
dev_langs:
- C++
helpviewer_keywords:
- localization, ActiveX controls
- MFC ActiveX controls [MFC], localizing
- LocaleID ambient property [MFC]
- LOCALIZE sample [MFC]
ms.assetid: a44b839a-c652-4ec5-b824-04392708a5f9
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: fd6384507982f74e02e8e4f42c97926f9125981e
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="mfc-activex-controls-localizing-an-activex-control"></a>Элементы управления ActiveX в MFC. Локализация элемента управления ActiveX
В этой статье рассматриваются процедуры для локализации интерфейсов элемента управления ActiveX.  
  
 Если вы хотите адаптировать элемент управления ActiveX для международных рынков, можно локализовать элемента управления. Windows поддерживает многие языки помимо Английский, немецкий, французский, а шведский по умолчанию. Это может представлять проблемы для элемента управления, если его интерфейс использует только английский язык.  
  
 Как правило элементы управления ActiveX всегда следует определять их языкового стандарта по внешнее свойство LocaleID. Это можно сделать тремя способами:  
  
-   Загрузка ресурсов, всегда по требованию, на основе текущего значения свойства окружения LocaleID. MFC ActiveX-элементы управления образец [LOCALIZE](../visual-cpp-samples.md) использует эту стратегию.  
  
-   Загрузка ресурсов, когда первый элемент управления создается на основе свойства окружения LocaleID и использовать эти ресурсы для всех экземпляров. В этой статье демонстрируется этой стратегии.  
  
    > [!NOTE]
    >  Это не будет работать в некоторых случаях, если будущие экземпляры имеют разных языков.  
  
-   Используйте **OnAmbientChanged** функция уведомления динамическую загрузку соответствующих ресурсов для языкового стандарта для контейнера.  
  
    > [!NOTE]
    >  Это будет работать для элемента управления, но DLL во время выполнения не будут обновляться динамически собственными ресурсами когда изменяется внешнее свойство LocaleID. Кроме того библиотеки DLL времени выполнения для элементов управления ActiveX использовать языковой стандарт потока для определения языковой стандарт для его ресурсы.  
  
 В оставшейся части этой статьи описаны две стратегии локализацию. Первая стратегия [интерфейса программирования элемента управления есть перевод](#_core_localizing_your_control.92.s_programmability_interface) (имена свойств, методов и событий). Вторая стратегия [пользовательский интерфейс элемента управления есть перевод](#_core_localizing_the_control.92.s_user_interface), с помощью внешнего LocaleID свойства контейнера. Демонстрационное локализации элемента управления, см. Пример элементов управления MFC ActiveX [LOCALIZE](../visual-cpp-samples.md).  
  
##  <a name="_core_localizing_your_control.92.s_programmability_interface"></a>Локализация интерфейса программирования элемента управления  
 При локализации интерфейса программирования элемента управления (интерфейс используется программистами, написание приложений, использующих элемент управления), необходимо создать измененную версию элемента управления. IDL файла (скрипт для создания библиотеки типов элемента управления) для каждого языка, который вы собираетесь поддерживать. Это единственное место, необходимо локализовать имена свойств элемента управления.  
  
 При разработке локализованного управления включают идентификатор языка как атрибут на уровне библиотеки типов. Например если вы хотите предоставить имена французский локализованные свойства библиотеки типов, создается копия ПРИМЕРА. IDL файла и назовите его SAMPLEFR. IDL. Добавление атрибута идентификатор языкового стандарта (код языка для французского языка — 0x040c) файла, следующим образом:  
  
 [!code-cpp[NVC_MFC_AxLoc#1](../mfc/codesnippet/cpp/mfc-activex-controls-localizing-an-activex-control_1.idl)]  
  
 Измените имена свойств в SAMPLEFR. IDL для их эквиваленты для французского языка, а затем использовать MKTYPLIB. EXE-файла для создания французского библиотеки SAMPLEFR типов. TLB.  
  
 Чтобы создать несколько библиотек типов локализованных можно добавить любую локализованы. IDL файлы в проект, и они будут сформированы автоматически.  
  
#### <a name="to-add-an-idl-file-to-your-activex-control-project"></a>Для добавления. IDL-файл в проект элемента управления ActiveX  
  
1.  С открыто, в проект элемента управления **проекта** меню, нажмите кнопку **Добавление существующего элемента**.  
  
     **Добавление существующего элемента** откроется диалоговое окно.  
  
2.  При необходимости выберите диск и каталог для просмотра.  
  
3.  В **тип файлов** выберите **все файлы (\*.\*)** .  
  
4.  Дважды щелкните в списке файлов. Файл IDL, который требуется вставить в проект.  
  
5.  Нажмите кнопку **откройте** после добавления всех необходимых. IDL-файлы.  
  
 Так как файлы были добавлены в проект, они будут сформированы при построении остальную часть проекта. Библиотеки типов локализованных расположены в текущем каталоге проекта элемента управления ActiveX.  
  
 Внутри кода имена внутренних свойств (обычно на английском языке) всегда используются и никогда не локализованы. Сюда входят диспетчеризации карту элементов управления, функции обмена данными свойство и код свойства страницы данных exchange.  
  
 Только один тип библиотеки (. Файл TLB) могут быть привязаны в ресурсы реализации элемента управления (. Файл OCX). Обычно это версия с стандартизированные (как правило, на английском языке) имена. Чтобы поставить локализованную версию элемента управления необходимо поставить. OCX (который уже привязано к значение по умолчанию. Версия TLB) и. TLB для соответствующего языка. Это означает, что только. После правильного для английской версии требуется OCX. TLB уже привязан к нему. Для других версий библиотеки типов локализованных также должны прилагаться к. OCX.  
  
 Чтобы убедиться, что клиенты элемента управления можно найти локализованные тип библиотеки, зарегистрируйте определенного языкового стандарта. TLB-файлы в разделе "TypeLib" реестра Windows. Третий параметр (обычно необязательно) [AfxOleRegisterTypeLib](../mfc/reference/registering-ole-controls.md#afxoleregistertypelib) функция предназначена для этой цели. В следующем примере регистрируется библиотеку французский типов для элемента управления ActiveX:  
  
 [!code-cpp[NVC_MFC_AxLoc#2](../mfc/codesnippet/cpp/mfc-activex-controls-localizing-an-activex-control_2.cpp)]  
  
 При регистрации управления `AfxOleRegisterTypeLib` функция автоматически ищет указанный. TLB-файл в том же каталоге, что и элемент управления и регистрирует его в регистрационную базу данных Windows. Если. TLB-файл не найден, функция не делает ничего.  
  
##  <a name="_core_localizing_the_control.92.s_user_interface"></a>Локализация элемента управления пользовательского интерфейса  
 Для локализации элемента управления пользовательского интерфейса, поместите все ресурсы видимыми элемента управления (например, страницы свойств и сообщения об ошибках) в DLL-файлы ресурсов для конкретного языка. Затем можно использовать внешнее свойство LocaleID контейнера для выбора соответствующего библиотеки DLL для языковой стандарт пользователя.  
  
 В следующем примере кода демонстрируется один из подходов для поиска и загрузки DLL-Библиотеки ресурсов для конкретного языка. Эта функция-член, вызывается `GetLocalizedResourceHandle` для этого примера может быть функции-члена класса элемента управления ActiveX:  
  
 [!code-cpp[NVC_MFC_AxLoc#3](../mfc/codesnippet/cpp/mfc-activex-controls-localizing-an-activex-control_3.cpp)]  
  
 Обратите внимание, проверку диалекте идентификатор каждого варианта в операторе switch для обеспечения более специализированные локализации. Демонстрацию этой функции см. в разделе `GetResourceHandle` функции в MFC ActiveX управляет образец [LOCALIZE](../visual-cpp-samples.md).  
  
 Когда элемент управления сначала загружается в контейнер, он может вызвать [COleControl::AmbientLocaleID](../mfc/reference/colecontrol-class.md#ambientlocaleid) для получения идентификатора языка. Элемент управления, затем можно передать значение возвращаемой локали для `GetLocalizedResourceHandle` функции, которая загружает библиотеку ресурсов. Элемент управления должен передавать полученный дескриптор, если таковые имеются, для [AfxSetResourceHandle](../mfc/reference/application-information-and-management.md#afxsetresourcehandle):  
  
 [!code-cpp[NVC_MFC_AxLoc#4](../mfc/codesnippet/cpp/mfc-activex-controls-localizing-an-activex-control_4.cpp)]  
  
 Поместите в образце кода выше в функции-члене класса элемента управления, например переопределение [COleControl::OnSetClientSite](../mfc/reference/colecontrol-class.md#onsetclientsite). Кроме того `m_hResDLL` должно быть переменной-члена класса элемента управления.  
  
 Аналогичная логика можно использовать для локализации страницы свойств элемента управления. Для локализации на странице свойств, добавление кода, похожего на следующий пример файла реализации страницу свойств (в переопределении [COlePropertyPage::OnSetPageSite](../mfc/reference/colepropertypage-class.md#onsetpagesite)):  
  
 [!code-cpp[NVC_MFC_AxLoc#5](../mfc/codesnippet/cpp/mfc-activex-controls-localizing-an-activex-control_5.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)

