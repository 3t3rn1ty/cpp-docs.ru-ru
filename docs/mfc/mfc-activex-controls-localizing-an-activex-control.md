---
title: "Элементы управления ActiveX в MFC. Локализация элемента управления ActiveX | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "LocaleID"
  - "AfxOleRegisterTypeLib"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "LocaleID - внешнее свойство"
  - "локализация, элементы управления ActiveX"
  - "LOCALIZE - пример [MFC]"
  - "MFC ActiveX - элементы управления, локализация"
ms.assetid: a44b839a-c652-4ec5-b824-04392708a5f9
caps.latest.revision: 12
caps.handback.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Элементы управления ActiveX в MFC. Локализация элемента управления ActiveX
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Этот раздел описывает процедуры для локализации интерфейсы элемента управления ActiveX.  
  
 Если необходимо разместить элемент управления ActiveX к международному рынку, может понадобиться локализации элемент управления.  Windows поддерживает множество языков, помимо английский язык по умолчанию, включая, французский, немецкий и шведском языке.  Это может представлять проблемы для элемента управления, если его интерфейс на английском языке\).  
  
 Как правило, элементы управления ActiveX всегда следует основывать их языковой стандарт в свойстве окружающем LocaleID.  Это можно сделать тремя способами:  
  
-   Загрузите ресурсы, всегда по требованию, в зависимости от текущего значения окружающего свойства LocaleID.  Пример элемента управления ActiveX MFC [ЛОКАЛИЗУЙТЕ](../top/visual-cpp-samples.md) использует эту стратегию.  
  
-   Загрузка ресурсов, если приведен в примере первый элемент управления, основанные на свойстве окружающем LocaleID, и использовать эти ресурсы для всех других экземпляров.  Этот раздел демонстрирует эту стратегию.  
  
    > [!NOTE]
    >  Это не будет работать правильно в некоторых случаях, если будущие экземпляры имеют разные языковые стандарты.  
  
-   Используйте функцию уведомления **OnAmbientChanged** динамически для загрузки и ресурсы для языкового стандарта контейнера.  
  
    > [!NOTE]
    >  Это будет работать для элемента управления, но во время выполнения библиотеки DLL, динамически не обновляет свои собственные ресурсы при при изменении свойства LocaleID.  Кроме того, во время выполнения DLL для элементов управления ActiveX используют языковой стандарт потока для идентификации языковой стандарт для своих ресурсов.  
  
 В оставшейся части этой статьи описаны 2 локализация стратегии.  Первая стратегия [возможность локализовать интерфейса элемента управления](#_core_localizing_your_control.92.s_programmability_interface) \(имена свойств, методов и событий\).  Второе [определенный язык и региональные параметры пользовательского интерфейса элемента управления](#_core_localizing_the_control.92.s_user_interface) стратегии, с помощью свойства контейнера окружающее LocaleID.  Для демонстрации локализации элемента управления см. в разделе [ЛОКАЛИЗУЙТЕ](../top/visual-cpp-samples.md) элементов управления ActiveX MFC.  
  
##  <a name="_core_localizing_your_control.92.s_programmability_interface"></a> Возможность локализации интерфейса элемента управления  
 Локализация интерфейс возможность элемента управления \(интерфейс, используемый программистами при написании приложений, использующих элемент управления\), необходимо создать измененную версию файла элемента управления .IDL \(скрипта для построения библиотеки типа элемента управления\) для каждого языка планируется поддерживать.  Это единственное место необходимо локализации имена свойств элемента управления.  
  
 При разработке локализованный элемент управления, разрешение кода языка как атрибут на уровне библиотеки типов.  Например, если нужно обеспечить библиотеку типов с именами свойств локализованными французом, добавление копии из файла SAMPLE.IDL и назовите его SAMPLEFR.IDL.  Добавьте атрибут кода языка в файл \(код языка для французского языка 0x040C \-\), подобному следующим образом:  
  
 [!code-cpp[NVC_MFC_AxLoc#1](../mfc/codesnippet/CPP/mfc-activex-controls-localizing-an-activex-control_1.idl)]  
  
 Измените имена свойств в SAMPLEFR.IDL их французским эквивалентами, а затем использовать MKTYPLIB.EXE для создания французскую библиотеки типов, SAMPLEFR.TLB.  
  
 Создание библиотеки типов локализованные несколько условных определений можно добавить все локализованные файлы .IDL в проект, и они будут созданы автоматически.  
  
#### Добавление файла .IDL в проект элемент управления ActiveX  
  
1.  С проектом элемента управления открыт, в меню **Проект** , щелкните **Добавление существующего элемента**.  
  
     Откроется диалоговое окно  **Добавление существующего элемента**.  
  
2.  При необходимости выберите диск и каталог для просмотра.  
  
3.  В поле **Тип файлов**, выберите **Все файлы \(\*.\*\)**.  
  
4.  В поле списка файлов, дважды щелкните файл .IDL необходимо добавить в проект.  
  
5.  Нажмите **Открыть** при добавлении все необходимые файлы .IDL.  
  
 Поскольку файлы были добавлены к проекту, они будут созданы при будут построены остальной части проекта.  Локализованные библиотеки типов находятся в текущем каталоге проекта элемента управления ActiveX.  
  
 Внутри кода, внутренние имена свойств \(обычно на английском языке\) всегда используются и никогда не локализованы.  Это включает в себя схему подготовки к отправке элемента управления, функции обмена свойства, и код обмена данными страницы свойств.  
  
 Только один файл библиотеки \(.TLB\) может быть привязан в файл ресурсов реализации элемента управления \(.OCX\).  Обычно это версия со стандартизированными \(обычно английский\) именами.  Выпуск локализованной версии элемента управления необходимо предоставить .OCX \(, которое уже было привязано к версии по умолчанию .TLB\) и .TLB соответствующего языкового стандарта.  Это означает, что только необходимые для .OCX английских версиях, поскольку правильное .TLB уже было привязано к нему.  Для других версий локализованной библиотеки типов также необходимо сделать с .OCX.  
  
 Чтобы убедиться, что клиенты элемента управления могут найти локализованной библиотеки типов, зарегистрируйте файлы языкового стандарта. .TLB в разделе библиотеки типов системного реестра Windows.  Третий параметр \(необязательно\) обычно функции [AfxOleRegisterTypeLib](../Topic/AfxOleRegisterTypeLib.md) используется для этой цели.  В следующем примере регистрируется французская библиотеку типов для элемента управления ActiveX.  
  
 [!code-cpp[NVC_MFC_AxLoc#2](../mfc/codesnippet/CPP/mfc-activex-controls-localizing-an-activex-control_2.cpp)]  
  
 Если элемент управления зарегистрирован, функция `AfxOleRegisterTypeLib` автоматически ищет указанный файл .TLB в том же каталоге, что и элемент управления и регистрирует их в базе данных регистрации Windows.  Если файл .TLB не найден, то функция не имеет эффекта.  
  
##  <a name="_core_localizing_the_control.92.s_user_interface"></a> Локализацию пользовательского интерфейса элемента управления  
 Чтобы локализацию пользовательского интерфейса элемента управления, установите ресурсы всего элемента управления пользователем видимые \(например, страницы свойств и сообщения об ошибках\) в языковые библиотеки ресурсов.  Затем можно использовать свойства контейнера окружающее LocaleID для выделения соответствующее библиотеки DLL для языкового стандарта пользователя.  
  
 В следующем примере кода показан один из способов для обнаружения и загрузки библиотеки ресурсов для конкретного языкового стандарта.  Этот вызывается функция\-член, `GetLocalizedResourceHandle` для этого примера, может быть функцией\-членом класса элемента управления ActiveX.  
  
 [!code-cpp[NVC_MFC_AxLoc#3](../mfc/codesnippet/CPP/mfc-activex-controls-localizing-an-activex-control_3.cpp)]  
  
 Обратите внимание, что идентификатор варианта языка может быть возвращены каждый случай оператор switch, чтобы обеспечить более специализированного локализации.  Для демонстрации этой функции см. функцию `GetResourceHandle` в примере элементов управления ActiveX MFC [ЛОКАЛИЗУЙТЕ](../top/visual-cpp-samples.md).  
  
 Если элемент управления первое загрузку в контейнер, он может вызвать метод [COleControl::AmbientLocaleID](../Topic/COleControl::AmbientLocaleID.md), чтобы получить идентификатор языкового стандарта  Элемент управления может передать возвращенный код языка значение функции `GetLocalizedResourceHandle`, которая загружает правильную библиотеку ресурса.  Элемент управления должен передать результирующее дескриптор, если таковые имеются, в [AfxSetResourceHandle](../Topic/AfxSetResourceHandle.md), выполните следующие действия.  
  
 [!code-cpp[NVC_MFC_AxLoc#4](../mfc/codesnippet/CPP/mfc-activex-controls-localizing-an-activex-control_4.cpp)]  
  
 Поместите приведенный выше пример в функции\-члена элемента управления, как переопределить [COleControl::OnSetClientSite](../Topic/COleControl::OnSetClientSite.md).  Кроме того, `m_hResDLL` должно быть переменной\-членом класса элемента управления.  
  
 Можно использовать похожую логику для локализации страницы свойств для элемента управления.  Для локализации страницы свойств добавьте код аналогичный следующему примеру в файл реализации страницы свойств \(при переопределении [COlePropertyPage::OnSetPageSite](../Topic/COlePropertyPage::OnSetPageSite.md)\).  
  
 [!code-cpp[NVC_MFC_AxLoc#5](../mfc/codesnippet/CPP/mfc-activex-controls-localizing-an-activex-control_5.cpp)]  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)