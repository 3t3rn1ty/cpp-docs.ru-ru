---
title: "Буфер обмена: Копирование и вставка данных | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- Clipboard, copying data to
- Clipboard, pasting
ms.assetid: 580e10be-241f-4f9f-94cf-8302edc5beef
caps.latest.revision: "10"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 6d76be3bd3863826391cc812f17dca88cb3a5457
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="clipboard-copying-and-pasting-data"></a>Буфер обмена. Копирование и вставка данных
В этом разделе описываются минимальные действия, необходимые для реализации копирования и вставки из буфера обмена в приложениях OLE. Рекомендуется ознакомиться с [объектов данных и источники данных (OLE)](../mfc/data-objects-and-data-sources-ole.md) разделы перед продолжением.  
  
 Прежде чем можно реализовать, копирование и вставка, прежде всего необходимо указать функции для обработки параметров копирования, вырезания и вставки на меню "Правка".  
  
##  <a name="_core_copying_or_cutting_data"></a>Копирование или копирование данных  
  
#### <a name="to-copy-data-to-the-clipboard"></a>Чтобы скопировать данные в буфер обмена  
  
1.  Определите, содержится ли данных для копирования данных в собственном или внедренного или связанного элемента.  
  
    -   Если данные внедренным или связанным, получить указатель на `COleClientItem` объект, который был выбран.  
  
    -   Если данные в собственном и приложения — это сервер, создайте новый объект, производный от `COleServerItem` содержащий выбранные данные. В противном случае создайте `COleDataSource` объекта данных.  
  
2.  Вызовите выбранный элемент `CopyToClipboard` функции-члена.  
  
3.  Если пользователь решает операции вырезания вместо операции копирования, удаления выбранных данных из приложения.  
  
 В качестве примера данной последовательности, в разделе **OnEditCut** и **OnEditCopy** функции в MFC OLE-пример программы [OCLIENT](../visual-cpp-samples.md) и [HIERSVR](../visual-cpp-samples.md). Обратите внимание, что в этих примерах использовать указатель выбранных данных, уже выполнен шаг 1.  
  
##  <a name="_core_pasting_data"></a>Вставка данных  
 Вставка данных гораздо сложнее копирования, поскольку необходимо выбрать формат, используемый в Вставка данных в приложение.  
  
#### <a name="to-paste-data-from-the-clipboard"></a>Вставка данных из буфера обмена  
  
1.  В классе представления реализовать **OnEditPaste** для обслуживания пользователей, выбрав параметр вставки из меню "Правка".  
  
2.  В **OnEditPaste** функции, создайте `COleDataObject` и вызовите его `AttachClipboard` функции-члена для связывания этого объекта с данными в буфере обмена.  
  
3.  Вызовите `COleDataObject::IsDataAvailable` Чтобы проверить, доступен ли определенный формат.  
  
     Кроме того, можно использовать `COleDataObject::BeginEnumFormats` для поиска для других форматов, чтобы найти наиболее подходящий для вашего приложения.  
  
4.  Выполнение вставки формата.  
  
 Пример того, как это работает, в разделе реализации **OnEditPaste** функций-членов в представлении классов, определенных в MFC OLE примеров программ [OCLIENT](../visual-cpp-samples.md) и [HIERSVR](../visual-cpp-samples.md).  
  
> [!TIP]
>  Основные преимущества разделения операции вставки в его собственную функцию — при удалении приложения во время операции перетаскивания и вставки данных может использоваться один и тот же код вставки. Как и OCLIENT и HIERSVR вашей `OnDrop` функция также может вызывать **DoPasteItem**, повторное использование кода, написанного для реализации операции вставки.  
  
 Для обработки Специальная вставка параметра в меню Правка, см. в разделе [диалоговые окна в OLE](../mfc/dialog-boxes-in-ole.md).  
  
### <a name="what-do-you-want-to-know-more-about"></a>Выберите Дополнительные сведения  
  
-   [Добавление других форматов](../mfc/clipboard-adding-other-formats.md)  
  
-   [Объекты и данные источников данных OLE и универсальный передачи данных](../mfc/data-objects-and-data-sources-ole.md)  
  
-   [Перетаскивание OLE](../mfc/drag-and-drop-ole.md)  
  
-   [OLE](../mfc/ole-background.md)  
  
## <a name="see-also"></a>См. также  
 [Буфер обмена. Использование механизма буфера обмена OLE](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)

