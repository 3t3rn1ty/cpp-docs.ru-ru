---
title: "Буфер обмена. Добавление других форматов | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "буфер обмена, форматы"
  - "пользовательские форматы данных буфера обмена"
  - "пользовательские форматы"
  - "пользовательские форматы, размещение в буфере обмена"
  - "форматы [C++], буфер обмена"
  - "регистрация пользовательских форматов данных буфера обмена"
ms.assetid: aea58159-65ed-4385-aeaa-3d9d5281903b
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Буфер обмена. Добавление других форматов
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этом разделе объясняется, как развернуть список поддерживаемых форматов, особенно для поддержки OLE.  Раздел [Буфер обмена. Копирование и вставящ данные](../Topic/Clipboard:%20Copying%20and%20Pasting%20Data.md) описывает минимальную требуемую реализацию, что до скопировать и вставить из буфера обмена.  Если это все, реализуемые единственными форматы, помещенные в буфер обмена `CF_METAFILEPICT`, **CF\_EMBEDSOURCE**, **CF\_OBJECTDESCRIPTOR** и по возможности `CF_LINKSOURCE`.  Большинство приложений будут требуются дополнительные форматов в буфер обмена, чем эти 3.  
  
##  <a name="_core_registering_custom_formats"></a> Зарегистрировать пользовательские форматы  
 Чтобы создать собственные пользовательские форматы, выполните одну и ту же процедуру можно использовать при регистрации настраиваемый формат буфера обмена. передайте имя формата функции **RegisterClipboardFormat** и используйте его возвращаемое значение как идентификатор формата  
  
##  <a name="_core_placing_formats_on_the_clipboard"></a> Параметр форматы в буфер обмена  
 Для добавления дополнительных форматов для этих размещаться в буфер обмена необходимо переопределить функцию `OnGetClipboardData` в классе. вывели из `COleClientItem` или `COleServerItem` \(в зависимости от того, скопировать данные собственен\).  В этой функции необходимо использовать следующую процедуру.  
  
#### Установка форматы в буфер обмена  
  
1.  Создайте объект `COleDataSource`.  
  
2.  Передайте этот источник данных в функции, добавить собственные форматы данных в список поддерживаемых форматов путем вызова `COleDataSource::CacheGlobalData`.  
  
3.  Добавьте стандартные форматы путем вызова `COleDataSource::CacheGlobalData` для каждого стандартного формата для поддержки.  
  
 Этот метод используется в примере программы [HIERSVR](../top/visual-cpp-samples.md) MFC OLE \(просмотрите функции\-члена `OnGetClipboardData` класса **CServerItem** \).  Единственное отличие заключается в этом примере, раздел 3 не реализован, поскольку HIERSVR не поддерживает другие стандартные форматы.  
  
### Дополнительные сведения  
  
-   [Объекты OLE данных и источники данных и унифицированная передача данных](../mfc/data-objects-and-data-sources-ole.md)  
  
-   [Перетаскивание OLE](../mfc/drag-and-drop-ole.md)  
  
-   [OLE](../mfc/ole-background.md)  
  
## См. также  
 [Буфер обмена. Использование механизма буфера обмена OLE](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)