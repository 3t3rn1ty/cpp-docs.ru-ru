---
title: "Элементы управления ActiveX MFC | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: MFC ActiveX Controls (MFC)
dev_langs: C++
helpviewer_keywords:
- COleControl class [MFC], MFC ActiveX controls
- ActiveX controls [MFC], MFC
- containers [MFC], MFC ActiveX controls
- MFC ActiveX controls [MFC], serializing
- MFC ActiveX controls [MFC], containers
- serialization [MFC], MFC ActiveX controls
- dispatch maps [MFC], for MFC ActiveX controls
- MFC ActiveX controls [MFC], active/inactive state
- events [MFC], ActiveX controls
- MFC ActiveX controls [MFC]
ms.assetid: c911fb74-3afc-4bf3-a0f5-7922b14d9a1b
caps.latest.revision: "14"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: c06b66be2dd9b982fc925aa69483a58fcc4799dc
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="mfc-activex-controls"></a>Элементы управления ActiveX MFC
Элемент управления ActiveX — это компонент для повторного использования программного обеспечения, на основе на компонент объекта модели (COM), который поддерживает широкий набор функциональных возможностей OLE и может быть настроена в соответствии с потребностями многих программного обеспечения. Элементы управления ActiveX, предназначенных для использования в обычные контейнеры элементов управления ActiveX и в Интернете, в веб-страницы. Можно создавать элементы управления ActiveX в MFC, описанные здесь, или с [Active Template Library (ATL)](../atl/active-template-library-atl-concepts.md).  
  
 Себя нарисовать элемент управления ActiveX в отдельном окне реагировать на события (например, щелчки мышью) и управлять через интерфейс, который включает свойства и методы, сходные с именами объектов автоматизации.  
  
 Эти элементы управления могут разрабатываться для различных целей, таких как доступ к базе данных, данных наблюдения или построения диаграмм. Помимо их переносимость элементы управления ActiveX поддерживают функции были недоступны для элементов управления ActiveX, например совместимость с существующие OLE-контейнеры и возможность интеграции их меню с меню контейнера OLE. Кроме того элемент управления ActiveX полностью поддерживает автоматизации, которая позволяет элементу управления предоставлять свойства находится и набор методов, которые могут быть вызваны пользователем элемента управления.  
  
 Можно создать элементов управления ActiveX без окон и элементов управления, когда они становятся активными только создать окно. Элементы управления без окон ускорить отображение приложение и сделать ее могут присутствовать прозрачные и создания непрямоугольных элементов управления. Свойства элемента управления ActiveX также можно загрузить асинхронно.  
  
 Элемент управления ActiveX реализован в виде внутрипроцессного сервера (обычно маленьких объектов), который может использоваться в OLE-контейнер. Обратите внимание, что все функции элемента управления ActiveX доступны только при использовании в OLE-контейнер, предназначенного для элементов управления ActiveX. В разделе [порт элементы управления ActiveX для других приложений](../mfc/containers-for-activex-controls.md) список контейнеров, которые поддерживают элементы управления ActiveX. Этот тип контейнера, именуемые «контейнер элемента управления», могут работать элемент управления ActiveX с помощью свойств и методов элемента управления и получает уведомления из элемента управления ActiveX в форме событий. На следующем рисунке показано это взаимодействие.  
  
 ![Взаимозависимость контейнера элементов управления ActiveX и управления](../mfc/media/vc37221.gif "vc37221")  
Взаимодействие между контейнере элементов управления ActiveX и оконный элемент управления ActiveX  
  
 Некоторые последние сведения по оптимизации элементов управления ActiveX, в разделе [элементы управления MFC ActiveX: оптимизация](../mfc/mfc-activex-controls-optimization.md).  
  
 Создание элемента управления MFC ActiveX, в разделе [Создание проекта элемента управления ActiveX](../mfc/reference/mfc-activex-control-wizard.md).  
  
 Дополнительные сведения:  
  
-   [Контейнеры для элементов ActiveX](../mfc/activex-control-containers.md)  
  
-   [Активные документы](../mfc/active-documents.md)  
  
-   [Основные сведения о элементы управления ActiveX](http://msdn.microsoft.com/library/windows/desktop/ms693753)  
  
-   [Обновление существующего элемента управления ActiveX для использования в Интернете](../mfc/upgrading-an-existing-activex-control.md)  
  
##  <a name="_core_basic_components_of_an_activex_control"></a>Основные компоненты элемента управления ActiveX  
 Элемент управления ActiveX использует несколько программные элементы эффективно взаимодействовать с контейнер элемента управления и пользователь. Это класс [COleControl](../mfc/reference/colecontrol-class.md), набор функций, формирование событий и отправки карты.  
  
 Каждый объект элемента управления ActiveX, разрабатываемых мощный набор функций наследует от базового класса MFC, `COleControl`. Эти возможности включают активации на месте и логики автоматизации. `COleControl`можно предоставить объект элемента управления те же функциональные возможности, как объект окна MFC, а также возможность запускать события. `COleControl`Можно также предоставить [элементов управления без окон](../mfc/providing-windowless-activation.md), которого зависят их контейнера для получения справки по некоторые функциональные возможности окна предоставляет (захват мыши, фокуса клавиатуры прокрутки), но они обеспечивают отображение намного быстрее.  
  
 Поскольку класс элемента управления является производным от `COleControl`, он наследует возможность отправки или «пожар,» сообщений, вызываемых событий в контейнере элемента управления при выполнении определенных условий. Эти события используются для уведомления о каких-либо важных контейнера элемента управления происходит в элементе управления. Дополнительные сведения о событии, можно отправить в контейнер элемента управления путем присоединения параметров к событию. Дополнительные сведения о события элементов управления ActiveX см. в статье [элементы управления MFC ActiveX: события](../mfc/mfc-activex-controls-events.md).  
  
 Последний элемент является диспетчерскую карту, которая используется для предоставления набора функций (методов) и атрибутов (называемые свойства) пользовательского элемента управления. Свойства позволяют контейнера элемента управления или управления пользователю работать с элементом управления различными способами. Пользователь может изменить внешний вид элемента управления, изменить некоторые значения элемента управления или запросы элемента управления, например для доступа к определенной части данных, для которого элемент управления поддерживает. Этот интерфейс определяется разработчиком элемента управления и определяются с помощью **представление классов**. Дополнительные сведения о свойства и методы элемента управления ActiveX, см. в статьях [элементы управления MFC ActiveX: методы](../mfc/mfc-activex-controls-methods.md) и [свойства](../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="_core_interaction_between_controls_with_windows_and_activex_control_containers"></a>Взаимодействие между элементами управления с Windows и контейнеры элементов управления ActiveX  
 При использовании элемента управления в контейнере элемента управления для связи используется двумя механизмами: он предоставляет свойства и методы, и он инициирует события. На следующем рисунке показано, как реализованы двух этих механизмов.  
  
 ![Элемент управления ActiveX взаимодействует со своим контейнером](../mfc/media/vc37222.gif "vc37222")  
Обмен данными между контейнере элементов управления ActiveX и элемент управления ActiveX  
  
 Предыдущем рисунке показано, как другие интерфейсы OLE (помимо автоматизации и события) обрабатываются элементами управления.  
  
 Все взаимодействия элемента управления с контейнером осуществляется `COleControl`. Для обработки некоторых запросов контейнера **COleControl** будет вызывать функции-члены, реализованные в классе элемента управления. Таким образом, обрабатываются все методы и некоторые свойства. Класс элемента управления также может инициировать соединение с контейнером путем вызова функции-члены `COleControl`. Таким образом происходят события.  
  
##  <a name="_core_active_and_inactive_states_of_an_activex_control"></a>Активного и неактивного состояния элемента управления ActiveX  
 Элемент управления имеет два основных состояния: активных и неактивных. В большинстве случаев эти состояния были выделяемая ли элемент управления имел окна. Активный элемент управления имел окно. Неактивный элемент управления не поддерживались. С появлением активации без окна это различие больше не является универсальной, но по-прежнему распространяется на многие элементы управления.  
  
 Когда [неоконным](../mfc/providing-windowless-activation.md) Быстрая активен, он вызывает захват мыши, фокуса клавиатуры, прокрутка и другие окна службы из контейнера. Вы также можете [обеспечивают взаимодействие мыши, чтобы неактивные элементы управления](../mfc/providing-mouse-interaction-while-inactive.md), а также создать элементы управления, [ожидания до активации для создания окна](../mfc/turning-off-the-activate-when-visible-option.md).  
  
 Когда элемент управления с помощью окна становится активным, возможность полностью взаимодействовать с контейнера элемента управления, пользователя и Windows. На следующем рисунке показано пути обмена данными между элемента управления ActiveX, контейнер элемента управления и операционной системы.  
  
 ![Обработка сообщений в активный элемент управления ActiveX оконные](../mfc/media/vc37223.gif "vc37223")  
Windows обработка сообщений в оконный элемент управления ActiveX (если активно)  
  
##  <a name="_core_serializing_activex_elements"></a>Сериализация  
 Возможность сериализации данных, иногда называют сохраняемости, позволяет элементу управления, для записи значения его свойств в постоянное хранилище. Затем элементы управления можно воссоздать путем чтения состояния объекта из хранилища.  
  
 Обратите внимание, что элемент управления не отвечает за получение доступа для среды хранения. Вместо этого контейнера элемента управления отвечает за предоставление управления носителя для использования в нужное время. Дополнительные сведения о сериализации см. в статье [элементы управления MFC ActiveX: сериализация](../mfc/mfc-activex-controls-serializing.md). Сведения по оптимизации сериализации см. в разделе [оптимизация постоянства и инициализации](../mfc/optimizing-persistence-and-initialization.md) в элементах управления ActiveX: оптимизации.  
  
##  <a name="_core_installing_activex_control_classes_and_tools"></a>Установка классы элементов управления ActiveX и инструментов  
 При установке Visual C++, MFC ActiveX управления классов или в розничной торговле и отладки элемента управления ActiveX, библиотек среды выполнения устанавливаются автоматически, если выбраны элементы управления ActiveX в программе установки (они выбираются по умолчанию).  
  
 По умолчанию классы элементов управления ActiveX и средства устанавливаются в следующих вложенных \Program Files\Microsoft Visual Studio .NET:  
  
-   **\Common7\Tools**  
  
     Файлы тестового контейнера (TstCon32.exe, а также его файлы справки).  
  
-   **\Vc7\atlmfc\include**  
  
     Содержит включаемые файлы, необходимые для разработки элементов управления ActiveX в MFC  
  
-   **\Vc7\atlmfc\src\mfc**  
  
     Содержит исходный код для конкретных классов элементов управления ActiveX в MFC  
  
-   **\Vc7\atlmfc\lib**  
  
     Содержит библиотеки, необходимые для разработки элементов управления ActiveX в MFC  
  
 Также есть образцы для элементов управления ActiveX в MFC. Дополнительные сведения об этих образцов см. в разделе [образцов элементов управления: MFC-Based элементы управления ActiveX](../visual-cpp-samples.md)  
  
## <a name="see-also"></a>См. также  
 [Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)
