---
title: "Контейнеры. Дополнительные возможности | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "приложения контейнера и сервера [C++]"
  - "контейнеры [C++], дополнительные возможности"
  - "контейнеры [C++], приложения контейнера"
  - "контейнеры [C++], ссылки на внедренные объекты OLE"
  - "внедренные объекты [C++]"
  - "ссылки [C++], во внедренные объекты OLE"
  - "OLE - контейнеры, дополнительные возможности"
  - "элементы управления OLE, контейнеры"
  - "приложения сервера и контейнера"
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Контейнеры. Дополнительные возможности
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этом разделе описываются шаги, которые необходимо включать необязательные дополнительные функции в существующем приложение\-контейнеры.  Эти функции:  
  
-   [Приложение, которое является и контейнером, и сервер](#_core_creating_a_container.2f.server_application)  
  
-   [Ссылка на объект OLE внедренному](#_core_links_to_embedded_objects)  
  
##  <a name="_core_creating_a_container.2f.server_application"></a> Создание контейнера или серверное приложение  
 Контейнер или серверное приложение, действующий как контейнер, и как сервер.  Microsoft Word Windows для этого образца.  Можно внедрить ключевое слово Windows для документов в других приложениях, а также включить элементы в слове для документов Windows.  Процесс для внесения изменений в приложение контейнера и контейнером, и полным сервером \(нельзя создать приложение контейнера или miniserver сочетания\) аналогичен процессу для создания полного сервера.  
  
 Раздел [Серверы: Реализация сервера](../mfc/servers-implementing-a-server.md) содержит несколько задач, необходимые снабдила серверное приложение.  При преобразовании контейнерное приложение на контейнер или серверное приложение, необходимо выполнить некоторые из этих одних и тех же задач, добавление кода на контейнер.  Ниже перечислены важные моменты, которые необходимо учитывать.  
  
-   Код контейнера созданный мастером приложений уже инициализирует OLE подсистема.  Не нужно изменять или добавлять к данной поддержки.  
  
-   Где бы ни базовый класс класса документа `COleDocument`, изменить базовый класс в `COleServerDoc`.  
  
-   Переопределите `COleClientItem::CanActivate` во избежание изменение элементов на месте, пока сервер сам используется для редактирования на месте.  
  
     Например, в примере MFC [OCLIENT](../top/visual-cpp-samples.md) OLE внедрял элемент, созданный с контейнером\/серверными приложениями.  При открытии приложения и OCLIENT на месте имеется элемент, созданный с контейнером\/серверными приложениями.  При редактировании элемент приложения, следует решить, требуется внедрить элемент, созданный в примере MFC [HIERSVR](../top/visual-cpp-samples.md) OLE.  Это можно сделать не встроенная функция активация использования.  Необходимо открыть полностью HIERSVR активировать этот элемент.  Поскольку библиотеки Microsoft Foundation Class не поддерживает эту функцию OLE, переопределить `COleClientItem::CanActivate` позволяет для проверки этой ситуации и предотвращает возможную ошибку во время выполнения в приложении.  
  
 При создании нового приложения и требуется его в функции в качестве контейнера или серверное приложение, выберите этот параметр в диалоговом окне OLE в мастере приложений и этой поддержки будет создан автоматически.  Дополнительные сведения см. в статье [Общие сведения: Создание контейнера элементов управления ActiveX](../mfc/reference/creating-an-mfc-activex-control-container.md).  Дополнительные сведения об образцах MFC см. в образцах MFC.  
  
 Обратите внимание, что нельзя вставить в приложение с интерфейсом MDI самостоятельно.  Приложение, контейнер\/сервер нельзя вставить на себя, если не будет SDI.  
  
##  <a name="_core_links_to_embedded_objects"></a> Ссылки на объекты во внедренные  
 Ссылки на функции внедренных объектов позволяют пользователю создать документ с OLE по ссылке к внедренному объект внутри данного приложения.  Например, создайте документ в текстовом процессоре, содержащий внедренную электронную таблицу.  Если приложение указател поддержки к внедренным объектам, оно может вставить ссылку к таблице, содержащейся в документе текстового процессора.  Эта функция позволяет приложению использовать сведения, содержащиеся в электронной таблице без использования, текстовый процессор исходного получил его.  
  
#### Связывание с внедренным объекты в приложении  
  
1.  Создайте производный класс из документа `COleLinkingDoc` вместо `COleDocument`.  
  
2.  Создайте идентификатор класса OLE \(**CLSID**\) для приложения с помощью генератора идентификаторов класса включенного с OLE средствами разработки.  
  
3.  Зарегистрируйте приложение с OLE.  
  
4.  Создайте объект `COleTemplateServer` как член класса приложения.  
  
5.  В функции\-члене `InitInstance` класса приложения, выполните следующие действия:  
  
    -   Подключиться данный объект `COleTemplateServer`, к шаблонам документов, вызвав функцию\-член `ConnectTemplate` объекта.  
  
    -   Вызовите функцию\-член **COleTemplateServer::RegisterAll** для регистрации все объекты класса с OLE системой.  
  
    -   Вызов метода `COleTemplateServer::UpdateRegistry`.  Единственным параметром в `UpdateRegistry` должен быть `OAT_CONTAINER`, если приложение не запускается с параметром «\/Embedded».  Это регистрирует приложение в качестве контейнера, который может указатели поддержки к внедренным объекты.  
  
         Если приложение запускается с параметром «\/Embedded», оно не должно отображать его главного окна, аналогична серверному приложению.  
  
 В примере MFC [OCLIENT](../top/visual-cpp-samples.md) OLE реализует эту функцию.  Пример того, как это делается см. функцию `InitInstance` в файле OCLIENT.CPP этого примера приложения.  
  
## См. также  
 [Контейнеры](../mfc/containers.md)   
 [Серверы](../mfc/servers.md)