---
title: "Контейнеры: Дополнительные возможности | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- links [MFC], to embedded OLE objects
- containers [MFC], links to embedded OLE objects
- containers [MFC], advanced features
- container/server applications [MFC]
- embedded objects [MFC]
- OLE controls [MFC], containers
- OLE containers [MFC], advanced features
- server/container applications [MFC]
- containers [MFC], container applications
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
caps.latest.revision: "10"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 4e79b1c88996e835a907129fa5810d4c4dca0770
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="containers-advanced-features"></a>Контейнеры. Дополнительные возможности
В этой статье описаны шаги, необходимые для включения необязательные дополнительные компоненты в существующие приложения контейнера. Эти функции представлены:  
  
-   [Это приложение, контейнер и сервер](#_core_creating_a_container_server_application)  
  
-   [Связь с внедренный объект](#_core_links_to_embedded_objects)  
  
##  <a name="_core_creating_a_container_server_application"></a>Создание контейнера и сервера приложений  
 Приложения контейнера и сервера — это приложение, которая действует как контейнер и сервер. Microsoft Word для Windows является примером. Документы Word для Windows можно внедрять в другие приложения и элементы можно внедрять в документы Word для Windows. Изменение приложения-контейнера для контейнера и полного сервера (нельзя создать в приложение контейнера и miniserver комбинации) выполняется похожа на процедуру для создания полного сервера.  
  
 Статья [серверы: реализация сервера](../mfc/servers-implementing-a-server.md) приведены несколько задач, необходимых для реализации серверного приложения. При преобразовании приложения-контейнера в приложение контейнера и сервера, затем необходимо для выполнения тех же задач, добавив код к контейнеру. В следующем списке перечислены важные моменты, которые следует учитывать:  
  
-   Код контейнера, уже созданные с помощью мастера приложений инициализирует подсистемы OLE. Не требуется изменять или добавлять никакие параметры для такой поддержки.  
  
-   Везде, где базовым классом класса документа является `COleDocument`, измените базовый класс для `COleServerDoc`.  
  
-   Переопределить `COleClientItem::CanActivate` во избежание изменения элементов в месте, пока сам сервер используется для редактирования на месте.  
  
     Например, MFC OLE образца [OCLIENT](../visual-cpp-samples.md) внедренными элемент, созданный приложением контейнера и сервера. Откройте приложение OCLIENT и на месте изменить элемент, созданный приложением контейнера и сервера. При изменении элемента приложения, решите, следует внедрять элемент, созданный Образец MFC OLE [HIERSVR](../visual-cpp-samples.md). Чтобы сделать это, нельзя использовать активации на месте. Необходимо полностью открыть HIERSVR для активации этого элемента. Так как библиотеки классов Microsoft Foundation не поддерживает эту функцию OLE, переопределение `COleClientItem::CanActivate` позволяет проверить наличие этой ситуации и предотвратить возможные ошибки во время выполнения в приложении.  
  
 Если создается новое приложение и он должен работать в качестве контейнера или серверное приложение, выберите том, что параметр в диалоговом окне OLE параметры в мастере приложений и поддержка этой возможности будет создана автоматически. Дополнительные сведения см. в статье [Обзор: создание контейнеров элементов управления ActiveX](../mfc/reference/creating-an-mfc-activex-control-container.md). Сведения об образцах MFC см. в разделе примеры MFC.  
  
 Обратите внимание, MDI-приложения не удается вставить в самого себя. Применяется в приложении SDI это приложение, контейнера и сервера нельзя вставлять в саму себя.  
  
##  <a name="_core_links_to_embedded_objects"></a>Ссылки на внедренные объекты  
 Ссылки на внедренные объекты компонентов позволяет пользователю создать документ с связь с внедренного объекта внутри приложения-контейнера. Например создайте документ в текстовый редактор, содержащий внедренные электронную таблицу. Если приложение поддерживает ссылки на внедренные объекты, он может вставить ссылку электронной таблицы, содержащиеся в документе текстовый процессор. Эта функция позволяет приложению использовать сведения, содержащиеся в электронную таблицу, не зная, где это текстовый процессор изначально верно.  
  
#### <a name="to-link-to-embedded-objects-in-your-application"></a>Для связи внедренные объекты в приложении  
  
1.  Создайте производный класс документа из `COleLinkingDoc` вместо `COleDocument`.  
  
2.  Создание идентификатора класса OLE (**CLSID**) для вашего приложения с помощью генератора идентификатор класса, входящий в состав средств разработки OLE.  
  
3.  Зарегистрируйте приложение с OLE.  
  
4.  Создание `COleTemplateServer` как член класса приложения.  
  
5.  В классе приложения `InitInstance` члена функции, выполните следующие действия:  
  
    -   Подключиться к `COleTemplateServer` объект шаблоны документов путем вызова объекта `ConnectTemplate` функции-члена.  
  
    -   Вызовите **COleTemplateServer::RegisterAll** функции-члена для регистрации всех объектов класса с системой OLE.  
  
    -   Вызовите метод `COleTemplateServer::UpdateRegistry`. Единственным параметром, который `UpdateRegistry` должно быть `OAT_CONTAINER` Если приложение не запускается с параметром «/ внедренные». Эта строка регистрирует приложение как контейнер, который может поддерживать ссылки на внедренные объекты.  
  
         Если приложение запускается с параметром «/ внедренные», не должно отображать основного окна, аналогично серверного приложения.  
  
 Пример MFC OLE [OCLIENT](../visual-cpp-samples.md) использует эту функцию. Пример, как это сделать, см. `InitInstance` функции в OCLIENT. Файл .cpp в этом образце приложения.  
  
## <a name="see-also"></a>См. также  
 [Контейнеры](../mfc/containers.md)   
 [Серверы](../mfc/servers.md)

