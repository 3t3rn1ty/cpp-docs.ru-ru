---
title: "Контейнеры элементов управления ActiveX. Обработка событий из элемента управления ActiveX | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "контейнер для элементов ActiveX [C++], приемники событий"
  - "элементы управления ActiveX [C++], события"
  - "BEGIN_EVENTSINK_MAP - макрос"
  - "END_EVENTSINK_MAP - макрос, использование"
  - "обработчики событий [C++], элементы управления ActiveX"
  - "обработка событий [C++], элементы управления ActiveX"
  - "события [C++], элементы управления ActiveX"
  - "ON_EVENT - макрос"
ms.assetid: f9c106db-052f-4e32-82ad-750646aa760b
caps.latest.revision: 9
caps.handback.revision: 5
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Контейнеры элементов управления ActiveX. Обработка событий из элемента управления ActiveX
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Этот раздел посвящен использованию окна свойств для задания обработчики событий для элементов управления ActiveX в контейнере элементов управления ActiveX.  Обработчики событий используются для получения уведомлений от элемента управления \(\) достоверных событий и выполнить какое\-либо действие в ответе.  Это уведомление вызывают «включения» событием.  
  
> [!NOTE]
>  Данная статья использует контейнер Контейнера элементов управления ActiveX на основе диалоговых окон с проектом и встроенный элемент управления с именем CIRC служит в качестве примеров в процедурах и коде.  
  
 С помощью кнопки События в окне свойств можно создать сопоставление событий, которые могут возникнуть в контейнерном приложении элемента управления ActiveX.  Это называется «сопоставление сопоставлением приемника событий,» создает поддерживается Visual C\+\+ при добавлении обработчиков событий в класс контейнера элементов управления.  Каждый обработчик событий, реализованный с записью сопоставления событий, сопоставляет определенное событие в функцию\-член контейнера обработчика событий.  Эта функция обработчика событий вызывается при запуске события объектом определенное событие элемента управления ActiveX.  
  
 Дополнительные сведения о сопоставлениях приемника событий см. в разделе [Сопоставления приемника событий](../mfc/reference/event-sink-maps.md) в *справочнике библиотеки классов*.  
  
##  <a name="_core_event_handler_modifications_to_the_project"></a> Изменения обработчика событий в проект  
 При использовании окна свойств для добавления обработчиков событий, сопоставление приемника событий объявляется и определяется в проекте.  Следующие выписки добавляются в файл .cpp элемента управления в первый раз добавляется обработчик событий.  Этот код объявляет сопоставление приемника событий для класса диалогового окна \(в этом случае `CContainerDlg`\).  
  
 [!code-cpp[NVC_MFC_AxCont#8](../mfc/codesnippet/CPP/activex-control-containers-handling-events-from-an-activex-control_1.cpp)]  
[!code-cpp[NVC_MFC_AxCont#9](../mfc/codesnippet/CPP/activex-control-containers-handling-events-from-an-activex-control_2.cpp)]  
  
 По мере того, как используется окно свойств для добавления события, запись сопоставления событий \(`ON_EVENT`\) добавляется к сопоставлению приемника событий и обработчик событий функциональность добавляется к файлу реализации контейнера \(CPP\).  
  
 В следующем примере объявляется обработчик событий, `OnClickInCircCtrl`, для события **ClickIn** элемента управления CIRC:  
  
 [!code-cpp[NVC_MFC_AxCont#10](../mfc/codesnippet/CPP/activex-control-containers-handling-events-from-an-activex-control_3.cpp)]  
  
 Кроме того, следующий шаблон будет добавлен в файл реализации класса `CContainerDlg` \(CPP\) функций\-членов обработчика событий:  
  
 [!code-cpp[NVC_MFC_AxCont#11](../mfc/codesnippet/CPP/activex-control-containers-handling-events-from-an-activex-control_4.cpp)]  
  
 Дополнительные сведения о макросах приемника событий см. в разделе [Сопоставления приемника событий](../mfc/reference/event-sink-maps.md) в *справочнике библиотеки классов*.  
  
#### Создание функции обработчика событий  
  
1.  В представлении классов, выделите класс диалогового окна, содержащего элемент управления ActiveX.  В данном примере используйте `CContainerDlg`.  
  
2.  В окне "Свойства" нажмите кнопку **События**.  
  
3.  В окне свойств, выделите идентификатор элемента управления внутреннего элемента управления ActiveX.  В данном примере используйте `IDC_CIRCCTRL1`.  
  
     Окно свойств отображается список событий, которые могут быть инициируемых встроенным элементом управления ActiveX.  Любой функции\-члена отображается полужирным уже содержит функции обработчика, к нему.  
  
4.  Выделите событие требуется класс диалогового окна обработки.  Для этого примера выберите **Щелчок**.  
  
5.  В раскрывающемся списке справа выберите **\<Add\> ClickCircctrl1**.  
  
6.  Дважды щелкните новую функцию обработчика из представления классов, чтобы поскакать в коде обработчика событий в файле реализации \(CPP\) `CContainerDlg`.  
  
## См. также  
 [Контейнеры для элементов управления ActiveX](../mfc/activex-control-containers.md)