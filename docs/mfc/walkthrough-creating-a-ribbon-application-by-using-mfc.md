---
title: "Пошаговое руководство. Создание приложения ленты с помощью MFC | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "создание приложения ленты (MFC)"
  - "приложение ленты, создание (MFC)"
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
caps.latest.revision: 21
caps.handback.revision: 17
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Пошаговое руководство. Создание приложения ленты с помощью MFC
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этом пошаговом руководстве рассматривается использование **Мастера приложений MFC** для создания приложения, в котором по умолчанию имеется лента.  Затем мы расширим ленту, добавив в нее категорию **Пользовательская** с панелью **Избранное**, и добавим на эту панель некоторые часто используемые команды.  
  
## Обязательные компоненты  
 В этом руководстве предполагается, что в [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] используются **Обычные параметры среды разработки**.  Если вы используете другие параметры, некоторые из элементов пользовательского интерфейса, упоминаемые в приведенных ниже инструкциях, могут не отображаться.  Сведения о том, как изменить эти параметры, см. в разделе [How to: Reset Your Settings](http://msdn.microsoft.com/ru-ru/c95c51be-e609-4769-abba-65e6beedec76).  
  
### Создание приложения MFC с лентой  
  
1.  С помощью **Мастера приложений MFC** создайте приложение MFC с лентой.  Чтобы запустить мастер, в меню **Файл** выберите **Создать** и затем выберите **Проект**.  
  
2.  В диалоговом окне **Новый проект** разверните узел **Visual C\+\+** в разделе **Установленные шаблоны**, выберите **Библиотека MFC**, а затем выберите **Приложение MFC**.  Введите имя для проекта, например `MFCRibbonApp`, и нажмите кнопку **ОК**.  
  
3.  На первой странице **Мастера приложений MFC** нажмите кнопку **Далее**.  
  
4.  На странице **Тип приложения** в списке **Визуальный стиль и цвета** выберите **Office 2007 \(синяя тема\)**.  Остальные параметры не изменяйте.  Нажмите кнопку **Далее**.  
  
5.  На странице **Поддержка составных документов** убедитесь, что выбран вариант **Нет**, и нажмите кнопку **Далее**.  
  
6.  На странице **Свойства шаблона документов** в поле **Расширение файла** введите расширение файла для документов, создаваемых этим приложением, например `mfcrbnapp`.  Нажмите кнопку **Далее**.  
  
7.  На странице **Поддержка базы данных** убедитесь, что выбран вариант **Нет**, и нажмите кнопку **Далее**.  
  
8.  На странице **Свойства интерфейса пользователя** убедитесь, что выбран вариант **Использовать ленту**.  Нажмите кнопку **Далее**.  
  
9. По умолчанию **Мастер приложений MFC** добавляет поддержку нескольких закрепляемых областей.  Поскольку в этом руководстве рассматривается только лента, эти компоненты можно удалить из приложения.  На странице **Дополнительные параметры** снимите все флажки.  Нажмите кнопку **Далее**.  
  
10. На странице **Созданные классы** нажмите кнопку **Готово**, чтобы создать приложение MFC.  
  
11. Чтобы убедиться, что приложение успешно создано, соберите и запустите его.  Для сборки приложения в меню **Сборка** выберите **Собрать решение**.  Если сборка приложения прошла успешно, запустите его, выбрав **Начать отладку** в меню **Отладка**.  
  
     Мастер автоматически создает ленту с одной категорией, которая называется **Главная**.  Эта лента содержит три панели ленты, которые называются **Буфер обмена**, **Вид** и **Окно**.  
  
### Добавление категории и панели на ленту  
  
1.  Чтобы открыть созданный мастером ресурс ленты, в меню **Вид** выберите **Другие окна** и затем выберите **Ресурсы**.  В окне **Ресурсы** щелкните **Лента**, а затем дважды щелкните **IDR\_RIBBON**.  
  
2.  Сначала добавьте на ленту пользовательскую категорию, дважды щелкнув элемент **Категория** в **панели элементов**.  
  
     Будет создана категория с заголовком **Категория1**.  По умолчанию категория содержит одну панель.  
  
     Щелкните правой кнопкой мыши заголовок **Категория1** и выберите **Свойства**.  В окне **Свойства** измените значение свойства **Заголовок** на `Пользовательская`.  
  
     Свойства **Большие изображения** и **Маленькие изображения** задают точечные рисунки, используемые в качестве значков для элементов ленты в этой категории.  Поскольку создание пользовательских точечных рисунков выходит за рамки этого руководства, просто используйте точечные рисунки, созданные мастером.  Маленькие точечные рисунки имеют размер 16 пикселей на 16 пикселей.  Используйте в качестве маленьких изображений точечные рисунки, доступ к которым осуществляется по идентификатору ресурса IDB\_FILESMALL.  Большие точечные рисунки имеют размер 32 пикселей на 32 пикселей.  Используйте в качестве больших изображений точечные рисунки, доступ к которым осуществляется по идентификатору ресурса IDB\_FILELARGE.  
  
    > [!NOTE]
    >  На HDPI\-мониторах автоматически используются HDPI\-версии изображений.  
  
3.  Теперь необходимо настроить панель.  Панели используются для группирования элементов, логически связанных друг с другом.  Например, на вкладке **Главная** команды **Вырезать**, **Копировать** и **Вставить** находятся на панели **Буфер обмена**.  Чтобы настроить панель, щелкните правой кнопкой мыши **Panel1** и выберите **Свойства**.  В окне **Свойства** измените значение свойства **Заголовок** на `Избранное`.  
  
     Для панели можно указать **Индекс изображения**.  Это число определяет значок, отображаемый, если панель ленты добавлена на **Панель быстрого доступа**.  На самой панели ленты значок не отображается.  
  
4.  Чтобы убедиться, что категория и панель ленты успешно созданы, просмотрите элемент управления "лента".  На **панели инструментов редактора ленты** нажмите кнопку **Проверить ленту**.  На ленте должны отображаться вкладка **Пользовательская** и панель **Избранное**.  
  
### Добавление элементов на панели ленты  
  
1.  Чтобы добавить элементы на панель, созданную в предыдущей процедуре, перетащите элементы управления из раздела **Редактор ленты** в **панели элементов** на панель в представлении кода.  
  
2.  Сначала добавьте кнопку **Печать**.  Кнопка **Печать** будет иметь подменю, содержащее команду **Быстрая печать**, которая выводит документ на принтер по умолчанию.  Обе эти команды уже определены для этого приложения.  Они находятся в меню приложения.  
  
     Чтобы создать кнопку **Печать**, перетащите на панель инструмент "Кнопка".  
  
     В окне **Свойства** измените значение свойства **Идентификатор** на **ID\_FILE\_PRINT** \(этот идентификатор должен уже быть определен\).  Измените значение свойства **Заголовок** на `Печать`.  Измените значение свойства **Индекс изображения** на `4`.  
  
     Чтобы создать кнопку **Быстрая печать**, щелкните столбец значения свойства рядом с пунктом **Пункты меню**, а затем щелкните многоточие \(**...**\).  В **Редакторе элементов** нажмите неподписанную кнопку **Добавить**, чтобы создать пункт меню.  В окне **Свойства** измените значение свойства **Заголовок** на `Быстрая печать`, свойства **Идентификатор** на `ID_FILE_PRINT_DIRECT`, а свойства **Изображение** на `5`.  Свойство "Изображение" задает значок "Быстрая печать" в ресурсе точечных изображений IDB\_FILESMALL.  
  
3.  Чтобы убедиться, что кнопки добавлены на панель ленты, соберите приложение и запустите его.  Для сборки приложения в меню **Сборка** выберите **Собрать решение**.  Если сборка приложения прошла успешно, запустите приложение, выбрав **Начать отладку** в меню **Отладка**.  На панели **Избранное** на вкладке ленты **Пользовательская** должны отображаться кнопка **Печать** и поле со списком.  
  
## Следующие действия  
 [Практическое руководство. Настройка панели быстрого доступа](../mfc/how-to-customize-the-quick-access-toolbar.md)  
  
 [Практическое руководство. Настройка кнопки приложения](../mfc/how-to-customize-the-application-button.md)  
  
 Полные примеры см. в разделе [Примеры \(пакет компонентов MFC\)](../top/visual-cpp-samples.md).  
  
## См. также  
 [Пошаговые руководства](../mfc/walkthroughs-mfc.md)   
 [Примеры \(пакет компонентов MFC\)](../top/visual-cpp-samples.md)