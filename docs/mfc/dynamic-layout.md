---
title: "Динамический макет | Microsoft Docs"
ms.custom: ""
ms.date: "12/16/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
ms.assetid: 8598cfb2-c8d4-4f5a-bf2b-59dc4653e042
caps.latest.revision: 7
caps.handback.revision: 3
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Динамический макет
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

С помощью MFC в [!INCLUDE[vs_dev14](../mfc/includes/vs_dev14_md.md)] можно создавать диалоговые окна, размер которых могут изменять пользователи, а также управлять способом перенастраивания макета в соответствии с изменениями размера.  Например, можно присоединить кнопки, которые находятся в нижней части диалогового окна, к нижней границе, чтобы они всегда находились в нижней части окна.  Также можно настроить некоторые элементы управления, например списки, поля ввода и текстовые поля, таким образом, чтобы они расширялись, когда пользователь увеличивает размер диалогового окна.  
  
## Задание параметров динамического макета в диалоговом окне MFC  
 Если пользователь изменяет размер диалогового окна, элементы управления в диалоговом окне могут изменить свой размер или перемещаться в направлении осей X и Y.  Изменение размера или положения элемента управления, когда пользователь изменяет размер диалогового окна, называется динамическим макетом.  Например, ниже показано диалоговое окно до изменения его размера.  
  
 ![Диалоговое окно, отображающееся до изменения размера.](../mfc/media/mfcdynamiclayout4.png "MFCDynamicLayout4")  
  
 После изменения размера область списка увеличивается для отображения большего количества элементов, а кнопки перемещаются вместе с правым нижним углом.  
  
 ![Диалоговое окно, отображающееся после изменения размера.](../mfc/media/mfcdynamiclayout5.png "MFCDynamicLayout5")  
  
 Для управления динамическим макетом можно указать подробные сведения для каждого элемента управления в редакторе ресурсов в интегрированной среде разработки, или это можно сделать программным образом путем организации доступа к объекту CMFCDynamicLayout для конкретного элемента управления, после чего задать его свойства.  
  
### Задание свойств динамического макета в редакторе ресурсов  
 Поведение динамического макета для диалогового окна можно задать без написания кода, а с помощью редактора ресурсов.  
  
##### Задание свойств динамического макета в редакторе ресурсов  
  
1.  Откройте проект MFC, затем откройте диалоговое окно, с которым необходимо работать в редакторе диалоговых окон.  
  
     ![Откройте диалоговое окно в редакторе ресурсов.](../mfc/media/mfcdynamiclayout3.png "MFCDynamicLayout3")  
  
2.  Выберите элемент управления и в окне свойств задайте для него свойства динамического макета.  Раздел **Динамический макет** в окне «Свойства» содержит свойства **Тип перемещения**, **Тип изменения размера**, а также \(в зависимости от значений, выбранных для этих свойств\) специальные свойства, которые определяют, сколько элементов управления перемещаются или изменяют размер.  **Тип перемещения** определяет, как элемент управления перемещается при изменении размера диалогового окна. **Тип изменения размера** определяет, как изменяется размер элемента управления при изменении размера диалогового окна.  **Тип перемещения** и **Тип изменения размера** могут иметь значения **Горизонтально**, **Вертикально**, **Оба режима** или **Нет**, в зависимости от измерений, которые нужно динамически изменять.  «Горизонтально» относится к оси X, а «Вертикально» — к оси Y.  
  
3.  Если требуется, чтобы элемент управления, например кнопка, имел фиксированный размер и всегда оставался в правом нижнем углу, что является обычным для кнопок **ОК** или **Отмена**, установите для свойства **Тип изменения размера** значение **Нет**, а для свойства **Тип перемещения** — значение **Оба режима**.  Для значений **Перемещение по X** и **Перемещение по Y** в разделе **Тип перемещения** установите 100 % — в этом случае элемент управления будет всегда находиться на фиксированном расстоянии от правого нижнего угла.  
  
     ![Динамический макет](../mfc/media/mfcdynamiclayout1.png "MFCDynamicLayout1")  
  
4.  Предположим, что у вас также есть элемент управления, который должен увеличиваться при расширении диалогового окна.  Как правило, пользователь может расширять диалоговое окно для увеличения размера многострочного поля ввода, чтобы увеличить размер текстового поля, или же расширять элемент управления списком, чтобы увидеть больше данных.  В этом случае для свойства **Тип изменения размера** установите значение «Оба режима», а для свойства **Тип перемещения** — значение «Нет».  Затем для параметров **Изменение размера по X** и **Изменение размера по Y** установите значение 100.  
  
     ![Параметры динамического макета](../mfc/media/mfcdynamiclayout2.png "MFCDynamicLayout2")  
  
5.  Попробуйте ввести другие значения, которые могут быть применимы для элементов управления.  Например, в диалоговом окне с однострочным текстовым полем может быть задано только одно свойство: для свойства **Тип изменения размера** будет установлено значение **Горизонтально**.  
  
### Задание свойств динамического макета программным образом  
 Описанную выше процедуру можно использовать для задания свойств динамического макета диалогового окна на этапе разработки. Но, если вы хотите управлять динамическим макетом во время выполнения, свойства динамического макета можно задавать программным образом.  
  
##### Задание свойств динамического макета программным образом  
  
1.  Найдите или создайте место в коде реализации класса своего диалогового окна, где необходимо задать динамический макет для диалогового окна.  Например, можно добавить метод, например `AdjustLayout` в диалоговом окне, и вызывать его из тех мест, где будет необходимо изменять макет.  Можно выполнить вызов из конструктора сначала или же после внесения изменений в диалоговое окно.  
  
2.  Для диалогового окна вызовите [GetDynamicLayout](../Topic/CWnd::GetDynamicLayout.md), представляющий собой метод класса CWnd.  GetDynamicLayout возвращает указатель на объект CMFCDynamicLayout.  
  
    ```  
    CMFCDynamicLayout* dynamicLayout = pDialog->GetDynamicLayout();  
    ```  
  
3.  Для первого элемента управления, для которого требуется добавить динамическое поведение, используйте статические методы в классе динамического макета для создания структуры [MoveSettings](../Topic/CMFCDynamicLayout::MoveSettings%20Structure.md), которая кодирует способ корректировки элемента управления.  Для этого нужно сначала нужно выбрать соответствующий статический метод: [CMFCDynamicLayout::MoveHorizontal](../Topic/CMFCDynamicLayout::MoveHorizontal.md), [CMFCDynamicLayout::MoveVertical](../Topic/CMFCDynamicLayout::MoveVertical.md), [CMFCDynamicLayout::MoveNone](../Topic/CMFCDynamicLayout::MoveNone.md) или [CMFCDynamicLayout::MoveHorizontalAndVertical](../Topic/CMFCDynamicLayout::MoveHorizontalAndVertical.md).  Вы передаете процентное соотношение для перемещения по горизонтали или по вертикали.  Эти статические методы возвращают вновь созданный объект MoveSettings, который можно использовать для задания поведения перемещения элемента управления.  
  
     Помните, что 100 означает перемещение на столько же, на сколько диалоговое окно изменяет свой размер. При этом край элемента управления будет оставаться на фиксированном расстоянии от новой границы.  
  
    ```  
    MoveSettings moveSettings = CMFCDynamicLayout::MoveHorizontal(100);  
    ```  
  
4.  Выполните ту же процедуру для поведения размера, который использует тип [SizeSettings](../Topic/CMFCDynamicLayout::SizeSettings%20Structure.md).  Например, чтобы указать, что элемент управления не изменяет размер при изменении размера диалогового окна, используйте следующий код:  
  
    ```  
    SizeSettings sizeSettings = CMFCDynamicLayout::SizeNone();  
    ```  
  
5.  Добавьте элемент управления в диспетчер динамического макета с помощью метода [CMFCDynamicLayout::AddItem](../Topic/CMFCDynamicLayout::AddItem.md).  Для различных способов указания требуемого элемента управления предусмотрены две перегрузки.  Одна использует дескриптор окна элемента управления \(HWND\), а другая — идентификатор элемента управления.  
  
    ```  
    dynamicLayout->AddItem(hWndControl, moveSettings, sizeSettings);  
    ```  
  
6.  Повторите для каждого элемента управления, который нужно переместить или для которого нужно изменить размер.  
  
7.  При необходимости можно использовать метод [CMFCDynamicLayout::HasItem](../Topic/CMFCDynamicLayout::HasItem.md), чтобы определить, находится ли элемент управления уже в списке элементов управления, для которых динамический макет будет изменен, или метод [CMFCDynamicLayout::IsEmpty](../Topic/CMFCDynamicLayout::IsEmpty.md), чтобы определить наличие элементов управления, которые подлежат изменению.  
  
8.  Чтобы включить макет диалогового окна, вызовите метод [CWnd::EnableDynamicLayout](../Topic/CWnd::EnableDynamicLayout.md).  
  
    ```  
    pDialog->EnableDynamicLayout(TRUE);  
    ```  
  
9. Когда пользователь в следующий раз изменит размер диалогового окна, будет вызван метод [CMFCDynamicLayout::Adjust](../Topic/CMFCDynamicLayout::Adjust.md), который фактически применит заданные параметры.  
  
10. Если необходимо отключить динамический макет, вызовите метод [CWnd::EnableDynamicLayout](../Topic/CWnd::EnableDynamicLayout.md), который имеет значение `FALSE` для параметра `bEnabled`.  
  
    ```  
    pDialog->EnableDynamicLayout(FALSE);  
    ```  
  
##### Задание динамического макета программным образом из файла ресурсов  
  
1.  Чтобы задать имя ресурса в соответствующем файле скрипта ресурсов \(RC\-файл\), который содержит сведения о динамическом макете, используйте метод [CMFCDynamicLayout::MoveHorizontalAndVertical](../Topic/CMFCDynamicLayout::MoveHorizontalAndVertical.md), как показано в следующем примере:  
  
    ```  
    dynamicLayout->LoadResource("IDD_DIALOG1");  
    ```  
  
     Именованный ресурс должен ссылаться на диалоговое окно, содержащее сведения о макете в форме записи AFX\_DIALOG\_LAYOUT в файле ресурсов, как показано в следующем примере:  
  
    ```  
    /////////////////////////////////////////////////////////////////////////////  
    //  
    // AFX_DIALOG_LAYOUT  
    //  
  
    IDD_MFCAPPLICATION1_DIALOG AFX_DIALOG_LAYOUT  
    BEGIN  
        0x0000, 0x6400, 0x0028, 0x643c, 0x0028  
    END  
  
    IDD_DIALOG1 AFX_DIALOG_LAYOUT  
    BEGIN  
        0x0000, 0x6464, 0x0000, 0x6464, 0x0000, 0x0000, 0x6464, 0x0000, 0x0000  
  
    END  
    ```  
  
## См. также  
 [Класс CMFCDynamicLayout](../mfc/reference/cmfcdynamiclayout-class.md)   
 [Классы элементов управления](../mfc/control-classes.md)   
 [Классы диалоговых окон](../mfc/dialog-box-classes.md)   
 [Dialog Editor](../mfc/dialog-editor.md)