---
title: Обработка сообщений и команду цели | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- IOleCommandTarget
dev_langs:
- C++
helpviewer_keywords:
- command targets [MFC]
- message handling [MFC], active documents
- IOleCommandTarget interface [MFC]
- command routing [MFC], command targets
ms.assetid: e45ce14c-e6b6-4262-8f3b-4e891e0ec2a3
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7184a6e8df67dfd220173c42bfa3e0580bd2cd3f
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33349471"
---
# <a name="message-handling-and-command-targets"></a>Обработка сообщений и цели команд
Интерфейс диспетчеризации команда `IOleCommandTarget` определяет простой и расширяемый механизм для запроса и выполнения команд. Этот механизм проще, чем автоматизации `IDispatch` , так как он полностью зависит от стандартный набор команд, команды редко имеют аргументов и участвует никакой информации о типе (безопасность типа позволяет уменьшить также аргументы командной строки).  
  
 Дизайн интерфейса диспетчеризации команд, каждая команда принадлежит «группу команд» определяемого с **GUID**. Таким образом любой пользователь может определять новые группы и определить все команды в пределах этой группы без любого необходимого для координации с корпорацией Майкрософт или любого другого поставщика. (Это по сути тех же средств определения как **disp-интерфейса** , а также **идентификаторы DISPID** автоматизации. Отсутствует перекрываются, хотя этот механизм маршрутизации команды только для маршрутизации команд, а не для сценариев и программирования на больших масштабах как дескрипторы автоматизации.)  
  
 `IOleCommandTarget` обрабатывает следующие сценарии:  
  
-   Используется месте активируется только обычно отображаются объекта панели инструментов и панели инструментов объекта может иметь кнопки команд контейнера как **печати**, **предварительного просмотра перед печатью**,  **Сохранить**, `New`, **масштаб**и др. (Активация на месте, рекомендуется стандартов, удалите объекты таких кнопок у свои панели инструментов или в бы отключить их. Такой подход позволяет этих команд, чтобы включить и еще направлены на обработчик справа). В настоящее время отсутствует механизм для объекта, для отправки этих команд в контейнер.  
  
-   При внедрении активного документа в контейнер активных документов (например, Office Binder), контейнер может потребоваться отправлять команды таких **печати**, **параметры страницы**, **свойства**и другим пользователям в автономной активный документ.  
  
 Этот простой команды маршрутизации может управляться с помощью существующих стандартов автоматизации и `IDispatch`. Тем не менее, участвующих дополнительную нагрузку, связанную с `IDispatch` больше, чем это необходимо, чтобы `IOleCommandTarget` предоставляет простые средства для достижения те же самые задачи:  
  
```  
interface IOleCommandTarget : IUnknown  
    {  
    HRESULT QueryStatus(  
        [in] GUID *pguidCmdGroup,  
        [in] ULONG cCmds,  
        [in,out][size_is(cCmds)] OLECMD *prgCmds,  
        [in,out] OLECMDTEXT *pCmdText);  
    HRESULT Exec(  
        [in] GUID *pguidCmdGroup,  
        [in] DWORD nCmdID,  
        [in] DWORD nCmdExecOpt,  
        [in] VARIANTARG *pvaIn,  
        [in,out] VARIANTARG *pvaOut);  
    }  
```  
  
 `QueryStatus` Здесь метод проверяет, является ли определенный набор команд, набор идентифицируется с **GUID**, поддерживается. Этот вызов заполняет массив **OLECMD** значения (структур) со списком поддерживаемых команд, а также возвращает текст, описывающий имя команды или состояние сведения. Когда вызывающий объект хочет вызова команды, его можно передать команду (и набор **GUID**) для **Exec** вместе с параметрами и аргументами, получение возвращаемого значения.  
  
## <a name="see-also"></a>См. также  
 [Контейнеры активных документов](../mfc/active-document-containers.md)

