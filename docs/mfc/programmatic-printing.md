---
title: "Программная печать | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "активные документы [C++], печать"
  - "IPrint - интерфейс"
  - "печать [MFC]"
  - "печать [MFC], активные документы"
  - "печать [MFC], программно"
ms.assetid: 3db0945b-5e13-4be4-86a0-6aecdae565bd
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Программная печать
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

OLE, предоставленное означает однозначно определить доступные документов \(**GetClassFile**\) и загрузить их в их связанный код \(`CoCreateInstance`, **QueryInterface\(IID\_IPersistFile\)**, **QueryInterface\(IID\_IPersistStorage\)**, **IPersistFile::Load** и **IPersistStorage::Load**\).  Включен для включения распечатать документы, контейнер активных документов \(с существующей OLE разработки не погруженную с OLE 2.0 первоначально\) представляет базовый интерфейс для печати, `IPrint`, обычно доступную сквозная — любой объект, который может загрузить постоянное состояние типа документа.  Каждое представление активного документа может при необходимости поддерживать интерфейс **IPrint**  для предоставления этих возможностей.  
  
 Интерфейс `IPrint` определяется следующим образом:  
  
 `interface IPrint : IUnknown`  
  
 `{`  
  
 `HRESULT SetInitialPageNum([in] LONG nFirstPage);`  
  
 `HRESULT GetPageInfo(`  
  
 `[out] LONG *pnFirstPage,`  
  
 `[out] LONG *pcPages);`  
  
 `HRESULT Print(`  
  
 `[in] DWORD grfFlags,`  
  
 `[in,out] DVTARGETDEVICE **pptd,`  
  
 `[in,out] PAGESET ** ppPageSet,`  
  
 `[in,out] STGMEDIUM **ppstgmOptions,`  
  
 `[in] IContinueCallback* pCallback,`  
  
 `[in] LONG nFirstPage,`  
  
 `[out] LONG *pcPagesPrinted,`  
  
 `[out] LONG *pnPageLast);`  
  
 `};`  
  
 Использование **IPrint::Print** клиентов и контейнеров просто указать документ вводить раз загруженный документ, указав управляющие флаги печати, целевое устройство, страницы для печати и дополнительных параметров.  Клиент может также элемент управления продолжение печати через \(см. ниже\) `IContinueCallback` интерфейса.  
  
 Кроме того, **IPrint::SetInitialPageNum** поддерживает возможность печати ряд документов в качестве его, нумерованный \(страницы без проблем, очевидно преимущество для контейнеров активных документов как Office Binder.  **IPrint::GetPageInfo** выполняет сведения о разбиении на страницы для отображения простым, предоставляя вызывающий объект для извлечения, число страниц ранее, переданный **SetInitialPageNum** \(или умолчанию документа внутреннего начальный номер страницы\) и число страниц в документе.  
  
 Объекты, поддерживающие `IPrint` помечены в реестре с «печатные» ключ, сохраненный в CLSID объекта:  
  
 HKEY\_CLASSES\_ROOT\\CLSID\\ {…}\\Printable  
  
 `IPrint` обычно реализуется в этом объекте, поддерживающий или `IPersistFile` или `IPersistStorage`.  Вызывающие объекты замечают возможность печати программными средствами постоянное состояние определенного класса, выполняя поиск в реестре для «печатные» ключ.  В настоящее время «печатные» означает поддержку по крайней мере `IPrint`; другие интерфейсы могут определяться в будущем, затем будет доступно через `QueryInterface`, где **IPrint**  просто представляет базовый уровень поддержки.  
  
 При выполнении процедуры печати, может потребоваться клиента или контейнер, начали печать в элемент управления должна ли печать продолжить.  Например, контейнер может поддерживать «остановка» печать», команда должна выполнить задание печати как можно скорее.  Чтобы поддерживать эту возможность, клиент печатные объекта может реализовать небольшой объект уведомления приемника с интерфейсом `IContinueCallback`:  
  
 `interface IContinueCallback : IUnknown`  
  
 `{`  
  
 `HRESULT FContinue(void);`  
  
 `HRESULT FContinuePrinting(`  
  
 `[in] LONG cPagesPrinted,`  
  
 `[in] LONG nCurrentPage,`  
  
 `[in] LPOLESTR pszPrintStatus);`  
  
 `};`  
  
 Этот интерфейс предназначен для того, чтобы быть использован в качестве универсальная функция обратного вызова продолжения, заменяет различных процедур продолжения в Win32 API \(например, **AbortProc** и **EnumMetafileProc** для печати для перечисления метафайла\).  Таким образом, этот предусмотрено разработчиками интерфейса полезен в больших разнообразии требующих много времени процессов.  
  
 В наиболее универсальных случаях функция **IContinueCallback::FContinue** вызывается периодически любым длинномерным процессом.  Возвращает объект приемника `S_OK`, чтобы продолжить операцию и **S\_FALSE** для остановки процедура как можно скорее.  
  
 **FContinue**, однако не используется в контексте **IPrint::Print**; вместо этого используется тип **IContinueCallback::FContinuePrint**.  Любой объект печати должен периодически вызывать **FContinuePrinting**, количество страниц, введенный текст, номер, языков со страницы и дополнительной строку, описывающую состояние печати, клиент может выбрать для отображения пользователю \(например, «страница 5 19»\).  
  
## См. также  
 [Контейнеры активных документов](../mfc/active-document-containers.md)