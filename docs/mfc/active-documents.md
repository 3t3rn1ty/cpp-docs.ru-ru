---
title: "Активные документы | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- active documents [MFC]
- active documents [MFC], requirements
- view objects [MFC], requirements
- OLE [MFC], active documents
- views [MFC], active documents
- active documents [MFC], views
ms.assetid: 1378f18e-aaa6-420b-8501-4b974905baa0
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 52f3165f69d47f63fc52ae01bbbd1947e7755a43
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="active-documents"></a>Активные документы
Активные документы расширить составных документов технологии OLE. Эти расширения предоставляются в виде дополнительные интерфейсы управления представления, чтобы объекты могли работать в контейнерах и еще сохранить контроль над их отображения и печати функции. Этот процесс позволяет отображать документы как внешний кадров (например, Microsoft Office Binder или Microsoft Internet Explorer), так и в кадры машинного кода (например, порты представление продукта собственные).  
  
 В этом разделе описываются функционального [требования для активных документов](#requirements_for_active_documents). Активный документ является владельцем набора данных и имеет доступ к хранилищу, где можно сохранить и получать данные. Его можно создавать и управлять одним или несколькими представлениями на данных. Помимо поддержки обычно встраивание и активация на месте интерфейсов OLE-документы, активный документ взаимодействует его способность создавать представления через `IOleDocument`. Через этот интерфейс контейнера могут запрашивать создание (и возможно перечислить) представления, которые могут быть отображены в активный документ. Через этот интерфейс активного документа можно также предоставить различные сведения о себе, например, он поддерживает несколько представлений или сложных прямоугольники.  
  
 Ниже приведен **IOleDocument** интерфейса. Обратите внимание, что **IEnumOleDocumentViews** интерфейс является стандартным перечислителем OLE для **IOleDocumentView \***  типов.  
  
```  
interface IOleDocument : IUnknown  
    {  
    HRESULT CreateView(  
        [in] IOleInPlaceSite *pIPSite,  
        [in] IStream *pstm,  
        [in] DWORD dwReserved,  
        [out] IOleDocumentView **ppView);  

    HRESULT GetDocMiscStatus([out] DWORD *pdwStatus);  

    HRESULT EnumViews(  
        [out] IEnumOleDocumentViews **ppEnum,  
        [out] IOleDocumentView **ppView);  
    }  
```  
  
 Каждый активный документ должен быть поставщик кадра представления с помощью этого интерфейса. Если документ не является внедренным в контейнере, сам сервер активного документа необходимо предоставить вид рамки. Тем не менее при внедрении активного документа в контейнер активного документа, контейнер предоставляет представление кадра.  
  
 Активного документа можно создать один или несколько типов [представления](#requirements_for_view_objects) его данные (например, обычный, структуры, вид страницы и так далее). Представления действуют как фильтры, через которые можно просматривать данные. Даже если документ содержит только один тип представления, могут по-прежнему требуется поддерживать несколько представлений, служащими для поддержки новых функциональных возможностей окна (например, **новое окно** товара **окна** меню в Office приложения).  
  
##  <a name="requirements_for_active_documents"></a>Требования для активных документов  
 Активный документ, который может быть отображен в контейнер активного документа необходимо:  
  
-   Использовать составных файлов OLE в качестве механизма хранения, реализуя `IPersistStorage`.  
  
-   Поддерживает базовые возможности внедрение OLE документов, включая **создать из файла**. Это требуются интерфейсы `IPersistFile`, `IOleObject`, и `IDataObject`.  
  
-   Поддерживает одно или несколько представлений, каждый из которых способен активации на месте. То есть представления должен поддерживать интерфейс `IOleDocumentView` а также интерфейсы `IOleInPlaceObject` и `IOleInPlaceActiveObject` (с помощью контейнера **IOleInPlaceSite** и **IOleInPlaceFrame** интерфейсы).  
  
-   Поддерживает интерфейсы Стандартная активного документа `IOleDocument`, `IOleCommandTarget`, и `IPrint`.  
  
 В этих требований подразумевается базы знаний, когда и как использовать интерфейсы стороне контейнера.  
  
##  <a name="requirements_for_view_objects"></a>Требования для представления объектов  
 Активного документа можно создать одно или несколько представлений данных. Функционально эти представления представляют собой порты на конкретный метод для отображения данных. Если активный документ поддерживает только одно представление, активный документ и что единое представление может осуществляться с помощью одного класса. **IOleDocument::CreateView** возвращает тот же объект `IOleDocumentView` указатель на интерфейс.  
  
 Представляются в контейнер активного документа, поддерживал компонент представления **IOleInPlaceObject** и **IOleInPlaceActiveObject** в дополнение к `IOleDocumentView`:  
  
```  
interface IOleDocumentView : IUnknown  
    {  
    HRESULT SetInPlaceSite([in] IOleInPlaceSite *pIPSite);  
    HRESULT GetInPlaceSite([out] IOleInPlaceSite **ppIPSite);  
    HRESULT GetDocument([out] IUnknown **ppunk);  
    [input_sync] HRESULT SetRect([in] LPRECT prcView);  
    HRESULT GetRect([in] LPRECT prcView);  
    [input_sync] HRESULT SetRectComplex(  
        [in] LPRECT prcView,  
        [in] LPRECT prcHScroll,  
        [in] LPRECT prcVScroll,  
        [in] LPRECT prcSizeBox);  
    HRESULT Show([in] BOOL fShow);  
    HRESULT UIActivate([in] BOOL fUIActivate);  
    HRESULT Open(void);  
    HRESULT CloseView([in] DWORD dwReserved);  
    HRESULT SaveViewState([in] IStream *pstm);  
    HRESULT ApplyViewState([in] IStream *pstm);  
    HRESULT Clone(  
        [in] IOleInPlaceSite *pIPSiteNew,  
        [out] IOleDocumentView **ppViewNew);  
    }  
```  
  
 Каждого представления есть узел связанного представления, который инкапсулирует вид рамки и порта просмотра (HWND и прямоугольной области, в этом окне). Сайт поддерживает эту функцию, однако стандартный **IOleInPlaceSite** интерфейса. Обратите внимание, что можно иметь более одного порта просмотра на одной HWND.  
  
 Как правило каждый тип представления имеет другое представление печати. Поэтому представления и соответствующие узлы представления необходимо реализовать интерфейсы печати если `IPrint` и `IContinueCallback`соответственно. Вид кадра должны согласовать с поставщиком через представление **IPrint** когда печать начинается, чтобы правильно печатать заголовки, нижние колонтитулы, поля и связанные элементы. Поставщик представление уведомляет рамки, связанные с печатью событий с помощью `IContinueCallback`. Дополнительные сведения об использовании этих интерфейсов см. в разделе [программный печати](../mfc/programmatic-printing.md).  
  
 Обратите внимание, что если активного документа поддерживает только одно представление, выберите активный документ и что единое представление может осуществляться с помощью один конкретный класс. **IOleDocument::CreateView** просто возвращает тот же объект `IOleDocumentView` указатель на интерфейс. Иными словами нет необходимости, существовать два отдельный объект экземпляры, когда требуется только одно представление.  
  
 Объект представления также может быть конечный объект команды. Путем реализации `IOleCommandTarget` представление может получать команды, которые получаются в пользовательском интерфейсе контейнера (такие как **New**, **откройте**, **Сохранить как**,  **Печать** на **файл** меню; и **копирования**, **вставить**, **отменить** на **изменить** меню). Дополнительные сведения см. в разделе [обработка сообщений и цели команды](../mfc/message-handling-and-command-targets.md).  
  
## <a name="see-also"></a>См. также  
 [Вложение активного документа](../mfc/active-document-containment.md)

