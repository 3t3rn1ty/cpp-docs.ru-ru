---
title: "Элементы управления ActiveX MFC: Добавление стандартных свойств | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- BackColor property [MFC]
- properties [MFC], adding stock
- ForeColor property [MFC]
- MFC ActiveX controls [MFC], properties
- foreground colors, ActiveX controls
- foreground colors [MFC]
ms.assetid: 8b98c8c5-5b69-4366-87bf-0e61e6668ecb
caps.latest.revision: "10"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 6523e5758e96c140b05f8416ba886a1e8636cc7d
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="mfc-activex-controls-adding-stock-properties"></a>Элементы управления ActiveX в MFC. Добавление стандартных свойств
Стандартные свойства отличаются от пользовательские свойства, что они уже реализован класс `COleControl`. `COleControl`содержит функции стандартных элементов, которые поддерживают общие свойства для элемента управления. Некоторые типичные свойства включают заголовок элемента управления и цвета переднего плана и фона. Сведения о других стандартных свойств см. в разделе [Stock поддерживаются свойства, с помощью мастера добавления свойства](#_core_stock_properties_supported_by_classwizard) далее в этой статье. Записи карты распределения для стандартных свойств всегда предшествует **DISP_STOCKPROP**.  
  
 В этой статье описывается добавление стандартных свойств (в данном случае заголовок) для элемента управления ActiveX, используя мастер добавления свойств и описываются изменения, полученный код. Ниже приведен список разделов.  
  
-   [С помощью мастера добавления свойства Добавление стандартных свойств](#_core_using_classwizard_to_add_a_stock_property)  
  
-   [Добавьте свойство мастер изменения для стандартных свойств](#_core_classwizard_changes_for_stock_properties)  
  
-   [Стандартных свойств, поддерживаемых с помощью мастера добавления свойства](#_core_stock_properties_supported_by_classwizard)  
  
-   [Свойства хранения и уведомления](#_core_stock_properties_and_notification)  
  
-   [Свойства цвета](#_core_color_properties)  
  
    > [!NOTE]
    >  Пользовательские элементы управления Visual Basic обычно имеют свойства, такие как верхнего, слева, ширину, высоту, выравнивание, тег, имя, TabIndex, TabStop и родительского. Контейнеры элементов управления ActiveX, однако отвечают за реализацию этих свойств элемента управления, и таким образом, элементы управления ActiveX не должны поддерживать эти свойства.  
  
##  <a name="_core_using_classwizard_to_add_a_stock_property"></a>Используя мастер добавления свойства Добавление стандартных свойств  
 Добавление стандартных свойств требует меньше кода, чем добавление пользовательских свойств, так как поддержка свойство обрабатывается автоматически в `COleControl`. Ниже показано, как добавить stock капитализации для платформу управления ActiveX и можно также использовать для добавления других стандартных свойств. Замените имя выбранного стандартное свойство для заголовка.  
  
#### <a name="to-add-the-stock-caption-property-using-the-add-property-wizard"></a>Чтобы добавить стандартное свойство заголовка, с помощью мастера добавления свойства  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении класса разверните узел библиотеки элемента управления.  
  
3.  Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.  
  
4.  В контекстном меню щелкните **добавить** и нажмите кнопку **добавить свойство**.  
  
     При этом откроется [мастер добавления свойств](../ide/names-add-property-wizard.md).  
  
5.  В **имя свойства** щелкните **заголовок**.  
  
6.  Нажмите кнопку **Готово**.  
  
##  <a name="_core_classwizard_changes_for_stock_properties"></a>Добавление изменения свойств мастера для стандартных свойств  
 Поскольку `COleControl` поддерживает свойств хранения, мастер добавления свойств не изменяет объявление класса в каким-либо образом; добавляет свойство карту диспетчеризации. Мастер добавления свойств добавляет следующую строку элемента управления, который находится в реализации карты распределения (. Файл .cpp):  
  
 [!code-cpp[NVC_MFC_AxUI#22](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_1.cpp)]  
  
 Следующая строка добавляется описание интерфейса элемента управления (. Файл IDL):  
  
 [!code-cpp[NVC_MFC_AxUI#23](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_2.idl)]  
  
 Эта строка назначает свойство Caption определенным идентификатором. Обратите внимание, что свойство может быть связано и запрашивать разрешение из базы данных перед изменением значения.  
  
 Это делает свойство Caption доступным пользователям элемента управления. Чтобы использовать значение стандартное свойство, доступ к переменную-член или функцию-член `COleControl` базового класса. Дополнительные сведения об этих переменных-членов и функций-членов см. следующий раздел, биржевая поддерживаются свойства, с помощью мастера добавления свойства.  
  
##  <a name="_core_stock_properties_supported_by_classwizard"></a>Стандартные свойства, поддерживаемые мастер добавления свойства  
 `COleControl` Класс предоставляет девять стандартных свойств. Можно добавить свойства, с помощью мастера добавления свойства.  
  
|Свойство|Элемент карты распределения|Как получить доступ к значение|  
|--------------|------------------------|-------------------------|  
|**Внешний вид**|**(DISP_STOCKPROP_APPEARANCE)**|Значение, доступным в качестве **m_sAppearance**.|  
|`BackColor`|**(DISP_STOCKPROP_BACKCOLOR)**|Значение доступного путем вызова `GetBackColor`.|  
|`BorderStyle`|**(DISP_STOCKPROP_BORDERSTYLE)**|Значение, доступным в качестве **m_sBorderStyle**.|  
|**Подпись**|**(DISP_STOCKPROP_CAPTION)**|Значение доступного путем вызова `InternalGetText`.|  
|**Включено**|**(DISP_STOCKPROP_ENABLED)**|Значение, доступным в качестве **m_bEnabled**.|  
|**Шрифт**|**(DISP_STOCKPROP_FONT)**|См. в статье [элементы управления MFC ActiveX: использование шрифтов](../mfc/mfc-activex-controls-using-fonts.md) для использования.|  
|`ForeColor`|**(DISP_STOCKPROP_FORECOLOR)**|Значение доступного путем вызова `GetForeColor`.|  
|**hWnd**|**(DISP_STOCKPROP_HWND)**|Значение, доступным в качестве `m_hWnd`.|  
|**Text**|**(DISP_STOCKPROP_TEXT)**|Значение доступного путем вызова `InternalGetText`. Это свойство является таким же, как **заголовок**, за исключением имени свойства.|  
|**Состояние готовности**|**DISP_STOCKPROP_READYSTATE()**|Значение, доступным в качестве m_lReadyState или`GetReadyState`|  
  
##  <a name="_core_stock_properties_and_notification"></a>Свойства хранения и уведомления  
 Многие стандартные свойства имеют функции уведомления, которые могут быть изменены. Например, каждый раз, когда `BackColor` изменения свойств, `OnBackColorChanged` вызывается функция (функцию-член класса элемента управления). Реализация по умолчанию (в `COleControl`) вызовы `InvalidateControl`. Переопределите эту функцию, если необходимо предпринять дополнительные действия при возникновении такой ситуации.  
  
##  <a name="_core_color_properties"></a>Свойства цвета  
 Можно использовать акции `ForeColor` и `BackColor` , и собственный пользовательский цвет свойств при рисовании элемента управления. Чтобы использовать свойство цвета, вызвать [COleControl::TranslateColor](../mfc/reference/colecontrol-class.md#translatecolor) функции-члена. Параметры этой функции — значение свойства color и дескриптор палитры необязательно. Возвращает значение **COLORREF** значение, которое может быть передан GDI, такие функции как `SetTextColor` и `CreateSolidBrush`.  
  
 Значения цвета акции `ForeColor` и `BackColor` доступа к свойствам с помощью вызова `GetForeColor` или `GetBackColor` функции, соответственно.  
  
 В следующем примере показано использование свойства этих двух цветов при рисовании элемента управления. Он инициализирует временную **COLORREF** переменной и `CBrush` объекта с вызовами `TranslateColor`: один с помощью `ForeColor` свойства и другие using `BackColor` свойство. Временный `CBrush` объект затем используется для закрашивания элемента управления, а цвет текста задается с помощью `ForeColor` свойство.  
  
 [!code-cpp[NVC_MFC_AxUI#24](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_3.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)   
 [Элементы управления MFC ActiveX: свойства](../mfc/mfc-activex-controls-properties.md)   
 [Элементы управления MFC ActiveX: методы](../mfc/mfc-activex-controls-methods.md)   
 [Класс COleControl](../mfc/reference/colecontrol-class.md)
