---
title: "Практическое руководство. Реализация отслеживания в коде | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CRectTracker - класс, реализация средства отслеживания"
ms.assetid: baaeca2c-5114-485f-bf58-8807db1bc973
caps.latest.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Практическое руководство. Реализация отслеживания в коде
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Для отслеживания элемент OLE следует обрабатывать некоторые события, относящиеся к элементу, например выбрать элемент или обновить представление документа.  Во всех случаях достаточно объявить временный объект [CRectTracker](../mfc/reference/crecttracker-class.md) и управления элементами посредством данного объекта.  
  
 Когда пользователь выбирает элемент или вставляет объект с помощью команды меню, необходимо инициализировать средство отслеживания с правильными стилями для представления состояние элемент OLE.  В следующей таблице которых соглашения, используемые в примере OCLIENT.  Дополнительные сведения об этих правилах см. в разделе `CRectTracker`.  
  
### Стили контейнера и состояния элемент OLE  
  
|Указанный стиль|Состояние элемент OLE|  
|---------------------|---------------------------|  
|Полученная точки граница|Связанный элемент|  
|Сплошная граница|Элемент вставлен в документе|  
|Маркеры изменения размеров|Элемент выбран|  
|Насиженная граница|Элемент в данный момент активен на месте|  
|Насиживать шаблон располагается поверх элемента|Сервер элемента открыт|  
  
 Можно обработать инициализация легко с помощью этой процедуры, которая проверяет состояние элемент OLE и устанавливает соответствующие стили.  Функция **SetupTracker** найдена в примере OCLIENT показывает инициализацию отслежывателя.  Параметры для данной функции адрес отслежывателя, *pTracker*; указатель на член клиента, связанный с отслежывателю, `pItem`; и указатель на прямоугольника, *pTrueRect*.  Более полный пример этой функции см. в примере MFC [OCLIENT](../top/visual-cpp-samples.md) OLE.  
  
 Пример кода **SetupTracker** представляет одну функцию; смешиваются линии функции с обсуждением функций функции:  
  
 [!code-cpp[NVC_MFCOClient#1](../mfc/codesnippet/CPP/how-to-implement-tracking-in-your-code_1.cpp)]  
  
 Tracker инициализируется с помощью установки минимальный размер и для стиля отслежывателя.  
  
 [!code-cpp[NVC_MFCOClient#2](../mfc/codesnippet/CPP/how-to-implement-tracking-in-your-code_2.cpp)]  
  
 Следующие линии проверяют, чтобы увидеть, выбран ли элемент в данный момент и связан ли элемент в документ или внедряется в нем.  Маркеры изменения размеров, расположенные на внутри границы добавляются на стиль, что элемент выбран.  Если элемент привязывается к документу, предоставленный точки используется стиль границы.  Сплошная граница используется, если элемент вставлен.  
  
 [!code-cpp[NVC_MFCOClient#3](../mfc/codesnippet/CPP/how-to-implement-tracking-in-your-code_3.cpp)]  
  
 Следующий код располагается поверх элемента с насиженным шаблоном, если элемент в настоящий момент открыт.  
  
 [!code-cpp[NVC_MFCOClient#4](../mfc/codesnippet/CPP/how-to-implement-tracking-in-your-code_4.cpp)]  
  
 Затем можно вызвать данную функцию, если средство отслеживания должен быть открыт.  Например, вызовите эту функцию из функции `OnDraw` класса представления.  Это обновляет внешний вид отслежывателя при представлении обновляется.  Полный пример см. на функцию **CMainView::OnDraw** образца [OCLIENT](../top/visual-cpp-samples.md) MFC OLE.  
  
 В приложении, события, требующие код отслежывателя \(например, изменение, перемещение и проверка обнаружение, происходят.  Эти действия показывают, что обычно делается попытка захватить или перемещение элемента.  В этих случаях необходимо решить, что было захвачено: маркер изменения размера или часть границу между маркеров изменения размера.  Обработчик сообщений `OnLButtonDown` рекомендуется начать ознакомление с раздела для выполнения положение указателя мыши по сравнению с элементом.  Вызывать в `CRectTracker::HitTest`.  Если тест возвращает что\-то, кроме **CRectTracker::hitOutside**, изменения или удаления элемента.  Поэтому необходимо выполнять в функцию\-член `Track`.  См. функцию **CMainView::OnLButtonDown**, расположенную в примере MFC [OCLIENT](../top/visual-cpp-samples.md) OLE полный пример.  
  
 Класс `CRectTracker` предоставляет несколько различных фигур курсора, используемых для отображения изменения ли перемещать их, или выполняется операция перетаскивания.  Обработка этого события, установите флажок для просмотра, выбран ли элемент в данный момент под указателем мыши.  Если это так, то вызывать в `CRectTracker::SetCursor`, или вызвать обработчика по умолчанию.  В следующем примере из образца [OCLIENT](../top/visual-cpp-samples.md) MFC OLE:  
  
 [!code-cpp[NVC_MFCOClient#5](../mfc/codesnippet/CPP/how-to-implement-tracking-in-your-code_5.cpp)]  
  
## См. также  
 [Средства отслеживания. Реализация средств отслеживания в приложении OLE](../mfc/trackers-implementing-trackers-in-your-ole-application.md)