---
title: 'Как: реализация отслеживания в коде | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- CRectTracker class [MFC], implementing trackers
ms.assetid: baaeca2c-5114-485f-bf58-8807db1bc973
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: bae9696be10ab00a076a73c14281a9baabe3d6d8
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33349740"
---
# <a name="how-to-implement-tracking-in-your-code"></a>Практическое руководство. Реализация отслеживания в коде
Чтобы отслеживать объект OLE, должен обрабатывать определенные события, связанные с элементом, например при выборе пункта меню или обновление представления документа. Во всех случаях достаточно объявить временную [CRectTracker](../mfc/reference/crecttracker-class.md) объекта и манипуляции элементом, с помощью этого объекта.  
  
 Когда пользователь выбирает элемент или вставляет объект с помощью команды меню, необходимо инициализировать инспектор с правильной стили для представления состояние элемента OLE. В следующей таблице указаны обозначения, используемые в образце OCLIENT. Дополнительные сведения об этих стилей см. в разделе `CRectTracker`.  
  
### <a name="container-styles-and-states-of-the-ole-item"></a>Стили контейнера, а также состояния объекта OLE  
  
|Стиль отображения|Состояние элемента управления OLE|  
|---------------------|-----------------------|  
|Пунктирная граница|Связанный элемент|  
|Сплошная граница|Элемент внедряется в документ|  
|Маркеры изменения размера|В настоящее время выбран элемент|  
|Штриховой границей|Элемент является активным в данный момент на месте|  
|Элемент наложений шаблон штриховки|Открытие элемента сервера|  
  
 Можно обработать эту инициализацию легко с помощью процедуры, которая используется для проверки состояния объекта OLE и устанавливает подходящие стили. **SetupTracker** функцией, которая находится в образце OCLIENT показана инициализация отслеживания. Параметры для этой функции являются адресами средство отслеживания *pTracker*; с помощью указателя на элемент клиента, связанные с отслеживанием, `pItem`; и указатель на прямоугольник, *pTrueRect*. Более полный пример этой функции см. в разделе Пример MFC OLE [OCLIENT](../visual-cpp-samples.md).  
  
 **SetupTracker** пример кода представляется одной функции; строки функции смешиваются с обсуждения возможностей функции:  
  
 [!code-cpp[NVC_MFCOClient#1](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_1.cpp)]  
  
 Средство отслеживания инициализируется путем установки минимальный размер и стиль инспектор очистки.  
  
 [!code-cpp[NVC_MFCOClient#2](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_2.cpp)]  
  
 Следующие строки проверьте ли в данный момент выбран элемент и связанный с этим документом или внедренный в него элемент. Маркеры изменения размера, расположенных внутри границы добавляются стиля, указывающее на то, что в настоящее время выбран элемент. Если соответствующий элемент связан в документе, используется стиль пунктиром. Если внедренный элемент используется сплошная граница.  
  
 [!code-cpp[NVC_MFCOClient#3](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_3.cpp)]  
  
 Следующий код наложений откройте элемент с заштрихованного шаблон, если элемент.  
  
 [!code-cpp[NVC_MFCOClient#4](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_4.cpp)]  
  
 Затем можно вызвать эту функцию всякий раз, когда средство отслеживания должен быть отображен. Например, вызов этой функции из `OnDraw` функция класса представления. Это обновление внешнего вида окна инспектора при окрашивание представления. Полный пример см. в разделе **CMainView::OnDraw** функция образца MFC OLE [OCLIENT](../visual-cpp-samples.md).  
  
 В приложении события, которые требуют tracker кода, например изменения размера, перемещение или нажатия обнаружение, будет выполняться. Эти действия обычно указывают, что предпринята попытка захвата или переместить элемент. В этих случаях необходимо решить, что было захвачено: маркер изменения размера или его части границы между маркерами изменения размера. `OnLButtonDown` Обработчик сообщений удобен для тестирования позицию указателя мыши относительно элемента. Вызвать `CRectTracker::HitTest`. Если тест возвращает отличное **CRectTracker::hitOutside**, элемент является время изменения размеров или перемещен. Таким образом, необходимо сделать вызов `Track` функции-члена. В разделе **CMainView::OnLButtonDown** функции находятся в образце MFC OLE [OCLIENT](../visual-cpp-samples.md) полный пример.  
  
 `CRectTracker` Класс предоставляет несколько фигур другой курсор, указывает ли операция перемещения изменения размера или перетащите выполняется операция. Чтобы обработать это событие, проверьте, выбран ли элемент в данный момент под указателем мыши. Если это так, вызвать `CRectTracker::SetCursor`, или вызывать обработчик по умолчанию. Следующий пример взят из образца MFC OLE [OCLIENT](../visual-cpp-samples.md):  
  
 [!code-cpp[NVC_MFCOClient#5](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_5.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Средства отслеживания. Реализация средств отслеживания в приложении OLE](../mfc/trackers-implementing-trackers-in-your-ole-application.md)

