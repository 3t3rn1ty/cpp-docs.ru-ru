---
title: "Точки подключения | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: IConnectionPoint
dev_langs: C++
helpviewer_keywords:
- IConnectionPoint interface
- connections, connection points
- OLE COM connection points
- MFC COM, connection points
- COM, connection points
- interfaces, IConnectionPoint
- MFC, COM support
- connection points [MFC]
- CCmdTarget class [MFC], and connection points
- sinks, connection points
ms.assetid: bc9fd7c7-8df6-4752-ac8c-0b177442c88d
caps.latest.revision: "10"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 0d8bbb131aa5d4ce1b12cba84c3928b80a8b2a7e
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="connection-points"></a>Точки подключения
В этой статье объясняется, как реализовать точки подключения (прежнее название — точки подключения OLE) с использованием классов MFC `CCmdTarget` и `CConnectionPoint`.  
  
 В прошлом модели объектов компонентов (COM) определен общий механизм (**IUnknown::QueryInterface**), допускающая объектов можно реализовать и предоставлять функции в интерфейсах. Тем не менее соответствующий механизм, который допускается объектов для предоставления их возможности вызова определенных интерфейсов не был определен. То есть COM определенные входящих указатели на объекты были обработаны (указатели на интерфейсы этого объекта), но не содержал модель явного для исходящих интерфейсов (указатели, объект содержит интерфейсы других объектов). COM теперь имеет модель, называется точки подключения, поддерживающий эту функцию.  
  
 Соединение состоит из двух частей: объект, вызывающий интерфейса, который называется источник и объект, реализующий интерфейс, называется приемником. Точки подключения — это интерфейс, предоставленный источником. Путем предоставления доступа к точке соединения, источник позволяет приемники для установления соединений к самому себе (источником). Через подключение точки механизм ( **IConnectionPoint** интерфейса), указатель на интерфейс приемника передается к исходному объекту. Этот указатель представляет собой источник с доступом к реализацию приемника набора функций-членов. Например срабатывание события, реализуемого в приемник, источник может вызовите соответствующий метод реализации приемника. На следующем рисунке показано соединение точка указанных выше.  
  
 ![Реализации точки подключения](../mfc/media/vc37lh1.gif "vc37lh1")  
Реализованная точка подключения  
  
 Реализация этой модели в MFC [CConnectionPoint](../mfc/reference/cconnectionpoint-class.md) и [CCmdTarget](../mfc/reference/ccmdtarget-class.md) классы. Классы, производные от **CConnectionPoint** реализовать **IConnectionPoint** интерфейс, используются для предоставления точек подключения для других объектов. Классы, производные от `CCmdTarget` реализовать **IConnectionPointContainer** интерфейс, который можно перечисления всех точек подключения, доступных для объекта или найти конкретную точку подключения.  
  
 Для каждой точки подключения, реализован в вашем классе необходимо объявить часть подключения, которая реализует точку подключения. Если вы реализуете одну или несколько точек подключения, также необходимо объявить сопоставление одного подключения в классе. Сопоставление подключения — это таблица точек соединения, поддерживаемых элементом управления ActiveX.  
  
 В следующих примерах демонстрируется сопоставление простого подключения и одну точку подключения. Первый пример объявляет сопоставление подключения и точки; Во втором примере реализует карты и точки. Обратите внимание, что `CMyClass` должен быть `CCmdTarget`-производного класса. В первом примере, код вставляется в объявлении класса, в разделе **защищенных** раздела:  
  
 [!code-cpp[NVC_MFCConnectionPoints#1](../mfc/codesnippet/cpp/connection-points_1.h)]  
  
 `BEGIN_CONNECTION_PART` И **END_CONNECTION_PART** макросы объявить класс внедренных `XSampleConnPt` (производный от `CConnectionPoint`), что указывают реализует этого конкретного подключения. Если вы хотите изменить любой `CConnectionPoint` функции-члены или добавить собственные функции-члены, объявите их между этих двух макросов. Например `CONNECTION_IID` переопределяет макрос `CConnectionPoint::GetIID` функция-член, помещенный между этих двух макросов.  
  
 Во втором примере код вставляется в элемент управления файла реализации (CPP-файл). Этот код реализует карты подключения, которая содержит точку подключения, `SampleConnPt`:  
  
 [!code-cpp[NVC_MFCConnectionPoints#2](../mfc/codesnippet/cpp/connection-points_2.cpp)]  
  
 Если у класса имеется более одного подключения точки, вставлять дополнительные `CONNECTION_PART` макросы между `BEGIN_CONNECTION_MAP` и `END_CONNECTION_MAP` макросы.  
  
 Наконец, добавьте вызов `EnableConnections` в конструктор класса. Пример:  
  
 [!code-cpp[NVC_MFCConnectionPoints#3](../mfc/codesnippet/cpp/connection-points_3.cpp)]  
  
 После вставки этого кода в `CCmdTarget`-производном классе предоставляет точку подключения для **ISampleSink** интерфейса. На следующем рисунке показано в этом примере.  
  
 ![Точка подключения, реализованная с помощью MFC](../mfc/media/vc37lh2.gif "vc37lh2")  
Точки подключения, реализуется с помощью MFC  
  
 Как правило, точки подключения поддерживают «многоадресная рассылка» — подключен к нескольким обработчикам возможности тот же интерфейс. В приведенном ниже примере фрагменте показано, как многоадресная рассылка, проходя через каждый приемник в точке соединения:  
  
 [!code-cpp[NVC_MFCConnectionPoints#4](../mfc/codesnippet/cpp/connection-points_4.cpp)]  
  
 В этом примере извлекается текущий набор подключений на `SampleConnPt` точки подключения с помощью вызова `CConnectionPoint::GetConnections`. Метод обходит подключений и вызовы **ISampleSink::SinkFunc** для каждого активного подключения.  
  
## <a name="see-also"></a>См. также  
 [MFC COM](../mfc/mfc-com.md)

