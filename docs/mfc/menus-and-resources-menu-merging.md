---
title: "Меню и ресурсы: слияние меню | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- status bars [MFC], OLE document applications
- visual editing [MFC], application menus and resources
- coordinating menu layouts [MFC]
- OLE containers [MFC], menus and resources
- toolbars [MFC], OLE document applications
- merging toolbar and status bar [MFC]
- menus [MFC], OLE document applications
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: c686d461a3052feb4a55cf7948b58102f10ac1f1
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="menus-and-resources-menu-merging"></a>Меню и ресурсы. Слияние меню
В этой статье описаны действия, необходимые для приложения документов OLE для визуального редактирования и перекрестный должным образом. Активация на месте возникают сложности для контейнера и сервера приложений (компонент). Пользователь остается в том же окне фрейма (в контексте документа-контейнера), но фактически запущена другим приложением (сервер). Это требует согласования между ресурсами контейнер и сервер приложений.  
  
 В этой статье рассматриваются:  
  
- [Макеты меню](#_core_menu_layouts)  
  
- [Панели инструментов и строки состояния](#_core_toolbars_and_status_bars)  
  
##  <a name="_core_menu_layouts"></a>Макеты меню  
 Первый шаг заключается в координации макеты меню. Дополнительные сведения см. в разделе **меню создания** статьи [вопросы программирования меню](https://msdn.microsoft.com/library/ms647557.aspx) в Windows SDK.  
  
 Приложения контейнера следует создать новое меню для использования только в том случае, когда внедренные элементы активируются на месте. Как минимум это меню должен состоять из следующих значений в указанном порядке:  
  
1.  Меню "файл" идентична используется, если файлы открыты. (Обычно не остальных пунктов меню, помещаются до следующего элемента.)  
  
2.  Два последовательных разделителя.  
  
3.  Меню "окно" идентична используется, если файлы открыты (только если приложение контейнера в приложении MDI). Некоторые приложения могут иметь другие меню, например меню параметров, входящие в эту группу, которая сохраняется в меню при активации встроенного элемента на месте.  
  
    > [!NOTE]
    >  Могут существовать другие меню, которые влияют на представление документа-контейнера, например масштаб. Эти меню контейнера отображаются между два разделителя в этом ресурсе меню.  
  
 Приложения сервера (компонент), также следует создать новое меню специально для активации на месте. Это должен быть как меню, используемое, если файлы открыты, но без пунктов меню, например файл и окно, в котором обработки документа сервера вместо данных. Как правило это меню состоит из следующих компонентов:  
  
1.  В меню Правка идентичной используется, если файлы открыты.  
  
2.  Разделитель.  
  
3.  Правка меню, например меню пера в образце приложения Scribble объектов.  
  
4.  Разделитель.  
  
5.  Меню "Справка".  
  
 Например рассмотрим макет некоторые меню Образец на месте для контейнера и сервер. Чтобы сделать пример более наглядным были удалены сведения каждого элемента меню. Меню контейнера на месте имеет следующие записи:  
  
```  
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&File C1"  
    MENUITEM SEPARATOR  
    POPUP "&Zoom C2"  
    MENUITEM SEPARATOR  
    POPUP "&Options C3"  
    POPUP "&Window C3"  
END  
```  
  
 Последовательные разделители указывать, куда в первой части меню сервера. Теперь рассмотрим меню на месте сервера:  
  
```  
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&Edit S1"  
    MENUITEM SEPARATOR  
    POPUP "&Format S2"  
    MENUITEM SEPARATOR  
    POPUP "&Help S3"  
END  
```  
  
 Здесь разделителей указывать, куда вторая группа пунктов меню контейнера. Полученная в результате структура меню при активации объекта с этого сервера на месте в этом контейнере выглядит следующим образом:  
  
```  
BEGIN  
    POPUP "&File C1"  
    POPUP "&Edit S1"  
    POPUP "&Zoom C2"  
    POPUP "&Format S2"  
    POPUP "&Options C3  
    POPUP "&Window C3"  
    POPUP "&Help S3"  
END  
```  
  
 Как видите, разделители были заменены различные группы меню каждого приложения.  
  
 Таблицы сочетаний клавиш, связанных с данным меню на месте также должен предоставляться серверного приложения. Контейнер будет внедрять их в свой собственный таблицы сочетаний клавиш.  
  
 При активизации внедренного элемента на месте, платформа загружает меню на месте. Он запрашивает у сервера приложения для его меню для активации на месте и вставляет его в которых в качестве разделителей. Это, как объединить меню. Получите меню из контейнера для работы с файла и размещение окон и меню получить от сервера для работы с элемента.  
  
##  <a name="_core_toolbars_and_status_bars"></a>Панели инструментов и строки состояния  
 Серверные приложения необходимо создать новую панель инструментов и хранить в отдельный файл изображения ее. Приложение, создаваемые мастером приложения хранения растрового изображения в файле с именем ITOOLBAR. BMP. Новая панель инструментов заменяет панель инструментов приложения-контейнера при сервера элемент активируется в месте и следует содержат одинаковые элементы как обычный панели инструментов, но удалить значки, представляющие элементы меню «файл» и окно.  
  
 Эта панель инструментов загружается в вашей `COleIPFrameWnd`-производный класс создан с помощью мастера приложений. В строке состояния обрабатывается приложением-контейнером. Дополнительные сведения о реализации окна фрейма на месте см. в разделе [серверы: реализация сервера](../mfc/servers-implementing-a-server.md).  
  
## <a name="see-also"></a>См. также  
 [Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)   
 [Активация](../mfc/activation-cpp.md)   
 [Серверы](../mfc/servers.md)   
 [Контейнеры](../mfc/containers.md)

