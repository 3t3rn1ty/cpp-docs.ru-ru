---
title: "Меню и ресурсы. Слияние меню | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "координирование шаблонов меню"
  - "меню [C++], приложения документов OLE"
  - "слияние панели инструментов и строки состояния"
  - "OLE - контейнеры, меню и ресурсы"
  - "строки состояния, приложения документов OLE"
  - "панели инструментов [C++], приложения документов OLE"
  - "визуальное редактирование, меню и ресурсы приложений"
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
caps.latest.revision: 9
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 6
---
# Меню и ресурсы. Слияние меню
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Сведения в статье шаги для приложений OLE документа обработки встроенная функция визуального редактирования и активация правильно.  Встроенная функция активация представляет проблему и контейнера для приложений и компонентов сервера \(\).  Пользователь остается в том же окне фреймовом \(в контексте документа контейнера\), но фактически выполняется другое приложение \(сервер\).  Это требует координации между ресурсами контейнера и серверными приложениями.  
  
 Разделы описанные в этой статье:  
  
-   [Макеты меню](#_core_menu_layouts)  
  
-   [Панели инструментов и строки состояния](#_core_toolbars_and_status_bars)  
  
##  <a name="_core_menu_layouts"></a> Макеты меню  
 Первый шаг координировать макетов меню.  Дополнительные сведения см. в разделе **Создание меню** в [Вопросы программирования меню](https://msdn.microsoft.com/en-us/library/ms647557.aspx) в [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)].  
  
 Приложение\-контейнеры необходимо создать новое меню, который следует использовать, только если внедренные элементы активированы на месте.  В меню минимуме, это должно состоять из следующего, в указанном порядке:  
  
1.  Меню "Файл" идентичное, если файлы открыты. \(Обычно другие пункты меню не помещаются до следующего элемента\).  
  
2.  2 Последовательных разделителя.  
  
3.  Меню окна идентичное, если файлы открытый \(если контейнерное приложение в приложении MDI\).  Некоторые приложения могут иметь другие меню, например меню параметров, которые принадлежат в этой группе, которая находится в меню, когда вложенный элемент активирован на месте.  
  
    > [!NOTE]
    >  Могут существовать другие меню, которые влияют на представление документа контейнера, например увеличение.  Эти меню контейнера отображается между 2 разделителями в этом ресурсе меню.  
  
 Приложения сервера \(компонента\) необходимо также создать новое меню специально для встроенной активации.  Она должна быть, например, если файлы открыть меню, но без пунктов меню, например файл и окно, управляющих документа серверного вместо данных.  Обычно это меню состоит из следующих компонентов:  
  
1.  Меню " Правка " идентичное, если файлы открыты.  
  
2.  Разделитель.  
  
3.  Объект редактирования меню, например меню пера в примере приложения Scribble.  
  
4.  Разделитель.  
  
5.  Меню " Справка ".  
  
 Пример, просмотрите макет некоторых меню примера на месте для контейнера и сервера.  Подробности каждого пункта меню были удалены, чтобы сделать код примера.  Меню контейнера на месте имеет следующие записи:  
  
```  
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&File C1"  
    MENUITEM SEPARATOR  
    POPUP "&Zoom C2"  
    MENUITEM SEPARATOR  
    POPUP "&Options C3"  
    POPUP "&Window C3"  
END  
```  
  
 Последовательные разделителей показывают, где первая часть меню сервера должны содержаться.  Теперь необходимо меню сервера на месте:  
  
```  
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&Edit S1"  
    MENUITEM SEPARATOR  
    POPUP "&Format S2"  
    MENUITEM SEPARATOR  
    POPUP "&Help S3"  
END  
```  
  
 Разделители здесь показывают, где вторая группа в составе пункты меню контейнера должны содержаться.  Результирующее структура меню, когда объект из этого сервера активирован на месте внутри этого контейнера выглядит следующим образом:  
  
```  
BEGIN  
    POPUP "&File C1"  
    POPUP "&Edit S1"  
    POPUP "&Zoom C2"  
    POPUP "&Format S2"  
    POPUP "&Options C3  
    POPUP "&Window C3"  
    POPUP "&Help S3"  
END  
```  
  
 Как видно, разделители замените с различными группами в составе меню каждого приложения.  
  
 Таблицы сочетаний клавиш, связанные с на месте меню также должны предоставляться серверными приложениями.  Контейнер будет включать их в собственные таблицы сочетаний клавиш.  
  
 Если вложенный элемент активирован на месте платформа загружает на месте меню.  Затем запрашивает серверное приложение этого меню встроенная функция активации и вставляет его, где разделителей.  Это способ меню объединяются.  При получении меню из контейнера для работы на размещения файла и окна, и появляется меню с сервера для работы в элементе.  
  
##  <a name="_core_toolbars_and_status_bars"></a> Панели инструментов и строки состояния  
 Серверные приложения необходимо создать новый инструмент растровое изображение и сохраняет его в отдельном файле.  Приложения, созданные мастером приложения сохраняют это растровое изображение в файле ITOOLBAR.BMP.  Новый инструмент заменяет панель инструментов приложения, когда элемент сервера активирован на месте и должен содержать те же элементы, что и обычный инструмент, но удалить Значки, представляющих элементы в файле и Окнах меню.  
  
 Эта панель инструментов загружается в `COleIPFrameWnd`\- производном классе, автоматически созданный мастером приложений.  Строка состояния обрабатывается из приложения контейнера.  Дополнительные сведения о реализации окна фрейма для встроенного редактирования см. в разделе [Серверы: Реализация сервера](../mfc/servers-implementing-a-server.md).  
  
## См. также  
 [Меню и ресурсы \(OLE\)](../mfc/menus-and-resources-ole.md)   
 [Активация](../mfc/activation-cpp.md)   
 [Серверы](../mfc/servers.md)   
 [Контейнеры](../mfc/containers.md)