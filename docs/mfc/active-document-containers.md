---
title: Контейнеры активных документов | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- active documents [MFC], containers
- active document containers [MFC]
- containers [MFC], active document
- MFC COM, active document containment
ms.assetid: ba20183a-8b4c-440f-9031-e5fcc41d391b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: a47db4f9715c539ecf9bcbfb78e48b7e8edbc94b
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="active-document-containers"></a>Контейнеры активных документов
Контейнер активного документа, например Microsoft Office Binder или Internet Explorer позволяет работать с несколькими документами для разных типов приложений в пределах одного кадра (вместо вас от необходимости создавать и использовать несколько кадров приложения для каждого Тип документа).  
  
 Контейнеры активных документов в MFC обеспечивает полную поддержку `COleDocObjectItem` класса. Можно использовать мастер приложений MFC создает контейнер активного документа, выбрав **контейнер активного документа** флажок на **поддержка составных документов** мастера приложений MFC. Дополнительные сведения см. в разделе [Создание приложения контейнера активных документов](../mfc/creating-an-active-document-container-application.md).  
  
 Дополнительные сведения о контейнерах активных документов см. в разделе:  
  
-   [Требования к контейнеру](#container_requirements)  
  
-   [Объекты сайтов документа](#document_site_objects)  
  
-   [Просмотр объектов сайта](#view_site_objects)  
  
-   [Объект кадра](#frame_object)  
  
-   [Слияние меню "Справка"](../mfc/help-menu-merging.md)  
  
-   [Программная печать](../mfc/programmatic-printing.md)  
  
-   [Целевые объекты команд](../mfc/message-handling-and-command-targets.md)  
  
##  <a name="container_requirements"></a> Требования к контейнеру  
 Поддержку активного документа в контейнер активных документов предполагает не только для реализации интерфейса: также требуются знания служб с помощью интерфейсов содержащегося объекта. Тоже относится к расширениям активного документа, где контейнера необходимо также знать, как использовать эти интерфейсы модуля на самих активных документов.  
  
 Контейнер активного документа, который интегрирует активные документы должны:  
  
-   Сможет обработать объект хранилища с помощью **IPersistStorage** интерфейс, то есть, он должен предоставлять `IStorage` экземпляр для каждого активного документа.  
  
-   Поддерживают основные возможности внедрение OLE-документы, создавая объектов «сайт» (по одному для каждого документа или внедрение), реализующие **IOleClientSite** и **IAdviseSink**.  
  
-   Поддерживает активацию на месте внедренные объекты или активных документов. Необходимо реализовать объекты контейнера сайтов `IOleInPlaceSite` и необходимо предоставить объект контейнера кадра **IOleInPlaceFrame**.  
  
-   Поддерживает активные документы расширений, реализовав `IOleDocumentSite` предоставлять механизм для контейнера, связавшись с документа. При необходимости контейнера можно реализовать интерфейсы активного документа `IOleCommandTarget` и `IContinueCallback` для получения самых простых команд, например печать или сохранение.  
  
 Объект кадра, объекты представлений и объект-контейнер можно при необходимости реализовать **IOleCommandTarget** для поддержки диспетчеризации некоторых команд, как описано в [целей команды](../mfc/message-handling-and-command-targets.md). Представления и контейнер объектов можно также реализовать класс `IPrint` и `IContinueCallback`, для поддержки программная печать, как описано в [программный печати](../mfc/programmatic-printing.md).  
  
 На следующем рисунке показана концептуальная связи между контейнером и его компонентов (слева) и активного документа и их представления (справа). Активный документ управляет хранения и обработки данных и представления отображаются или при необходимости выводит эти данные. Интерфейсы полужирным шрифтом, которые требуется для участия в активном документе; Эти полужирный и курсивный являются необязательными. Необходимы все другие интерфейсы.  
  
 ![Интерфейсы контейнера активного документа](../mfc/media/vc37gj1.gif "vc37gj1")  
  
 Документ, который поддерживает только одно представление можно реализовать документа и представление компонентов (то есть их соответствующих интерфейсов) на один конкретный класс. Кроме того узел контейнера, который поддерживает только одно представление можно объединить узла документов и Просмотр сайта в класс одного конкретного сайта. Объект кадра контейнера, однако должны оставаться distinct и контейнера документа просто включен компонент здесь для предоставления полной картины архитектура; не зависит от архитектуры вложения активного документа.  
  
##  <a name="document_site_objects"></a> Объекты сайтов документа  
 В архитектуре вложения активного документа узла документов является объект сайта клиента в OLE-документы с добавлением `IOleDocument` интерфейс:  
  
 `interface IOleDocumentSite : IUnknown`  
  
 `{`  
  
 `HRESULT ActivateMe(IOleDocumentView *pViewToActivate);`  
  
 `}`  
  
 Узел документа по существу контейнер для одного или нескольких объектов «Просмотр сайта». Каждый объект сайта представления связан с объекты отдельных представлений документа управляется узла документов. Если контейнер поддерживает только одно представление каждого узла документа, затем его выполнить узла документов и Просмотр сайта с один конкретный класс.  
  
##  <a name="view_site_objects"></a> Просмотр объектов сайта  
 Объект узла представления контейнера управляет пространстве экрана для конкретного представления документа. Помимо поддержки стандарта `IOleInPlaceSite` обычно также реализует интерфейс, Просмотр сайта `IContinueCallback` для программного управления печатью. (Обратите внимание, что объект представления никогда не запрашивает `IContinueCallback` , фактически может осуществляться на любой объект пожеланий контейнера.)  
  
 Контейнер, который поддерживает несколько представлений, необходимо создать представление нескольких объектов сайта на сайте документа. Это предоставляет каждое представление отдельные активации и деактивации службы как благодаря `IOleInPlaceSite`.  
  
##  <a name="frame_object"></a> Объект кадра  
 Объект кадра контейнера является, в большинстве случаев одного кадра, который используется для активации на месте в документах OLE, то есть, который обрабатывает согласование меню и панели инструментов. Объект представления имеет доступ к этому объекту кадра через **IOleInPlaceSite::GetWindowContext**, обеспечивающий доступ к контейнеру объект, представляющий документе-контейнере (который может обрабатывать согласования уровня панели инструментов и содержащегося объекта перечисления).  
  
 Контейнер активного документа можно дополнить кадр, добавив `IOleCommandTarget`. Это позволяет принимать команды, которые создаются в интерфейсе пользователя активного документа таким же образом, что этот интерфейс можно разрешить контейнера для отправки команды (такие как **новый файл**, **откройте**,  **Сохранить как**, **печати**; **Edit Copy**, **вставить**, **отменить**и другие) для активного документа. Дополнительные сведения см. в разделе [целей команды](../mfc/message-handling-and-command-targets.md).  
  
## <a name="see-also"></a>См. также  
 [Вложение активного документа](../mfc/active-document-containment.md)

