---
title: "Регистрация | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- servers [MFC], initializing
- initializing servers [MFC]
- OLE, registration
- installing servers [MFC]
- registry [MFC], OLE item database
- registration databases [MFC]
- servers [MFC], installing
- OLE server applications [MFC], registering servers
ms.assetid: 991d5684-72c1-4f9e-a09a-9184ed12bbb9
caps.latest.revision: "9"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: e755ae6b0d6170087af64f7561b310894f0768d1
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="registration"></a>Регистрация
Когда пользователю для вставки элемента OLE в приложении OLE выводит список типов объектов для выбора. Этот список возвращает OLE из системной регистрации базы данных, который содержит сведения, предоставляемые все серверные приложения. Сервер регистрирует себя, операции, он помещает в регистрации системной базы данных (реестр) описания каждого типа объектов, которые он предоставляет, файла расширения и путь к самому себе, помимо прочего, сведения.  
  
 Платформа и OLE системные библиотеки динамической компоновки (DLL) Используйте этот реестр, чтобы определить, какие типы OLE-элементы доступны в системе. Система OLE библиотеки DLL также используют этот реестр для определения способа запуска серверного приложения при активации связанный или внедренный объект.  
  
 В этой статье описывается каждое серверное приложение требуется в случае, если он установлен, и каждый раз при ее выполнении.  
  
 Подробные сведения о регистрации системной базы данных и формата REG-файлов, используемую для обновления его разделе *справочнике программиста OLE*.  
  
##  <a name="_core_server_installation"></a>Установка сервера  
 При первой установке серверное приложение, его необходимо зарегистрировать все типы OLE-элементы, которые она поддерживает. Вы также можете обновить регистрацию системной базы данных каждый раз, он выполняется как отдельное приложение сервера. Это выполняет обновление базы данных регистрации при перемещении сервера исполняемый файл.  
  
> [!NOTE]
>  Приложения MFC, созданные с помощью мастера приложений автоматически регистрироваться при запуске в качестве автономных приложений.  
  
 Если вы хотите зарегистрировать приложение во время установки, используйте программу RegEdit.exe. (В Windows 95, Windows 98 и Windows ME RegEdit находится в каталоге Windows. В Windows NT и Windows 2000 RegEdit находится в папке System32.) Если программа установки включает вместе с приложением, имеют запуска программы установки» RegEdit /S *appname*.reg». (/S флаг указывает, операции в фоновом режиме, то есть он не отображается диалоговым окном reporting успешного завершения команды). В противном случае пользователю следует вручную выполнить RegEdit.  
  
> [!NOTE]
>  REG-файл, созданный мастером приложений не включает полный путь к исполняемому файлу. Программе установки необходимо либо изменить REG-файл включает полный путь к исполняемому файлу или изменение переменной среды PATH для включения в каталог установки.  
  
 RegEdit объединяет содержимое текстового REG-файл в базу данных регистрации. Проверка базы данных или для его восстановления, используйте редактор реестра. Будьте внимательны, чтобы избежать удаления основные операции OLE. (В Windows 95, Windows 98 и Windows ME, редактор реестра является RegEdit.exe. В Windows NT и Windows 2000 это RegEdit32.exe.)  
  
##  <a name="_core_server_initialization"></a>Инициализация сервера  
 При создании серверного приложения с помощью мастера приложений, мастер автоматически завершит все задачи инициализации для вас. В этом разделе описывается, что необходимо сделать, если серверное приложение создать вручную.  
  
 При запуске серверного приложения приложением контейнера OLE системные библиотеки DLL добавьте параметр «/ внедрение» командной строки сервера. Серверное приложение поведение отличается в зависимости от того, было ли он был запущен контейнер, поэтому проверка выполняется первое, что приложению необходимо выполнить, когда начинается ее выполнение «/ внедрение» или «-Embedding» в командной строке параметр. Если этот параметр существует, загрузить другой набор ресурсов, которые показывают, как активный либо на месте сервера или полностью открыть. Дополнительные сведения см. в разделе [меню и ресурсы: Добавление серверов](../mfc/menus-and-resources-server-additions.md).  
  
 Серверное приложение, также следует вызвать его `CWinApp::RunEmbedded` функции для синтаксического анализа командной строки. Если он возвращает ненулевое значение, приложение не должно отображать его окна, так как он был выполнен из приложения-контейнера, не в качестве изолированного приложения. Эта функция обновляет записи сервера регистрации системной базы данных и вызывает `RegisterAll` функции-члена для вас, выполняющий регистрацию экземпляра.  
  
 При запуске приложение сервера, необходимо убедиться в его способность выполнять регистрация экземпляра. Регистрация экземпляра информирует OLE системные библиотеки DLL, сервер включен и готов к приему запросов из контейнеров. Не добавляет запись в базу данных регистрации. Выполнение регистрации экземпляра сервера путем вызова `ConnectTemplate` функция-член определяется `COleTemplateServer`. Это подключит `CDocTemplate` объект `COleTemplateServer` объекта.  
  
 `ConnectTemplate` Функция принимает три параметра: сервер **CLSID**, указатель на `CDocTemplate` объект и флаг, указывающий, поддерживает ли сервер несколько экземпляров. Miniserver должен иметь возможность поддерживать несколько экземпляров, то есть оно должно быть возможно наличие нескольких экземпляров сервера для запуска одновременно, один для каждого контейнера. Следовательно, передайте **TRUE** этот флаг при запуске miniserver.  
  
 При создании miniserver по определению она всегда запускается в контейнере. По-прежнему следует выполнить синтаксический анализ командной строки для проверки для параметра «/ Embedding». Отсутствие этого параметра в командной строке означает пользователь попытался запустить miniserver как отдельное приложение. В этом случае зарегистрировать сервер в системную базу данных регистрации и отобразите окно сообщения, сообщая пользователю, чтобы запустить miniserver из приложения-контейнера.  
  
## <a name="see-also"></a>См. также  
 [OLE](../mfc/ole-in-mfc.md)   
 [Серверы](../mfc/servers.md)   
 [CWinApp::RunAutomated](../mfc/reference/cwinapp-class.md#runautomated)   
 [CWinApp::RunEmbedded](../mfc/reference/cwinapp-class.md#runembedded)   
 [Класс COleTemplateServer](../mfc/reference/coletemplateserver-class.md)
