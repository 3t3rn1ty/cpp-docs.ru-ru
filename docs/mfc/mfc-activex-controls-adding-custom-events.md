---
title: 'Элементы управления ActiveX MFC: Добавление пользовательских событий | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- MFC ActiveX controls [MFC], events [MFC]
- EVENT_CUSTOM prefix [MFC]
- custom events [MFC], adding to ActiveX controls
- EVENT_CUSTOM macro [MFC]
- InCircle method [MFC]
- ClickIn event
- FireClickIn event
- COleControl class [MFC], custom events [MFC]
- Click event, custom events [MFC]
- events [MFC], ActiveX controls
- custom events [MFC]
- FireEvent method, adding custom events
ms.assetid: c584d053-1e34-47aa-958e-37d3e9b85892
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: a2e6e5eeab0be13eb64052eb9e90a570dcc5124d
ms.sourcegitcommit: 060f381fe0807107ec26c18b46d3fcb859d8d2e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36929056"
---
# <a name="mfc-activex-controls-adding-custom-events"></a>Элементы управления ActiveX в MFC. Добавление пользовательских событий
Пользовательские события отличаются от событий хранения в том, что они не срабатывают автоматически классом `COleControl`. Пользовательское событие распознает определенное действие, определяются разработчиками элементов управления, как событие. EVENT_CUSTOM-макрос представлены карты записей событий для пользовательских событий. Следующий раздел реализует пользовательское событие для проекта элемента управления ActiveX, который был создан с помощью мастера элементов управления ActiveX.  
  
##  <a name="_core_adding_a_custom_event_with_classwizard"></a> Добавить пользовательское событие с мастер добавления события  
 Следующая процедура позволяет добавить определенные пользовательское событие ClickIn. Эта процедура позволяет добавить другие пользовательские события. Замените имя пользовательского события и его параметры ClickIn имя события, а также параметры.  
  
#### <a name="to-add-the-clickin-custom-event-using-the-add-event-wizard"></a>Чтобы добавить пользовательское событие ClickIn, используя мастер добавления события  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении классов щелкните правой кнопкой мыши по классу элемента управления ActiveX, чтобы открыть контекстное меню.  
  
3.  В контекстном меню щелкните **добавить** и нажмите кнопку **добавить событие**.  
  
     Откроется мастер добавления события.  
  
4.  В **имя события** , сначала выберите любые существующие события, а затем щелкните **настраиваемый** переключатель, а затем введите *ClickIn*.  
  
5.  В **внутреннее имя** введите имя функции обработки события. Например, используйте значение по умолчанию, предоставляемые мастер добавления события (`FireClickIn`).  
  
6.  Добавьте параметр с именем *xCoord* (тип *OLE_XPOS_PIXELS*), с использованием **имя параметра** и **тип параметра** элементов управления.  
  
7.  Добавьте второй параметр с именем *yCoord* (тип *OLE_YPOS_PIXELS*).  
  
8.  Нажмите кнопку **Готово** для создания события.  
  
##  <a name="_core_classwizard_changes_for_custom_events"></a> Добавление событий мастер изменения для пользовательских событий  
 При добавлении пользовательского события, мастер добавления события вносит изменения в класс элемента управления. СИМВОЛ «H». CPP, и. IDL-файлы. В следующих примерах кода определяются ClickIn-событие.  
  
 Следующие строки добавляются в заголовок (. H) файла класса элемента управления.  
  
 [!code-cpp[NVC_MFC_AxUI#7](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_1.h)]  
  
 Этот код объявляет встроенная функция вызывается `FireClickIn` , который вызывает [COleControl::FireEvent](../mfc/reference/colecontrol-class.md#fireevent) ClickIn-событие и параметры, определенные с помощью мастера добавления события.  
  
 Кроме того, следующая строка добавляется к схеме события для элемента управления, расположенных в реализации (. Файл .cpp) класса элемента управления:  
  
 [!code-cpp[NVC_MFC_AxUI#8](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_2.cpp)]  
  
 Этот код события ClickIn сопоставляется встроенная функция `FireClickIn`, передав параметры, определенные с помощью мастера добавления события.  
  
 И, наконец следующая строка добавляется в элемент управления. IDL-файла:  
  
 [!code-cpp[NVC_MFC_AxUI#9](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_3.idl)]  
  
 Эта строка назначает ClickIn-событие с определенным номером идентификатора взяты из положение события в списке событий мастер добавления события. Запись в списке событий позволяет контейнера реагировать на события. Например он может обеспечивать код обработчика, выполняемый при возникновении события.  
  
##  <a name="_core_calling_fireclickin"></a> Вызов FireClickIn  
 Теперь, когда вы добавили ClickIn пользовательское событие, используя мастер добавления событий, необходимо решить, случае срабатывание события. Это делается путем вызова `FireClickIn` при возникновении соответствующее действие. В данном разделе используется элемент управления `InCircle` функцию внутри обработчика сообщений WM_LBUTTONDOWN порождения события ClickIn, когда пользователь щелкает внутри области круга или эллипса. В следующей процедуре добавляется обработчик WM_LBUTTONDOWN.  
  
#### <a name="to-add-a-message-handler-with-the-add-event-wizard"></a>Чтобы добавить обработчик сообщений с помощью мастера добавления события  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении классов выберите класс элемента управления ActiveX.  
  
3.  В окне «Свойства» щелкните **сообщений** кнопки.  
  
     Окна «Свойства» отображает список сообщений, которые могут быть обработаны с помощью элемента управления ActiveX. Любое сообщение, показанное полужирным шрифтом, уже имеет функцию обработчика событий, назначенного ей.  
  
4.  В окне «Свойства» выберите сообщение, которое необходимо обработать. Для этого примера выберите WM_LBUTTONDOWN.  
  
5.  В раскрывающемся списке справа выберите  **\<Добавить > OnLButtonDown**.  
  
6.  Дважды щелкните новую функцию обработчика в представлении классов, чтобы перейти к коду обработчика сообщений в реализации (. Файл .cpp) элемента управления ActiveX.  
  
 Следующий код вызывает образец `InCircle` функции каждый раз при щелчке левой кнопкой мыши внутри окна элемента управления. В этом примере можно найти в функцию обработчика WM_LBUTTONDOWN `OnLButtonDown`в [образец CIRC](../visual-cpp-samples.md) абстрактным.  
  
 [!code-cpp[NVC_MFC_AxUI#10](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_4.cpp)]  
  
> [!NOTE]
>  Когда мастер добавления события создает обработчики сообщений для действия кнопок мыши, автоматически добавляется вызов один и тот же обработчик сообщений базового класса. Не удаляйте этот вызов. Если элемент управления используется любой из стандартных мыши сообщения, обработчики сообщений в базовом классе должен быть вызван для обеспечения правильной обработки захват мыши.  
  
 В следующем примере событие возникает, только если щелчок внутри области круга или эллипса в элементе управления. Чтобы добиться этого поведения, можно поместить `InCircle` функцию в реализации элемента управления (. Файл .cpp):  
  
 [!code-cpp[NVC_MFC_AxUI#11](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_5.cpp)]  
  
 Также необходимо добавить следующее объявление `InCircle` функцию для заголовка элемента управления (. H) файла.  
  
 [!code-cpp[NVC_MFC_AxUI#12](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_6.h)]  
  
##  <a name="_core_custom_events_with_stock_names"></a> Пользовательские события с названия акций  
 Можно создать пользовательские события с тем же именем, как биржевые события, однако нельзя реализовать оба в одном элементе управления. Например можно создать пользовательское событие, вызывается щелчка, который не запускается, когда стандартное событие Click бы обычно срабатывание. Затем может обработать события щелчка в любое время путем вызова функции обработки.  
  
 В следующей процедуре добавляется пользовательский щелкните событие.  
  
#### <a name="to-add-a-custom-event-that-uses-a-stock-event-name"></a>Чтобы добавить пользовательское событие, которое использует имя стандартное событие  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении классов щелкните правой кнопкой мыши по классу элемента управления ActiveX, чтобы открыть контекстное меню.  
  
3.  В контекстном меню щелкните **добавить** и нажмите кнопку **добавить событие**.  
  
     Откроется мастер добавления события.  
  
4.  В **имя события** раскрывающегося списка выберите имя стандартное событие. В этом примере выберите **щелкните**.  
  
5.  Для **тип события**выберите **настраиваемый**.  
  
6.  Нажмите кнопку **Готово** для создания события.  
  
7.  Вызовите `FireClick` в нужных местах в коде.  
  
## <a name="see-also"></a>См. также  
 [Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)   
 [Элементы управления MFC ActiveX: методы](../mfc/mfc-activex-controls-methods.md)   
 [Класс COleControl](../mfc/reference/colecontrol-class.md)
