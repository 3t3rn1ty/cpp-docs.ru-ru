---
title: "Перетаскивание. Реализация объекта-приемника | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "перетаскивание, цель перетаскивания"
  - "перетаскивание OLE, цель перетаскивания"
  - "перетаскивание OLE, реализация целей перетаскивания"
ms.assetid: 0689f1ec-5326-4008-b226-4b373c881358
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Перетаскивание. Реализация объекта-приемника
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этой статье которых, как сделать приложением целевой объект перетаскивания.  Реализация целевой объект перетаскивания требуется несколько больше операций, чем реализация источнику перетаскивания, но по\-прежнему относительно прост.  Эти методы также применяются к не OLE приложения.  
  
#### Реализовать целевой объект перетаскивания  
  
1.  Добавьте переменную\-член в каждое представление в приложении, которые должны быть целевым объектом перетаскивания.  Этот переменную\-член должен иметь тип `COleDropTarget` или класс, производный от него.  
  
2.  Из функции класса представления, обрабатывающей сообщение `WM_CREATE` \(обычно `OnCreate`\), вызовите функцию\-член `Register` новой переменной\-члена.  `Revoke` будет вызываться автоматически, когда для представления будет уничтожается.  
  
3.  Переопределите следующие функции.  Если требуется такое же расширение функциональности на протяжении всего приложения, следует переопределить класс этих функций по в представлении.  Если требуется изменить расширение функциональности в отдельных случаях или включить удаления не в окнах `CView`, переопределите эти функции в `COleDropTarget`\- производного класса.  
  
    |Переопределение|Разрешить|  
    |---------------------|---------------|  
    |`OnDragEnter`|Операции перетаскивания, который должен содержаться в поле.  Вызывается, когда курсор сначала вводит окно.|  
    |`OnDragLeave`|Особое расширение функциональности при операции перетаскивания, отобразится окно.|  
    |`OnDragOver`|Операции перетаскивания, который должен содержаться в поле.  Вызывается, когда курсор перетаскивания в окно.|  
    |`OnDrop`|Обработка данных, удаленных в указанное поле.|  
    |`OnScrollBy`|Особое расширение функциональности, когда прокрутки, в поле целевого объекта.|  
  
 См. файл MAINVIEW.CPP, который является частью образца [OCLIENT](../top/visual-cpp-samples.md) для примера MFC OLE, как эти функции работают вместе.  
  
 Дополнительные сведения см. в следующих разделах:  
  
-   [Реализация источнику перетаскивания](../mfc/drag-and-drop-implementing-a-drop-source.md)  
  
-   [Создание и уничтожения объектов OLE данных и источников данных](../mfc/data-objects-and-data-sources-creation-and-destruction.md)  
  
-   [Управление OLE объекты данных и источников данных](../mfc/data-objects-and-data-sources-manipulation.md)  
  
## См. также  
 [Перетаскивание \(OLE\)](../mfc/drag-and-drop-ole.md)   
 [COleDropTarget Class](../Topic/COleDropTarget%20Class.md)