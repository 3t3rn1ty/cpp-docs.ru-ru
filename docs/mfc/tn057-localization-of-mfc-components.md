---
title: 'TN057: Локализация компонентов MFC | Документы Microsoft'
ms.custom: ''
ms.date: 06/28/2018
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- vc.mfc.components
dev_langs:
- C++
helpviewer_keywords:
- components [MFC], localizing
- TN057
- resources [MFC], localization
- localization [MFC], MFC resources
- localization [MFC], MFC components
- MFC DLLs [MFC], localizing
- DLLs [MFC], localizing MFC
- localization [MFC], resources
ms.assetid: 5376d329-bd45-41bd-97f5-3d895a9a0af5
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: ec786277432ab1ce47614c3afac627733edc4985
ms.sourcegitcommit: 208d445fd7ea202de1d372d3f468e784e77bd666
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2018
ms.locfileid: "37121161"
---
# <a name="tn057-localization-of-mfc-components"></a>TN057. Локализация компонентов MFC

> [!NOTE]
> Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

Эта заметка описываются принципы и процедуры, которые можно использовать для локализации компонента, если он управляет приложения или OLE или библиотеку DLL, которая использует MFC.

## <a name="overview"></a>Обзор

Существует две проблемы для решения при локализации компонент, который использует MFC. Во-первых, необходимо локализовать собственные ресурсы — строки, диалоговые окна и другие ресурсы, относящиеся к компоненту. Большинство компонентов, созданных с использованием MFC также включить и использовать ряд ресурсов, которые определены в MFC. Локализованные ресурсы MFC также необходимо предоставить. К счастью MFC уже имеются несколько языков.

Кроме того компонент должно быть подготовлено к выполнить в целевой среде (Европейские или кодировку DBCS включены среде). В большинстве случаев это зависит от приложения правильно обработке символы расширенного набора, а также обработка строк с двухбайтовыми символами. MFC включена по умолчанию, обе эти среды таким образом, что можно иметь один двоичный по всему миру, используемый на всех платформах с только что различные ресурсы, которые подключены к сети во время установки.

## <a name="localizing-your-components-resources"></a>Локализация ресурсов компонента

Локализация приложением или библиотекой DLL привлечь подставляя ресурсы с ресурсами, которые соответствуют целевым языком. Для ресурсов, это относительно проста: редактирования ресурсов в редакторе ресурсов и построения приложения. Если код написан правильно, что будет нет строк или текст, который требуется локализовать жестко в исходный код C++ - все локализации можно сделать, просто изменив ресурсы. На самом деле могут реализовывать компонент таким образом, что все предоставления локализованные версии даже происходит без сборки исходного кода. Это более сложен, но имеет смысл его и механизм, выбранные для MFC. Можно также локализации приложения по загрузке файла EXE или DLL в редакторе ресурсов и редактирование ресурсов напрямую. Возможно он требует вводит эти изменения каждый раз при создании новой версии приложения.

Один из способов избежать, требуется найти все ресурсы в отдельные библиотеки DLL, иногда называется вспомогательную библиотеку DLL. Затем эта библиотека DLL динамически загружается во время выполнения, и они загружаются из этой библиотеки DLL вместо из главного модуля с вашим кодом. MFC поддерживает такой подход. Рассмотрите возможность приложения MyApp. EXE-ФАЙЛА; он может иметь все его ресурсам, расположенным в библиотеку DLL с именем MYRES. БИБЛИОТЕКИ DLL. В приложении `InitInstance` выполнить следующую команду, чтобы загрузить этот DLL-ФАЙЛ и заставить MFC загружать ресурсы из этого расположения:

```cpp
CMyApp::InitInstance()
{
    // one of the first things in the init code
    HINSTANCE hInst = LoadLibrary("myres.dll");

    if (hInst != NULL)
        AfxSetResourceHandle(hInst);

    // other initialization code would follow
    // ...
}
```

После этого для MFC загрузит ресурсы из НЕЕ вместо myapp.exe. Все ресурсы, однако, должны присутствовать в этой библиотеке DLL; MFC не выполняет поиск экземпляра приложения поиске данного ресурса. Этот прием применяется одинаково хорошо обычные библиотеки DLL MFC, а также элементы управления OLE. Соответствующую версию MYRES скопировать программу установки. Что пользователь предпочитает библиотеки DLL, в зависимости от того, какой язык ресурса.

Относительно легко создать ресурс только библиотеки DLL. Создайте проект библиотеки DLL, добавьте к. Версия-Кандидат на него и добавьте необходимые ресурсы. При наличии существующего проекта, который не использует этот способ, ресурсы можно скопировать из этого проекта. После добавления файла ресурсов в проект, почти все готово для построения проекта. Единственный момент, необходимо выполнить, задайте нужные параметры компоновщика **/NOENTRY**. Это указывает компоновщику, что библиотеки DLL не имеет запись точки -, так как он не имеет кода, он не имеет ни одной точки входа.

> [!NOTE]
> Редактор ресурсов в Visual C++ 4.0 и более поздних версий поддерживает несколько языков в. RC-файле. Это можно сделать очень легко управлять локализации в отдельный проект. Директивы препроцессора, созданные с помощью редактора ресурсов управляет ресурсами для каждого языка.

## <a name="using-the-provided-mfc-localized-resources"></a>С помощью предоставленного MFC локализованные ресурсы

Любое приложение MFC, при построении повторно использует две вещи из MFC: код и ресурсы. То есть MFC предоставляет различные сообщения об ошибках, встроенных диалоговых окон и другие ресурсы, используемые классами MFC. Чтобы полностью локализовать приложение, необходимо локализовать не только ресурсы приложения, но ресурсы, полученные непосредственно из MFC. MFC предоставляет ряд различных языковых файлов ресурсов автоматически, поэтому, если язык, который вы используете один из языков, уже поддерживаемых MFC, необходимо просто убедитесь, что использование локализованных ресурсов.

На момент написания этой статьи MFC поддерживает китайский, немецкий, испанский, французский, итальянский, японский и корейский. Файлы, содержащие эти локализованные версии находятся в MFC\INCLUDE\L.* («L» означает для локализации) каталоги. Немецкий файлы находятся в MFC\INCLUDE\L.DEU, например. Приложения для использования вместо файлы, расположенные в MFC\INCLUDE RC-файлы, ссылкам `/IC:\PROGRAM FILES\MICROSOFT VISUAL STUDIO .NET 2003\VC7\MFC\INCLUDE\L.DEU` для версии-КАНДИДАТА командную строку (это всего лишь пример, необходимо заменить региональных настроек выбора, а также каталог, в котором установлена Visual C ++).

Выше инструкциям будет работать, если приложение связывает статически с MFC. Большинство приложений связать динамически (так как это значение по умолчанию мастер приложений). В этом случае является не только код, динамически связанных - таким образом, — это ресурсы. В результате локализации ресурсов в приложении, но реализация ресурсы MFC будет загружен из MFC7x.DLL (или более поздней версии) или MFC7xLOC.DLL, если он существует. Это может повысить из двух разных углов.

Более сложный подход — отгрузки один локализованные MFC7xLOC.DLLs (например, MFC7xDEU для немецкого языка, MFC7xESP.DLL для испанский, т. д.) или более поздней версии и установить соответствующие MFC7xLOC.DLL в системный каталог, когда пользователь устанавливает приложение. Это могут быть очень сложными для разработчиком и конечным пользователем и таким образом не рекомендуется. В разделе [Технические заметки 56](../mfc/tn056-installation-of-localized-mfc-components.md) Дополнительные сведения о такой подход и особенностей.

Самым простым и безопасным подходом является включение локализованные ресурсы MFC в приложении или в DLL сам (или его вспомогательную библиотеку DLL, если вы используете). Это позволяет избежать проблем с установкой MFC7xLOC.DLL должным образом. Для этого выполните те же действия в случае статических приведенному выше (параметр командной строки версии-КАНДИДАТА должным образом, чтобы она указывала на локализованных ресурсов), за исключением, то необходимо также удалить `/D_AFXDLL` определить, был добавлен в мастере приложений. Когда `/D_AFXDLL` имеет определенные AFXRES. H (и другие файлы MFC RC) не следует определять фактически все ресурсы (так как они будут извлекаться из библиотеки DLL MFC вместо).

## <a name="see-also"></a>См. также

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)  
[Технические примечания по категории](../mfc/technical-notes-by-category.md)  
