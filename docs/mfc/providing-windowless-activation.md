---
title: "Предоставление активации без окна | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "активация [C++], MFC ActiveX - элементы управления"
  - "активация [C++], без окон"
  - "элементы управления MFC ActiveX [C++], параметры активации"
  - "активация элементов управления MFC ActiveX без окон"
ms.assetid: 094903b5-c344-42fa-96ff-ce01e16891c5
caps.latest.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 6
---
# Предоставление активации без окна
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Код создания окна \(т е все, возникает при вызове **CreateWindow**\) дорог для выполнения.  Элемент управления, который поддерживает на экране окно должен управлять сообщения для окна.  Безоконные элементы управления, поэтому быстрее, чем элементы управления с окнами.  
  
 Более следующее преимущество безоконных элементов управления, в отличие от windowed элементы управления, безоконные элементы управления поддерживают рисование прозрачной и nonrectangular области экрана.  Типичным примером прозрачного элемента управления текстовый элемент управления с прозрачным фоном.  Элементы управления красят текст, но не фон, поэтому все, что угодновсе, что любые под текстом отображает до конца.  Более новые формы часто используют nonrectangular элементы управления, например стрелки и круглые кнопки.  
  
 Часто, элемент управления не должен окно его, и вместо этого не может использовать службы окна контейнера, при условии, что контейнер написан для поддержки безоконные объекты.  Безоконные элементы управления обратной совместимостью с предыдущими контейнерами.  В прежних контейнерах не, написанных для поддержки безоконные элементы управления, безоконные элементы управления создают окно, активно.  
  
 Поскольку безоконные элементы управления не имеют свои собственные окна, контейнер \(с окно\) отвечает за предоставление службы, в противном случае были бы предоставлены собственным окна элемента управления.  Например, если элементу управления требуется запрос фокус клавиатуры, захват мыши или получить контекст устройства, эти операции управлять контейнером.  Контейнер направляет сообщения вводимых пользователем данных, отправленных в окно безоконному его к соответствующему элементу управления, используя интерфейс `IOleInPlaceObjectWindowless`. \(См. *ActiveX SDK*  для описания данного интерфейса.\) функции\-члены `COleControl` вызывать эти службы из контейнера.  
  
 Чтобы использовать элемент управления безоконную активацию, включите флажок **windowlessActivate**  в наборе флажков, возвращенных методом [COleControl::GetControlFlags](../Topic/COleControl::GetControlFlags.md).  Примеры.  
  
 [!code-cpp[NVC_MFC_AxOpt#5](../mfc/codesnippet/CPP/providing-windowless-activation_1.cpp)]  
[!code-cpp[NVC_MFC_AxOpt#6](../mfc/codesnippet/CPP/providing-windowless-activation_2.cpp)]  
[!code-cpp[NVC_MFC_AxOpt#7](../mfc/codesnippet/CPP/providing-windowless-activation_3.cpp)]  
  
 Код, чтобы включить этот флажок создается автоматически, если выбирать параметр **Активация без окна** на странице [Параметры элементов управления](../mfc/reference/control-settings-mfc-activex-control-wizard.md) мастера элементов управления ActiveX MFC.  
  
 При безоконная активация будет включена, контейнер делегирует сообщения ввода к интерфейсу `IOleInPlaceObjectWindowless` элемента управления.  реализация `COleControl` этого интерфейса диспетчеризация сообщений по схеме сообщений элемента управления, после изменения координаты мыши соответствующим образом.  Процесс можно сообщения, такие как обычные сообщения окна, добавив соответствующие записи в схеме сообщений.  В обработчиках для этих сообщений, избегайте использования переменной `m_hWnd` \(или любой функции\-члена, использующего\), необходимо проверить, его значение не равно **NULL**.  
  
 `COleControl` предоставляет функции\-члены, вызывают захват мыши, фокус клавиатуры, прокрутку и другие окна из контейнера службы при необходимости, в том числе:  
  
-   [GetFocus](../Topic/COleControl::GetFocus.md) [SetFocus](../Topic/COleControl::SetFocus.md),  
  
-   [GetCapture](../Topic/COleControl::GetCapture.md) [SetCapture](../Topic/COleControl::SetCapture.md), [ReleaseCapture](../Topic/COleControl::ReleaseCapture.md)  
  
-   [GetDC](../Topic/COleControl::GetDC.md) [ReleaseDC](../Topic/COleControl::ReleaseDC.md),  
  
-   [InvalidateRgn](../Topic/COleControl::InvalidateRgn.md)  
  
-   [ScrollWindow](../Topic/COleControl::ScrollWindow.md)  
  
-   [GetClientRect](../Topic/COleControl::GetClientRect.md)  
  
 В безоконных элементов управления, следует всегда использовать функции\-члены `COleControl` вместо соответствующих функции\-члены `CWnd` или их соответствующих функций Win32 API.  
  
 Может потребоваться безоконный элемент управления называется целевым объектом операции перетаскивания OLE.  Обычно это требовало бы, чтобы окно элемента управления зарегистрированное как целевой объект перетаскивания.  Поскольку элемент управления не имеет окно его, контейнер использует свое собственное окно как целевой объект перетаскивания.  Элемент управления предоставляет реализацию интерфейса `IDropTarget`, к которому контейнер может делегировать вызовы в соответствующее время.  Чтобы сделать этот интерфейс в контейнер, переопределите [COleControl::GetWindowlessDropTarget](../Topic/COleControl::GetWindowlessDropTarget.md).  Примеры.  
  
 [!code-cpp[NVC_MFC_AxOpt#8](../mfc/codesnippet/CPP/providing-windowless-activation_4.cpp)]  
  
## См. также  
 [Элементы управления ActiveX в MFC. Оптимизация](../mfc/mfc-activex-controls-optimization.md)