---
title: "Контейнеры: Составные файлы | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- compound files [MFC]
- compound documents
- containers [MFC], compound files
- OLE documents [MFC], compound files
- performance [MFC], compound files
- files [MFC], compound
- standardized file structure compound files
- documents [MFC], compound
- documents [MFC], OLE
- OLE containers [MFC], compound files
- access modes for files [MFC]
ms.assetid: 8b83cb3e-76c8-4bbe-ba16-737092b36f49
caps.latest.revision: "9"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: e48915641abae2285f00dcc24328efd810ec5e68
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="containers-compound-files"></a>Контейнеры. Составные файлы
В этой статье описываются компоненты и реализации составных файлов, а также их преимущества и недостатки использования составных файлов в приложениях OLE.  
  
 Составные файлы являются неотъемлемой частью OLE. Они используются для упрощения передачи данных и хранения документов OLE. Составные файлы представляет собой реализацию активную модель структурированного хранилища. Согласованных интерфейсов существует, сериализацию поддержки хранилища, потока или объекта файла. Составные файлы поддерживаются классы в библиотеке Microsoft Foundation Class `COleStreamFile` и `COleDocument`.  
  
> [!NOTE]
>  С помощью составного файла не означает, что данные поступают из документа OLE или составных документов. Составные файлы являются одним из способов хранения составных документов, OLE-документы и другие данные.  
  
##  <a name="_core_components_of_a_compound_file"></a>Компоненты составного файла  
 Реализация OLE составные файлы используются три типа объектов: потока объектов, объектов хранилища и `ILockBytes` объектов. Эти объекты аналогичны компонентов системы стандартный файл одним из следующих способов:  
  
-   Объекты потока, как и файлы, хранить данные любого типа.  
  
-   Объекты хранилища, как каталоги, может содержать другие объекты, хранение и поток.  
  
-   **LockBytes** объекты представляют собой интерфейс между объектами, хранилища и физическим оборудованием. Они определяют, как фактические байты написаны на любом устройстве хранения **LockBytes** доступ объекта, например жесткий диск или области глобальной памяти. Дополнительные сведения о **LockBytes** объектов и `ILockBytes` интерфейса см. в разделе *справочнике программиста OLE*.  
  
##  <a name="_core_advantages_and_disadvantages_of_compound_files"></a>Преимущества и недостатки составные файлы  
 Составные файлы предоставляют преимущества недоступно с предыдущих методов хранения файлов. В их число входят следующее.  
  
-   Доступ к добавочное файла.  
  
-   Файл режимы доступа.  
  
-   Стандартизация структуры файлов.  
  
 Потенциальные недостатки составные файлы — большой размер и производительность вопросы, относящиеся к хранилищу на дисковод гибких дисков, должны быть рассматриваемой Если принятие решения об использовании их в приложении.  
  
###  <a name="_core_incremental_access_to_files"></a>Добавочное доступ к файлам  
 Добавочное доступ к файлам является автоматическое преимуществом использования составных файлов. Поскольку в составном файле можно рассматривать как «file system в файле», типы отдельных объектов, например поток или хранилище, может осуществляться без необходимости загружать весь файл. Это может значительно сокращает время приложения требуется доступ к новые объекты для редактирования пользователем. Добавочное обновление, на основе на то же самое, сходную с преимуществами предложений. Вместо сохранения всего файла так же, чтобы сохранить изменения, внесенные в один объект OLE сохраняет только поток или хранилище объект изменена пользователем.  
  
###  <a name="_core_file_access_modes"></a>Режима доступа к файлам  
 Возможность определить, когда изменения объектов в составном файле не записаны на диск является еще одним преимуществом использования составных файлов. Режим, в котором выполняется обращение к файлам, direct, либо с поддержкой транзакций определяет, когда изменения фиксируются.  
  
-   Режиме транзакций использует операцию двухфазной фиксации для внесения изменений в объекты в составном файле, тем самым повысить старые и новые копии документа доступны, пока пользователь не решит сохранить или отменить изменения.  
  
-   Режим прямого включает изменения документа в которых были сделаны, без возможности их позже отмены.  
  
 Дополнительные сведения о режимах доступа см. в разделе *справочнике программиста OLE*.  
  
###  <a name="_core_standardization"></a>Стандартизации.  
 Стандартизированный структура составных файлов позволяет различных приложений OLE справочников составных файлов, созданных в приложениях OLE, не имея сведений приложения, в котором был создан файл.  
  
###  <a name="_core_size_and_performance_considerations"></a>Размер и вопросы производительности  
 Из-за сложности структуры хранения составной файл и возможностью сохранения данных постепенно, файлы, используя следующий формат, как правило, быть больше, чем другие файлы с помощью неструктурированных или хранения «плоский файл». Если приложение часто загружает и сохраняет файлы, с помощью составных файлов может привести к гораздо быстрее, чем noncompound файлы увеличить размер файла. Поскольку составные файлы могут иметь большой объем, время доступа для файлов, хранящихся на и загружаются с помощью гибких дисков также может быть изменено, что приводит к замедлению доступа к файлам.  
  
 Еще одна проблема, влияющим на производительность является составной файл фрагментации. Размер составного файла определяется разница между первым и последним дисковых секторов, используемая в файле. Фрагментированный файл может содержать множество области свободного пространства, которые не содержат данных, но учитываются при вычислении размера. На протяжении составной файл этих областей создаются путем вставки или удаления объектов хранилища.  
  
##  <a name="_core_using_compound_files_format_for_your_data"></a>С помощью составных файлов формата данных  
 После успешного создания приложения, производный от класса документа `COleDocument`, убедиться, что в основном документе конструктор вызывает `EnableCompoundFile`. Когда в мастере приложений создает OLE-приложения контейнера, этот вызов вставляется автоматически.  
  
 В *справочнике программиста OLE*, в разделе [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034), [IStorage](http://msdn.microsoft.com/library/windows/desktop/aa380015), и [ILockBytes](http://msdn.microsoft.com/library/windows/desktop/aa379238).  
  
## <a name="see-also"></a>См. также  
 [Контейнеры](../mfc/containers.md)   
 [Контейнеры: Проблемы пользовательского интерфейса](../mfc/containers-user-interface-issues.md)   
 [Класс COleStreamFile](../mfc/reference/colestreamfile-class.md)   
 [Класс COleDocument](../mfc/reference/coledocument-class.md)
