---
title: "Класс CDaoWorkspace | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CDaoWorkspace
- AFXDAO/CDaoWorkspace
- AFXDAO/CDaoWorkspace::CDaoWorkspace
- AFXDAO/CDaoWorkspace::Append
- AFXDAO/CDaoWorkspace::BeginTrans
- AFXDAO/CDaoWorkspace::Close
- AFXDAO/CDaoWorkspace::CommitTrans
- AFXDAO/CDaoWorkspace::CompactDatabase
- AFXDAO/CDaoWorkspace::Create
- AFXDAO/CDaoWorkspace::GetDatabaseCount
- AFXDAO/CDaoWorkspace::GetDatabaseInfo
- AFXDAO/CDaoWorkspace::GetIniPath
- AFXDAO/CDaoWorkspace::GetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::GetLoginTimeout
- AFXDAO/CDaoWorkspace::GetName
- AFXDAO/CDaoWorkspace::GetUserName
- AFXDAO/CDaoWorkspace::GetVersion
- AFXDAO/CDaoWorkspace::GetWorkspaceCount
- AFXDAO/CDaoWorkspace::GetWorkspaceInfo
- AFXDAO/CDaoWorkspace::Idle
- AFXDAO/CDaoWorkspace::IsOpen
- AFXDAO/CDaoWorkspace::Open
- AFXDAO/CDaoWorkspace::RepairDatabase
- AFXDAO/CDaoWorkspace::Rollback
- AFXDAO/CDaoWorkspace::SetDefaultPassword
- AFXDAO/CDaoWorkspace::SetDefaultUser
- AFXDAO/CDaoWorkspace::SetIniPath
- AFXDAO/CDaoWorkspace::SetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::SetLoginTimeout
- AFXDAO/CDaoWorkspace::m_pDAOWorkspace
dev_langs:
- C++
helpviewer_keywords:
- DAO workspaces [C++]
- transaction spaces [C++], DAO workspace
- ODBC classes [C++], vs. DAO classes
- default workspaces [C++], DAO
- workspaces [C++], DAO
- sessions [C++], DAO workspace
- Workspace class
- CDaoWorkspace class
- workspaces [C++], interface to database engine
- Workspaces collection
- persistence [C++], DAO workspace
- workspaces [C++], default
- defaults [C++], workspaces
- DAO workspaces [C++], CDaoWorkspace class
- security [MFC], DAO workspaces
- security [MFC]
- database engine [C++], accessing via workspace
- transaction spaces [C++]
- DDLs [C++]
- workspaces [C++], persistence
- default workspaces [C++]
ms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52
caps.latest.revision: 24
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 3f91eafaf3b5d5c1b8f96b010206d699f666e224
ms.openlocfilehash: 72fcabd7db70050ba95f142bea92e69f441dd717
ms.contentlocale: ru-ru
ms.lasthandoff: 04/01/2017

---
# <a name="cdaoworkspace-class"></a>Класс CDaoWorkspace
Управление именованным, защищенным паролем сеансом базы данных от входа до выхода одним пользователем.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CDaoWorkspace : public CObject  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::CDaoWorkspace](#cdaoworkspace)|Создает объект рабочей области. После этого вызвать **создать** или **откройте**.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::Append](#append)|Добавляет созданную рабочую область в коллекцию рабочих областей компонент database engine.|  
|[CDaoWorkspace::BeginTrans](#begintrans)|Начинает новую транзакцию, которая применяется ко всем базам данных откройте в рабочей области.|  
|[CDaoWorkspace::Close](#close)|Закрытие рабочей области и все объекты, содержащиеся в нем. Незавершенные транзакции выполняется откат.|  
|[CDaoWorkspace::CommitTrans](#committrans)|Выполняет текущую транзакцию и сохраняет изменения.|  
|[CDaoWorkspace::CompactDatabase](#compactdatabase)|Сжимает (или дублирует) базы данных.|  
|[CDaoWorkspace::Create](#create)|Создает новый объект DAO рабочей области.|  
|[CDaoWorkspace::GetDatabaseCount](#getdatabasecount)|Возвращает количество объектов базы данных DAO в коллекции баз данных рабочей области.|  
|[CDaoWorkspace::GetDatabaseInfo](#getdatabaseinfo)|Возвращает сведения об указанной базы данных DAO, определенным в коллекции баз данных рабочей области.|  
|[CDaoWorkspace::GetIniPath](#getinipath)|Возвращает параметры инициализации механизма расположение базы данных Microsoft Jet в реестре Windows.|  
|[CDaoWorkspace::GetIsolateODBCTrans](#getisolateodbctrans)|Возвращает значение, указывающее, несколько транзакций, задействовавших один и тот же источник данных ODBC изолируются посредством принудительно несколько подключений к источнику данных.|  
|[CDaoWorkspace::GetLoginTimeout](#getlogintimeout)|Возвращает количество секунд до ошибка возникает, когда пользователь пытается войти базе данных ODBC.|  
|[CDaoWorkspace::GetName](#getname)|Возвращает имя определяемого пользователем объекта рабочей области.|  
|[CDaoWorkspace::GetUserName](#getusername)|Возвращает имя пользователя, указанного при создании рабочей области. Это имя владельца рабочей области.|  
|[CDaoWorkspace::GetVersion](#getversion)|Возвращает строку, содержащую версию ядра базы данных, связанный с рабочей областью.|  
|[CDaoWorkspace::GetWorkspaceCount](#getworkspacecount)|Возвращает количество объектов DAO рабочей области в коллекции рабочих областей компонент database engine.|  
|[CDaoWorkspace::GetWorkspaceInfo](#getworkspaceinfo)|Возвращает сведения о заданной рабочей области DAO, определенным в коллекции рабочих областей компонент database engine.|  
|[CDaoWorkspace::Idle](#idle)|Позволяет компоненту database engine для выполнения фоновых задач.|  
|[CDaoWorkspace::IsOpen](#isopen)|Возвращает ненулевое значение, если рабочая область — открыть.|  
|[CDaoWorkspace::Open](#open)|Явно открывает объект рабочей области, связанные с DAO в рабочую область по умолчанию.|  
|[CDaoWorkspace::RepairDatabase](#repairdatabase)|Предпринимает попытку восстановить поврежденную базу данных.|  
|[CDaoWorkspace::Rollback](#rollback)|Завершает текущую транзакцию и не сохранить изменения.|  
|[CDaoWorkspace::SetDefaultPassword](#setdefaultpassword)|Задает пароль, который компонент database engine использует при создании объекта workspace без определенного пароля.|  
|[CDaoWorkspace::SetDefaultUser](#setdefaultuser)|Задает имя пользователя, которое компонент database engine использует при создании объекта рабочей области без определенного имени пользователя.|  
|[CDaoWorkspace::SetIniPath](#setinipath)|Задает параметры инициализации механизма расположение базы данных Microsoft Jet в реестре Windows.|  
|[CDaoWorkspace::SetIsolateODBCTrans](#setisolateodbctrans)|Указывает ли несколько транзакций, задействовавших один и тот же источник данных ODBC, изолируются принудительной несколько подключений к источнику данных.|  
|[CDaoWorkspace::SetLoginTimeout](#setlogintimeout)|Задает количество секунд, прежде чем ошибка возникает, когда пользователь пытается войти источник данных ODBC.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::m_pDAOWorkspace](#m_pdaoworkspace)|Указывает на объект базового DAO рабочей области.|  
  
## <a name="remarks"></a>Примечания  
 В большинстве случаев вам не потребуется несколько рабочих областей, а не потребуется создавать объекты явную рабочей области; При открытии объектов базы данных и набор записей, они используют DAO в рабочую область по умолчанию. Однако при необходимости можно запустить несколько сеансов одновременно путем создания рабочей области дополнительных объектов. Каждый объект рабочей области может содержать несколько открытых объектов базы данных в собственную коллекцию баз данных. В MFC рабочая область — в первую очередь диспетчер транзакций, указав набор открытых баз данных в одном «места транзакций».  
  
> [!NOTE]
>  Классы баз данных DAO отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классы MFC на основе ODBC. Классы на основе DAO доступ к данным через ядро базы данных Microsoft Jet, включая драйверы ODBC. Они также поддерживают операции языка определения данных (DDL), например создание баз данных и добавление таблиц и полей через классы, без необходимости непосредственный вызов DAO.  
  
## <a name="capabilities"></a>Возможности  
 Класс `CDaoWorkspace` предоставляет следующие:  
  
-   Явный доступ в рабочую область по умолчанию, созданные путем инициализации компонент database engine. Обычно используется рабочая область по умолчанию DAO неявно при создании объектов базы данных и набор записей.  
  
-   В рабочей области откройте место транзакций, в котором транзакции применяются ко всем базам данных. Можно создать дополнительные рабочие области для управления пробелы в отдельной транзакции.  
  
-   Интерфейс для многих свойств базовый компонент database engine Microsoft Jet (см. статические функции-члены). Открытие или создание рабочей области или статическая функция-член до вызова откройте или создайте, инициализирует компонент database engine.  
  
-   Доступ к коллекции рабочих областей компонент database engine, где хранятся все активные рабочие области, добавленных к нему. Можно также создать и работа с ними без добавления их в коллекцию.  
  
## <a name="security"></a>Безопасность  
 MFC не реализует коллекций пользователей и групп в DAO, которые используются для управления безопасностью. Если необходимо, чтобы те аспекты DAO, необходимо запрограммировать их самостоятельно через прямые вызовы интерфейсов DAO. Сведения см. в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
## <a name="usage"></a>Использование  
 Можно использовать класс `CDaoWorkspace` для:  
  
-   Явным образом откройте рабочую область по умолчанию.  
  
     Обычно подразумевается использование рабочей области по умолчанию — при открытии нового [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объектов. Однако может потребоваться доступ к ней явным образом — например, для доступа к свойствам ядра базы данных или коллекцию рабочих областей. См. ниже «Неявное использование рабочей области по умолчанию».  
  
-   Создайте новые рабочие области. Вызовите [Append](#append) Если вы хотите добавить их в коллекцию рабочих областей.  
  
-   Откройте существующую рабочую область в коллекции рабочих областей.  
  
 Создание новой рабочей области, еще не существует в коллекции описан в рабочих областях [создать](#create) функции-члена. Объектов рабочей области не сохраняются между сеансами engine datababase каким-либо образом. Если приложение связывает MFC статически, завершения работы приложения Отменяет инициализацию компонент database engine. Если приложение связывает с MFC динамически, компонент database engine не инициализирован при выгрузке библиотеки DLL MFC.  
  
 Явно открытии рабочей области по умолчанию, или существующую рабочую область в коллекции рабочих областей, описанная в разделе [откройте](#open) функции-члена.  
  
 Завершение сеанса рабочую область, закрыв рабочую область с [закрыть](#close) функции-члена. **Закрыть** закрывает все базы данных, не закрыт ранее, выполняется откат всех незафиксированных транзакций.  
  
## <a name="transactions"></a>Транзакции  
 DAO управляет транзакциями на уровне рабочей области. Следовательно транзакции на рабочую область с несколькими базами данных, откройте применяются для всех баз данных. Например, если две базы данных имеют незафиксированных обновлениях, при вызове метода [CommitTrans](#committrans), все обновления фиксируются. Если вы хотите ограничить транзакции в одной базе данных, для него необходим объект отдельную рабочую область.  
  
## <a name="implicit-use-of-the-default-workspace"></a>Неявное использование рабочей области по умолчанию  
 Используется библиотекой MFC DAO в рабочую область по умолчанию неявно при следующих обстоятельствах:  
  
-   Если вы создаете новый `CDaoDatabase` объекта, но делать это через существующий `CDaoWorkspace` объекта MFC создает объект временную рабочую область, соответствующая DAO в рабочую область по умолчанию. Если сделать это для нескольких баз данных, все объекты базы данных связаны с рабочей областью по умолчанию. Можно получить доступ к рабочей базе данных через `CDaoDatabase` члена данных.  
  
-   Аналогично при создании `CDaoRecordset` объект без указания указатель `CDaoDatabase` объекта MFC создает временный объект базы данных и по мере расширения объекта временную рабочую область. Можно обращаться из набора записей базы данных и косвенно его рабочей области `CDaoRecordset` члена данных.  
  
## <a name="other-operations"></a>Другие операции  
 Другие операции базы данных также предоставляются, такие как Восстановление поврежденной базы данных или сжатие базы данных.  
  
 Сведения о вызов DAO напрямую, а также о безопасности DAO см. в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 `CDaoWorkspace`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="append"></a>CDaoWorkspace::Append  
 Вызовите эту функцию-член, после вызова метода [создать](#create).  
  
```  
virtual void Append();
```  
  
### <a name="remarks"></a>Примечания  
 **Добавление** добавляет объект рабочей области только что созданный компонент database engine коллекцию рабочих областей. Рабочие области не сохраняются между сеансами ядра базы данных; они хранятся только в памяти, а не на диске. Нет необходимости добавления рабочей области; Если этого не сделать, вы по-прежнему можно использовать.  
  
 Рабочую область присоединенных остается в коллекции рабочих областей в активном, открытом состоянии до вызова его [закрыть](#close) функции-члена.  
  
 Дополнительные сведения см. в разделе «Добавление Method» в справке DAO.  
  
##  <a name="begintrans"></a>CDaoWorkspace::BeginTrans  
 Вызовите эту функцию-член для запуска транзакции.  
  
```  
void BeginTrans();
```  
  
### <a name="remarks"></a>Примечания  
 После вызова метода **BeginTrans**, обновления, внесенные в структуру данных или базы данных вступят в силу при фиксации транзакции. Поскольку рабочую область определяет пространство одной транзакции, транзакции применяется ко всем открытым базам данных в рабочей области. Для завершения транзакции двумя способами.  
  
-   Вызовите [CommitTrans](#committrans) функции-члена для фиксации транзакции и сохранить изменения в источнике данных.  
  
-   Или позвоните [отката](#rollback) функции-члена для отмены операции.  
  
 Закрытие рабочей области или объект базы данных, пока ожидается транзакции откат всех незавершенных транзакций.  
  
 Если необходимо изолировать транзакции на один источник данных ODBC по сравнению с другим источником данных ODBC, см. раздел [SetIsolateODBCTrans](#setisolateodbctrans) функции-члена.  
  
##  <a name="cdaoworkspace"></a>CDaoWorkspace::CDaoWorkspace  
 Создает объект `CDaoWorkspace`.  
  
```  
CDaoWorkspace();
```  
  
### <a name="remarks"></a>Примечания  
 После создания объекта C++ имеются две возможности:  
  
-   Вызвать объект [откройте](#open) функции-члена откройте рабочую область по умолчанию или открыть существующий объект в коллекцию рабочих областей.  
  
-   Или вызвать объект [создать](#create) функции-члена для создания нового объекта DAO рабочей области. Это явно начинает новый сеанс рабочей области, который может ссылаться на через `CDaoWorkspace` объекта. После вызова метода **создать**, можно вызвать [Append](#append) Если вы хотите добавить в коллекцию рабочих областей ядро базы данных рабочей области.  
  
 См. в обзоре класса для [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) сведения о при необходимости явно создавать `CDaoWorkspace` объекта. Как правило, использование рабочих областей, неявно создается при открытии [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) объект без указания рабочей области, или при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объект без указания объекта базы данных. Объекты DAO Библиотеки MFC, созданные таким образом использовать рабочую область по умолчанию в DAO, который создается один раз и использовать повторно.  
  
 Чтобы освободить рабочую область и содержащиеся в нем объекты, вызывающие этот объект рабочей [закрыть](#close) функции-члена.  
  
##  <a name="close"></a>CDaoWorkspace::Close  
 Вызовите эту функцию-член закрытия объекта рабочей области.  
  
```  
virtual void Close();
```  
  
### <a name="remarks"></a>Примечания  
 Закрытие объекта открыть рабочую область освобождает объект базового DAO и, если рабочей области является членом коллекции рабочих областей, удаляет его из коллекции. Вызов **закрыть** является хорошим стилем программирования.  
  
> [!CAUTION]
>  Закрытие объекта workspace закрывает все открытые базы данных в рабочей области. Это приведет к все наборы записей, открытые в базах данных также закрывается, и любые несохраненные изменения или обновления будет выполнен откат. Дополнительные сведения см. в разделе [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#close), и [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#close) функции-члены.  
  
 Объекты в рабочей области не являются постоянными; они существуют только пока существуют ссылки на них. Это означает, что при завершении сеанса ядра базы данных, в рабочей области и его баз данных коллекции не сохраняются. Необходимо повторно создать их для следующего сеанса, снова открыть рабочую область и баз данных.  
  
 Дополнительные сведения см. в разделе «Метод Close» в справке DAO.  
  
##  <a name="committrans"></a>CDaoWorkspace::CommitTrans  
 Вызовите эту функцию-член для фиксации транзакции — сохранить группу изменения и обновления для одного или нескольких баз данных в рабочей области.  
  
```  
void CommitTrans();
```  
  
### <a name="remarks"></a>Примечания  
 Транзакция состоит из серии изменений базы данных или ее структуру, начиная с вызова [BeginTrans](#begintrans). Если после завершения транзакции, либо выполняющее ее фиксацию или откат (отменить изменения) с [отката](#rollback). По умолчанию без транзакций обновления записей фиксируются немедленно. Вызов **BeginTrans** вызывает обновлений приверженность отложенной, пока не будет вызван **CommitTrans**.  
  
> [!CAUTION]
>  В одной рабочей области транзакции всегда являются глобальными в рабочую область и не ограничиваются только одной базы данных или набора записей. При выполнении операций на более чем одной базы данных или набора записей в рабочей области транзакции, **CommitTrans** фиксации все ожидающие обновления, и **отката** восстанавливает все операции с этими базами данных и наборы записей.  
  
 При закрытии базы данных или в рабочей области с ожидающими транзакции, откат этих транзакций являются все.  
  
> [!NOTE]
>  Это не является механизмом двухфазной фиксации. Если не удается зафиксировать одно обновление, другим пользователям по-прежнему будут зафиксированы.  
  
##  <a name="compactdatabase"></a>CDaoWorkspace::CompactDatabase  
 Вызовите эту функцию-член для сжатия указанного Microsoft Jet (. База данных MDB).  
  
```  
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,  
    LPCTSTR lpszDestName,  
    LPCTSTR lpszLocale = dbLangGeneral,  
    int nOptions = 0);

 
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,  
    LPCTSTR lpszDestName,  
    LPCTSTR lpszLocale,  
    int nOptions,  
    LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSrcName`  
 Имя существующей, закрытый базы данных. Это может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Если имя файла имеет расширение, необходимо указать его. Ваша сеть поддерживает универсальный соглашение об именах (UNC), можно также указать сетевой путь, например «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (В строки пути требуются двойную обратную косую черту, так как "\\" escape-символ C++.)  
  
 `lpszDestName`  
 Полный путь сжатой базы данных, для которого создается. Можно также указать сетевой путь, как с `lpszSrcName`. Нельзя использовать `lpszDestName` аргумент, чтобы указать тот же файл базы данных `lpszSrcName`.  
  
 `lpszPassword`  
 Пароль, используемый при требуется сжать паролем базы данных. Обратите внимание, что если вы используете версию `CompactDatabase` , принимающий пароль, необходимо указать все параметры. Кроме того, так как это параметр подключения он требует специального форматирования, как показано ниже:; PWD= `lpszPassword`. Например:; PWD = «С». (Требуется начальные точки с запятой).  
  
 `lpszLocale`  
 Строковое выражение, используемое, чтобы указать порядок сортировки при создании `lpszDestName`. Если этот аргумент опущен, принимая значение по умолчанию **dbLangGeneral** (см. ниже), для новой базы данных используется таким же, как для старой базы данных. Доступны следующие значения:  
  
- **dbLangGeneral** английский, немецкий, французский, португальский, итальянский и современной  
  
- **dbLangArabic** арабский  
  
- **dbLangCyrillic** русский  
  
- **dbLangCzech** чешский  
  
- **dbLangDutch** голландский  
  
- **dbLangGreek** греческая  
  
- **dbLangHebrew** иврит  
  
- **dbLangHungarian** венгерский  
  
- **dbLangIcelandic** исландская  
  
- **dbLangNordic** Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)  
  
- **dbLangNorwdan** норвежский и датский  
  
- **dbLangPolish** польского языка  
  
- **dbLangSpanish** испанский (традиционный)  
  
- **dbLangSwedfin** шведский и финский  
  
- **dbLangTurkish** для турецкого языка  
  
 `nOptions`  
 Указывает один или несколько параметров для целевой базы данных `lpszDestName`. Если этот аргумент опущен, приняв значения по умолчанию, `lpszDestName` будет иметь такое же шифрование и совпадает с версией `lpszSrcName`. Можно объединять **dbEncrypt** или **dbDecrypt** параметр с одним из параметров версии, с помощью оператора побитового или. Возможные значения, которые задают формат базы данных, а не версию ядра базы данных, являются:  
  
- **dbEncrypt** шифрования базы данных во время сжатия.  
  
- **dbDecrypt** расшифровывать базу данных при сжатии.  
  
- **dbVersion10** создания базы данных, которая используется при сжатии ядра базы данных Microsoft Jet версии 1.0.  
  
- **dbVersion11** создания базы данных, которая используется при сжатии ядра базы данных Microsoft Jet версии 1.1.  
  
- **dbVersion20** создания базы данных, которая использует ядро СУБД Microsoft Jet версии 2.0 во время сжатия.  
  
- **dbVersion30** создания базы данных, которая использует ядро СУБД Microsoft Jet версии 3.0 при сжатии.  
  
 Можно использовать **dbEncrypt** или **dbDecrypt** в аргументе параметры для указания, следует ли шифровать или расшифровывать базу данных при ее сжатии. Если опустить константу шифрования или одновременно включать **dbDecrypt** и **dbEncrypt**, `lpszDestName` будет иметь такое же шифрование как `lpszSrcName`. Одна из констант версии можно использовать в качестве аргумента параметры для указания версии формата данных для сжатой базы данных. Эта константа затрагивает только версию формата данных `lpszDestName`. Можно указать только одну версию константа. Если опустить константа версии `lpszDestName` будет иметь ту же версию, что `lpszSrcName`. Можно сжать `lpszDestName` только к версии, которая равна или более поздней версии, чем `lpszSrcName`.  
  
> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если вы реализуете безопасности пользователя и пароль, чтобы сразу прочитать двоичное диска, составляющее базы данных.  
  
### <a name="remarks"></a>Примечания  
 При изменении данных в базе данных, файл базы данных может стать фрагментированным и использовать больше места, чем необходимо. Периодически необходимо выполнить сжатие базы данных для дефрагментации файла базы данных. Размер сжатой базы данных обычно меньше. Можно также изменить порядок сортировки, шифрование или версии формата данных при копировании и сжатия базы данных.  
  
> [!CAUTION]
>  `CompactDatabase` Функция-член не станет преобразовывать правильно всей базы данных Microsoft Access из одной версии в другую. Преобразуются только формат данных. Microsoft доступ определенных пользователем объектов, таких как формы и отчеты, не преобразуются. Однако данные правильно преобразовать.  
  
> [!TIP]
>  Можно также использовать `CompactDatabase` для копирования файла базы данных.  
  
 Дополнительные сведения о сжатие баз данных см. в разделе «Метод CompactDatabase» в справке DAO.  
  
##  <a name="create"></a>CDaoWorkspace::Create  
 Вызовите эту функцию-член для создания нового объекта DAO рабочей области и связать его с MFC `CDaoWorkspace` объекта.  
  
```  
virtual void Create(
    LPCTSTR lpszName,  
    LPCTSTR lpszUserName,  
    LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строка, однозначно определяющий новый объект рабочей области с длиной до 14 символов. Необходимо указать имя. Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.  
  
 *lpszUserName*  
 Имя пользователя владельца рабочей области. Требования см. в разделе `lpszDefaultUser` параметр [SetDefaultUser](#setdefaultuser) функции-члена. Дополнительные сведения см. в разделе «Свойство имени пользователя» справки DAO.  
  
 `lpszPassword`  
 Пароль для нового объекта рабочей области. Пароль может иметь длину до 14 символов и могут содержать любой символ, за исключением ASCII 0 (null). Пароли учитывают регистр. Дополнительные сведения см. в разделе «Свойство пароль» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 Общий процесс создания является:  
  
1.  Создать [CDaoWorkspace](#cdaoworkspace) объекта.  
  
2.  Вызвать объект **создать** функции-члена для создания базовой рабочей области DAO. Необходимо указать имя рабочей области.  
  
3.  При необходимости вызовите функцию [Append](#append) Если вы хотите добавить в коллекцию рабочих областей ядро базы данных рабочей области. Без добавления ее можно работать с рабочей областью.  
  
 После **создать** вызов, объект рабочей области находится в открытом состоянии, готов к использованию. Не следует вызывать **откройте** после **создать**. Не следует вызывать **создать** Если рабочая область уже существует в коллекции рабочих областей. **Создание** инициализирует ядро базы данных, если он еще не был инициализирован для вашего приложения.  
  
##  <a name="getdatabasecount"></a>CDaoWorkspace::GetDatabaseCount  
 Вызовите эту функцию-член для извлечения нескольких объектов базы данных DAO в коллекции баз данных рабочей области — число открытых баз данных в рабочей области.  
  
```  
short GetDatabaseCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество открытых баз данных в рабочей области.  
  
### <a name="remarks"></a>Примечания  
 `GetDatabaseCount`полезно, если требуется перебрать все базы данных, определенных в коллекции баз данных рабочей области. Чтобы получить сведения о данной базы данных в коллекции, в разделе [GetDatabaseInfo](#getdatabaseinfo). Обычно используется для вызова `GetDatabaseCount` число открытых баз данных, затем использовать это число как индекс цикла повторяющиеся вызовы `GetDatabaseInfo`.  
  
##  <a name="getdatabaseinfo"></a>CDaoWorkspace::GetDatabaseInfo  
 Вызовите эту функцию-член для получения различного рода сведения об открытии базы данных в рабочей области.  
  
```  
void GetDatabaseInfo(
    int nIndex,  
    CDaoDatabaseInfo& dbinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetDatabaseInfo(
    LPCTSTR lpszName,  
    CDaoDatabaseInfo& dbinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Отсчитываемый от нуля индекс объекта базы данных в коллекции баз данных рабочей области, для поиска по индексу.  
  
 `dbinfo`  
 Ссылку на [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) объект, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, указывающие, какие сведения о базе данных для извлечения. Ниже перечислены доступные параметры и как они вызвать функцию возврата:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя обновляемой, транзакции  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения о первичном: версия, порядок сортировки, время ожидания запроса  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: подключение  
  
 `lpszName`  
 Имя объекта базы данных, для поиска по имени. Имя является строкой с длиной до 14 символов, однозначно определяющий новый объект рабочей области.  
  
### <a name="remarks"></a>Примечания  
 Одну версию функции позволяет найти базу данных по индексу. Другая версия позволяет найти базу данных по имени.  
  
 Описание сведений, возвращаемых в `dbinfo`, в разделе [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. При запросе сведения на одном уровне, вы получаете сведения всех предыдущих уровней.  
  
##  <a name="getinipath"></a>CDaoWorkspace::GetIniPath  
 Вызовите эту функцию-член для получения расположения базы данных Microsoft Jet механизма инициализации параметров в реестре Windows.  
  
```  
static CString PASCAL GetIniPath();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) содержащий расположение реестра.  
  
### <a name="remarks"></a>Примечания  
 Расположение можно использовать для получения сведений о параметрах для компонента database engine. Сведения, возвращаемые является фактически имя подраздела реестра.  
  
 Дополнительные сведения см. в разделах «Свойства IniPath» и «Настройка Windows реестра параметры для доступа к данным» в справке DAO.  
  
##  <a name="getisolateodbctrans"></a>CDaoWorkspace::GetIsolateODBCTrans  
 Вызовите эту функцию-член для получения текущего значения свойства DAO IsolateODBCTrans для рабочей области.  
  
```  
BOOL GetIsolateODBCTrans();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если транзакции ODBC изолированы; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одной и той же базе данных ODBC. Чтобы сделать это, необходимо открыть отдельную рабочую область для каждой транзакции. Имейте в виду, что несмотря на то, что каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакции не обычно требуется, по умолчанию являются общими соединений ODBC из нескольких объектов рабочая область открывается с тем же пользователем.  
  
 Некоторые серверы ODBC, например Microsoft SQL Server не позволяют одновременные транзакции в одном соединении. Если необходимо иметь более одной транзакции во время ожидания для такой базы данных, задайте свойства IsolateODBCTrans **TRUE** на каждой рабочей области сразу открыть его. Это заставляет отдельное соединение ODBC для каждой рабочей области.  
  
 Дополнительные сведения см. в разделе «Свойство IsolateODBCTrans» в справке DAO.  
  
##  <a name="getlogintimeout"></a>CDaoWorkspace::GetLoginTimeout  
 Вызовите эту функцию-член для получения текущего значения свойства DAO LoginTimeout для рабочей области.  
  
```  
static short PASCAL GetLoginTimeout();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество секунд до произошла ошибка при попытке входа в базе данных ODBC.  
  
### <a name="remarks"></a>Примечания  
 Это значение представляет количество секунд до произошла ошибка при попытке входа в базе данных ODBC. Значение LoginTimeout по умолчанию — 20 секунд. Если LoginTimeout имеет значение 0, отсутствие времени ожидания и связи с источником данных может перестать отвечать на запросы.  
  
 При попытке входа в базе данных ODBC, например Microsoft SQL Server не удается установить подключение в результате ошибки сети или потому, что сервер не работает. Вместо ожидания по умолчанию 20 секунд для подключения, можно указать время ожидания компонент database engine, прежде чем произойдет ошибка. Вход в систему сервера выполняется неявно в рамках ряд различных событий, таких как выполнение запроса для внешнего сервера базы данных.  
  
 Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.  
  
##  <a name="getname"></a>CDaoWorkspace::GetName  
 Вызовите эту функцию-член для получения имени определяемого пользователем базового объекта DAO рабочей `CDaoWorkspace` объекта.  
  
```  
CString GetName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) содержащее определяемое пользователем имя объекта DAO рабочей области.  
  
### <a name="remarks"></a>Примечания  
 Оно полезно для доступа к объекту рабочей DAO в компонент database engine рабочих областей коллекции по имени.  
  
 Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.  
  
##  <a name="getusername"></a>CDaoWorkspace::GetUserName  
 Вызовите эту функцию-член для получения имени владельца рабочей области.  
  
```  
CString GetUserName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , представляющий владельца объекта рабочей области.  
  
### <a name="remarks"></a>Примечания  
 Чтобы получить или задать разрешения для владельца рабочей области, вызов DAO напрямую, чтобы проверить значение свойства разрешения; Определяет, какие разрешения, которыми обладает пользователь. Для работы с разрешениями, требуется система. Файл MDA.  
  
 Сведения о вызовах DAO напрямую, содержатся [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md). Дополнительные сведения см. в разделе «Свойство имени пользователя» справки DAO.  
  
##  <a name="getversion"></a>CDaoWorkspace::GetVersion  
 Вызовите эту функцию-член для определения версии базы данных Microsoft Jet используется.  
  
```  
static CString PASCAL GetVersion();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию компонента database engine, связанный с объектом.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение представляет номер версии в виде «основной.дополнительный»; например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точку и номер выпуска (0).  
  
 Дополнительные сведения см. в разделе «Версии свойство» в справке DAO.  
  
##  <a name="getworkspacecount"></a>CDaoWorkspace::GetWorkspaceCount  
 Вызовите эту функцию-член для извлечения нескольких объектов DAO рабочей области в коллекции рабочих областей компонент database engine.  
  
```  
short GetWorkspaceCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число открытых рабочих областей в коллекции рабочих областей.  
  
### <a name="remarks"></a>Примечания  
 Этот счетчик не включает все открытые рабочие области, не добавляется в коллекцию. `GetWorkspaceCount`полезно, если вам нужно перебор всех определенных рабочих областей в коллекции рабочих областей. Чтобы получить сведения о данном рабочем пространстве в коллекции, в разделе [GetWorkspaceInfo](#getworkspaceinfo). Обычно используется для вызова `GetWorkspaceCount` число открытых рабочих областей, затем использовать это число как индекс цикла повторяющиеся вызовы `GetWorkspaceInfo`.  
  
##  <a name="getworkspaceinfo"></a>CDaoWorkspace::GetWorkspaceInfo  
 Вызовите эту функцию-член для получения различные виды информации о откройте рабочую область в сеансе.  
  
```  
void GetWorkspaceInfo(
    int nIndex,  
    CDaoWorkspaceInfo& wkspcinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetWorkspaceInfo(
    LPCTSTR lpszName,  
    CDaoWorkspaceInfo& wkspcinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Отсчитываемый от нуля индекс объекта базы данных в коллекцию рабочих областей для поиска по индексу.  
  
 `wkspcinfo`  
 Ссылку на [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) объект, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, указывающие, какие сведения о рабочей области для извлечения. Ниже перечислены доступные параметры и как они вызвать функцию возврата:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения о первичном: имя пользователя  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: изолировать ODBCTrans  
  
 `lpszName`  
 Имя объекта рабочей области, для поиска по имени. Имя является строкой с длиной до 14 символов, однозначно определяющий новый объект рабочей области.  
  
### <a name="remarks"></a>Примечания  
 Описание сведений, возвращаемых в `wkspcinfo`, в разделе [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. Сведения о предыдущих уровней также получить при запросе информации на одном уровне.  
  
##  <a name="idle"></a>CDaoWorkspace::Idle  
 Вызовите **Idle** для предоставления компонент database engine возможность выполнения фоновых задач, из-за интенсивной обработки данных может оказаться устаревшей.  
  
```  
static void PASCAL Idle(int nAction = dbFreeLocks);
```  
  
### <a name="parameters"></a>Параметры  
 `nAction`  
 Действия, предпринимаемые во время обработки бездействия. В настоящее время является единственным допустимым действие **dbFreeLocks**.  
  
### <a name="remarks"></a>Примечания  
 Это особенно актуально в многопользовательской, многозадачных средах, в которых не достаточно времени фоновой обработки для синхронизации всех записей в наборе записей.  
  
> [!NOTE]
>  Вызов **Idle** необязателен с базами данных, созданных в версии 3.0 базы данных Microsoft Jet. Используйте **Idle** только для баз данных, созданных в более ранних версиях.  
  
 Как правило, удаляются блокировки чтения и данные в локальном динамического типа объекта набора записей обновляется только в том случае, если выполняются другие действия не (включая движения мыши). Если периодически вызывать **Idle**, предоставить компоненту database engine с время для фоновой обработки задач, освобождая ненужные блокировки для чтения. Указание **dbFreeLocks** константы в качестве аргумента задерживает вычисления, пока не снимаются все блокировки чтения.  
  
 Если запущено несколько экземпляров приложения эта функция-член не требуется в средах в однопользовательском режиме. **Idle** функция-член может повысить производительность в многопользовательской среде, так как он заставляет механизм записями данных на диск, освобождения блокировки памяти базы данных. Можно освободить блокировку считывания, делая операций часть транзакции.  
  
 Дополнительные сведения см. в разделе «Простоя метод» в справке DAO.  
  
##  <a name="isopen"></a>CDaoWorkspace::IsOpen  
 Вызовите эту функцию-член для определения ли `CDaoWorkspace` открыт объект — то есть ли MFC объект был инициализирован с помощью вызова [откройте](#open) или вызов [создать](#create).  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если открыт объект рабочей области; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Можно вызывать любые члена функции рабочее пространство, которое находится в открытом состоянии.  
  
##  <a name="m_pdaoworkspace"></a>CDaoWorkspace::m_pDAOWorkspace  
 Указатель на базовый объект рабочей DAO.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот элемент данных, если требуется прямой доступ к базовому объекту DAO. Можно вызывать интерфейсы объекта DAO через этот указатель.  
  
 Сведения о доступе к объектам DAO напрямую см. в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
##  <a name="open"></a>CDaoWorkspace::Open  
 Явно открывает объект рабочей области, связанные с DAO в рабочую область по умолчанию.  
  
```  
virtual void Open(LPCTSTR lpszName = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя объекта рабочей DAO, чтобы открыть — строка, однозначно определяющий рабочую область с длиной до 14 символов. Примите значение по умолчанию **NULL** явно открыть рабочую область по умолчанию. Требования к именованию, в разделе `lpszName` параметр [создать](#create). Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 После построения `CDaoWorkspace` , вызовите эту функцию-член для выполните одно из следующих действий:  
  
-   Явным образом откройте рабочую область по умолчанию. Pass **NULL** for `lpszName`.  
  
-   Откройте существующий `CDaoWorkspace` объект, является членом коллекции рабочих областей, по имени. Передайте допустимое имя для существующего объекта рабочей области.  
  
 **Откройте** помещает объект рабочей области в открытом состоянии, а также инициализирует ядро базы данных, если он еще не был инициализирован для вашего приложения.  
  
 Хотя многие `CDaoWorkspace` члена функции могут вызываться только после открытия рабочей области, следующие функции-члены, которые работают в компоненте database engine, доступные после создания экземпляра объекта C++, но перед вызовом **откройте**:  
  
||||  
|-|-|-|  
|[Создание](#create)|[GetVersion](#getversion)|[SetDefaultUser](#setdefaultuser)|  
|[GetIniPath](#getinipath)|[Простоя](#idle)|[SetIniPath](#setinipath)|  
|[GetLoginTimeout](#getlogintimeout)|[SetDefaultPassword](#setdefaultpassword)|[SetLoginTimeout](#setlogintimeout)|  
  
##  <a name="repairdatabase"></a>CDaoWorkspace::RepairDatabase  
 Вызовите эту функцию-член, если вам нужно попытаться восстановить поврежденную базу данных, которая обращается к базы данных Microsoft Jet.  
  
```  
static void PASCAL RepairDatabase(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Путь и имя файла для файла базы данных Microsoft Jet Database engine. Если путь не указан, выполняется поиск только в текущем каталоге. Если система поддерживает универсальный соглашение об именах (UNC), можно также указать сетевой путь, например: «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойную обратную косую черту необходимы в строке пути, так как "\\" escape-символ C++.)  
  
### <a name="remarks"></a>Примечания  
 Необходимо закрыть базы данных, указанной `lpszName` перед его восстановления. В многопользовательской среде, другие пользователи не могут иметь `lpszName` открыть, когда вы производится восстановление. Если `lpszName` закрыт или не доступен для монопольного использования, возникает ошибка.  
  
 Эта функция-член пытается выполнить восстановление базы данных, помеченного как может быть повреждена неполная запись операции. Это может произойти, если приложения с помощью базы данных Microsoft Jet неожиданно закрыто из-за power простоя или компьютере проблемы с оборудованием. Если продолжить операцию и вызовите [закрыть](../../mfc/reference/cdaodatabase-class.md#close) функции-члена или выйти из приложения обычным образом, базы данных не будет помечена как может быть повреждена.  
  
> [!NOTE]
>  После восстановления базы данных, рекомендуется также сжать с помощью [CompactDatabase](#compactdatabase) функции-члена для дефрагментации файла и освободить место на диске.  
  
 Дополнительные сведения о восстановлении баз данных см. в разделе «Метод RepairDatabase» в справке DAO.  
  
##  <a name="rollback"></a>CDaoWorkspace::Rollback  
 Вызовите эту функцию-член до завершения текущей транзакции и восстановления всех баз данных в рабочей области их условия перед транзакция была начата.  
  
```  
void Rollback();
```  
  
### <a name="remarks"></a>Примечания  
  
> [!CAUTION]
>  В один объект рабочей области транзакции всегда являются глобальными в рабочую область и не ограничиваются только одной базы данных или набора записей. При выполнении операций на более чем одной базы данных или набора записей в рабочей области транзакции, **отката** восстанавливает все операции во всех этих баз данных и наборы данных.  
  
 Если объект рабочей области закрыть без сохранения или отката все отложенные транзакции, откат этих транзакций автоматически. При вызове метода [CommitTrans](#committrans) или **отката** без предварительного вызова функции [BeginTrans](#begintrans), возникает ошибка.  
  
> [!NOTE]
>  При запуске транзакции, компонент database engine записывает операции, его в файле, который хранится в каталоге, указанном в переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпывает доступное хранилище на диске TEMP, компонент database engine приведет к MFC создаст `CDaoException` (ошибка DAO 2004 г.). На этом этапе при вызове метода **CommitTrans**фиксируются неопределенное количество операций, но остальные незавершенные действия будут утеряны, и операция должна быть перезапущена. Вызов **отката** освобождает журнал транзакций и выполняет откат всех операций в транзакции.  
  
##  <a name="setdefaultpassword"></a>CDaoWorkspace::SetDefaultPassword  
 Вызовите эту функцию-член для установки пароля по умолчанию, компонент database engine использует при создании объекта рабочей области без определенного пароля.  
  
```  
static void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszPassword`  
 Пароль по умолчанию. Пароль может иметь длину до 14 символов и могут содержать любой символ, за исключением ASCII 0 (null). Пароли учитывают регистр.  
  
### <a name="remarks"></a>Примечания  
 Пароль по умолчанию, заданное применяет новые рабочие области, созданные после вызова метода. При создании последующих рабочих областей, необходимо указать пароль в [создать](#create) вызова.  
  
 Чтобы использовать эту функцию-член:  
  
1.  Создать `CDaoWorkspace` объекта, но не нужно вызывать **создать**.  
  
2.  Вызовите `SetDefaultPassword` и при желании [SetDefaultUser](#setdefaultuser).  
  
3.  Вызовите **создать** для этого объекта в рабочей области или последующие условия, без указания пароля.  
  
 По умолчанию свойство DefaultUser имеет значение «admin» и DefaultPassword задано равным пустой строке (»»).  
  
 Дополнительные сведения о безопасности см. в разделе «Разрешения свойство» в справке DAO. Дополнительные сведения см. в разделах «Свойства DefaultPassword» и «DefaultUser свойство» в справке DAO.  
  
##  <a name="setdefaultuser"></a>CDaoWorkspace::SetDefaultUser  
 Вызовите эту функцию-член для задания имени пользователя по умолчанию, компонент database engine использует при создании объекта рабочей области без определенного имени пользователя.  
  
```  
static void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszDefaultUser`  
 Имя пользователя по умолчанию. Имя пользователя может иметь длину от 1 до 20 символов и включать буквы, диакритические знаки, цифры, пробелы и символы, за исключением: "(кавычки) / (косая черта), \ (обратная косая черта), \[ \] (скобки): (двоеточие) | (вертикальная черта), \< (меньше-знак "больше"), настроек (больше-знак "больше"), + (плюс) = (равно входа), (точку с запятой), (запятая) (вопросительный знак) * (звездочка), начальные пробелы и управляющие символы (коды ASCII от 00 до ASCII 31). Дополнительные сведения см. в разделе «Свойство имени пользователя» справки DAO.  
  
### <a name="remarks"></a>Примечания  
 Имя пользователя по умолчанию, которое вы указали применяет новые рабочие области, созданные после вызова метода. При создании последующих рабочих областей, необходимо указать имя пользователя в [создать](#create) вызова.  
  
 Чтобы использовать эту функцию-член:  
  
1.  Создать `CDaoWorkspace` объекта, но не нужно вызывать **создать**.  
  
2.  Вызовите `SetDefaultUser` и при желании [SetDefaultPassword](#setdefaultpassword).  
  
3.  Вызовите **создать** для этого объекта в рабочей области или последующие условия, без указания имени пользователя.  
  
 По умолчанию свойство DefaultUser имеет значение «admin» и DefaultPassword задано равным пустой строке (»»).  
  
 Дополнительные сведения см. в разделах «Свойства DefaultUser» и «DefaultPassword свойство» в справке DAO.  
  
##  <a name="setinipath"></a>CDaoWorkspace::SetIniPath  
 Вызовите эту функцию-член для указания расположения параметры реестра Windows для базы данных Microsoft Jet.  
  
```  
static void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszRegistrySubkey*  
 Строка, содержащая имя подраздела реестра Windows для настройки ядра базы данных Microsoft Jet или параметры, необходимые для установки базы данных ISAM.  
  
### <a name="remarks"></a>Примечания  
 Вызовите `SetIniPath` только в том случае, если необходимо указать параметры. Дополнительные сведения см. в разделе «IniPath свойство» в справке DAO.  
  
> [!NOTE]
>  Вызовите `SetIniPath` во время установки приложения, не при запуске приложения. `SetIniPath`должен вызываться перед открытием все рабочие области, баз данных или наборов записей; в противном случае MFC вызывает исключение.  
  
 Этот механизм позволяет настроить компонент database engine с параметрами реестра, предоставляемых системой. Область этого атрибута только в пределах приложения и нельзя изменить без повторного запуска приложения.  
  
##  <a name="setisolateodbctrans"></a>CDaoWorkspace::SetIsolateODBCTrans  
 Вызовите эту функцию-член для задания значения свойства DAO IsolateODBCTrans для рабочей области.  
  
```  
void SetIsolateODBCTrans(BOOL bIsolateODBCTrans);
```  
  
### <a name="parameters"></a>Параметры  
 *bIsolateODBCTrans*  
 Передайте **TRUE** Если вы хотите начать изоляции транзакции ODBC. Передайте **FALSE** Если вы хотите остановить изоляции транзакции ODBC.  
  
### <a name="remarks"></a>Примечания  
 В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одной и той же базе данных ODBC. Чтобы сделать это, необходимо открыть отдельную рабочую область для каждой транзакции. Несмотря на то, что каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакции не обычно требуется, по умолчанию являются общими соединений ODBC из нескольких объектов рабочая область открывается с тем же пользователем.  
  
 Некоторые серверы ODBC, например Microsoft SQL Server не позволяют одновременные транзакции в одном соединении. Если необходимо иметь более одной транзакции во время ожидания для такой базы данных, задайте свойства IsolateODBCTrans **TRUE** на каждой рабочей области сразу открыть его. Это заставляет отдельное соединение ODBC для каждой рабочей области.  
  
##  <a name="setlogintimeout"></a>CDaoWorkspace::SetLoginTimeout  
 Вызовите эту функцию-член значение DAO LoginTimeout свойства для рабочей области.  
  
```  
static void PASCAL SetLoginTimeout(short nSeconds);
```  
  
### <a name="parameters"></a>Параметры  
 `nSeconds`  
 Количество секунд до произошла ошибка при попытке входа в базе данных ODBC.  
  
### <a name="remarks"></a>Примечания  
 Это значение представляет количество секунд до произошла ошибка при попытке входа в базе данных ODBC. Значение LoginTimeout по умолчанию — 20 секунд. Если LoginTimeout имеет значение 0, отсутствие времени ожидания и связи с источником данных может перестать отвечать на запросы.  
  
 При попытке входа в базе данных ODBC, например Microsoft SQL Server не удается установить подключение в результате ошибки сети или потому, что сервер не работает. Вместо ожидания по умолчанию 20 секунд для подключения, можно указать время ожидания компонент database engine, прежде чем произойдет ошибка. Вход в систему на сервере выполняется неявно в рамках ряд различных событий, таких как выполнение запроса для внешнего сервера базы данных. Значение времени ожидания определяется текущего значения свойства LoginTimeout.  
  
 Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.  
  
## <a name="see-also"></a>См. также  
 [CObject-класс](../../mfc/reference/cobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [Класс CDaoException](../../mfc/reference/cdaoexception-class.md)

