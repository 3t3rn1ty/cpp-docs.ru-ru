---
title: "Класс CDaoWorkspace | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CDaoWorkspace
- AFXDAO/CDaoWorkspace
- AFXDAO/CDaoWorkspace::CDaoWorkspace
- AFXDAO/CDaoWorkspace::Append
- AFXDAO/CDaoWorkspace::BeginTrans
- AFXDAO/CDaoWorkspace::Close
- AFXDAO/CDaoWorkspace::CommitTrans
- AFXDAO/CDaoWorkspace::CompactDatabase
- AFXDAO/CDaoWorkspace::Create
- AFXDAO/CDaoWorkspace::GetDatabaseCount
- AFXDAO/CDaoWorkspace::GetDatabaseInfo
- AFXDAO/CDaoWorkspace::GetIniPath
- AFXDAO/CDaoWorkspace::GetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::GetLoginTimeout
- AFXDAO/CDaoWorkspace::GetName
- AFXDAO/CDaoWorkspace::GetUserName
- AFXDAO/CDaoWorkspace::GetVersion
- AFXDAO/CDaoWorkspace::GetWorkspaceCount
- AFXDAO/CDaoWorkspace::GetWorkspaceInfo
- AFXDAO/CDaoWorkspace::Idle
- AFXDAO/CDaoWorkspace::IsOpen
- AFXDAO/CDaoWorkspace::Open
- AFXDAO/CDaoWorkspace::RepairDatabase
- AFXDAO/CDaoWorkspace::Rollback
- AFXDAO/CDaoWorkspace::SetDefaultPassword
- AFXDAO/CDaoWorkspace::SetDefaultUser
- AFXDAO/CDaoWorkspace::SetIniPath
- AFXDAO/CDaoWorkspace::SetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::SetLoginTimeout
- AFXDAO/CDaoWorkspace::m_pDAOWorkspace
dev_langs:
- C++
helpviewer_keywords:
- DAO workspaces [C++]
- transaction spaces [C++], DAO workspace
- ODBC classes [C++], vs. DAO classes
- default workspaces [C++], DAO
- workspaces [C++], DAO
- sessions [C++], DAO workspace
- Workspace class
- CDaoWorkspace class
- workspaces [C++], interface to database engine
- Workspaces collection
- persistence [C++], DAO workspace
- workspaces [C++], default
- defaults [C++], workspaces
- DAO workspaces [C++], CDaoWorkspace class
- security [MFC], DAO workspaces
- security [MFC]
- database engine [C++], accessing via workspace
- transaction spaces [C++]
- DDLs [C++]
- workspaces [C++], persistence
- default workspaces [C++]
ms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52
caps.latest.revision: 24
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 5d7f9aea6fa4913641bc92662b3cf5dfeaddb9d8
ms.lasthandoff: 02/24/2017

---
# <a name="cdaoworkspace-class"></a>Класс CDaoWorkspace
Управление именованным, защищенным паролем сеансом базы данных от входа до выхода одним пользователем.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CDaoWorkspace : public CObject  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::CDaoWorkspace](#cdaoworkspace)|Создает объект рабочей области. После этого вызвать **создать** или **откройте**.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::Append](#append)|Добавляет созданную рабочую область в коллекцию рабочих областей ядро базы данных.|  
|[CDaoWorkspace::BeginTrans](#begintrans)|Начинает новую транзакцию, которая применяется ко всем базам данных откройте в рабочей области.|  
|[CDaoWorkspace::Close](#close)|Закрытие рабочей области и всех содержащихся в нем объектов. Незавершенные транзакции выполняется откат.|  
|[CDaoWorkspace::CommitTrans](#committrans)|Выполняет текущую транзакцию и сохраняет изменения.|  
|[CDaoWorkspace::CompactDatabase](#compactdatabase)|Сжимает (или дублирует) базы данных.|  
|[CDaoWorkspace::Create](#create)|Создает новый объект workspace DAO.|  
|[CDaoWorkspace::GetDatabaseCount](#getdatabasecount)|Возвращает число объектов базы данных DAO в коллекции баз данных рабочей области.|  
|[CDaoWorkspace::GetDatabaseInfo](#getdatabaseinfo)|Возвращает сведения об указанной базе данных DAO, определенных в коллекции баз данных рабочей области.|  
|[CDaoWorkspace::GetIniPath](#getinipath)|Возвращает расположение базы данных Microsoft Jet параметры инициализации подсистемы в реестре Windows.|  
|[CDaoWorkspace::GetIsolateODBCTrans](#getisolateodbctrans)|Возвращает значение, указывающее, несколько транзакций, включающих один и тот же источник данных ODBC изолированы через принудительно несколько подключений к источнику данных.|  
|[CDaoWorkspace::GetLoginTimeout](#getlogintimeout)|Возвращает количество секунд, прежде чем ошибка возникает, когда пользователь пытается войти базу данных ODBC.|  
|[CDaoWorkspace::GetName](#getname)|Возвращает определенное пользователем имя для объекта workspace.|  
|[CDaoWorkspace::GetUserName](#getusername)|Возвращает имя пользователя, указанного при создании рабочей области. Это имя владельца рабочей области.|  
|[CDaoWorkspace::GetVersion](#getversion)|Возвращает строку, содержащую версию компонента database engine, связанное с рабочей областью.|  
|[CDaoWorkspace::GetWorkspaceCount](#getworkspacecount)|Возвращает количество объектов DAO рабочей области в ядро базы данных коллекции рабочих областей.|  
|[CDaoWorkspace::GetWorkspaceInfo](#getworkspaceinfo)|Возвращает сведения о заданной рабочей области DAO, определенных в коллекции Workspaces ядро базы данных.|  
|[CDaoWorkspace::Idle](#idle)|Позволяет компоненту database engine для выполнения фоновых задач.|  
|[CDaoWorkspace::IsOpen](#isopen)|Возвращает ненулевое значение, если рабочая область — открыть.|  
|[CDaoWorkspace::Open](#open)|Явно откроется рабочая область объекта, связанного с DAO в рабочей области по умолчанию.|  
|[CDaoWorkspace::RepairDatabase](#repairdatabase)|Предпринимает попытку восстановить поврежденную базу данных.|  
|[CDaoWorkspace::Rollback](#rollback)|Завершает текущую транзакцию и не сохранить изменения.|  
|[CDaoWorkspace::SetDefaultPassword](#setdefaultpassword)|Задает пароль, который компонент database engine использует при создании объекта workspace без пароля.|  
|[CDaoWorkspace::SetDefaultUser](#setdefaultuser)|Задает имя пользователя, которое компонент database engine использует при создании объекта workspace без имени пользователя.|  
|[CDaoWorkspace::SetIniPath](#setinipath)|Задает расположение базы данных Microsoft Jet параметры инициализации подсистемы в реестре Windows.|  
|[CDaoWorkspace::SetIsolateODBCTrans](#setisolateodbctrans)|Указывает ли несколько транзакций, включающих один и тот же источник данных ODBC, изолируются принудительное несколько подключений к источнику данных.|  
|[CDaoWorkspace::SetLoginTimeout](#setlogintimeout)|Задает количество секунд, прежде чем ошибка возникает, когда пользователь пытается войти источник данных ODBC.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoWorkspace::m_pDAOWorkspace](#m_pdaoworkspace)|Указывает на объект базового DAO рабочей области.|  
  
## <a name="remarks"></a>Примечания  
 В большинстве случаев вам не потребуется несколько рабочих областей и не требуется создавать объекты явную рабочей области; При открытии объектов базы данных и набор записей, они используют DAO в рабочей области по умолчанию. Однако при необходимости можно запустить несколько сеансов одновременно путем создания объектов Дополнительная рабочая область. Каждый объект рабочая область может содержать несколько открытых объектов базы данных в коллекции баз данных. В MFC рабочая область — в основном диспетчера транзакций, указав набор открытых баз данных в одном «транзакций места».  
  
> [!NOTE]
>  Классы баз данных DAO отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классов MFC на основе ODBC. Классы DAO под управлением доступа к данным через ядро базы данных Microsoft Jet, включая драйверы ODBC. Они также поддерживают операции языка определения данных (DDL), например создание баз данных и добавление таблиц и полей через классы, без необходимости непосредственного вызова DAO.  
  
## <a name="capabilities"></a>Возможности  
 Класс `CDaoWorkspace` предоставляет следующее:  
  
-   Явный доступ в рабочую область по умолчанию, созданные инициализация ядро базы данных. Обычно используется DAO в рабочей области по умолчанию неявно путем создания объектов базы данных и набор записей.  
  
-   В рабочей области откройте транзакций, в котором транзакции применяются ко всем базам данных. Можно создать дополнительные рабочие области для управления пробелы в отдельной транзакции.  
  
-   Интерфейс для многих свойств базовой СУБД Microsoft Jet (см. статические функции-члены). Открытие или создание рабочей области или статическая функция-член перед вызовом откройте или создайте, инициализирует компонент database engine.  
  
-   Доступ к коллекции рабочих областей ядро базы данных, которая хранит все активные рабочие области, добавленные к ней. Можно также создать и работа с рабочими областями без добавления их в коллекцию.  
  
## <a name="security"></a>Безопасность  
 MFC не реализует коллекций пользователей и групп в DAO, которые используются для управления безопасностью. Если необходимо, чтобы эти аспекты DAO, необходимо запрограммировать их самостоятельно через прямые вызовы интерфейсов DAO. Сведения см. в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
## <a name="usage"></a>Использование  
 Можно использовать класс `CDaoWorkspace` для:  
  
-   Явным образом откройте рабочую область по умолчанию.  
  
     Обычно подразумевается использование рабочей области по умолчанию, если открыть новое [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объектов. Однако может потребоваться доступ к явным образом — например, для свойства ядра базы данных access или коллекцию рабочих областей. См. ниже «Неявного использования рабочей области по умолчанию».  
  
-   Создание новой рабочей области. Вызов [Append](#append) Если вы хотите добавить их в коллекцию рабочих областей.  
  
-   Откройте существующую рабочую область в коллекцию рабочих областей.  
  
 Создание новой рабочей области, еще не существует в коллекции описан в рабочих областях [создать](#create) функции-члена. Каким-либо образом между сеансами ядра datababase объектов рабочей области не сохраняются. Если приложение связывает MFC статически, конечное приложение Отменяет инициализацию ядро базы данных. Если приложение связано с MFC динамически, компонент database engine не инициализирован при выгрузке библиотеки DLL MFC.  
  
 Явно открытии рабочей области по умолчанию, или существующую рабочую область в коллекции рабочих областей, описан в разделе [откройте](#open) функции-члена.  
  
 Завершение сеанса рабочей области, закрыв рабочей области с [закрыть](#close) функции-члена. **Закрыть** закрывает все базы данных, не закрыт ранее, откат всех незафиксированных транзакций.  
  
## <a name="transactions"></a>Транзакции  
 DAO управляет транзакции на уровне рабочей области. Таким образом транзакции в рабочую область с несколькими базами данных, откройте применяются для всех баз данных. Например, если две базы данных имеют незафиксированных обновлениях, при вызове метода [CommitTrans](#committrans), все обновления фиксируются. Если вы хотите ограничить транзакции в одной базе данных, для него необходим объект отдельную рабочую область.  
  
## <a name="implicit-use-of-the-default-workspace"></a>Неявное использование рабочей области по умолчанию  
 Используется библиотекой MFC DAO в рабочую область по умолчанию неявно при следующих условиях:  
  
-   Если вы создаете новый `CDaoDatabase` объекта, но делать это через существующий `CDaoWorkspace` объекта MFC создает временную рабочую объект, соответствующий DAO в рабочей области по умолчанию. Если сделать это для нескольких баз данных, все объекты базы данных связаны с рабочей области по умолчанию. Можно получить доступ к рабочей базе данных через `CDaoDatabase` члена данных.  
  
-   Аналогичным образом при создании `CDaoRecordset` объекта без указания указатель `CDaoDatabase` объекта MFC создает временный объект базы данных и модулем объекта временной рабочей областью. Можно обращаться из набора записей базы данных и косвенно его рабочей области `CDaoRecordset` члена данных.  
  
## <a name="other-operations"></a>Другие операции  
 Другие операции базы данных предоставляются, таких как Восстановление поврежденной базы данных или сжатие базы данных.  
  
 Сведения о вызов DAO напрямую и безопасности DAO см. в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 `CDaoWorkspace`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="append"></a>CDaoWorkspace::Append  
 Вызовите эту функцию-член, после вызова метода [создать](#create).  
  
```  
virtual void Append();
```  
  
### <a name="remarks"></a>Примечания  
 **Добавление** добавляет объект созданной рабочей области в коллекцию рабочих областей ядро базы данных. Рабочие области не сохраняются между сеансами ядра базы данных. они хранятся только в памяти, а не на диске. Нет необходимости добавлять рабочей области; Если этого не сделать, вы по-прежнему можно использовать.  
  
 Рабочую область присоединенных остается в коллекцию рабочих областей в активном открытое состояние до вызова его [закрыть](#close) функции-члена.  
  
 Дополнительные сведения см. в разделе «Добавить метод» в справке DAO.  
  
##  <a name="begintrans"></a>CDaoWorkspace::BeginTrans  
 Вызовите эту функцию-член для запуска транзакции.  
  
```  
void BeginTrans();
```  
  
### <a name="remarks"></a>Примечания  
 После вызова метода **BeginTrans**, обновления, внесенные в структуру данных или базы данных вступят в силу при фиксации транзакции. Поскольку область определяет пространство одной транзакции, транзакции применяется для всех открытых баз данных в рабочей области. Для завершения транзакции двумя способами:  
  
-   Вызов [CommitTrans](#committrans) функции-члена для фиксации транзакции и сохранить изменения в источнике данных.  
  
-   Или позвоните [отката](#rollback) функции-члена отменить транзакцию.  
  
 Закрытие рабочей области или объект базы данных, пока ожидается завершение транзакции откат всех незавершенных транзакций.  
  
 Если необходимо изолировать проводок на один источник данных ODBC по сравнению с другим источником данных ODBC, см. раздел [SetIsolateODBCTrans](#setisolateodbctrans) функции-члена.  
  
##  <a name="cdaoworkspace"></a>CDaoWorkspace::CDaoWorkspace  
 Создает объект `CDaoWorkspace`.  
  
```  
CDaoWorkspace();
```  
  
### <a name="remarks"></a>Примечания  
 После создания объекта C++ имеются две возможности:  
  
-   Вызов объекта [откройте](#open) функция-член для открытия рабочей области по умолчанию или откройте существующий объект в коллекцию рабочих областей.  
  
-   Или позвоните объекта [создать](#create) функции-члена для создания нового объекта DAO рабочей области. Это явно запускает новый сеанс рабочей области, можно ссылаться через `CDaoWorkspace` объекта. После вызова метода **создать**, можно вызвать [Append](#append) Если вы хотите добавить в коллекцию рабочих областей ядро базы данных рабочей области.  
  
 В разделе Общие сведения о классе для [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) сведения о при необходимости явного создания `CDaoWorkspace` объекта. Как правило, использование рабочих областей, неявно создается при открытии [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) объекта без указания рабочей области, или при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объекта без указания объекта базы данных. Объекты DAO Библиотеки MFC, созданные таким образом использовать по умолчанию в DAO рабочая область, которая создается один раз и использовать повторно.  
  
 Чтобы освободить рабочую область и содержащиеся в нем объекты, вызывающие этот объект рабочей [закрыть](#close) функции-члена.  
  
##  <a name="close"></a>CDaoWorkspace::Close  
 Вызовите эту функцию-член для закрытия объекта workspace.  
  
```  
virtual void Close();
```  
  
### <a name="remarks"></a>Примечания  
 Закрыть объект открыть рабочую область освобождает базового объекта DAO и, если область входит в коллекцию рабочих областей, он удаляется из коллекции. Вызов **закрыть** хорошим стилем программирования.  
  
> [!CAUTION]
>  При закрытии объекта workspace всех открытых баз данных в рабочей области. Это приведет к все открытые наборы записей в базах данных также закрывается и все отложенные изменения и обновления откатываются. Дополнительные сведения см. в разделе [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#close), и [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#close) функции-члены.  
  
 Объекты в рабочей области не являются постоянными; только они существуют, пока существуют ссылки на них. Это означает, что при завершении сеанса ядра базы данных в рабочей области и коллекции баз данных не сохраняются. Необходимо повторно создать их для следующего сеанса, откройте рабочую область и баз данных снова.  
  
 Дополнительные сведения см. в разделе «Метод Close» в справке DAO.  
  
##  <a name="committrans"></a>CDaoWorkspace::CommitTrans  
 Вызов этой функции-члена для фиксации транзакции, — сохранить группу изменений и обновлений для одного или нескольких баз данных в рабочей области.  
  
```  
void CommitTrans();
```  
  
### <a name="remarks"></a>Примечания  
 Транзакция состоит из ряда изменения базы данных или ее структуру, начиная с помощью вызова [BeginTrans](#begintrans). Если после завершения транзакции, либо выполняющее ее фиксацию или откат (отменить изменения) с [отката](#rollback). По умолчанию без транзакций обновления записей фиксируются немедленно. Вызов **BeginTrans** вызывает обновлений приверженность отложена, пока не будет вызван **CommitTrans**.  
  
> [!CAUTION]
>  В одной рабочей области транзакции всегда являются глобальными, в рабочую область и не ограничиваются только одной базы данных или набора записей. При выполнении операций более одной базы данных или набора записей в рабочей области транзакции, **CommitTrans** фиксирует все ожидающие обновления, и **отката** восстанавливает все операции с этими базами данных и наборы записей.  
  
 При закрытии базы данных или рабочую область с ожидающими транзакции, транзакции откат всех.  
  
> [!NOTE]
>  Это не является механизмом двухфазной фиксации. Если не удается зафиксировать одно обновление, другие по-прежнему будут зафиксированы.  
  
##  <a name="compactdatabase"></a>CDaoWorkspace::CompactDatabase  
 Вызовите эту функцию-член для сжатия указанного Microsoft Jet (. База данных MDB).  
  
```  
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,  
    LPCTSTR lpszDestName,  
    LPCTSTR lpszLocale = dbLangGeneral,  
    int nOptions = 0);

 
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,  
    LPCTSTR lpszDestName,  
    LPCTSTR lpszLocale,  
    int nOptions,  
    LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSrcName`  
 Имя существующего закрытия базы данных. Он может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Если имя файла имеет расширение, необходимо указать его. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, такие как «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойной обратной косой черты в строки пути требуются, так как «\\» escape-символом C++.)  
  
 `lpszDestName`  
 Полный путь сжатой базы данных, для которого создается. Можно также указать сетевой путь как с `lpszSrcName`. Нельзя использовать `lpszDestName` аргумент, чтобы указать тот же файл базы данных `lpszSrcName`.  
  
 `lpszPassword`  
 Пароль используется при сжатии базы данных, защищенной паролем. Обратите внимание, что при использовании версии `CompactDatabase` , принимающий пароль, необходимо указать все параметры. Кроме того, поскольку это параметр connect требуется специального форматирования, следующим образом:; PWD= `lpszPassword`. Например:; PWD = «С». (Требуется начальные точки с запятой).  
  
 `lpszLocale`  
 Строковое выражение, используемое для указания порядка сортировки для создания `lpszDestName`. Если этот аргумент опущен, принимая значение по умолчанию **dbLangGeneral** (см. ниже), языковой стандарт для новой базы данных совпадает в старой базе данных. Доступны следующие значения:  
  
- **dbLangGeneral** английский, немецкий, французский, португальский, итальянский и испанский современных  
  
- **dbLangArabic** арабский  
  
- **dbLangCyrillic** русский  
  
- **dbLangCzech** чешский  
  
- **dbLangDutch** нидерландский  
  
- **dbLangGreek** греческий  
  
- **dbLangHebrew** иврит  
  
- **dbLangHungarian** венгерский  
  
- **dbLangIcelandic** исландская  
  
- **dbLangNordic** Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)  
  
- **dbLangNorwdan** норвежский и датский  
  
- **dbLangPolish** польский  
  
- **dbLangSpanish** испанский (традиционный)  
  
- **dbLangSwedfin** шведский и финский  
  
- **dbLangTurkish** турецкий  
  
 `nOptions`  
 Указывает один или несколько параметров для целевой базы данных `lpszDestName`. Если этот аргумент опущен, принимая значения по умолчанию, `lpszDestName` будет иметь такое же шифрование и та же версия `lpszSrcName`. Можно объединить **dbEncrypt** или **dbDecrypt** вариант с одним из параметров версии, с помощью оператора побитового или. Ниже перечислены возможные значения, которые задают формат базы данных, а не версию ядра базы данных,  
  
- **dbEncrypt** шифрование при сжатии базы данных.  
  
- **dbDecrypt** расшифровывать базу данных во время сжатия.  
  
- **dbVersion10** Создание базы данных, которая используется при сжатии ядра базы данных Microsoft Jet версии 1.0.  
  
- **dbVersion11** Создание базы данных, которая использует ядро СУБД Microsoft Jet версии 1.1 при сжатии.  
  
- **dbVersion20** Создание базы данных, которая использует ядро СУБД Microsoft Jet версии 2.0 при сжатии.  
  
- **dbVersion30** Создание базы данных, которая использует ядро СУБД Microsoft Jet версии 3.0 при сжатии.  
  
 Можно использовать **dbEncrypt** или **dbDecrypt** в качестве аргумента параметров укажите, следует ли шифровать и расшифровывать базу данных при ее сжатии. Если опустить константу шифрования или включаются как **dbDecrypt** и **dbEncrypt**, `lpszDestName` будет иметь такое же шифрование как `lpszSrcName`. Одна из констант версии можно использовать в качестве аргумента параметры для указания версии формата данных для сжатой базы данных. Эта константа затрагивает только версия формата данных `lpszDestName`. Можно указать только одну версию константа. Если опустить константа версии `lpszDestName` будут иметь одинаковую версию `lpszSrcName`. Можно сжать `lpszDestName` только к версии, которая равна или более поздней версии, чем `lpszSrcName`.  
  
> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если реализация безопасности пользователя и пароль, чтобы непосредственно считать файл на диске двоичные, составляющее базы данных.  
  
### <a name="remarks"></a>Примечания  
 При изменении данных в базе данных, файл базы данных может стать фрагментированным и использовать больше места, чем необходимо. Периодически необходимо выполнить сжатие базы данных для дефрагментации файла базы данных. Сжатой базы данных обычно меньше. Можно также изменить порядок сортировки, шифрование или версия формата данных при копировании и сжатие базы данных.  
  
> [!CAUTION]
>  `CompactDatabase` Функция-член не преобразуется правильно всей базы данных Microsoft Access из одной версии в другую. Преобразуется только формат данных. Microsoft доступ определенных пользователем объектов, таких как формы и отчеты, не преобразуются. Тем не менее данные правильно преобразовать.  
  
> [!TIP]
>  Можно также использовать `CompactDatabase` для копирования файла базы данных.  
  
 Дополнительные сведения о сжатия баз данных см. в разделе «Метод CompactDatabase» в справке DAO.  
  
##  <a name="create"></a>CDaoWorkspace::Create  
 Вызов этой функции-члена для создания нового объекта DAO рабочей области и связать его с MFC `CDaoWorkspace` объекта.  
  
```  
virtual void Create(
    LPCTSTR lpszName,  
    LPCTSTR lpszUserName,  
    LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строка, однозначно имена новый объект рабочей области с длиной до 14 символов. Необходимо указать имя. Дополнительные сведения см. в разделе «Свойства Name» в справке DAO.  
  
 *lpszUserName*  
 Имя пользователя владельца рабочей области. Требования см. в разделе `lpszDefaultUser` параметр [SetDefaultUser](#setdefaultuser) функции-члена. Дополнительные сведения см. в разделе «Свойства пользователя» в справке DAO.  
  
 `lpszPassword`  
 Пароль для нового объекта workspace. Пароль может иметь длину до 14 символов и может содержать любой символ, кроме ASCII от 0 (null). Паролях учитывается регистр символов. Дополнительные сведения см. в разделе «Свойство пароль» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 Общий процесс создания является:  
  
1.  Создать [CDaoWorkspace](#cdaoworkspace) объекта.  
  
2.  Вызов объекта **создать** функции-члена для создания базовой рабочей области DAO. Необходимо указать имя рабочей области.  
  
3.  При необходимости вызовите [Append](#append) Если вы хотите добавить в коллекцию рабочих областей ядро базы данных рабочей области. Без добавления ее можно работать с рабочей областью.  
  
 После **создать** вызов, объект рабочей области находится в открытом состоянии, готов к использованию. Не следует вызывать **откройте** после **создать**. Не следует вызывать **создать** Если рабочая область уже существует в коллекции рабочих областей. **Создание** инициализирует компонент database engine, если он еще не был инициализирован для вашего приложения.  
  
##  <a name="getdatabasecount"></a>CDaoWorkspace::GetDatabaseCount  
 Вызовите эту функцию-член для получения числа объектов базы данных DAO в рабочей области базы данных коллекции — число открытых баз данных в рабочей области.  
  
```  
short GetDatabaseCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество открытых баз данных в рабочей области.  
  
### <a name="remarks"></a>Примечания  
 `GetDatabaseCount`полезно, если необходимо перебрать все базы данных, определенных в коллекции баз данных рабочей области. Чтобы получить сведения о данной базы данных в коллекции, в разделе [GetDatabaseInfo](#getdatabaseinfo). Обычно используется для вызова `GetDatabaseCount` числа открытых баз данных, затем использовать это число как индекс цикла повторяющиеся вызовы `GetDatabaseInfo`.  
  
##  <a name="getdatabaseinfo"></a>CDaoWorkspace::GetDatabaseInfo  
 Вызовите эту функцию-член для получения различных видов сведения об открытии базы данных в рабочей области.  
  
```  
void GetDatabaseInfo(
    int nIndex,  
    CDaoDatabaseInfo& dbinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetDatabaseInfo(
    LPCTSTR lpszName,  
    CDaoDatabaseInfo& dbinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Отсчитываемый от нуля индекс объекта базы данных в коллекции баз данных рабочей области, для поиска по индексу.  
  
 `dbinfo`  
 Ссылку на [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) объекта, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, определяющие, какие базы данных для извлечения. Ниже перечислены доступные параметры и что они могут вызывать функцию возврата:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя обновляемой, транзакции  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения об основном: версия, порядок сортировки, время ожидания запроса  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: подключение  
  
 `lpszName`  
 Имя объекта базы данных, для поиска по имени. Имя является строкой с длиной до 14 символов, дает уникальное название нового объекта workspace.  
  
### <a name="remarks"></a>Примечания  
 Одна версия функции позволяет искать базы данных по индексу. Другая версия позволяет искать базы данных по имени.  
  
 Описание сведений, возвращаемых в `dbinfo`, в разделе [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. При запросе информации на одном уровне, вы получите сведения всех предыдущих уровней.  
  
##  <a name="getinipath"></a>CDaoWorkspace::GetIniPath  
 Вызовите эту функцию-член для получения расположения базы данных Microsoft Jet параметры инициализации подсистемы в реестре Windows.  
  
```  
static CString PASCAL GetIniPath();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) содержащий месте реестра.  
  
### <a name="remarks"></a>Примечания  
 Расположение можно использовать для получения сведений о параметрах для компонента database engine. Сведения, возвращаемые является на самом деле имя подраздела реестра.  
  
 Дополнительные сведения см. в разделах «Свойства IniPath» и «Настройка Windows реестра параметры для доступа к данным» в справке DAO.  
  
##  <a name="getisolateodbctrans"></a>CDaoWorkspace::GetIsolateODBCTrans  
 Вызовите эту функцию-член для получения текущего значения свойства DAO IsolateODBCTrans для рабочей области.  
  
```  
BOOL GetIsolateODBCTrans();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если транзакции ODBC изолированы; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одной и той же базе данных ODBC. Для этого необходимо открыть отдельную рабочую область для каждой транзакции. Имейте в виду, что хотя каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакции не обычно требуется, по умолчанию являются общими подключения ODBC из нескольких объектов рабочей области открывается тем же пользователем.  
  
 Некоторые серверы ODBC, например Microsoft SQL Server не позволяют одновременных транзакций в одном соединении. Если необходимо иметь несколько транзакций во время ожидания для такой базы данных, задайте свойства IsolateODBCTrans **TRUE** на каждой рабочей области по мере его открыть. Это заставляет отдельных соединений ODBC для каждой рабочей области.  
  
 Дополнительные сведения см. в разделе «IsolateODBCTrans свойство» в справке DAO.  
  
##  <a name="getlogintimeout"></a>CDaoWorkspace::GetLoginTimeout  
 Вызовите эту функцию-член для получения текущего значения свойства DAO LoginTimeout для рабочей области.  
  
```  
static short PASCAL GetLoginTimeout();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество секунд, прежде чем возникает ошибка при попытке входа базе данных ODBC.  
  
### <a name="remarks"></a>Примечания  
 Это значение представляет количество секунд, прежде чем возникает ошибка при попытке входа базе данных ODBC. Параметр LoginTimeout по умолчанию — 20 секунд. Когда LoginTimeout имеет значение 0, без ожидания и связи с источником данных может перестать отвечать на запросы.  
  
 При попытке выполнить вход в базу данных ODBC, например Microsoft SQL Server не удается установить подключение в результате ошибки сети или потому, что сервер не работает. Вместо ожидания по умолчанию 20 секунд для подключения, можно указать время ожидания компонент database engine, прежде чем произойдет ошибка. Вход на сервер происходит неявно, как часть числа различных событий, таких как выполнение запроса на внешнем сервере базы данных.  
  
 Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.  
  
##  <a name="getname"></a>CDaoWorkspace::GetName  
 Вызовите эту функцию-член для получения определяемое пользователем имя базового объекта DAO рабочей `CDaoWorkspace` объекта.  
  
```  
CString GetName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) содержащее определяемое пользователем имя объекта workspace DAO.  
  
### <a name="remarks"></a>Примечания  
 Имя полезна для доступа к объекту рабочей DAO в компонент database engine рабочих областей коллекции по имени.  
  
 Дополнительные сведения см. в разделе «Свойства Name» в справке DAO.  
  
##  <a name="getusername"></a>CDaoWorkspace::GetUserName  
 Вызовите эту функцию-член для получения имени владельца рабочей области.  
  
```  
CString GetUserName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , представляющий владельца объекта workspace.  
  
### <a name="remarks"></a>Примечания  
 Чтобы получить или задать разрешения для владельца рабочей области, вызов DAO напрямую, чтобы проверить значение свойства разрешения; Определяет, какие разрешения этого пользователя. Для работы с разрешениями, вам необходима система. Файл Помощника.  
  
 Сведения о вызовах DAO напрямую, в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md). Дополнительные сведения см. в разделе «Свойства пользователя» в справке DAO.  
  
##  <a name="getversion"></a>CDaoWorkspace::GetVersion  
 Вызовите эту функцию-член для определения версии базы данных Microsoft Jet используется.  
  
```  
static CString PASCAL GetVersion();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию компонента database engine, связанный с объектом.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение представляет номер версии в формате "основная.дополнительная «";» например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точки и номер версии (0).  
  
 Дополнительные сведения см. в разделе «Свойство Version» в справке DAO.  
  
##  <a name="getworkspacecount"></a>CDaoWorkspace::GetWorkspaceCount  
 Вызовите эту функцию-член для получения числа объектов DAO рабочей области в коллекцию рабочих областей ядро базы данных.  
  
```  
short GetWorkspaceCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число открытых рабочих областей в коллекции рабочих областей.  
  
### <a name="remarks"></a>Примечания  
 Этот счетчик не включает все открытые рабочие пространства не добавляется в коллекцию. `GetWorkspaceCount`полезно, если необходимо перебрать все определенные рабочие области в коллекцию рабочих областей. Чтобы получить сведения о заданной рабочей области в коллекции, в разделе [GetWorkspaceInfo](#getworkspaceinfo). Обычно используется для вызова `GetWorkspaceCount` числа открытых рабочих областей, затем использовать это число как индекс цикла повторяющиеся вызовы `GetWorkspaceInfo`.  
  
##  <a name="getworkspaceinfo"></a>CDaoWorkspace::GetWorkspaceInfo  
 Вызовите эту функцию-член для получения различные виды информации о откройте рабочую область в сеансе.  
  
```  
void GetWorkspaceInfo(
    int nIndex,  
    CDaoWorkspaceInfo& wkspcinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetWorkspaceInfo(
    LPCTSTR lpszName,  
    CDaoWorkspaceInfo& wkspcinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Отсчитываемый от нуля индекс объекта базы данных в коллекцию рабочих областей для поиска по индексу.  
  
 `wkspcinfo`  
 Ссылку на [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) объекта, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, указывающие, какие сведения о рабочей области для извлечения. Ниже перечислены доступные параметры и что они могут вызывать функцию возврата:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения об основном: имя пользователя  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: изолировать ODBCTrans  
  
 `lpszName`  
 Имя объекта workspace для поиска по имени. Имя является строкой с длиной до 14 символов, дает уникальное название нового объекта workspace.  
  
### <a name="remarks"></a>Примечания  
 Описание сведений, возвращаемых в `wkspcinfo`, в разделе [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. При запросе информации на одном уровне, вы получите сведения также предыдущих уровней.  
  
##  <a name="idle"></a>CDaoWorkspace::Idle  
 Вызов **Idle** предоставить компонент database engine возможность выполнения фоновых задач, из-за процесс обработки данных может оказаться устаревшей.  
  
```  
static void PASCAL Idle(int nAction = dbFreeLocks);
```  
  
### <a name="parameters"></a>Параметры  
 `nAction`  
 Действие, применяемое во время обработки бездействия. В настоящее время является единственным допустимым действие **dbFreeLocks**.  
  
### <a name="remarks"></a>Примечания  
 Это особенно актуально в многопользовательской, многозадачных средах, в которых не достаточно времени обработки фона для синхронизации всех записей в наборе записей.  
  
> [!NOTE]
>  Вызов **Idle** нет необходимости в базах данных, созданных с помощью базы данных Microsoft Jet версии 3.0. Используйте **Idle** только для баз данных, созданных в более ранних версиях.  
  
 Как правило, снятии блокировки чтения и данных в локальном наборе записей объектов обновляется только в том случае, когда выполняются другие действия не (включая движения мыши). Если периодически вызывать **Idle**, предоставить компоненту database engine с времени для фоновой обработки задач, выпустив ненужные read блокировки. Указание **dbFreeLocks** константу в качестве аргумента откладывает обработку до снимаются все блокировки чтения.  
  
 Если запущено несколько экземпляров приложения эта функция-член не требуется в средах с одним пользователем. **Idle** функция-член может повысить производительность в многопользовательской среде, поскольку он заставляет механизм базы данных, записи данных на диск, освобождения блокировки памяти. Можно освободить блокировки чтения, сделав часть операций в транзакции.  
  
 Дополнительные сведения см. в разделе «Бездействие метод» в справке DAO.  
  
##  <a name="isopen"></a>CDaoWorkspace::IsOpen  
 Вызов этой функции-члена для определения ли `CDaoWorkspace` открыт объект — то есть ли MFC объект был инициализирован с помощью вызова [откройте](#open) или вызов [создать](#create).  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если открыт объект рабочей области; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Можно вызвать любой член функции рабочей области, которая находится в открытом состоянии.  
  
##  <a name="m_pdaoworkspace"></a>CDaoWorkspace::m_pDAOWorkspace  
 Указатель на объект базового DAO рабочей области.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот элемент данных, если требуется прямой доступ к базовому объекту DAO. Можно вызывать интерфейсы объекта DAO через этот указатель.  
  
 Дополнительные сведения о доступе к объектам DAO непосредственно в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
##  <a name="open"></a>CDaoWorkspace::Open  
 Явно откроется рабочая область объекта, связанного с DAO в рабочей области по умолчанию.  
  
```  
virtual void Open(LPCTSTR lpszName = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя объекта DAO рабочей области, чтобы открыть — строку с длиной до 14 символов, который дает уникальное название рабочей области. Примите значение по умолчанию **NULL** явно открыть рабочую область по умолчанию. Требования к именованию, в разделе `lpszName` параметр [создать](#create). Дополнительные сведения см. в разделе «Свойства Name» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 После создания `CDaoWorkspace` объекта, вызов этой функции-члена для выполните одно из следующих действий:  
  
-   Явным образом откройте рабочую область по умолчанию. Pass **NULL** for `lpszName`.  
  
-   Откройте существующий `CDaoWorkspace` объект, член коллекции Workspaces по имени. Передайте допустимое имя существующего объекта workspace.  
  
 **Откройте** помещает объект рабочей области в открытом состоянии, а также инициализирует компонент database engine, если он еще не был инициализирован для вашего приложения.  
  
 Хотя многие `CDaoWorkspace` член функции можно вызывать только после открытия рабочей области, следующие функции-члены, которые работают в компоненте database engine, доступные после создания экземпляра объекта C++, но перед вызовом **откройте**:  
  
||||  
|-|-|-|  
|[Создание](#create)|[GetVersion](#getversion)|[SetDefaultUser](#setdefaultuser)|  
|[GetIniPath](#getinipath)|[В состоянии простоя](#idle)|[SetIniPath](#setinipath)|  
|[GetLoginTimeout](#getlogintimeout)|[SetDefaultPassword](#setdefaultpassword)|[SetLoginTimeout](#setlogintimeout)|  
  
##  <a name="repairdatabase"></a>CDaoWorkspace::RepairDatabase  
 Вызовите эту функцию-член, чтобы попытаться восстановить поврежденную базу данных, который обращается к базы данных Microsoft Jet.  
  
```  
static void PASCAL RepairDatabase(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Путь и имя файла существующего файла базы данных Microsoft Jet Database engine. Если путь не указан, выполняется поиск только в текущем каталоге. Если система поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например: «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойные обратные косые черты необходимы в строке пути, так как «\\» является escape-символ C++.)  
  
### <a name="remarks"></a>Примечания  
 Необходимо закрыть базы данных, указанной `lpszName` до ее восстановления. В многопользовательской среде другие пользователи не могут иметь `lpszName` открыть, когда он восстанавливается. Если `lpszName` не закрыты или не доступен для монопольного использования, возникает ошибка.  
  
 Эта функция-член пытается восстановить базу данных, которая была отмечена как возможное повреждение операцией неполная запись. Это может произойти при неожиданном завершении приложения с помощью базы данных Microsoft Jet из-за питанием отключение электроэнергии или компьютере проблемы с оборудованием. По завершении операции и вызвать [закрыть](../../mfc/reference/cdaodatabase-class.md#close) функции-члена или выйти из приложения обычным образом, базы данных не будет помечена как может быть повреждена.  
  
> [!NOTE]
>  После восстановления базы данных, это также хороший способ сжатия с помощью [CompactDatabase](#compactdatabase) функции-члена для дефрагментации файла и освободить место на диске.  
  
 Дополнительные сведения о восстановлении баз данных см. в разделе «Метод RepairDatabase» в справке DAO.  
  
##  <a name="rollback"></a>CDaoWorkspace::Rollback  
 Вызов этой функции-члена для завершения текущей транзакции и восстановить все базы данных в рабочей области в их состояние до начала транзакции.  
  
```  
void Rollback();
```  
  
### <a name="remarks"></a>Примечания  
  
> [!CAUTION]
>  В один объект рабочей области транзакции всегда являются глобальными, в рабочую область и не ограничиваются только одной базы данных или набора записей. При выполнении операций более одной базы данных или набора записей в рабочей области транзакции, **отката** восстанавливает все операции во всех этих баз данных и наборы данных.  
  
 Если вы закроете объекта workspace без сохранения или откат всех отложенных транзакций, транзакции автоматический откат. При вызове метода [CommitTrans](#committrans) или **отката** без предварительного вызова функции [BeginTrans](#begintrans), возникает ошибка.  
  
> [!NOTE]
>  При запуске транзакции, компонент database engine записывает операции, его в файле, который хранится в каталоге, указанном в переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпывает доступное хранилище на диске TEMP, компонент database engine приведет к MFC, позволяющий создавать `CDaoException` (ошибка DAO 2004 г.). На этом этапе, если вызвать **CommitTrans**фиксируются неопределенное количество операций, но остальные незавершенные операции будут потеряны, и операция должна быть перезапущена. Вызов **отката** освобождает журнала транзакций и выполняет откат всех операций в транзакции.  
  
##  <a name="setdefaultpassword"></a>CDaoWorkspace::SetDefaultPassword  
 Вызов этой функции-члена для установки пароля по умолчанию, компонент database engine использует при создании объекта workspace без определенного пароля.  
  
```  
static void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszPassword`  
 Пароль по умолчанию. Пароль может иметь длину до 14 символов и может содержать любой символ, кроме ASCII от 0 (null). Паролях учитывается регистр символов.  
  
### <a name="remarks"></a>Примечания  
 Пароль по умолчанию, заданные применяется к новые рабочие области, созданные после вызова. При создании последующих рабочих областей, необходимо указать пароль в [создать](#create) вызова.  
  
 Чтобы использовать эту функцию-член:  
  
1.  Создать `CDaoWorkspace` объекта, но не нужно вызывать **создать**.  
  
2.  Вызов `SetDefaultPassword` и при необходимости [SetDefaultUser](#setdefaultuser).  
  
3.  Вызов **создать** для этого объекта в рабочей области или последующие без указания пароля.  
  
 По умолчанию свойство DefaultUser имеет значение «admin» и DefaultPassword свойству пустую строку (»»).  
  
 Дополнительные сведения о безопасности см. в разделе «Разрешения свойство» в справке DAO. Дополнительные сведения см. в разделах «DefaultPassword свойств» и «DefaultUser» в справке DAO.  
  
##  <a name="setdefaultuser"></a>CDaoWorkspace::SetDefaultUser  
 Вызов этой функции-члена для задания имени пользователя по умолчанию, компонент database engine использует при создании объекта workspace без имени пользователя.  
  
```  
static void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszDefaultUser`  
 Имя пользователя по умолчанию. Имя пользователя может иметь длину от 1 — 20 символов и включать буквенные символы, символы с диакритическими знаками, цифры, пробелы и символы, за исключением: "(кавычки) / (косая черта), \ (обратная косая черта), \[ \] (квадратные скобки): (двоеточие), | (вертикальная черта), \< (меньше-знак "больше"), настроек (больше-знак "больше"), + (плюс) = (равно входа), (точка с запятой), (запятая) (вопросительный знак), * (звездочка), начальные пробелы и управляющие символы (коды ASCII от 00 до ASCII 31). Дополнительные сведения см. в разделе «Свойства пользователя» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 Имя пользователя по умолчанию, которое вы указали применяет новые рабочие области, созданные после вызова. При создании последующих рабочих областей, необходимо указать имя пользователя в [создать](#create) вызова.  
  
 Чтобы использовать эту функцию-член:  
  
1.  Создать `CDaoWorkspace` объекта, но не нужно вызывать **создать**.  
  
2.  Вызов `SetDefaultUser` и при необходимости [SetDefaultPassword](#setdefaultpassword).  
  
3.  Вызов **создать** для этого объекта в рабочей области или последующие без указания имени пользователя.  
  
 По умолчанию свойство DefaultUser имеет значение «admin» и DefaultPassword свойству пустую строку (»»).  
  
 Дополнительные сведения см. в разделах «Свойства DefaultUser» и «DefaultPassword свойство» в справке DAO.  
  
##  <a name="setinipath"></a>CDaoWorkspace::SetIniPath  
 Вызов этой функции-члена для указания расположения параметров реестра Windows для базы данных Microsoft Jet.  
  
```  
static void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszRegistrySubkey*  
 Строка, содержащая имя подраздела реестра Windows для настройки ядра базы данных Microsoft Jet или параметры, необходимые для установки базы данных ISAM.  
  
### <a name="remarks"></a>Примечания  
 Вызов `SetIniPath` только в том случае, если необходимо указать параметры. Дополнительные сведения см. в разделе «IniPath свойство» в справке DAO.  
  
> [!NOTE]
>  Вызов `SetIniPath` во время установки приложения, не при запуске приложения. `SetIniPath`должен вызываться перед открытием любого рабочих областей, баз данных или наборов записей; в противном случае — MFC создает исключение.  
  
 Этот механизм позволяет настроить компонент database engine с параметрами реестра, предоставленных пользователем. Область этого атрибута ограничены приложения и нельзя изменить без повторного запуска приложения.  
  
##  <a name="setisolateodbctrans"></a>CDaoWorkspace::SetIsolateODBCTrans  
 Вызовите эту функцию-член для задания значения свойства DAO IsolateODBCTrans для рабочей области.  
  
```  
void SetIsolateODBCTrans(BOOL bIsolateODBCTrans);
```  
  
### <a name="parameters"></a>Параметры  
 *bIsolateODBCTrans*  
 Передайте **TRUE** Если вы хотите начать изоляции транзакции ODBC. Передайте **FALSE** Если вы хотите остановить изоляции транзакции ODBC.  
  
### <a name="remarks"></a>Примечания  
 В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одной и той же базе данных ODBC. Для этого необходимо открыть отдельную рабочую область для каждой транзакции. Хотя каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакции не обычно требуется, по умолчанию являются общими подключения ODBC из нескольких объектов рабочей области открывается тем же пользователем.  
  
 Некоторые серверы ODBC, например Microsoft SQL Server не позволяют одновременных транзакций в одном соединении. Если необходимо иметь несколько транзакций во время ожидания для такой базы данных, задайте свойства IsolateODBCTrans **TRUE** на каждой рабочей области по мере его открыть. Это заставляет отдельных соединений ODBC для каждой рабочей области.  
  
##  <a name="setlogintimeout"></a>CDaoWorkspace::SetLoginTimeout  
 Вызовите эту функцию-член для задания значения свойства DAO LoginTimeout для рабочей области.  
  
```  
static void PASCAL SetLoginTimeout(short nSeconds);
```  
  
### <a name="parameters"></a>Параметры  
 `nSeconds`  
 Количество секунд, прежде чем возникает ошибка при попытке входа базе данных ODBC.  
  
### <a name="remarks"></a>Примечания  
 Это значение представляет количество секунд, прежде чем возникает ошибка при попытке входа базе данных ODBC. Параметр LoginTimeout по умолчанию — 20 секунд. Когда LoginTimeout имеет значение 0, без ожидания и связи с источником данных может перестать отвечать на запросы.  
  
 При попытке выполнить вход в базу данных ODBC, например Microsoft SQL Server не удается установить подключение в результате ошибки сети или потому, что сервер не работает. Вместо ожидания по умолчанию 20 секунд для подключения, можно указать время ожидания компонент database engine, прежде чем произойдет ошибка. Вход в систему на сервере выполняется неявно в рамках ряд различных событий, таких как выполнение запроса на внешнем сервере базы данных. Значение времени ожидания определяется текущего значения свойства LoginTimeout.  
  
 Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.  
  
## <a name="see-also"></a>См. также  
 [CObject-класс](../../mfc/reference/cobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [Класс CDaoException](../../mfc/reference/cdaoexception-class.md)

