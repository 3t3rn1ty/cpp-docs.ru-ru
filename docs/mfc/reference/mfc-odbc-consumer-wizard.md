---
title: "мастер потребителей ODBC MFC | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.class.mfc.consumer.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "мастер потребителей ODBC MFC"
  - "мастера [MFC]"
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
caps.latest.revision: 7
caps.handback.revision: 4
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# мастер потребителей ODBC MFC
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Вставьте здесь сводную информацию из раздела "Результаты поиска".  
  
 Этот мастер устанавливает класс набора записей ODBC и привязки данных, необходимые для доступа к указанному источнику данных.  
  
## Список элементов пользовательского интерфейса  
 **Источник данных**  
 Кнопка **Источник данных** позволяет установить заданный источник данных, используя указанный драйвер ODBC.  Дополнительные сведения о файлах источников данных \(DSN\) см. в разделе [Файлы источников данных](https://msdn.microsoft.com/en-us/library/ms715401.aspx) в ODBC SDK.  Диалоговое окно **Выбор источника данных** имеет две вкладки:  
  
-   Вкладка **Файл источника данных**. Поле **Искать в** указывает каталог, в котором должны выбираться файлы, используемые в качестве источника данных.  По умолчанию это каталог \\Program Files\\Common Files\\ODBC\\Data Sources.  Существующие файлы источников данных \(DSN\-файлы\) отображаются в главном списке.  Можно либо установить заранее источники данных, используя вкладку **Файл DSN** в [администраторе источников данных ODBC](https://msdn.microsoft.com/en-us/library/ms714024.aspx), либо создать новые источники данных с помощью диалогового окна.  
  
     Для создания в диалоговом окне нового файла источника данных нажмите кнопку `New`, чтобы задать имя DSN. В результате отобразится диалоговое окно **Создание нового источника данных**.  В диалоговом окне **Создание нового источника данных** выберите подходящий драйвер и нажмите кнопку `Next`; нажмите кнопку **Обзор** и выберите имя файла, который должен использоваться в качестве источника данных \(необходимо выбрать "Все файлы", чтобы просмотреть файлы, не являющиеся DSN, например XLS\-файлы\); нажмите кнопку `Next`, а затем нажмите **Готово**. \(Если выбран файл не DSN, отобразится зависящее от драйвера диалоговое окно, например "Настройка ODBC Microsoft Excel", которая преобразует файл в DSN\).  
  
    > [!NOTE]
    >  Можно также заранее создать новый файл источника данных при помощи администратора источников данных ODBC.  В меню **Пуск** выберите **Настройки**, **Панель управления**, **Администрирование**, **Источники данных \(ODBC\)**, и затем **Администратор источников данных ODBC**.  
  
     Поле **Имя DSN** позволяет задать имя файла источника данных.  Необходимо обеспечить, чтобы имя DSN имело соответствующее расширение файла, например .xls для файлов Excel или .mdb для файлов Access.  
  
     Дополнительные сведения об именах DSN см. в разделе [Файлы источников данных](https://msdn.microsoft.com/en-us/library/ms715401.aspx) в ODBC SDK.  
  
-   Вкладка **Машинные источники данных**. На этой вкладке указываются системные источники данных и источники пользовательских данных.  Источники пользовательских данных зависят от пользователя на данной машине.  Системные источники данных могут использоваться всеми пользователями на этой машине или в службе для всей системы.  См. раздел [Машинные источники данных](https://msdn.microsoft.com/en-us/library/ms710952.aspx) в ODBC SDK  
  
 Дополнительные сведения об источниках данных ODBC см. в разделе [Источники данных](https://msdn.microsoft.com/en-us/library/ms711688.aspx) в ODBC SDK.  
  
 В завершение нажмите кнопку **ОК**.  Появится диалоговое окно **Выбор объектов базы данных**.  В этом диалоговом окне выберите таблицу или представление, которое будет использовать потребитель.  Обратите внимание, что можно выбрать несколько представлений и таблиц, удерживая клавишу CTRL при щелчке элементов.  
  
 **Класс**  
 Имя класса потребителя, по умолчанию основанное на имени выбранного файла источника данных или машинного источника данных.  
  
 **H\-файл**  
 Имя файла заголовка класса потребителя, по умолчанию основанное на имени выбранного файла источника данных или машинного источника данных.  
  
 **CPP\-файл**  
 Имя файла реализации класса потребителя, по умолчанию основанное на имени выбранного файла источника данных или машинного источника данных.  
  
 **Тип**  
 Указывает, является ли набор записей динамическим множеством \(тип по умолчанию\) или моментальным снимком.  
  
-   **Dynaset**: указывает, что набор записей является динамическим множеством.  Динамическое подмножество является результатом запроса, предоставляющим индексированное представление в запрошенных данных базы данных.  Динамическое подмножество кэширует только интегральный индекс исходных данных и, таким образом, обеспечивает повышение производительности, по сравнению с моментальным снимком.  Индекс указывает непосредственно на каждую найденную в результате запроса запись и определяет, удалена ли запись.  Имеется также доступ к обновленным данным в запрошенных записях.  Это значение по умолчанию.  
  
-   **Snapshot**: указывает, что набор записей является моментальным снимком.  Моментальный снимок является результатом запроса и представлением базы данных в отдельно взятый момент времени.  Все найденные в результате запроса записи кэшируются, так что не видны изменения в исходных записях.  
  
 **Привязать все столбцы**  
 Указывает, привязаны ли все столбцы выбранной таблицы.  Если этот флажок установлен \(настройка по умолчанию\), все столбцы связаны; в противном случае столбцы не связаны, и необходимо связать их вручную в классе наборов записей.  
  
## См. также  
 [Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)   
 [Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)