---
title: Структура CDaoIndexInfo | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CDaoIndexInfo
dev_langs:
- C++
helpviewer_keywords:
- DAO (Data Access Objects), Indexes collection
- CDaoIndexInfo structure [MFC]
ms.assetid: 251d8285-78ce-4716-a0b3-ccc3395fc437
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 85e59173ec330d0a5abb968225ce6b2e12263948
ms.sourcegitcommit: c6b095c5f3de7533fd535d679bfee0503e5a1d91
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2018
ms.locfileid: "36954069"
---
# <a name="cdaoindexinfo-structure"></a>Структура CDaoIndexInfo
`CDaoIndexInfo` Структура содержит сведения об объекте индекс, определенный для объектов доступа к данным (DAO).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
struct CDaoIndexInfo {  
    CDaoIndexInfo();
*// Constructor  
    CString m_strName;  // Primary  
    CDaoIndexFieldInfo* m_pFieldInfos;  // Primary  
    short m_nFields;    // Primary  
    BOOL m_bPrimary;    // Secondary  
    BOOL m_bUnique;     // Secondary  
    BOOL m_bClustered;  // Secondary  
    BOOL m_bIgnoreNulls;                // Secondary  
    BOOL m_bRequired;   // Secondary  
    BOOL m_bForeign;    // Secondary  
    long m_lDistinctCount;              // All  
 *// Below the // Implementation comment: *// Destructor, not otherwise documented  
};   
```  
  
#### <a name="parameters"></a>Параметры  
 *m_strName*  
 Однозначно имена полей объекта. Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.  
  
 *m_pFieldInfos*  
 Указатель на массив [CDaoIndexFieldInfo](../../mfc/reference/cdaoindexfieldinfo-structure.md) объектов, указывающее, какие поля tabledef или набора записей ключевых полей в индексе. Каждый объект определяет одно поле в индексе. Индекс по умолчанию порядок по возрастанию. Индекс объекта, который может иметь одно или несколько полей, представляющих ключи индекса для каждой записи. Они могут быть отсортированы по возрастанию, по убыванию, или их комбинацию.  
  
 *m_nFields*  
 Число полей, хранящихся в *m_pFieldInfos*.  
  
 *m_bPrimary*  
 Если свойство основной **TRUE**, индекс объекта, который представляет первичного индекса. Первичный индекс состоит из одного или нескольких полей, которые однозначно определяют все записи в таблицу в заранее определенном порядке. Так как поле индекса должны быть уникальными, уникальное свойство объекта индекса также присвоено **TRUE** в DAO. Если первичный индекс состоит из нескольких полей, каждое поле может содержать повторяющиеся значения, но каждая комбинация значений всех индексированных полей должно быть уникальным. Первичный индекс состоит из ключа для таблицы и обычно содержит те же поля в качестве первичного ключа.  
  
 При установке первичный ключ для таблицы первичный ключ автоматически определяется как первичный индекс для таблицы. Дополнительные сведения см. в разделах «Свойства источника» и «Уникальное свойство» в справке DAO.  
  
> [!NOTE]
>  Может существовать, не более одного первичного индекса таблицы.  
  
 *m_bUnique*  
 Указывает, представляет ли объект индекса уникального индекса для таблицы. Если это свойство имеет **TRUE**, индекс объекта, который представляет индекс, который является уникальным. Уникальный индекс состоит из одного или нескольких полей, которые логически Упорядочить все записи из таблицы в порядке уникальный, предопределенные. Если индекс состоит из одного поля, значения в этом поле должно быть уникальным для всей таблицы. Если индекс состоит из нескольких полей, каждое поле может содержать повторяющиеся значения, но каждая комбинация значений всех индексированных полей должно быть уникальным.  
  
 Если первичный и уникальный индекс объекта задано значение **TRUE**, индекс является уникальным, а основной: однозначно определяет все записи в таблице в стандартных, логический порядок. Если свойство Primary равно **FALSE**, индекс является вторичным индексом. Вторичные индексы (ключевых и неключевых) логически упорядочить записи в предопределенном порядке без выступают в качестве идентификатора для записей в таблице.  
  
 Дополнительные сведения см. в разделах «Свойства источника» и «Уникальное свойство» в справке DAO.  
  
 *m_bClustered*  
 Указывает, представляет ли объект индекса кластеризованный индекс для таблицы. Если это свойство имеет **TRUE**, индекс объекта, который представляет кластеризованный индекс; в противном случае это не так. Кластеризованный индекс состоит из одного или нескольких неключевых полей, в совокупности определяют каждую запись в таблицу в заранее определенном порядке. С кластеризованным индексом данные в таблице буквально хранятся в порядке, указанном в кластеризованный индекс. Эффективный доступ к записи в таблице кластеризованного индекса. Дополнительные сведения см. в разделе «Clustered свойство» в справке DAO.  
  
> [!NOTE]
>  Свойство Clustered учитывается для баз данных, использующих базы данных Microsoft Jet, так как базы данных Jet не поддерживает кластеризованные индексы.  
  
 *m_bIgnoreNulls*  
 Указывает, имеются ли записи индекса для записи, имеющие значения Null в полях индекса. Если это свойство имеет **TRUE**, полей со значениями Null не имеют элемента указателя. Чтобы для поиска записей, используя поле быстрее, можно определить индекс для поля. Если разрешить записи со значением Null в индексируемым полям и ожидать, что многие из записей, чтобы иметь значение Null, можно задать свойство IgnoreNulls индекса объекта, чтобы **TRUE** для сокращения объема дискового пространства, которое использует индекс. Значение свойства IgnoreNulls и значение обязательного свойства вместе определяют ли запись со значением Null индекс имеет элемент указателя, как показано в следующей таблице.  
  
|IgnoreNulls|Обязательно|Значение NULL в поле индекса|  
|-----------------|--------------|-------------------------|  
|Да|False|Значение NULL разрешено; не добавлена запись индекса.|  
|False|False|Значение NULL разрешено; Индекс добавленного элемента.|  
|True или False|Да|Значение NULL не допускается; не добавлена запись индекса.|  
  
 Дополнительные сведения см. в разделе «IgnoreNulls свойство» в справке DAO.  
  
 *m_bRequired*  
 Указывает, требуется ли индекс объекта DAO непустое значение. Если это свойство имеет **TRUE**, индекс объекта, который не допускает значение Null. Дополнительные сведения см. в разделе «Необходимые свойства» в справке DAO.  
  
> [!TIP]
>  При установке этого свойства для объекта DAO индекса или объект поля (содержится tabledef, записей или querydef объекта), укажите значение для поля объекта. До этого индекса объекта проверяется допустимость настройку свойства для объекта поля.  
  
 *m_bForeign*  
 Указывает, представляет ли объект индекса внешнего ключа в таблице. Если это свойство имеет **TRUE**, индекс представляет внешний ключ в таблице. Внешний ключ состоит из одного или нескольких полей во внешней таблице, однозначно идентифицировать строку в таблице первичного. Создает объект индекса для таблицы внешнего базы данных Microsoft Jet и задает свойство внешнего при создании отношение, которое обеспечивает целостность ссылок. Дополнительные сведения см. в разделе «Свойство внешнего» в справке DAO.  
  
 *m_lDistinctCount*  
 Указывает количество уникальных значений для объекта индекса, которые включены в связанную таблицу. Проверьте свойство DistinctCount для определения количества уникальных значений или ключи в индексе. Любая клавиша учитывается только один раз, даже если могут существовать несколько экземпляров данного значения, если индекс допускает повторяющиеся значения. Эта информация полезна в приложениях, пытающиеся получить доступ к данным оптимизируется путем оценки данных индекса. Количество уникальных значений называется также количество элементов объекта индекса. Свойство DistinctCount будет всегда отражает фактическое число ключей в конкретный момент времени. Например изменения, вызванные отката транзакции не отразится непосредственно в свойстве DistinctCount. Дополнительные сведения см. в разделе «Число различных значений свойства» в справке DAO.  
  
## <a name="remarks"></a>Примечания  
 Ссылки на основной, дополнительный и все указанные выше указывают, как возвращаются сведения по `GetIndexInfo` функции-члена в классах [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md#getindexinfo) и [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md#getindexinfo).  
  
 Класс MFC не представлены объектов индекса. Вместо этого DAO объекты базовых объектов MFC класса [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) содержать коллекцию объектов индекса, который называется коллекции индексов. Эти классы предоставьте функции-члены для доступа к отдельным элементам данных индекса, или можно получить доступ к их все одновременно с `CDaoIndexInfo` путем вызова метода `GetIndexInfo` функции-члена вмещающего объекта.  
  
 `CDaoIndexInfo` содержит конструктор и деструктор, чтобы правильно выделять и освобождать поля сведений об индексе *m_pFieldInfos*.  
  
 Сведений, получаемых методом `GetIndexInfo` функции-члена объекта tabledef хранится в `CDaoIndexInfo` структуры. Вызовите `GetIndexInfo` функции-члена вмещающего объекта tabledef, в которых коллекции индексов хранится индекс объекта. `CDaoIndexInfo` также определяет `Dump` функции-члена в отладочных построений. Можно использовать `Dump` для помещения в дамп содержимого `CDaoIndexInfo` объекта.  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
## <a name="see-also"></a>См. также  
 [Структуры, стили, обратные вызовы и схемы сообщений](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)   
 [CDaoTableDef::GetIndexInfo](../../mfc/reference/cdaotabledef-class.md#getindexinfo)

