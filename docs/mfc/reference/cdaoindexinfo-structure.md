---
title: "Структура CDaoIndexInfo | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- CDaoIndexInfo
dev_langs:
- C++
helpviewer_keywords:
- DAO (Data Access Objects), Indexes collection
- CDaoIndexInfo structure
ms.assetid: 251d8285-78ce-4716-a0b3-ccc3395fc437
caps.latest.revision: 13
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 040985df34f2613b4e4fae29498721aef15d50cb
ms.openlocfilehash: 92206d8d8f9b2315fb859e2712a83d32a4c293ad
ms.contentlocale: ru-ru
ms.lasthandoff: 02/24/2017

---
# <a name="cdaoindexinfo-structure"></a>Структура CDaoIndexInfo
`CDaoIndexInfo` Структура содержит сведения об объекте индекс, определенный для объектов доступа к данным (DAO).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
struct CDaoIndexInfo {  
    CDaoIndexInfo();
*// Constructor  
    CString m_strName;  // Primary  
    CDaoIndexFieldInfo* m_pFieldInfos;  // Primary  
    short m_nFields;    // Primary  
    BOOL m_bPrimary;    // Secondary  
    BOOL m_bUnique;     // Secondary  
    BOOL m_bClustered;  // Secondary  
    BOOL m_bIgnoreNulls;                // Secondary  
    BOOL m_bRequired;   // Secondary  
    BOOL m_bForeign;    // Secondary  
    long m_lDistinctCount;              // All  
 *// Below the // Implementation comment: *// Destructor, not otherwise documented  
};   
```  
  
#### <a name="parameters"></a>Параметры  
 `m_strName`  
 Однозначно имена полей объекта. Дополнительные сведения см. в разделе «Свойства Name» в справке DAO.  
  
 `m_pFieldInfos`  
 Указатель на массив [CDaoIndexFieldInfo](../../mfc/reference/cdaoindexfieldinfo-structure.md) объектов, позволяющее определить, какие поля tabledef или набора записей являются полями ключей в индексе. Каждый объект определяет одного поля в индексе. Индекс по умолчанию порядок по возрастанию. Объект индекса может иметь одно или несколько полей, представляющих ключей индекса для каждой записи. Они могут быть отсортированы по возрастанию, по убыванию, или их комбинацию.  
  
 `m_nFields`  
 Количество полей, хранящихся в `m_pFieldInfos`.  
  
 *m_bPrimary*  
 Если свойство основной **TRUE**, представляет объект индекса первичного индекса. Первичный индекс состоит из одного или нескольких полей, которые уникально идентифицируют все записи в таблицу в заранее определенном порядке. Поскольку поле индекса должны быть уникальными, уникальный индекс объекта также задано значение **TRUE** в DAO. Если первичный индекс состоит из нескольких полей, каждое поле может содержать повторяющиеся значения, но каждая комбинация значений всех индексированных полей должно быть уникальным. Первичный индекс состоит из ключа для таблицы и обычно содержит те же поля в качестве первичного ключа.  
  
 При установке первичный ключ для таблицы первичный ключ автоматически определяется как первичный индекс для таблицы. Дополнительные сведения см. в разделах «Основной свойства» и «Уникальное свойство» в справке DAO.  
  
> [!NOTE]
>  Может существовать, не более одного первичного индекса в таблице.  
  
 *m_bUnique*  
 Указывает, представляет ли объект индекса уникального индекса для таблицы. Если это свойство имеет **TRUE**, объект индекса представляет индекс, который является уникальным. Уникальный индекс состоит из одного или нескольких полей, которые логически Упорядочить все записи в таблице в порядке уникальный, предопределенные. Если индекс состоит из одного поля, значения в этом поле должны быть уникальными для всей таблицы. Если индекс состоит из нескольких полей, каждое поле может содержать повторяющиеся значения, но каждая комбинация значений всех индексированных полей должно быть уникальным.  
  
 Если первичный и уникальный индекс объекта задано значение **TRUE**, индекс является уникальным, а основной: однозначно определяет все записи в таблице в стандартных, логический порядок. Если свойство Primary **FALSE**, индекс является вторичным индексом. Вторичные индексы (ключевые и неключевые) логически упорядочить записи в заранее определенном порядке без служащее идентификатором для записей в таблице.  
  
 Дополнительные сведения см. в разделах «Основной свойства» и «Уникальное свойство» в справке DAO.  
  
 *m_bClustered*  
 Указывает, представляет ли объект индекса кластеризованный индекс для таблицы. Если это свойство имеет **TRUE**, кластеризованный индекс представляет объект индекса, в противном случае — нет. Кластеризованный индекс состоит из одного или нескольких неключевых полей, взятые вместе, определяют каждую запись в таблицу в заранее определенном порядке. С кластеризованным индексом данные в таблице буквально хранятся в порядке, указанном в кластеризованный индекс. Кластерный индекс обеспечивает эффективный доступ к записям в таблице. Дополнительные сведения см. в разделе «Кластеризованный свойство» в справке DAO.  
  
> [!NOTE]
>  Свойство Clustered учитывается для баз данных, использующих базы данных Microsoft Jet, поскольку ядро базы данных Jet не поддерживает кластеризованные индексы.  
  
 *m_bIgnoreNulls*  
 Указывает, имеются ли записи индекса для записи, имеющие значения Null в полях индекса. Если это свойство имеет **TRUE**, полей со значениями Null не имеют элемента указателя. Чтобы поиск записей с помощью поля быстрее, можно определить индекс для поля. Если разрешить записи со значением Null в индексированных полей и ожидать, что многие из записей, чтобы иметь значение Null, можно задать свойство IgnoreNulls объект индекса для **TRUE** для уменьшения объема дискового пространства, используемого индексом. Свойства параметра IgnoreNulls и обязательное свойство вместе определяют, имеет ли запись со значением Null индекса элемента указателя, как показано в следующей таблице.  
  
|IgnoreNulls|Обязательно|Значение NULL в поле индекса|  
|-----------------|--------------|-------------------------|  
|True|False|Значение NULL разрешено; не добавлена запись индекса.|  
|False|False|Значение NULL разрешено; добавлена запись индекса.|  
|True или False|True|Значение NULL не допускается; не добавлена запись индекса.|  
  
 Дополнительные сведения см. в разделе «IgnoreNulls свойство» в справке DAO.  
  
 `m_bRequired`  
 Указывает, требуется ли объект индекса DAO непустое значение. Если это свойство имеет **TRUE**, объект индекса не допускает значение Null. Дополнительные сведения см. в разделе «Необходимые свойства» в справке DAO.  
  
> [!TIP]
>  При установке этого свойства для объекта индекса DAO или объект поля (содержащиеся tabledef, записей или объекта querydef) задать для поля объекта. До этого индекса объекта проверяется допустимость значения свойства для объекта поля.  
  
 *m_bForeign*  
 Указывает, представляет ли объект индекса внешнего ключа в таблице. Если это свойство имеет **TRUE**, индекс представляет внешний ключ в таблице. Внешний ключ состоит из одного или нескольких полей во внешней таблице, однозначно идентифицировать строку в таблице первичного. Ядро базы данных Microsoft Jet создает объект индекса для внешней таблицы и задает свойство внешнего при создании отношение, которое обеспечивает целостность ссылочных данных. Дополнительные сведения см. в разделе «Свойство внешнего» в справке DAO.  
  
 *m_lDistinctCount*  
 Указывает количество уникальных значений для объекта индекса, включенные в связанную таблицу. Проверьте свойство DistinctCount для определения количества уникальных значений или ключей в индекс. Любая клавиша учитывается только один раз, несмотря на то, что может существовать несколько экземпляров данного значения Если индекс допускает повторяющиеся значения. Эта информация полезна в приложениях, пытающиеся получить доступ к данным оптимизируется путем вычисления данных индекса. Количество уникальных значений называется также количество элементов объекта индекса. Число различных значений свойств не будет всегда отражать фактическое число ключей в конкретный момент времени. Например изменения, вызванные отката транзакции будут отображаться непосредственно в свойстве DistinctCount. Дополнительные сведения см. в разделе «Число различных значений свойства» в справке DAO.  
  
## <a name="remarks"></a>Примечания  
 Ссылки на основной, дополнительный и все указанные выше указывают, как возвращаются сведения по `GetIndexInfo` функции-члена в классах [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md#getindexinfo) и [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md#getindexinfo).  
  
 Класс MFC не представлены объектов индекса. Вместо этого DAO объекты базового MFC класса [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) содержит коллекцию объектов индекс с именем коллекции индексов. Эти классы предоставить функции-члены для доступа к отдельным элементам данных индекса, или использовать их все одновременно с `CDaoIndexInfo` путем вызова метода `GetIndexInfo` функцию-член вмещающего объекта.  
  
 `CDaoIndexInfo`содержит конструктор и деструктор, чтобы правильно выделять и освобождать данные полей индекса в `m_pFieldInfos`.  
  
 Данные, полученные по `GetIndexInfo` функции-члена объекта tabledef хранится в `CDaoIndexInfo` структуру. Вызов `GetIndexInfo` содержащего tabledef объект в коллекции, индекс сохраняется объект, функция-член. `CDaoIndexInfo`также определяет `Dump` создает функцию-член в режиме отладки. Можно использовать `Dump` для вывода содержимого из `CDaoIndexInfo` объекта.  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
## <a name="see-also"></a>См. также  
 [Структуры, стили, обратные вызовы и схемы сообщений](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)   
 [CDaoTableDef::GetIndexInfo](../../mfc/reference/cdaotabledef-class.md#getindexinfo)


