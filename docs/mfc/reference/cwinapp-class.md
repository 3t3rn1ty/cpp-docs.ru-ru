---
title: CWinApp-класс | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.reviewer: ''
ms.suite: ''
ms.technology:
- cpp-windows
ms.tgt_pltfrm: ''
ms.topic: reference
f1_keywords:
- CWinApp
- AFXWIN/CWinApp
- AFXWIN/CWinApp::CWinApp
- AFXWIN/CWinApp::AddDocTemplate
- AFXWIN/CWinApp::AddToRecentFileList
- AFXWIN/CWinApp::ApplicationRecoveryCallback
- AFXWIN/CWinApp::CloseAllDocuments
- AFXWIN/CWinApp::CreatePrinterDC
- AFXWIN/CWinApp::DelRegTree
- AFXWIN/CWinApp::DoMessageBox
- AFXWIN/CWinApp::DoWaitCursor
- AFXWIN/CWinApp::EnableD2DSupport
- AFXWIN/CWinApp::EnableHtmlHelp
- AFXWIN/CWinApp::EnableTaskbarInteraction
- AFXWIN/CWinApp::ExitInstance
- AFXWIN/CWinApp::GetApplicationRecoveryParameter
- AFXWIN/CWinApp::GetApplicationRecoveryPingInterval
- AFXWIN/CWinApp::GetApplicationRestartFlags
- AFXWIN/CWinApp::GetAppRegistryKey
- AFXWIN/CWinApp::GetDataRecoveryHandler
- AFXWIN/CWinApp::GetFirstDocTemplatePosition
- AFXWIN/CWinApp::GetHelpMode
- AFXWIN/CWinApp::GetNextDocTemplate
- AFXWIN/CWinApp::GetPrinterDeviceDefaults
- AFXWIN/CWinApp::GetProfileBinary
- AFXWIN/CWinApp::GetProfileInt
- AFXWIN/CWinApp::GetProfileString
- AFXWIN/CWinApp::GetSectionKey
- AFXWIN/CWinApp::HideApplication
- AFXWIN/CWinApp::HtmlHelp
- AFXWIN/CWinApp::InitInstance
- AFXWIN/CWinApp::IsTaskbarInteractionEnabled
- AFXWIN/CWinApp::LoadCursor
- AFXWIN/CWinApp::LoadIcon
- AFXWIN/CWinApp::LoadOEMCursor
- AFXWIN/CWinApp::LoadOEMIcon
- AFXWIN/CWinApp::LoadStandardCursor
- AFXWIN/CWinApp::LoadStandardIcon
- AFXWIN/CWinApp::OnDDECommand
- AFXWIN/CWinApp::OnIdle
- AFXWIN/CWinApp::OpenDocumentFile
- AFXWIN/CWinApp::ParseCommandLine
- AFXWIN/CWinApp::PreTranslateMessage
- AFXWIN/CWinApp::ProcessMessageFilter
- AFXWIN/CWinApp::ProcessShellCommand
- AFXWIN/CWinApp::ProcessWndProcException
- AFXWIN/CWinApp::Register
- AFXWIN/CWinApp::RegisterWithRestartManager
- AFXWIN/CWinApp::ReopenPreviousFilesAtRestart
- AFXWIN/CWinApp::RestartInstance
- AFXWIN/CWinApp::RestoreAutosavedFilesAtRestart
- AFXWIN/CWinApp::Run
- AFXWIN/CWinApp::RunAutomated
- AFXWIN/CWinApp::RunEmbedded
- AFXWIN/CWinApp::SaveAllModified
- AFXWIN/CWinApp::SelectPrinter
- AFXWIN/CWinApp::SetHelpMode
- AFXWIN/CWinApp::SupportsApplicationRecovery
- AFXWIN/CWinApp::SupportsAutosaveAtInterval
- AFXWIN/CWinApp::SupportsAutosaveAtRestart
- AFXWIN/CWinApp::SupportsRestartManager
- AFXWIN/CWinApp::Unregister
- AFXWIN/CWinApp::WinHelp
- AFXWIN/CWinApp::WriteProfileBinary
- AFXWIN/CWinApp::WriteProfileInt
- AFXWIN/CWinApp::WriteProfileString
- AFXWIN/CWinApp::EnableShellOpen
- AFXWIN/CWinApp::LoadStdProfileSettings
- AFXWIN/CWinApp::OnContextHelp
- AFXWIN/CWinApp::OnFileNew
- AFXWIN/CWinApp::OnFileOpen
- AFXWIN/CWinApp::OnFilePrintSetup
- AFXWIN/CWinApp::OnHelp
- AFXWIN/CWinApp::OnHelpFinder
- AFXWIN/CWinApp::OnHelpIndex
- AFXWIN/CWinApp::OnHelpUsing
- AFXWIN/CWinApp::RegisterShellFileTypes
- AFXWIN/CWinApp::SetAppID
- AFXWIN/CWinApp::SetRegistryKey
- AFXWIN/CWinApp::UnregisterShellFileTypes
- AFXWIN/CWinApp::m_bHelpMode
- AFXWIN/CWinApp::m_eHelpType
- AFXWIN/CWinApp::m_hInstance
- AFXWIN/CWinApp::m_lpCmdLine
- AFXWIN/CWinApp::m_nCmdShow
- AFXWIN/CWinApp::m_pActiveWnd
- AFXWIN/CWinApp::m_pszAppID
- AFXWIN/CWinApp::m_pszAppName
- AFXWIN/CWinApp::m_pszExeName
- AFXWIN/CWinApp::m_pszHelpFilePath
- AFXWIN/CWinApp::m_pszProfileName
- AFXWIN/CWinApp::m_pszRegistryKey
- AFXWIN/CWinApp::m_dwRestartManagerSupportFlags
- AFXWIN/CWinApp::m_nAutosaveInterval
- AFXWIN/CWinApp::m_pDataRecoveryHandler
dev_langs:
- C++
helpviewer_keywords:
- CWinApp [MFC], CWinApp
- CWinApp [MFC], AddDocTemplate
- CWinApp [MFC], AddToRecentFileList
- CWinApp [MFC], ApplicationRecoveryCallback
- CWinApp [MFC], CloseAllDocuments
- CWinApp [MFC], CreatePrinterDC
- CWinApp [MFC], DelRegTree
- CWinApp [MFC], DoMessageBox
- CWinApp [MFC], DoWaitCursor
- CWinApp [MFC], EnableD2DSupport
- CWinApp [MFC], EnableHtmlHelp
- CWinApp [MFC], EnableTaskbarInteraction
- CWinApp [MFC], ExitInstance
- CWinApp [MFC], GetApplicationRecoveryParameter
- CWinApp [MFC], GetApplicationRecoveryPingInterval
- CWinApp [MFC], GetApplicationRestartFlags
- CWinApp [MFC], GetAppRegistryKey
- CWinApp [MFC], GetDataRecoveryHandler
- CWinApp [MFC], GetFirstDocTemplatePosition
- CWinApp [MFC], GetHelpMode
- CWinApp [MFC], GetNextDocTemplate
- CWinApp [MFC], GetPrinterDeviceDefaults
- CWinApp [MFC], GetProfileBinary
- CWinApp [MFC], GetProfileInt
- CWinApp [MFC], GetProfileString
- CWinApp [MFC], GetSectionKey
- CWinApp [MFC], HideApplication
- CWinApp [MFC], HtmlHelp
- CWinApp [MFC], InitInstance
- CWinApp [MFC], IsTaskbarInteractionEnabled
- CWinApp [MFC], LoadCursor
- CWinApp [MFC], LoadIcon
- CWinApp [MFC], LoadOEMCursor
- CWinApp [MFC], LoadOEMIcon
- CWinApp [MFC], LoadStandardCursor
- CWinApp [MFC], LoadStandardIcon
- CWinApp [MFC], OnDDECommand
- CWinApp [MFC], OnIdle
- CWinApp [MFC], OpenDocumentFile
- CWinApp [MFC], ParseCommandLine
- CWinApp [MFC], PreTranslateMessage
- CWinApp [MFC], ProcessMessageFilter
- CWinApp [MFC], ProcessShellCommand
- CWinApp [MFC], ProcessWndProcException
- CWinApp [MFC], Register
- CWinApp [MFC], RegisterWithRestartManager
- CWinApp [MFC], ReopenPreviousFilesAtRestart
- CWinApp [MFC], RestartInstance
- CWinApp [MFC], RestoreAutosavedFilesAtRestart
- CWinApp [MFC], Run
- CWinApp [MFC], RunAutomated
- CWinApp [MFC], RunEmbedded
- CWinApp [MFC], SaveAllModified
- CWinApp [MFC], SelectPrinter
- CWinApp [MFC], SetHelpMode
- CWinApp [MFC], SupportsApplicationRecovery
- CWinApp [MFC], SupportsAutosaveAtInterval
- CWinApp [MFC], SupportsAutosaveAtRestart
- CWinApp [MFC], SupportsRestartManager
- CWinApp [MFC], Unregister
- CWinApp [MFC], WinHelp
- CWinApp [MFC], WriteProfileBinary
- CWinApp [MFC], WriteProfileInt
- CWinApp [MFC], WriteProfileString
- CWinApp [MFC], EnableShellOpen
- CWinApp [MFC], LoadStdProfileSettings
- CWinApp [MFC], OnContextHelp
- CWinApp [MFC], OnFileNew
- CWinApp [MFC], OnFileOpen
- CWinApp [MFC], OnFilePrintSetup
- CWinApp [MFC], OnHelp
- CWinApp [MFC], OnHelpFinder
- CWinApp [MFC], OnHelpIndex
- CWinApp [MFC], OnHelpUsing
- CWinApp [MFC], RegisterShellFileTypes
- CWinApp [MFC], SetAppID
- CWinApp [MFC], SetRegistryKey
- CWinApp [MFC], UnregisterShellFileTypes
- CWinApp [MFC], m_bHelpMode
- CWinApp [MFC], m_eHelpType
- CWinApp [MFC], m_hInstance
- CWinApp [MFC], m_lpCmdLine
- CWinApp [MFC], m_nCmdShow
- CWinApp [MFC], m_pActiveWnd
- CWinApp [MFC], m_pszAppID
- CWinApp [MFC], m_pszAppName
- CWinApp [MFC], m_pszExeName
- CWinApp [MFC], m_pszHelpFilePath
- CWinApp [MFC], m_pszProfileName
- CWinApp [MFC], m_pszRegistryKey
- CWinApp [MFC], m_dwRestartManagerSupportFlags
- CWinApp [MFC], m_nAutosaveInterval
- CWinApp [MFC], m_pDataRecoveryHandler
ms.assetid: e426a3cd-0d15-40d6-bd55-beaa5feb2343
caps.latest.revision: 27
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 0708eb815bc6bc00ab04a558ae84a15c4704a761
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="cwinapp-class"></a>CWinApp-класс
Базовый класс, от которого необходимо наследовать объект приложения Windows.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CWinApp : public CWinThread  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CWinApp::CWinApp](#cwinapp)|Создает объект `CWinApp`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CWinApp::AddDocTemplate](#adddoctemplate)|Добавляет шаблон документа приложения список шаблонов документов доступны.|  
|[CWinApp::AddToRecentFileList](#addtorecentfilelist)|Добавляет имя файла в список недавно использовавшихся файлов (MRU).|  
|[CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback)|Вызывается платформой, когда приложение неожиданно завершает работу.|  
|[CWinApp::CloseAllDocuments](#closealldocuments)|Закрывает все открытые документы.|  
|[CWinApp::CreatePrinterDC](#createprinterdc)|Создает контекст устройства принтера.|  
|[CWinApp::DelRegTree](#delregtree)|Удаляет указанный ключ и все его подразделы.|  
|[CWinApp::DoMessageBox](#domessagebox)|Реализует [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox) для приложения.|  
|[CWinApp::DoWaitCursor](#dowaitcursor)|Включает курсор ожидания и выключает.|  
|[CWinApp::EnableD2DSupport](#enabled2dsupport)|Позволяет приложению `D2D` поддержки. Данный метод следует вызывать до инициализации основного окна.|  
|[CWinApp::EnableHtmlHelp](#enablehtmlhelp)|Реализует HTMLHelp для приложения, а не WinHelp.|  
|[CWinApp::EnableTaskbarInteraction](#enabletaskbarinteraction)|Разрешает взаимодействие задач.|  
|[CWinApp::ExitInstance](#exitinstance)|Переопределение для очистки после окончания работы приложения.|  
|[CWinApp::GetApplicationRecoveryParameter](#getapplicationrecoveryparameter)|Получает входной параметр для метода восстановления приложений.|  
|[CWinApp::GetApplicationRecoveryPingInterval](#getapplicationrecoverypinginterval)|Возвращает время, диспетчер перезапуска ожидает функция обратного вызова восстановления для возврата.|  
|[CWinApp::GetApplicationRestartFlags](#getapplicationrestartflags)|Возвращает флаги диспетчера перезапуска.|  
|[CWinApp::GetAppRegistryKey](#getappregistrykey)|Возвращает ключ для HKEY_CURRENT_USER\\\RegistryKey\ProfileName «Программное обеспечение».|  
|[CWinApp::GetDataRecoveryHandler](#getdatarecoveryhandler)|Получает обработчик восстановления данных для этого экземпляра приложения.|  
|[CWinApp::GetFirstDocTemplatePosition](#getfirstdoctemplateposition)|Возвращает позицию первого шаблона документа.|  
|[CWinApp::GetHelpMode](#gethelpmode)|Возвращает тип справки, используемые приложением.|  
|[CWinApp::GetNextDocTemplate](#getnextdoctemplate)|Возвращает позицию шаблона документа. Можно рекурсивно использовать.|  
|[CWinApp::GetPrinterDeviceDefaults](#getprinterdevicedefaults)|Извлекает устройства по умолчанию.|  
|[CWinApp::GetProfileBinary](#getprofilebinary)|Получает двоичные данные из записи в приложении. INI-файл.|  
|[CWinApp::GetProfileInt](#getprofileint)|Возвращает целое число из записи в приложении. INI-файл.|  
|[CWinApp::GetProfileString](#getprofilestring)|Извлекает строку из записи в приложении. INI-файл.|  
|[CWinApp::GetSectionKey](#getsectionkey)|Возвращает ключ для HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection «Программное обеспечение».|  
|[CWinApp::HideApplication](#hideapplication)|Скрывает приложением перед тем как закрыть все документы.|  
|[CWinApp::HtmlHelp](#htmlhelp)|Вызовы `HTMLHelp` функции Windows.|  
|[CWinApp::InitInstance](#initinstance)|Переопределите, чтобы выполнить инициализацию экземпляра Windows, таких как создание объектов-окон.|  
|[CWinApp::IsTaskbarInteractionEnabled](#istaskbarinteractionenabled)|Указывает, включен ли взаимодействия задач Windows 7.|  
|[CWinApp::LoadCursor](#loadcursor)|Загружает ресурс курсора.|  
|[CWinApp::LoadIcon](#loadicon)|Загружает ресурс значка.|  
|[CWinApp::LoadOEMCursor](#loadoemcursor)|Загружает Windows OEM предопределенные курсора, **OCR_** константы указывают в WINDOWS. З.|  
|[CWinApp::LoadOEMIcon](#loadoemicon)|Загружает значком предварительно определенных Windows OEM, **OIC_** константы указывают в WINDOWS. З.|  
|[CWinApp::LoadStandardCursor](#loadstandardcursor)|Загружает Windows предопределенные курсора, **IDC_** константы указывают в WINDOWS. З.|  
|[CWinApp::LoadStandardIcon](#loadstandardicon)|Загружает предварительно определенных значок Windows, **IDI_** константы указывают в WINDOWS. З.|  
|[CWinApp::OnDDECommand](#onddecommand)|Вызывается платформой в ответ на динамических данных exchange (DDE) выполните команду.|  
|[CWinApp::OnIdle](#onidle)|Переопределите, чтобы выполнить обработку времени простоя для конкретного приложения.|  
|[CWinApp::OpenDocumentFile](#opendocumentfile)|Вызывается платформой для открытия документа из файла.|  
|[CWinApp::ParseCommandLine](#parsecommandline)|Выполняет синтаксический анализ отдельных параметров и флаги в командной строке.|  
|[CWinApp::PreTranslateMessage](#pretranslatemessage)|Фильтрует сообщения перед их передачей функциям Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) и [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934).|  
|[CWinApp::ProcessMessageFilter](#processmessagefilter)|Перехватывает определенных сообщений, прежде чем они достигнут приложения.|  
|[CWinApp::ProcessShellCommand](#processshellcommand)|Обрабатывает аргументы командной строки и флаги.|  
|[CWinApp::ProcessWndProcException](#processwndprocexception)|Перехватывает все необработанные исключения, вызванные сообщения приложения и обработчики команд.|  
|[CWinApp::Register](#register)|Выполняет пользовательские регистрации.|  
|[CWinApp::RegisterWithRestartManager](#registerwithrestartmanager)|Регистрирует приложение с помощью диспетчера перезапуска.|  
|[CWinApp::ReopenPreviousFilesAtRestart](#reopenpreviousfilesatrestart)|Определяет, открывается ли диспетчер перезапуска повторно файлы, которые были открыты при неожиданный выход из приложения.|  
|[CWinApp::RestartInstance](#restartinstance)|Обрабатывает инициировано диспетчера перезапуска перезапуск приложения.|  
|[CWinApp::RestoreAutosavedFilesAtRestart](#restoreautosavedfilesatrestart)|Определяет, восстанавливает ли файлы автоматически сохраненная диспетчера перезапуска при перезапуске приложения.|  
|[CWinApp::Run](#run)|Запускает цикл обработки сообщений по умолчанию. Переопределите, чтобы настроить цикл обработки сообщений.|  
|[CWinApp::RunAutomated](#runautomated)|Проверяет приложения командной строки для **/Automation** параметр. Является устаревшей. Вместо этого используйте значение в [CCommandLineInfo::m_bRunAutomated](../../mfc/reference/ccommandlineinfo-class.md#m_brunautomated) после вызова [ParseCommandLine](#parsecommandline).|  
|[CWinApp::RunEmbedded](#runembedded)|Проверяет приложения командной строки для **/Embedding** параметр. Является устаревшей. Вместо этого используйте значение в [CCommandLineInfo::m_bRunEmbedded](../../mfc/reference/ccommandlineinfo-class.md#m_brunembedded) после вызова [ParseCommandLine](#parsecommandline).|  
|[CWinApp::SaveAllModified](#saveallmodified)|Предлагает пользователю сохранить все измененные документы.|  
|[CWinApp::SelectPrinter](#selectprinter)|Служит для выбора принтера, ранее обозначал пользователем через диалоговое окно печати.|  
|[CWinApp::SetHelpMode](#sethelpmode)|Задает и инициализирует тип справки, используемые приложением.|  
|[CWinApp::SupportsApplicationRecovery](#supportsapplicationrecovery)|Определяет, восстанавливает ли диспетчер перезапуска приложения, неожиданно завершил работу.|  
|[CWinApp::SupportsAutosaveAtInterval](#supportsautosaveatinterval)|Определяет ли преждевременном диспетчера перезапуска открывать документы с регулярным интервалом.|  
|[CWinApp::SupportsAutosaveAtRestart](#supportsautosaveatrestart)|Определяет, является ли преждевременном диспетчер перезапуска при перезапуске открытые документы.|  
|[CWinApp::SupportsRestartManager](#supportsrestartmanager)|Определяет, поддерживает ли приложение диспетчера перезапуска.|  
|[CWinApp::Unregister](#unregister)|Отменяет регистрацию все заведомо зарегистрированный с `CWinApp` объекта.|  
|[CWinApp::WinHelp](#winhelp)|Вызовы `WinHelp` функции Windows.|  
|[CWinApp::WriteProfileBinary](#writeprofilebinary)|Записывает двоичные данные для записи в приложения. INI-файл.|  
|[CWinApp::WriteProfileInt](#writeprofileint)|Записывает целое записи в приложения. INI-файл.|  
|[CWinApp::WriteProfileString](#writeprofilestring)|Записывает строку в запись в приложении. INI-файл.|  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CWinApp::EnableShellOpen](#enableshellopen)|Позволяет пользователю открывать файлы данных из диспетчера файлов Windows.|  
|[CWinApp::LoadStdProfileSettings](#loadstdprofilesettings)|Загружает standard. Параметры INI-файла и включает список последних Использованных файлов компонент списка.|  
|[CWinApp::OnContextHelp](#oncontexthelp)|Обрабатывает клавиши SHIFT + F1 справки в приложении.|  
|[CWinApp::OnFileNew](#onfilenew)|Реализует `ID_FILE_NEW` команды.|  
|[CWinApp::OnFileOpen](#onfileopen)|Реализует `ID_FILE_OPEN` команды.|  
|[CWinApp::OnFilePrintSetup](#onfileprintsetup)|Реализует `ID_FILE_PRINT_SETUP` команды.|  
|[CWinApp::OnHelp](#onhelp)|Обрабатывает справку F1 в приложении (с использованием текущего контекста).|  
|[CWinApp::OnHelpFinder](#onhelpfinder)|Обрабатывает команды `ID_HELP_FINDER` и `ID_DEFAULT_HELP`.|  
|[CWinApp::OnHelpIndex](#onhelpindex)|Обрабатывает команду `ID_HELP_INDEX` и предоставляет раздел справки по умолчанию.|  
|[CWinApp::OnHelpUsing](#onhelpusing)|Обрабатывает команду `ID_HELP_USING`.|  
|[CWinApp::RegisterShellFileTypes](#registershellfiletypes)|Регистрирует приложение типов документов с помощью диспетчера файлов Windows.|  
|[CWinApp::SetAppID](#setappid)|Явно задает идентификатор модели пользователя приложения для приложения. Этот метод должен вызываться перед любой пользовательский интерфейс предоставляется пользователя (лучше всего конструктор приложения).|  
|[CWinApp::SetRegistryKey](#setregistrykey)|Параметры приложения для сохранения в реестре, а не в результате. INI-файлы.|  
|[CWinApp::UnregisterShellFileTypes](#unregistershellfiletypes)|Отменяет регистрацию типов документов приложения с помощью диспетчера файлов Windows.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CWinApp::m_bHelpMode](#m_bhelpmode)|Указывает, является ли пользователь режим контекста справки (обычно вызывается с помощью клавиши SHIFT + F1).|  
|[CWinApp::m_eHelpType](#m_ehelptype)|Указывает тип справки, используемые приложением.|  
|[CWinApp::m_hInstance](#m_hinstance)|Определяет текущий экземпляр приложения.|  
|[CWinApp::m_lpCmdLine](#m_lpcmdline)|Указывает символом null строку, которая определяет командную строку для приложения.|  
|[CWinApp::m_nCmdShow](#m_ncmdshow)|Указывает, как будет первоначально отображаться окно.|  
|[CWinApp::m_pActiveWnd](#m_pactivewnd)|Указатель на главное окно приложения-контейнера при активен OLE-сервер на месте.|  
|[CWinApp::m_pszAppID](#m_pszappid)|Модель идентификатора пользователя приложения.|  
|[CWinApp::m_pszAppName](#m_pszappname)|Указывает имя приложения.|  
|[CWinApp::m_pszExeName](#m_pszexename)|Имя модуля приложения.|  
|[CWinApp::m_pszHelpFilePath](#m_pszhelpfilepath)|Путь к файлу справки приложения.|  
|[CWinApp::m_pszProfileName](#m_pszprofilename)|Приложения. Имя INI-файла.|  
|[CWinApp::m_pszRegistryKey](#m_pszregistrykey)|Используется для определения полного реестра для хранения параметров профиля приложения.|  
  
### <a name="protected-data-members"></a>Защищенные члены данных  
  
|name|Описание|  
|----------|-----------------|  
|[CWinApp::m_dwRestartManagerSupportFlags](#m_dwrestartmanagersupportflags)|Флаги, которые определяют поведение диспетчера перезапуска.|  
|[CWinApp::m_nAutosaveInterval](#m_nautosaveinterval)|Продолжительность времени в миллисекундах между преждевременном.|  
|[CWinApp::m_pDataRecoveryHandler](#m_pdatarecoveryhandler)|Указатель на обработчик восстановления данных для приложения.|  
  
## <a name="remarks"></a>Примечания  
 Объект приложения предоставляет функции-члены для инициализации приложения (и каждого экземпляра), а также для запуска приложения.  
  
 Каждого приложения, использующего Microsoft Foundation classes может содержать только один объект, производный от `CWinApp`. Этот объект создается при формировании другие глобальные объекты C++ и уже доступна, когда Windows вызывает `WinMain` функции, которая является результатом библиотеки классов Microsoft Foundation. Объявите производного `CWinApp` объекта на глобальном уровне.  
  
 При наследовании класса приложения из `CWinApp`, переопределите [InitInstance](#initinstance) функции-члена для создания объекта главного окна приложения.  
  
 В дополнение к `CWinApp` функции-члены, библиотеки классов Microsoft Foundation предоставляет следующие глобальные функции для доступа к вашей `CWinApp` объекта и других общих сведений:  
  
- [AfxGetApp](application-information-and-management.md#afxgetapp) получает указатель `CWinApp` объекта.  
  
- [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle) Получает дескриптор текущего экземпляра приложения.  
  
- [AfxGetResourceHandle](application-information-and-management.md#afxgetresourcehandle) Получает дескриптор к ресурсам приложения.  
  
- [AfxGetAppName](application-information-and-management.md#afxgetappname) получает указатель на строку, содержащую имя приложения. Кроме того Если имеется указатель на `CWinApp` , используйте `m_pszExeName` для получения имени приложения.  
  
 В разделе [CWinApp: класс приложения](../../mfc/cwinapp-the-application-class.md) для получения дополнительных сведений о `CWinApp` класса, включая общие сведения из следующих:  
  
- `CWinApp`-производные код, написанный с помощью мастера приложений.  
  
- `CWinApp`в роли в последовательность выполнения приложения.  
  
- `CWinApp`в реализациях функций-членов по умолчанию.  
  
- `CWinApp`в переопределяемости ключа.  
  
 **M_hPrevInstance** член данных больше не существует. Сведения об определении предыдущего экземпляра `CWinApp`, см. в статье базы знаний «Как для идентификации предыдущего экземпляра из приложения» (KB106385) в [ http://support.microsoft.com/default.aspxscid=kb; en-us; 106385](http://support.microsoft.com/default.aspxscid=kb;en-us;106385).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWinThread](../../mfc/reference/cwinthread-class.md)  
  
 `CWinApp`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxwin.h  
  
##  <a name="adddoctemplate"></a>  CWinApp::AddDocTemplate  
 Вызовите эту функцию-член для добавления шаблона документа в список шаблонов документов доступны, поддерживается приложением.  
  
```  
void AddDocTemplate(CDocTemplate* pTemplate);
```  
  
### <a name="parameters"></a>Параметры  
 `pTemplate`  
 Указатель на `CDocTemplate` для добавления.  
  
### <a name="remarks"></a>Примечания  
 Следует добавить все шаблоны в приложение документов, перед вызовом метода [RegisterShellFileTypes](#registershellfiletypes).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#35](../../mfc/reference/codesnippet/cpp/cwinapp-class_1.cpp)]  
  
##  <a name="addtorecentfilelist"></a>  CWinApp::AddToRecentFileList  
 Вызовите эту функцию-член для добавления `lpszPathName` в список последних Выбиравшихся файлов.  
  
```  
virtual void AddToRecentFileList(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszPathName`  
 Путь к файлу.  
  
### <a name="remarks"></a>Примечания  
 Необходимо вызвать [LoadStdProfileSettings](#loadstdprofilesettings) функции-члена для загрузки файла текущий список, прежде чем использовать эту функцию-член.  
  
 Платформа вызывает эту функцию-член, когда он открывает файл, или выполняет команду Сохранить как, чтобы сохранить файл с новым именем.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#36](../../mfc/reference/codesnippet/cpp/cwinapp-class_2.cpp)]  
  
##  <a name="applicationrecoverycallback"></a>  CWinApp::ApplicationRecoveryCallback  
 Вызывается платформой, когда приложение неожиданно завершает работу.  
  
```  
virtual DWORD ApplicationRecoveryCallback(LPVOID lpvParam);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `lpvParam`  
 Зарезервировано для будущего использования.  
  
### <a name="return-value"></a>Возвращаемое значение  
 0, если этот метод выполнен успешно; ненулевое значение, если произошла ошибка.  
  
### <a name="remarks"></a>Примечания  
 Если приложение поддерживает диспетчер перезапуска, платформа вызывает эту функцию, когда приложение неожиданно завершает работу.  
  
 Реализация по умолчанию `ApplicationRecoveryCallback` использует `CDataRecoveryHandler` для сохранения списка открытых документов в реестр. Этот метод не автосохранения не все файлы.  
  
 Для настройки поведения, переопределяют данную функцию в производном [CWinApp-класс](../../mfc/reference/cwinapp-class.md) или передайте собственный метод восстановления приложения в качестве параметра для [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
##  <a name="closealldocuments"></a>  CWinApp::CloseAllDocuments  
 Вызовите эту функцию-член для закрытия всех открытых документов перед завершением работы.  
  
```  
void CloseAllDocuments(BOOL bEndSession);
```  
  
### <a name="parameters"></a>Параметры  
 `bEndSession`  
 Определяет заканчивается ли сессия Windows. Это **TRUE** Если сеанс завершается; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 Вызовите [HideApplication](#hideapplication) перед вызовом `CloseAllDocuments`.  
  
##  <a name="createprinterdc"></a>  CWinApp::CreatePrinterDC  
 Вызовите эту функцию-член для создания контекста принтера (DC) из выбранного принтера.  
  
```  
BOOL CreatePrinterDC(CDC& dc);
```  
  
### <a name="parameters"></a>Параметры  
 `dc`  
 Ссылка на контекст устройства принтера.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если контекст устройства принтера создана успешно. в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 `CreatePrinterDC` Инициализирует контекст устройства, переданное по ссылке, чтобы можно было использовать для печати.  
  
 Если функция выполнена успешно, после завершения печати, требуется уничтожить контекст устройства. Можно позволить деструктор класса [CDC](../../mfc/reference/cdc-class.md) объекта выполнить эту операцию, или это можно сделать явным образом путем вызова [CDC::DeleteDC](../../mfc/reference/cdc-class.md#deletedc).  
  
##  <a name="cwinapp"></a>  CWinApp::CWinApp  
 Создает `CWinApp` объекта и передает `lpszAppName` для сохранения как имя приложения.  
  
```  
CWinApp(LPCTSTR lpszAppName = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszAppName`  
 Нулем строка, содержащая имя приложения, использующего Windows. Если этот аргумент не указан или является **NULL**, `CWinApp` использует строку ресурса **AFX_IDS_APP_TITLE** или имя исполняемого файла.  
  
### <a name="remarks"></a>Примечания  
 Необходимо настроить один глобальный объект вашей `CWinApp`-производного класса. Можно иметь только одну `CWinApp` объекта в приложении. Конструктор сохраняет указатель на `CWinApp` объекта, чтобы `WinMain` можно вызвать объект функции-члены для инициализации и запуска приложения.  
  
##  <a name="delregtree"></a>  CWinApp::DelRegTree  
 Удаление определенного раздела реестра и его подразделов.  
  
```  
LONG DelRegTree(
    HKEY hParentKey,  
    const CString& strKeyName);

 
LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName,
    CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *hParentKey*  
 Дескриптор раздела реестра.  
  
 *strKeyName*  
 Имя раздела реестра для удаления.  
  
 *pTM*  
 Указатель на объект catltransactionmanager.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если функция выполняется успешно, возвращаемое значение равно ERROR_SUCCESS. Если функция завершается с ошибкой, возвращается код ненулевое значение ошибки, определенные в файле Winerror.h.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается для удаления указанного ключа и его подразделов.  
  
##  <a name="domessagebox"></a>  CWinApp::DoMessageBox  
 Платформа вызывает эту функцию-член для реализации окно сообщения для глобальной функции [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox).  
  
```  
virtual int DoMessageBox(
    LPCTSTR lpszPrompt,  
    UINT nType,  
    UINT nIDPrompt);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszPrompt*  
 Адрес текст в окне сообщения.  
  
 `nType`  
 В окне сообщения [стиль](../../mfc/reference/styles-used-by-mfc.md#message-box-styles).  
  
 `nIDPrompt`  
 Индекс строки контекста справки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращает те же значения, что `AfxMessageBox`.  
  
### <a name="remarks"></a>Примечания  
 Не вызывайте эту функцию-член для окна сообщения; Используйте `AfxMessageBox` вместо него.  
  
 Переопределить эту функцию-член для настройки на уровне приложения обработки `AfxMessageBox` вызовов.  
  
##  <a name="dowaitcursor"></a>  CWinApp::DoWaitCursor  
 Эта функция-член вызывается платформой для реализации [CWaitCursor](../../mfc/reference/cwaitcursor-class.md), [CCmdTarget::BeginWaitCursor](../../mfc/reference/ccmdtarget-class.md#beginwaitcursor), [CCmdTarget::EndWaitCursor](../../mfc/reference/ccmdtarget-class.md#endwaitcursor), и [ CCmdTarget::RestoreWaitCursor](../../mfc/reference/ccmdtarget-class.md#restorewaitcursor).  
  
```  
virtual void DoWaitCursor(int nCode);
```  
  
### <a name="parameters"></a>Параметры  
 `nCode`  
 Если этот параметр равен 1, появится курсор ожидания. Если значение равно 0, курсор ожидания восстанавливается без приращения счетчика ссылок. Если значение-1, то заканчивается курсор ожидания.  
  
### <a name="remarks"></a>Примечания  
 Значение по умолчанию реализует курсор с песочными часами. `DoWaitCursor` поддерживает счетчик ссылок. Когда положительно, отображается курсор с песочными часами.  
  
 Хотя обычно не вызывается `DoWaitCursor` напрямую, можно переопределить эту функцию-член для изменения курсор ожидания или выполнять обработку во время отображения курсора ожидания.  
  
 Для удобства, более простой способ реализации курсор ожидания, используйте `CWaitCursor`.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#37](../../mfc/reference/codesnippet/cpp/cwinapp-class_3.cpp)]  
  
##  <a name="enabled2dsupport"></a>  CWinApp::EnableD2DSupport  
 [!INCLUDE[dev10_sp1required](../../mfc/reference/includes/dev10_sp1required_md.md)]  
  
 Включает поддержку приложением D2D. Данный метод следует вызывать до инициализации основного окна.  
  
```  
BOOL EnableD2DSupport(
D2D1_FACTORY_TYPE d2dFactoryType = D2D1_FACTORY_TYPE_SINGLE_THREADED,  
DWRITE_FACTORY_TYPE writeFactoryType = DWRITE_FACTORY_TYPE_SHARED);
```  
  
### <a name="parameters"></a>Параметры  
 `d2dFactoryType`  
 Потоковая модель фабрики D2D и ресурсы, которые он создает.  
  
 `writeFactoryType`  
 Значение, указывающее, будет ли объект фабрики записи совместно или изолированных  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращает значение TRUE, если поддержка D2D был включен, FALSE — в противном случае  
  
##  <a name="enablehtmlhelp"></a>  CWinApp::EnableHtmlHelp  
 Вызовите эту функцию-член из конструктора вашей `CWinApp`-производным классом, который используется для получения справки приложения HTMLHelp.  
  
```  
void EnableHtmlHelp();
```  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="enableshellopen"></a>  CWinApp::EnableShellOpen  
 Вызывайте эту функцию обычно из вашего `InitInstance` переопределение, чтобы пользователи приложения могли открывать файлы данных после двойного щелчка файлы из диспетчера файлов Windows.  
  
```  
void EnableShellOpen();
```  
  
### <a name="remarks"></a>Примечания  
 Вызовите `RegisterShellFileTypes` член работать совместно с помощью этой функции или предоставить. REG-файл вместе с приложением для ручной регистрации типов документов.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#38](../../mfc/reference/codesnippet/cpp/cwinapp-class_4.cpp)]  
  
##  <a name="enabletaskbarinteraction"></a>  CWinApp::EnableTaskbarInteraction  
 Разрешает взаимодействие задач.  
  
```  
BOOL EnableTaskbarInteraction(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `bEnable`  
 Указывает, следует ли включить взаимодействие с панели задач Windows 7 ( `TRUE`), или отключена ( `FALSE`).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращает `TRUE` взаимодействия задач может быть включена или отключена.  
  
### <a name="remarks"></a>Примечания  
 Этот метод должен вызываться до создания главного окна, в противном случае его утверждения и возвращает `FALSE`.  
  
##  <a name="exitinstance"></a>  CWinApp::ExitInstance  
 Вызывается платформой из **запуска** функции-члена для выхода из этого экземпляра приложения.  
  
```  
virtual int ExitInstance();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Код выхода приложения; 0 указывает без ошибок, а значения больше 0 указывает на ошибку. Это значение используется как возвращаемое значение `WinMain`.  
  
### <a name="remarks"></a>Примечания  
 Не вызывайте эту функцию-член в любом месте но в **запуска** функции-члена.  
  
 Реализация по умолчанию эта функция записывает параметры framework в приложение. INI-файл. Переопределите эту функцию для очистки после окончания работы приложения.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#39](../../mfc/reference/codesnippet/cpp/cwinapp-class_5.cpp)]  
  
##  <a name="getapplicationrecoveryparameter"></a>  CWinApp::GetApplicationRecoveryParameter  
 Получает входной параметр для метода восстановления приложений.  
  
```  
virtual LPVOID GetApplicationRecoveryParameter();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Входной параметр по умолчанию для метода восстановления приложений.  
  
### <a name="remarks"></a>Примечания  
 По умолчанию эта функция возвращает `NULL`.  
  
 Дополнительные сведения см. в разделе [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
##  <a name="getapplicationrecoverypinginterval"></a>  CWinApp::GetApplicationRecoveryPingInterval  
 Возвращает время, диспетчер перезапуска ожидает функция обратного вызова восстановления для возврата.  
  
```  
virtual DWORD GetApplicationRecoveryPingInterval();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Продолжительность времени в миллисекундах.  
  
### <a name="remarks"></a>Примечания  
 Когда приложение, в которой зарегистрирован неожиданно завершает работу диспетчера перезапуска, приложение пытается сохранить открытые документы и вызывает функцию обратного вызова для восстановления. Функция обратного вызова для восстановления по умолчанию — [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
 Продолжительность времени, платформа ожидает функция обратного вызова для возврата восстановления — интервал проверки связи. Можно настроить интервал проверки связи, переопределив `CWinApp::GetApplicationRecoveryPingInterval` , или определив пользовательское значение для `RegisterWithRestartManager`.  
  
##  <a name="getapplicationrestartflags"></a>  CWinApp::GetApplicationRestartFlags  
 Возвращает флаги диспетчера перезапуска.  
  
```  
virtual DWORD GetApplicationRestartFlags();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Флаги для диспетчера перезапуска. Реализация по умолчанию возвращает значение 0.  
  
### <a name="remarks"></a>Примечания  
 Флаги для диспетчера перезапуска не имеют реализации по умолчанию. Они предназначены для использования в будущем.  
  
 Установить флаги, когда зарегистрировать приложение с помощью диспетчера перезапуска с помощью [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
 Ниже приведены возможные значения для флагов диспетчера перезапуска.  
  
- `RESTART_NO_CRASH`  
  
- `RESTART_NO_HANG`  
  
- `RESTART_NO_PATCH`  
  
- `RESTART_NO_REBOOT`  
  
##  <a name="getappregistrykey"></a>  CWinApp::GetAppRegistryKey  
 Возвращает ключ для HKEY_CURRENT_USER\\\RegistryKey\ProfileName «Программное обеспечение».  
  
```  
HKEY GetAppRegistryKey(CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pTM`  
 Указатель на `CAtlTransactionManager` объект.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ключ приложения, если функция выполняется успешно. в противном случае `NULL`.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getdatarecoveryhandler"></a>  CWinApp::GetDataRecoveryHandler  
 Получает обработчик восстановления данных для этого экземпляра приложения.  
  
```  
virtual CDataRecoveryHandler *GetDataRecoveryHandler();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Обработчик данных восстановления для этого экземпляра приложения.  
  
### <a name="remarks"></a>Примечания  
 Каждое приложение, который использует диспетчер перезапуска должны иметь один экземпляр [CDataRecoveryHandler класса](../../mfc/reference/cdatarecoveryhandler-class.md). Этот класс отвечает за мониторинг открытые документы и файлы автосохранения. Поведение `CDataRecoveryHandler` зависит от конфигурации диспетчера перезапуска. Дополнительные сведения см. в разделе [CDataRecoveryHandler класса](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
 Этот метод возвращает `NULL` на операционные системы более ранних, чем Windows Vista. Диспетчер перезапуска не поддерживается в операционных системах более ранних, чем Windows Vista.  
  
 Если приложение не имеет обработчика восстановления данных, этот метод создает и возвращает указатель на него.  
  
##  <a name="getfirstdoctemplateposition"></a>  CWinApp::GetFirstDocTemplatePosition  
 Возвращает позицию первого шаблона документа в приложении.  
  
```  
POSITION GetFirstDocTemplatePosition() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект **ПОЗИЦИИ** значение, которое может использоваться для итерации или извлечения указатель объекта; **NULL** Если список пуст.  
  
### <a name="remarks"></a>Примечания  
 Используйте **ПОЗИЦИИ** значение, возвращаемое при вызове [GetNextDocTemplate](#getnextdoctemplate) для получения первого [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) объекта.  
  
##  <a name="gethelpmode"></a>  CWinApp::GetHelpMode  
 Возвращает тип справки, используемые приложением.  
  
```  
AFX_HELP_TYPE GetHelpMode();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Тип справки, используемые приложением. В разделе [CWinApp::m_eHelpType](#m_ehelptype) для получения дополнительной информации.  
  
##  <a name="getnextdoctemplate"></a>  CWinApp::GetNextDocTemplate  
 Возвращает шаблон документа, определяемый по `pos`, затем устанавливает `pos` для **ПОЗИЦИИ** значение.  
  
```  
CDocTemplate* GetNextDocTemplate(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `pos`  
 Ссылку на **ПОЗИЦИИ** значение, возвращенное предыдущим вызовом `GetNextDocTemplate` или [GetFirstDocTemplatePosition](#getfirstdoctemplateposition). Значение обновляется до следующей позиции при вызове этого метода.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) объекта.  
  
### <a name="remarks"></a>Примечания  
 Можно использовать `GetNextDocTemplate` в прямой итерации цикла, если установить начальное положение, с помощью вызова `GetFirstDocTemplatePosition`.  
  
 Необходимо убедиться, что ваш **ПОЗИЦИИ** значение является допустимым. Если он является недопустимым, подтверждает отладочной версии библиотеки классов Microsoft Foundation.  
  
 Если шаблон документа, полученного за последние доступные, затем новое значение `pos` равно **NULL**.  
  
##  <a name="getprinterdevicedefaults"></a>  CWinApp::GetPrinterDeviceDefaults  
 Вызовите эту функцию-член для подготовки контекст устройства принтера для печати.  
  
```  
BOOL GetPrinterDeviceDefaults(struct tagPDA* pPrintDlg);
```  
  
### <a name="parameters"></a>Параметры  
 *pPrintDlg*  
 Указатель на [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Получает текущие значения по умолчанию для принтера из Windows. INI файла при необходимости или с помощью последней конфигурации принтера, установленные пользователем в программе установки печати.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#40](../../mfc/reference/codesnippet/cpp/cwinapp-class_6.cpp)]  
  
##  <a name="getprofilebinary"></a>  CWinApp::GetProfileBinary  
 Вызовите эту функцию-член для извлечения двоичных данных из записи в указанный раздел реестра приложения или. INI-файл.  
  
```  
BOOL GetProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE* ppData,  
    UINT* pBytes);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszSection*  
 Указывает строка, указывающая раздела, содержащего запись символом null.  
  
 *lpszEntry*  
 Указывает символом null строку, которая содержит элемент, значение которого требуется получить.  
  
 *ppData*  
 Указатель на указатель, который будет получать адрес данных.  
  
 *pBytes*  
 Указывает UINT, который получит объема данных (в байтах).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член не должен учитываться регистр, поэтому строки в *lpszSection* и *lpszEntry* параметры могут различаться в случае.  
  
> [!NOTE]
> **GetProfileBinary** выделяет буфер и возвращается его адрес в \* *ppData*. Вызывающий объект отвечает за освобождение буфера с помощью **delete []**.  
  
> [!IMPORTANT]
>  Данные, возвращаемые этой функцией не обязательно NULL завершается, а вызывающий объект должен выполнять проверку. Дополнительные сведения см. в разделе [Как избежать переполнения буфера](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#41](../../mfc/reference/codesnippet/cpp/cwinapp-class_7.cpp)]  
  
 Дополнительный пример, в разделе [CWinApp::WriteProfileBinary](#writeprofilebinary).  
  
##  <a name="getprofileint"></a>  CWinApp::GetProfileInt  
 Вызовите эту функцию-член для извлечения значения целого числа из записи в указанный раздел реестра приложения или. INI-файл.  
  
```  
UINT GetProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nDefault);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Указывает строка, указывающая раздела, содержащего запись символом null.  
  
 `lpszEntry`  
 Указывает символом null строку, которая содержит элемент, значение которого требуется получить.  
  
 `nDefault`  
 Указывает значение по умолчанию для возврата, если платформа не найдена запись.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Целочисленное значение строки, которая предшествует указанную запись, если функция выполнена успешно. Возвращаемое значение является значением `nDefault` параметра, если функция не находит записи. Возвращаемое значение равно 0, если значение, соответствующее в указанный элемент не является целым числом.  
  
 Эта функция-член поддерживает значение в шестнадцатеричном формате. INI-файл. При извлечении целого числа со знаком, необходимо привести значение в `int`.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член не должен учитываться регистр, поэтому строки в `lpszSection` и `lpszEntry` параметры могут различаться в случае.  
  
> [!IMPORTANT]
>  Данные, возвращаемые этой функцией не обязательно NULL завершается, а вызывающий объект должен выполнять проверку. Дополнительные сведения см. в разделе [Как избежать переполнения буфера](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#42](../../mfc/reference/codesnippet/cpp/cwinapp-class_8.cpp)]  
  
 Дополнительный пример, в разделе [CWinApp::WriteProfileInt](#writeprofileint).  
  
##  <a name="getprofilestring"></a>  CWinApp::GetProfileString  
 Вызовите эту функцию-член для извлечения строки, связанной с запись в указанный раздел в реестре приложения или. INI-файл.  
  
```  
CString GetProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszDefault = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Указывает строка, указывающая раздела, содержащего запись символом null.  
  
 `lpszEntry`  
 Указывает символом null строку, которая содержит запись, строка которого требуется получить. Это значение не должно быть **NULL**.  
  
 `lpszDefault`  
 Указывает строковое значение по умолчанию для данной записи, если не удается найти запись в файле настройки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращаемое значение является строкой, в приложении. INI-файл или `lpszDefault` Если строка не найдена. Максимальная длина строки поддерживается платформой является `_MAX_PATH`. Если `lpszDefault` — **NULL**, возвращается пустая строка.  
  
### <a name="remarks"></a>Примечания  
  
> [!IMPORTANT]
>  Данные, возвращаемые этой функцией не обязательно NULL завершается, а вызывающий объект должен выполнять проверку. Дополнительные сведения см. в разделе [Как избежать переполнения буфера](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Другой пример, см. пример для [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="getsectionkey"></a>  CWinApp::GetSectionKey  
 Возвращает ключ для HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection «Программное обеспечение».  
  
```  
HKEY GetSectionKey(
LPCTSTR lpszSection,  
CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Имя ключа может быть получена.  
  
 `pTM`  
 Указатель на `CAtlTransactionManager` объект.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ключ раздела, если функция выполняется успешно. в противном случае `NULL`.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="hideapplication"></a>  CWinApp::HideApplication  
 Вызовите эту функцию-член для скрытия приложения перед тем как закрыть открытые документы.  
  
```  
void HideApplication();
```  
  
##  <a name="htmlhelp"></a>  CWinApp::HtmlHelp  
 Вызовите эту функцию-член для вызова приложения HTMLHelp.  
  
```  
virtual void HtmlHelp(
    DWORD_PTR dwData,  
    UINT nCmd = 0x000F);
```  
  
### <a name="parameters"></a>Параметры  
 `dwData`  
 Задает дополнительные данные. Значение, используемое зависит от значения `nCmd` параметра.  
  
 `nCmd`  
 Задает тип запрошенной справки. Список возможных значений и их влияние на `dwData` параметр, в разделе `uCommand` параметра, описанные в о HTMLHelp функции API пакета SDK для Windows.  
  
### <a name="remarks"></a>Примечания  
 Кроме того, платформа вызывает эту функцию для вызова приложения HTMLHelp.  
  
 Платформа автоматически закроется приложения HTMLHelp при завершении приложения.  
  
##  <a name="initinstance"></a>  CWinApp::InitInstance  
 Windows позволяет несколько копий одной и той же программе для запуска в то же время.  
  
```  
virtual BOOL InitInstance();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если инициализация прошла успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Концептуально инициализации приложения состоит из двух разделов: одноразовый приложения инициализацию, которая выполняется в первый раз программа запускается, а инициализацию экземпляра, которая выполняется каждый раз копии программа запускается в том числе в первый раз. Реализация framework `WinMain` вызывает эту функцию.  
  
 Переопределить `InitInstance` для инициализации каждого нового экземпляра вашего приложения, работающего под управлением Windows. Как правило, можно переопределить `InitInstance` для создания объекта главное окно и задания `CWinThread::m_pMainWnd` элемент данных для указания этого окна. Дополнительные сведения о переопределении функции-члена см. в разделе [CWinApp: класс приложений](../../mfc/cwinapp-the-application-class.md).  
  
> [!NOTE]
>  Приложения MFC необходимо инициализировать в виде однопотокового подразделения (STA). При вызове метода [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) в ваш `InitInstance` переопределения, укажите `COINIT_APARTMENTTHREADED` (а не `COINIT_MULTITHREADED`). Дополнительные сведения см. в статье PRB: приложение MFC перестает отвечать при инициализации приложения в качестве многопотокового подразделения (828643) в [ http://support.microsoft.com/default.aspxscid=kb; en-us; 828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCListView#9](../../atl/reference/codesnippet/cpp/cwinapp-class_10.cpp)]  
  
##  <a name="istaskbarinteractionenabled"></a>  CWinApp::IsTaskbarInteractionEnabled  
 Указывает, включен ли взаимодействия задач Windows 7.  
  
```  
virtual BOOL IsTaskbarInteractionEnabled();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращает `TRUE` Если `EnableTaskbarInteraction` был вызван и операционной системы Windows 7 или более поздней версии.  
  
### <a name="remarks"></a>Примечания  
 Взаимодействия задач означает, что приложение MDI откроется содержимое дочерних окон MDI в отдельном эскизы на вкладках, отображаемых при наведении указателя мыши на панели задач кнопку приложения.  
  
##  <a name="loadcursor"></a>  CWinApp::LoadCursor  
 Загружает ресурс курсор с именем `lpszResourceName` или заданные `nIDResource` из текущего исполняемого файла.  
  
```  
HCURSOR LoadCursor(LPCTSTR lpszResourceName) const;  HCURSOR LoadCursor(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lpszResourceName`  
 Указывает нулем строка, содержащая имя ресурса курсора. Можно использовать `CString` для этого аргумента.  
  
 `nIDResource`  
 Идентификатор ресурса курсора. Список ресурсов см. в разделе [LoadCursor](http://msdn.microsoft.com/library/windows/desktop/ms648391) в Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор курсора в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 `LoadCursor` Загружает курсора в памяти только в том случае, если он не был загружен ранее; в противном случае она получает дескриптор существующего ресурса.  
  
 Используйте [LoadStandardCursor](#loadstandardcursor) или [LoadOEMCursor](#loadoemcursor) функции-члена для доступа к предварительно определенных курсоров Windows.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#44](../../mfc/reference/codesnippet/cpp/cwinapp-class_11.cpp)]  
  
##  <a name="loadicon"></a>  CWinApp::LoadIcon  
 Загружает ресурс значка, названный `lpszResourceName` или заданные `nIDResource` из исполняемого файла.  
  
```  
HICON LoadIcon(LPCTSTR lpszResourceName) const;  HICON LoadIcon(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lpszResourceName`  
 Указывает нулем строка, содержащая имя ресурса значка. Можно также использовать `CString` для этого аргумента.  
  
 `nIDResource`  
 Идентификатор ресурса значка.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор значка в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 `LoadIcon` загружает значок только в том случае, если он не был загружен ранее; в противном случае она получает дескриптор существующего ресурса.  
  
 Можно использовать [LoadStandardIcon](#loadstandardicon) или [LoadOEMIcon](#loadoemicon) функции-члена для доступа к предварительно определенных значков Windows.  
  
> [!NOTE]
>  Эта функция-член вызывает функцию Win32 API [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072), которого можно загружать только значок, размер которого соответствует **SM_CXICON** и **SM_CYICON** значения метрики системы.  
  
##  <a name="loadoemcursor"></a>  CWinApp::LoadOEMCursor  
 Загружает Windows предопределенные курсора ресурса, указанного в `nIDCursor`.  
  
```  
HCURSOR LoadOEMCursor(UINT nIDCursor) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `nIDCursor`  
 **OCR_** манифеста идентификатор константы, указывающее предопределенные курсора Windows. Необходимо иметь **#define OEMRESOURCE** перед **#include \<afxwin.h >** для получения доступа к **OCR_** констант в WINDOWS. З.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор курсора в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Используйте `LoadOEMCursor` или [LoadStandardCursor](#loadstandardcursor) функции-члена для доступа к предварительно определенных курсоров Windows.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#45](../../mfc/reference/codesnippet/cpp/cwinapp-class_12.h)]  
  
 [!code-cpp[NVC_MFCWindowing#46](../../mfc/reference/codesnippet/cpp/cwinapp-class_13.cpp)]  
  
##  <a name="loadoemicon"></a>  CWinApp::LoadOEMIcon  
 Значок ресурса, указанного в предварительно загружает Windows `nIDIcon`.  
  
```  
HICON LoadOEMIcon(UINT nIDIcon) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `nIDIcon`  
 **OIC_** манифеста идентификатор константы, указывающий стандартные значки Windows. Необходимо иметь **#define OEMRESOURCE** перед **#include \<afxwin.h >** для доступа к **OIC_** констант в WINDOWS. З.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор значка в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Используйте `LoadOEMIcon` или [LoadStandardIcon](#loadstandardicon) функции-члена для доступа к предварительно определенных значков Windows.  
  
##  <a name="loadstandardcursor"></a>  CWinApp::LoadStandardCursor  
 Загружает Windows предопределенные ресурса курсора, `lpszCursorName` указывает.  
  
```  
HCURSOR LoadStandardCursor(LPCTSTR lpszCursorName) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lpszCursorName`  
 **IDC_** манифеста идентификатор константы, указывающее предопределенные курсора Windows. Эти идентификаторы определяются в WINDOWS. З. Ниже перечислены возможные стандартные значения и значения для `lpszCursorName`:  
  
- **IDC_ARROW** курсора Стандартная стрелка  
  
- **IDC_IBEAM** курсора Стандартная вставки текста  
  
- **IDC_WAIT** песочные часы курсор, используемый, когда Windows выполняет трудоемкой задачей  
  
- **IDC_CROSS** курсор перекрестья для выбора  
  
- **IDC_UPARROW** стрелка, указывающая вверх  
  
- **IDC_SIZE** устарела и не поддерживается; используйте **IDC_SIZEALL**  
  
- **IDC_SIZEALL** четырехнаправленной стрелки. Курсор изменения размера окна.  
  
- **IDC_ICON** устарело и не поддерживается. Используйте **IDC_ARROW**.  
  
- **IDC_SIZENWSE** двунаправленную стрелку с заканчивается на верхней левой и правой нижней  
  
- **IDC_SIZENESW** двунаправленную стрелку с заканчивается в верхнем левом углу справа и ниже  
  
- **IDC_SIZEWE** горизонтальная Стрелка с двумя наконечниками  
  
- **IDC_SIZENS** вертикальной двунаправленную стрелку  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор курсора в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Используйте `LoadStandardCursor` или [LoadOEMCursor](#loadoemcursor) функции-члена для доступа к предварительно определенных курсоров Windows.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#47](../../mfc/reference/codesnippet/cpp/cwinapp-class_14.cpp)]  
  
##  <a name="loadstandardicon"></a>  CWinApp::LoadStandardIcon  
 Загружает Windows предопределенные ресурс значка, `lpszIconName` указывает.  
  
```  
HICON LoadStandardIcon(LPCTSTR lpszIconName) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lpszIconName`  
 Манифеста идентификатор константы, указывающий стандартные значки Windows. Эти идентификаторы определяются в WINDOWS. З. Список возможных стандартных значений и их описание см. в разделе *lpIconName* параметр в [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072) в Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор значка в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Используйте `LoadStandardIcon` или [LoadOEMIcon](#loadoemicon) функции-члена для доступа к предварительно определенных значков Windows.  
  
##  <a name="loadstdprofilesettings"></a>  CWinApp::LoadStdProfileSettings  
 Вызывает эту функцию-член из [InitInstance](#initinstance) функция-член для включения и загрузить список недавно использованных файлов (MRU) и последнего предварительного просмотра состояния.  
  
```  
void LoadStdProfileSettings(UINT nMaxMRU = _AFX_MRU_COUNT);
```  
  
### <a name="parameters"></a>Параметры  
 `nMaxMRU`  
 Количество недавно использовавшихся файлов для отслеживания.  
  
### <a name="remarks"></a>Примечания  
 Если `nMaxMRU` равно 0, список последних выбиравшихся файлов не будет поддерживаться.  
  
##  <a name="m_bhelpmode"></a>  CWinApp::m_bHelpMode  
 **Значение TRUE,** Если приложение находится в режиме контекст справки (обычно вызывается с SHIFT + F1); в противном случае **FALSE**.  
  
```  
BOOL m_bHelpMode;  
```  
  
### <a name="remarks"></a>Примечания  
 В режиме контекст справки указатель примет вид вопросительный знак и пользователь может перемещать о экрана. Изучите этот флаг, если требуется реализовать специальную обработку в режиме справки. `m_bHelpMode` — это открытая переменная типа **BOOL**.  
  
##  <a name="m_dwrestartmanagersupportflags"></a>  CWinApp::m_dwRestartManagerSupportFlags  
 Флаги, которые определяют поведение диспетчера перезапуска.  
  
```  
DWORD m_dwRestartManagerSupportFlags;  
```  
  
### <a name="remarks"></a>Примечания  
 Чтобы включить диспетчер перезапуска, задайте `m_dwRestartManagerSupportFlags` на желаемое поведение. В следующей таблице показаны доступные флаги.  
  
|||  
|-|-|  
|Flag|Описание|  
|`AFX_RESTART_MANAGER_SUPPORT_RESTART`|Приложение регистрируется с помощью [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager). Диспетчер перезапуска отвечает за перезапуска приложения, если она неожиданно завершает работу.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RECOVERY`|Зарегистрировать приложение диспетчер перезапуска и диспетчер перезапуска вызывает функцию обратного вызова восстановления при перезапуске приложения. Функция обратного вызова для восстановления по умолчанию — [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|- `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`|Включена функция автоматического сохранения и преждевременном manager перезапустите все открытые документы, при повторном запуске приложения.|  
|- `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`|Включена функция автоматического сохранения и преждевременном manager перезапустите все открытые документы с регулярным интервалом. Интервал определяется [CWinApp::m_nAutosaveInterval](#m_nautosaveinterval).|  
|- `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`|Диспетчер перезапуска открывает ранее открытых документов после перезапуска приложения из непредвиденный выход. [CDataRecoveryHandler класс](../../mfc/reference/cdatarecoveryhandler-class.md) обеспечивает сохранение списка открытых документов и их восстановления.|  
|- `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`|Диспетчер перезапуска предлагает пользователю восстановить файлы автоматически сохраненная после перезапуска приложения. `CDataRecoveryHandler` Класс запросы пользователя.|  
|- `AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE`|Объединение `AFX_RESTART_MANAGER_SUPPORT_RESTART`, `AFX_RESTART_MANAGER_SUPPORT_RECOVER`, и `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_ALL_ASPECTS`|Объединение `AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`, и `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RESTART_ASPECTS`|Объединение `AFX_RESTART_MANAGER_SUPPORT_RESTART`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`, `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`, и `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RECOVERY_ASPECTS`|Объединение `AFX_RESTART_MANAGER_SUPPORT_RECOVERY`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`, `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`, и `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
  
##  <a name="m_ehelptype"></a>  CWinApp::m_eHelpType  
 Тип этого элемента данных является перечисляемым типом **AFX_HELP_TYPE**, которая определена в `CWinApp` класса.  
  
```  
AFX_HELP_TYPE m_eHelpType;  
```  
  
### <a name="remarks"></a>Примечания  
 **AFX_HELP_TYPE** перечисление определяется следующим образом:  
  
```  
enum AFX_HELP_TYPE {  
    afxWinHelp = 0,
    afxHTMLHelp = 1
    };  
```  
  
-   Чтобы задать справки приложения на HTML-справки, вызовите [SetHelpMode](#sethelpmode) и укажите **afxHTMLHelp**.  
  
-   Чтобы задать помогают приложения WinHelp, вызовите `SetHelpMode` и укажите **afxWinHelp**.  
  
##  <a name="m_hinstance"></a>  CWinApp::m_hInstance  
 Соответствует `hInstance` параметр, передаваемый по Windows `WinMain`.  
  
```  
HINSTANCE m_hInstance;  
```  
  
### <a name="remarks"></a>Примечания  
 `m_hInstance` Член данных — это дескриптор для текущего экземпляра приложения, работающие под управлением Windows. Это значение возвращается функцией глобального [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle). `m_hInstance` — это открытая переменная типа `HINSTANCE`.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#55](../../mfc/reference/codesnippet/cpp/cwinapp-class_15.cpp)]  
  
##  <a name="m_lpcmdline"></a>  CWinApp::m_lpCmdLine  
 Соответствует `lpCmdLine` параметр, передаваемый по Windows `WinMain`.  
  
```  
LPTSTR m_lpCmdLine;  
```  
  
### <a name="remarks"></a>Примечания  
 Указывает символом null строку, которая определяет командную строку для приложения. Используйте `m_lpCmdLine` для доступа к аргументов командной строки введенные при запуске приложения пользователем. `m_lpCmdLine` — это открытая переменная типа `LPTSTR`.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="m_nautosaveinterval"></a>  CWinApp::m_nAutosaveInterval  
 Продолжительность времени в миллисекундах между преждевременном.  
  
```  
int m_nAutosaveInterval;  
```  
  
### <a name="remarks"></a>Примечания  
 Диспетчер перезапуска для автоматического сохранения открытых документов можно настроить через заданные интервалы времени. Если приложение не функция автоматического сохранения файлов, этот параметр не оказывает влияния.  
  
##  <a name="m_ncmdshow"></a>  CWinApp::m_nCmdShow  
 Соответствует `nCmdShow` параметр, передаваемый по Windows `WinMain`.  
  
```  
int m_nCmdShow;  
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо передать `m_nCmdShow` в качестве аргумента при вызове [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow) для главного окна приложения. `m_nCmdShow` — это открытая переменная типа `int`.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#56](../../mfc/reference/codesnippet/cpp/cwinapp-class_17.cpp)]  
  
##  <a name="m_pactivewnd"></a>  CWinApp::m_pActiveWnd  
 Используйте этот элемент данных для хранения указатель на главное окно приложения OLE-контейнера с вашей OLE сервера приложений на месте активирован.  
  
### <a name="remarks"></a>Примечания  
 Если этот член данных — **NULL**, приложение не является активным на месте.  
  
 Платформа задает переменную-член при активации приложения контейнера OLE на месте окна фрейма.  
  
##  <a name="m_pdatarecoveryhandler"></a>  CWinApp::m_pDataRecoveryHandler  
 Указатель на обработчик восстановления данных для приложения.  
  
```  
CDataRecoveryHandler* m_pDataRecoveryHandler;  
```  
  
### <a name="remarks"></a>Примечания  
 Обработчик данных восстановления приложения отслеживает открытые документы и преждевременном их. Платформа использует обработчик восстановления данных для восстановления файлов автоматически сохраненная, когда приложение будет перезапущено после его неожиданно завершает свою работу. Дополнительные сведения см. в разделе [CDataRecoveryHandler класса](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
##  <a name="m_pszappname"></a>  CWinApp::m_pszAppName  
 Указывает имя приложения.  
  
```  
LPCTSTR m_pszAppName;  
```  
  
### <a name="remarks"></a>Примечания  
 Имя приложения могут поступать из параметра, передаваемое [CWinApp](#cwinapp) конструктор, или, если не указан, на строку ресурса с Идентификатором **AFX_IDS_APP_TITLE**. Если имя приложения не найден в ресурсе, он поступает из программы. Имя файла EXE.  
  
 Возвращенный глобальной функции [AfxGetAppName](application-information-and-management.md#afxgetappname). `m_pszAppName` — это открытая переменная типа **const char\***.  
  
> [!NOTE]
>  Если присвоить значение `m_pszAppName`, должен быть динамически выделен в куче. `CWinApp` Вызовы деструктора **свободного**() этого указателя. Возможно, следует использовать `_tcsdup`функция библиотеки времени выполнения () для выполнения выделения. Кроме того свободной памяти, связанной с текущим указателем, до присвоения нового значения. Пример:  
  
 [!code-cpp[NVC_MFCWindowing#57](../../mfc/reference/codesnippet/cpp/cwinapp-class_18.cpp)]  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#65](../../mfc/reference/codesnippet/cpp/cwinapp-class_19.cpp)]  
  
##  <a name="m_pszexename"></a>  CWinApp::m_pszExeName  
 Содержит имя исполняемого файла приложения без расширения.  
  
```  
LPCTSTR m_pszExeName;  
```  
  
### <a name="remarks"></a>Примечания  
 В отличие от [m_pszAppName](#m_pszappname), это имя не может содержать пробелы. `m_pszExeName` — это открытая переменная типа **const char\***.  
  
> [!NOTE]
>  Если присвоить значение `m_pszExeName`, должен быть динамически выделен в куче. `CWinApp` Вызовы деструктора **свободного**() этого указателя. Возможно, следует использовать `_tcsdup`функция библиотеки времени выполнения () для выполнения выделения. Кроме того свободной памяти, связанной с текущим указателем, до присвоения нового значения. Пример:  
  
 [!code-cpp[NVC_MFCWindowing#58](../../mfc/reference/codesnippet/cpp/cwinapp-class_20.cpp)]  
  
##  <a name="m_pszhelpfilepath"></a>  CWinApp::m_pszHelpFilePath  
 Содержит путь к файлу справки приложения.  
  
```  
LPCTSTR m_pszHelpFilePath;  
```  
  
### <a name="remarks"></a>Примечания  
 По умолчанию инициализирует платформа `m_pszHelpFilePath` к имени приложения с». HLP» добавлено. Чтобы изменить имя файла справки, установите `m_pszHelpFilePath` для указания строка, содержащая полное имя файла справки нужное. — Удобное место для этого в приложении [InitInstance](#initinstance) функции. `m_pszHelpFilePath` — это открытая переменная типа **const char\***.  
  
> [!NOTE]
>  Если присвоить значение `m_pszHelpFilePath`, должен быть динамически выделен в куче. `CWinApp` Вызовы деструктора **свободного**() этого указателя. Возможно, следует использовать `_tcsdup`функция библиотеки времени выполнения () для выполнения выделения. Кроме того свободной памяти, связанной с текущим указателем, до присвоения нового значения. Пример:  
  
 [!code-cpp[NVC_MFCWindowing#59](../../mfc/reference/codesnippet/cpp/cwinapp-class_21.cpp)]  
  
##  <a name="m_pszprofilename"></a>  CWinApp::m_pszProfileName  
 Содержит имя приложения. INI-файл.  
  
```  
LPCTSTR m_pszProfileName;  
```  
  
### <a name="remarks"></a>Примечания  
 `m_pszProfileName` — это открытая переменная типа **const char\***.  
  
> [!NOTE]
>  Если присвоить значение `m_pszProfileName`, должен быть динамически выделен в куче. `CWinApp` Вызовы деструктора **свободного**() этого указателя. Возможно, следует использовать `_tcsdup`функция библиотеки времени выполнения () для выполнения выделения. Кроме того свободной памяти, связанной с текущим указателем, до присвоения нового значения. Пример:  
  
 [!code-cpp[NVC_MFCWindowing#60](../../mfc/reference/codesnippet/cpp/cwinapp-class_22.cpp)]  
  
##  <a name="m_pszregistrykey"></a>  CWinApp::m_pszRegistryKey  
 Используется, чтобы определить место хранения, в реестре или INI-файл, параметры профиля приложения.  
  
```  
LPCTSTR m_pszRegistryKey;  
```  
  
### <a name="remarks"></a>Примечания  
 Как правило этот элемент данных обрабатывается только для чтения.  
  
-   Значение, хранящееся в раздел реестра. Имя параметра профиля приложения добавляется следующий раздел реестра: HKEY_CURRENT_USER и программного обеспечения и LocalAppWizard-создан /.  
  
 Если присвоить значение `m_pszRegistryKey`, должен быть динамически выделен в куче. `CWinApp` Вызовы деструктора **свободного**() этого указателя. Возможно, следует использовать `_tcsdup`функция библиотеки времени выполнения () для выполнения выделения. Кроме того свободной памяти, связанной с текущим указателем, до присвоения нового значения. Пример:  
  
 [!code-cpp[NVC_MFCWindowing#61](../../mfc/reference/codesnippet/cpp/cwinapp-class_23.cpp)]  
  
##  <a name="m_pszappid"></a>  CWinApp::m_pszAppID  
 Модель идентификатора пользователя приложения.  
  
```  
LPCTSTR m_pszAppID;  
```  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="oncontexthelp"></a>  CWinApp::OnContextHelp  
 Обрабатывает клавиши SHIFT + F1 справки в приложении.  
  
```  
afx_msg void OnContextHelp();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_CONTEXT_HELP, OnContextHelp )` инструкцию, чтобы ваш `CWinApp` класса схему сообщений, а также добавить записи в таблице сочетаний клавиш, обычно клавиши SHIFT + F1, чтобы включить эту функцию-член.  
  
 `OnContextHelp` переводит приложение в режим справки. Курсора примет стрелки и вопросительного знака и пользователь может затем наведите указатель мыши и нажмите левую кнопку мыши для выбора диалоговое окно, окно, меню или кнопки. Эта функция-член возвращает контекст справки для объекта под курсором и вызывает функцию Windows WinHelp этого контекста справки.  
  
##  <a name="onddecommand"></a>  CWinApp::OnDDECommand  
 Вызывается платформой, когда фрейм главного окна получает DDE выполнения сообщения.  
  
```  
virtual BOOL OnDDECommand(LPTSTR lpszCommand);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszCommand*  
 Указывает строку команды DDE, полученных приложением.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если команда обработана; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию проверяет, является ли команда запроса на открытие документа и в этом случае открывается указанный документ. Диспетчер файлов обычно отправляет такие DDE командной строки при двойном щелчке в файл данных. Переопределить эту функцию для обработки других DDE выполните команды, например команды для печати.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#48](../../mfc/reference/codesnippet/cpp/cwinapp-class_24.cpp)]  
  
##  <a name="onfilenew"></a>  CWinApp::OnFileNew  
 Реализует `ID_FILE_NEW` команды.  
  
```  
afx_msg void OnFileNew();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_FILE_NEW, OnFileNew )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, эта функция обрабатывает выполнение команды создания файла.  
  
 В разделе [Технические заметки 22](../../mfc/tn022-standard-commands-implementation.md) сведения на поведение по умолчанию и рекомендации о том, как переопределить эту функцию-член.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileopen"></a>  CWinApp::OnFileOpen  
 Реализует `ID_FILE_OPEN` команды.  
  
```  
afx_msg void OnFileOpen();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_FILE_OPEN, OnFileOpen )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, эта функция обрабатывает выполнение команды открытия файла.  
  
 Сведения о поведение по умолчанию и рекомендации о том, как переопределить эту функцию-член, в разделе [Технические заметки 22](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileprintsetup"></a>  CWinApp::OnFilePrintSetup  
 Реализует **ID_FILE_PRINT_SETUP** команды.  
  
```  
afx_msg void OnFilePrintSetup();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_FILE_PRINT_SETUP, OnFilePrintSetup )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, эта функция обрабатывает выполнение команды печати файла.  
  
 Сведения о поведение по умолчанию и рекомендации о том, как переопределить эту функцию-член, в разделе [Технические заметки 22](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onhelp"></a>  CWinApp::OnHelp  
 Обрабатывает справку F1 в приложении (с использованием текущего контекста).  
  
```  
afx_msg void OnHelp();
```  
  
### <a name="remarks"></a>Примечания  
 Обычно можно также добавить запись сочетаний клавиш для клавиши F1. Включение клавиши F1 является только правилом, не является обязательным.  
  
 Необходимо добавить `ON_COMMAND( ID_HELP, OnHelp )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, вызывается платформой, когда пользователь нажимает клавишу F1.  
  
 Реализация по умолчанию эта функция обработчика сообщений определяет контекст справки, который соответствует текущее окно, диалоговое окно или пункта меню и затем вызывает метод WINHELP. EXE-ФАЙЛА. Если контекст недоступен в данный момент, функция использует контекст по умолчанию.  
  
 Переопределите эту функцию-член для задания контекста справки на какие-либо отличные от окна, диалоговое окно, пункт меню или кнопки панели инструментов, которая в данный момент имеет фокус. Вызовите `WinHelp` с нужной справки идентификатор контекста.  
  
##  <a name="onhelpfinder"></a>  CWinApp::OnHelpFinder  
 Обрабатывает **ID_HELP_FINDER** и **ID_DEFAULT_HELP** команд.  
  
```  
afx_msg void OnHelpFinder();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_HELP_FINDER, OnHelpFinder )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, платформа вызывает эту функцию обработчик сообщений, при выборе пользователем приложения поиска справки команду, вызываемую `WinHelp` со стандартом **HELP_FINDER** раздела.  
  
##  <a name="onhelpindex"></a>  CWinApp::OnHelpIndex  
 Обрабатывает **ID_HELP_INDEX** команды и предоставляет раздел справки по умолчанию.  
  
```  
afx_msg void OnHelpIndex();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_HELP_INDEX, OnHelpIndex )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Если параметр включен, платформа вызывает эту функцию обработчик сообщений, при выборе пользователем приложения индекс справки команду, вызываемую `WinHelp` со стандартом **HELP_INDEX** раздела.  
  
##  <a name="onhelpusing"></a>  CWinApp::OnHelpUsing  
 Обрабатывает **ID_HELP_USING** команды.  
  
```  
afx_msg void OnHelpUsing();
```  
  
### <a name="remarks"></a>Примечания  
 Необходимо добавить `ON_COMMAND( ID_HELP_USING, OnHelpUsing )` инструкцию, чтобы ваш `CWinApp` схему класса сообщений, чтобы включить эту функцию-член. Платформа вызывает эту функцию обработчик сообщений, при выборе пользователем приложения справку используя команду, вызываемую `WinHelp` приложение со стандартом **HELP_HELPONHELP** раздела.  
  
##  <a name="onidle"></a>  CWinApp::OnIdle  
 Переопределите эту функцию-член для выполнения обработки времени простоя.  
  
```  
virtual BOOL OnIdle(LONG lCount);
```  
  
### <a name="parameters"></a>Параметры  
 `lCount`  
 Счетчик увеличивается каждый раз `OnIdle` вызывается, когда очередь сообщений приложения является пустым. Этот счетчик обнуляется каждый раз при обработке нового сообщения. Можно использовать `lCount` параметра, чтобы определить относительный интервал времени приложения простаивал без обработки сообщения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, для получения более обработки время простоя; 0, если требуется больше времени простоя.  
  
### <a name="remarks"></a>Примечания  
 `OnIdle` функция вызывается в цикла сообщений по умолчанию, когда очередь сообщений приложения является пустым. Используйте переопределения для вызова свой опыт простоя обработчика задачи.  
  
 `OnIdle` должен возвращать 0, чтобы указать на время обработки без простоя. `lCount` Параметр увеличивается каждый раз `OnIdle` вызывается, когда очередь сообщений является пустым и сбрасывается в 0 каждый раз при обработке нового сообщения. Можно вызвать в разные процедуры простоя, на основе этого количества.  
  
 Далее перечислены обработка пустых циклов.  
  
1.  Если цикл обработки сообщений в библиотеке Microsoft Foundation Class проверяет очереди сообщений и не находит ожидающих сообщений, он вызывает метод `OnIdle` для объекта приложения и предоставляет 0 как `lCount` аргумент.  
  
2. `OnIdle` выполняет определенную обработку и возвращает ненулевое значение, указывающее, она должна быть вызвана снова сделать дальнейшей обработки.  
  
3.  Цикл обработки сообщений снова проверяет очереди сообщений. Если нет сообщений, ожидающих выполнения, он вызывает метод `OnIdle` еще раз, увеличивая `lCount` аргумент.  
  
4.  Со временем `OnIdle` заканчивает обработку всех своих задач простоя и возвращает 0. Это значит, цикл обработки сообщений, чтобы остановить вызов `OnIdle` до следующего сообщения из очереди сообщений, после чего цикла простоя перезапускается с аргументом, значение 0.  
  
 Не выполняйте продолжительных задач во время `OnIdle` , так как приложение не может обработать входные данные пользователя до `OnIdle` возвращает.  
  
> [!NOTE]
>  Реализация по умолчанию `OnIdle` обновления команды объекты пользовательского интерфейса, например, пункты меню и кнопки панели инструментов и выполняет очистку структуры внутренних данных. Таким образом Если переопределить `OnIdle`, необходимо вызвать `CWinApp::OnIdle` с `lCount` в переопределенных версии. Сначала вызовите обработка простоя все базового класса (то есть до базового класса `OnIdle` возвращает 0). Если вам нужно работать до завершения обработки базового класса, просмотрите реализацию базового класса для выбора соответствующих `lCount` во время которого будет выполняться.  
  
 Если вы не хотите `OnIdle` вызываться всякий раз, когда сообщение извлекается из очереди сообщений, можно переопределить [CWinThreadIsIdleMessage](../../mfc/reference/cwinthread-class.md#isidlemessage). Если приложение установило коротком таймер или система отправляет **WM_SYSTIMER** сообщений, затем `OnIdle` будет вызываться несколько раз и привести к снижению производительности.  
  
### <a name="example"></a>Пример  
 В следующих двух примерах показано как использовать `OnIdle`. Первый пример обрабатывает два простоя задач с помощью `lCount` аргумент, чтобы определить приоритеты задач. Первой задачей является важным, и необходимо сделать это, когда это возможно. Вторая задача менее важно и должно выполняться только в том случае, если длиннее вводимые пользователем данные. Обратите внимание на вызов к версии базового класса `OnIdle`. Во втором примере управляет группу простоя задач с различным приоритетом.  
  
 [!code-cpp[NVC_MFCWindowing#51](../../mfc/reference/codesnippet/cpp/cwinapp-class_27.cpp)]  
  
##  <a name="opendocumentfile"></a>  CWinApp::OpenDocumentFile  
 Платформа вызывает этот метод для открытия именованного [CDocument](../../mfc/reference/cdocument-class.md) файл для приложения.  
  
```  
virtual CDocument* OpenDocumentFile(
LPCTSTR lpszFileName  
BOOL bAddToMRU = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `lpszFileName`  
 Имя файла для открытия.  
  
 [in] `bAddToMRU`  
 `TRUE` Указывает, что документ является одним из самых последних версий файлов; `FALSE` указывает документ не является одним из самых последних версий файлов.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на `CDocument` Если успешно; в противном случае `NULL`.  
  
### <a name="remarks"></a>Примечания  
 Если документ с таким именем уже открыт, первое окно фрейма, содержащего этот документ получит фокус. Если приложение поддерживает несколько шаблонов документов, платформа использует расширение имени файла для поиска соответствующего шаблона документа для повторной загрузки документа. В случае успешного выполнения документ затем шаблон создает фрейм окна и представления документа.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="parsecommandline"></a>  CWinApp::ParseCommandLine  
 Вызовите эту функцию-член для командной строки и отправлять параметры, по одному [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam).  
  
```  
void ParseCommandLine(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Параметры  
 `rCmdInfo`  
 Ссылку на [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) объекта.  
  
### <a name="remarks"></a>Примечания  
 При запуске нового проекта MFC с помощью мастера приложений приложения будет создан локальный экземпляр `CCommandLineInfo`, а затем вызвать `ProcessShellCommand` и `ParseCommandLine` в [InitInstance](#initinstance) функции-члена. В командной строке выполняется по маршруту, описанных ниже:  
  
1.  После создания в `InitInstance`, `CCommandLineInfo` объект передается `ParseCommandLine`.  
  
2. `ParseCommandLine` затем вызывает `CCommandLineInfo::ParseParam` несколько раз, один раз для каждого параметра.  
  
3. `ParseParam` заполняет `CCommandLineInfo` объекта, который затем передается [ProcessShellCommand](#processshellcommand).  
  
4. `ProcessShellCommand` Обработка аргументов командной строки и флаги.  
  
 Обратите внимание, что вы можете вызвать `ParseCommandLine` напрямую, при необходимости.  
  
 Описание флагов командной строки см. в разделе [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand).  
  
##  <a name="pretranslatemessage"></a>  CWinApp::PreTranslateMessage  
 Переопределить эту функцию для фильтрации сообщений окна перед их передачей функциям Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) и [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934) реализация по умолчанию выполняет сочетаний клавиш преобразования, поэтому необходимо вызвать `CWinApp::PreTranslateMessage` функции-члена в переопределенных версии.  
  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>Параметры  
 `pMsg`  
 Указатель на [MSG](../../mfc/reference/msg-structure1.md) структуру, содержащую сообщение для обработки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если сообщение было обработано полностью в `PreTranslateMessage` и не должны обрабатываться Дополнительно. Нуль, если сообщения должны обрабатываться обычным способом.  
  
##  <a name="processmessagefilter"></a>  CWinApp::ProcessMessageFilter  
 Функция-ловушка framework вызывает эту функцию-член для фильтрации и реагировать на некоторые сообщения Windows.  
  
```  
virtual BOOL ProcessMessageFilter(
    int code,  
    LPMSG lpMsg);
```  
  
### <a name="parameters"></a>Параметры  
 `code`  
 Указывает код обработчика. Эта функция-член использует код, чтобы определить способ обработки `lpMsg.`  
  
 `lpMsg`  
 Указатель на Windows [MSG](../../mfc/reference/msg-structure1.md) структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если сообщение обработано; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Функция-ловушка обрабатывает события перед их отправкой в обычное сообщение приложения обработки.  
  
 Если переопределить это дополнительная возможность, необходимо вызвать версии базового класса для обеспечения framework подключить обработки.  
  
##  <a name="processshellcommand"></a>  CWinApp::ProcessShellCommand  
 Эта функция-член вызывается [InitInstance](#initinstance) принимать параметры, переданные от `CCommandLineInfo` объекта, указанного в `rCmdInfo`и выполнить указанное действие.  
  
```  
BOOL ProcessShellCommand(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Параметры  
 `rCmdInfo`  
 Ссылку на [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если успешно обработала командной оболочки. Если значение равно 0, возвращают **FALSE** из [InitInstance](#initinstance).  
  
### <a name="remarks"></a>Примечания  
 При запуске нового проекта MFC с помощью мастера приложений приложения будет создан локальный экземпляр `CCommandLineInfo`, а затем вызвать `ProcessShellCommand` и [ParseCommandLine](#parsecommandline) в `InitInstance` функции-члена. В командной строке выполняется по маршруту, описанных ниже:  
  
1.  После создания в `InitInstance`, `CCommandLineInfo` объект передается `ParseCommandLine`.  
  
2. `ParseCommandLine` затем вызывает [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam) несколько раз, один раз для каждого параметра.  
  
3. `ParseParam` заполняет `CCommandLineInfo` объекта, который затем передается `ProcessShellCommand`.  
  
4. `ProcessShellCommand` Обработка аргументов командной строки и флаги.  
  
 Данные-члены `CCommandLineInfo` объекта, идентифицируемого по [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand), являются следующие перечислимого типа, определенные в `CCommandLineInfo` класса.  
  
```  
enum {
    FileNew,
    FileOpen,
    FilePrint,
    FilePrintTo,
    FileDDE
    };  
```
  
 Краткое описание каждого из этих значений см. в разделе `CCommandLineInfo::m_nShellCommand`.  
  
##  <a name="processwndprocexception"></a>  CWinApp::ProcessWndProcException  
 Эта функция-член вызывается платформой, каждый раз, когда обработчик не перехватывает исключение, создаваемое в одном из сообщения приложения или обработчики команд.  
  
```  
virtual LRESULT ProcessWndProcException(
    CException* e,  
    const MSG* pMsg);
```  
  
### <a name="parameters"></a>Параметры  
 *e*  
 Указатель на исключение.  
  
 `pMsg`  
 Объект [MSG](../../mfc/reference/msg-structure1.md) структуру, содержащую сведения о windows сообщения, которое вызвало платформа для создания исключения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение, которое должно возвращаться в Windows. Обычно это 0L для сообщения windows, 1L ( **TRUE**) для командных сообщений.  
  
### <a name="remarks"></a>Примечания  
 Не вызывайте эту функцию-член напрямую.  
  
 Реализация по умолчанию эта функция-член создает окно сообщения. Если неперехваченное исключение происходит с меню, панели инструментов или сбоя команды сочетаний клавиш, в окне сообщения отображается сообщение «Не удалось выполнить команду»; в противном случае он отображает сообщение «Ошибка внутреннего приложения».  
  
 Переопределите эту функцию-член для предоставления глобальных обработки свои исключения. Вызовите только базовую функциональность, при желании для отображения в окне сообщения.  
  
##  <a name="register"></a>  CWinApp::Register  
 Выполняет все задачи регистрации, не обработанные `RegisterShellFileTypes`.  
  
```  
virtual BOOL Register();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию просто возвращает значение TRUE. Переопределите эту функцию для обеспечения регистрации настраиваемого действия.  
  
##  <a name="registershellfiletypes"></a>  CWinApp::RegisterShellFileTypes  
 Вызовите эту функцию-член для регистрации всех типов документов приложения с помощью диспетчера файлов Windows.  
  
```  
void RegisterShellFileTypes(BOOL bCompat = FALSE);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `bCompat`  
 `TRUE` Добавление записей регистрации для оболочки команды печати и распечатать, дает пользователям возможность печатать файлы непосредственно из оболочки, либо путем перетаскивания файл к объекту принтера. Он также добавляет ключ DefaultIcon. По умолчанию этот параметр является `FALSE` для обеспечения обратной совместимости.  
  
### <a name="remarks"></a>Примечания  
 Это позволяет пользователю открыть файл данных, созданный приложением, дважды щелкнув его из диспетчера файлов. Вызовите `RegisterShellFileTypes` после вызова метода [AddDocTemplate](#adddoctemplate) для каждого из шаблонов документов в приложении. Кроме того, вызвать [EnableShellOpen](#enableshellopen) при вызове функции-члена `RegisterShellFileTypes`.  
  
 `RegisterShellFileTypes` выполняет итерацию по списку [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) объектов, что приложение поддерживает и, для каждого шаблона документа добавляет записи в базу данных регистрации Windows поддерживает для сопоставления файлов. Диспетчер файлов использует эти записи для открытия файла данных, когда пользователь дважды щелкает. Это избавляет от необходимости отправки. REG-файл вместе с приложением.  
  
> [!NOTE]
> `RegisterShellFileTypes` работает, только если пользователь запускает программу с правами администратора. Если программа не имеет прав администратора, его невозможно изменить разделы реестра.  
  
 Если база данных регистрации уже связывает расширение данного имени файла с другим типом файла, создается не новой связи. В разделе `CDocTemplate` класс форматирования строк, необходимо зарегистрировать эти сведения.  
  
##  <a name="registerwithrestartmanager"></a>  CWinApp::RegisterWithRestartManager  
 Регистрирует приложение с помощью диспетчера перезапуска.  
  
```  
virtual HRESULT RegisterWithRestartManager(
BOOL bRegisterRecoveryCallback,  
const CString& strRestartIdentifier);

 
virtual HRESULT RegisterWithRestartManager(
LPCWSTR pwzCommandLineArgs,  
DWORD dwRestartFlags,  
APPLICATION_RECOVERY_CALLBACK pRecoveryCallback,  
LPVOID lpvParam,  
DWORD dwPingInterval,  
DWORD dwCallbackFlags);
```  
  
### <a name="parameters"></a>Параметры  
  
|||  
|-|-|  
|Параметр|Описание|  
|[in] `bRegisterRecoveryCallback`|`TRUE` Указывает, что этот экземпляр приложения использует функцию обратного вызова восстановления; `FALSE` указывает не делает. Платформа вызывает функцию обратного вызова восстановления, когда приложение завершает работу непредвиденным образом. Дополнительные сведения см. в разделе [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in] `strRestartIdentifier`|Уникальная строка, идентифицирующая диспетчера перезапуска данного экземпляра. Диспетчер перезапуска идентификатор является уникальным для каждого экземпляра приложения.|  
|[in] `pwzCommandLineArgs`|Строка, содержащая все лишние аргументы из командной строки.|  
|[in] `dwRestartFlags`|Необязательные флаги диспетчера перезапуска. Дополнительные сведения см. в разделе "Примечания".|  
|[in] `pRecoveryCallback`|Функция обратного вызова для восстановления. Эта функция должна принимать `LPVOID` параметра в виде входных данных и возврата `DWORD`. Функция обратного вызова для восстановления по умолчанию — `CWinApp::ApplicationRecoveryCallback`.|  
|[in] `lpvParam`|Входной параметр для восстановления функции обратного вызова. Дополнительные сведения см. в разделе [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in] `dwPingInterval`|Длина времени ожидания диспетчера перезапуска для восстановления функции обратного вызова для возврата. Этот параметр указывается в миллисекундах.|  
|[in] `dwCallbackFlags`|Флаги передан функции обратного вызова для восстановления. Зарезервировано для будущего использования.|  
  
### <a name="return-value"></a>Возвращаемое значение  
 `S_OK` Если метод выполнен успешно; в противном случае — код ошибки.  
  
### <a name="remarks"></a>Примечания  
 Если приложение использует реализация MFC по умолчанию для файлов автосохранения, следует использовать простой версии `RegisterWithRestartManager`. Использование сложных версии `RegisterWithRestartManager` Если вы хотите настроить Автосохранение поведение приложения.  
  
 При вызове этого метода с пустой строки для `strRestartIdentifier`, `RegisterWithRestartManager` создает строку уникальный идентификатор для этого экземпляра перезапуска диспетчера.  
  
 При неожиданно завершает приложение, диспетчер перезапуска перезапускает приложение из командной строки и предоставляет уникальный идентификатор, что необязательный аргумент перезапустить. В этом случае платформа вызывает `RegisterWithRestartManager` два раза. Первый вызов поступают из [CWinApp::InitInstance](#initinstance) с пустой строки для идентификатора строки. Затем метод [CWinApp::ProcessShellCommand](#processshellcommand) вызовы `RegisterWithRestartManager` с перезапуска уникальный идентификатор.  
  
 После регистрации приложения в диспетчер перезапуска, диспетчер перезапуска отслеживает приложение. Если приложение неожиданно завершает работу, диспетчер перезапуска вызывает функцию обратного вызова восстановления во время процесса завершается. Ожидание диспетчера перезапуска `dwPingInterval` ответа от восстановления функции обратного вызова. Если функция обратного вызова восстановления не отвечает в течение этого времени, приложение завершает работу без выполнения функции обратного вызова для восстановления.  
  
 По умолчанию dwRestartFlags не поддерживаются, но предназначены для использования в будущем. Возможные значения параметра `dwRestartFlags` , как показано ниже:  
  
- `RESTART_NO_CRASH`  
  
- `RESTART_NO_HANG`  
  
- `RESTART_NO_PATCH`  
  
- `RESTART_NO_REBOOT`  
  
##  <a name="reopenpreviousfilesatrestart"></a>  CWinApp::ReopenPreviousFilesAtRestart  
 Определяет, открывается ли диспетчер перезапуска повторно файлы, которые были открыты при неожиданный выход из приложения.  
  
```  
virtual BOOL ReopenPreviousFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает, повторно открывает диспетчер перезапуска ранее открытые файлы; `FALSE` указывает диспетчер перезапуска — нет.  
  
##  <a name="restartinstance"></a>  CWinApp::RestartInstance  
 Обрабатывает инициировано диспетчера перезапуска перезапуск приложения.  
  
```  
virtual BOOL CWinApp::RestartInstance();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Если обработчик восстановления данных открывает ранее открытие документов; `FALSE` Если обработчик восстановления данных возникла ошибка, или если нет ранее открытых документов.  
  
### <a name="remarks"></a>Примечания  
 Когда диспетчер перезапуска перезапускает приложение, платформа вызывает этот метод. Этот метод извлекает обработчик восстановления данных и восстанавливает файлы автоматически сохраненная. Этот метод вызывает метод [CDataRecoveryHandler::RestoreAutosavedDocuments](../../mfc/reference/cdatarecoveryhandler-class.md#restoreautosaveddocuments) для определения, желает ли восстановить файлы автоматически сохраненная пользователя.  
  
 Этот метод возвращает `FALSE` Если [CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) определяет, что было не открытые документы. Если нет открытых документов, обычно запуска приложения.  
  
##  <a name="restoreautosavedfilesatrestart"></a>  CWinApp::RestoreAutosavedFilesAtRestart  
 Определяет, восстанавливает ли файлы автоматически сохраненная диспетчера перезапуска при перезапуске приложения.  
  
```  
virtual BOOL RestoreAutosavedFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает файлы автоматически сохраненная восстановление диспетчера перезагрузки; `FALSE` указывает диспетчер перезапуска — нет.  
  
##  <a name="run"></a>  CWinApp::Run  
 Обеспечивает цикла сообщений по умолчанию.  
  
```  
virtual int Run();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `int` Значение, которое возвращается `WinMain`.  
  
### <a name="remarks"></a>Примечания  
 **Запустите** получает и отправляет сообщения Windows, пока приложение не получит **WM_QUIT** сообщения. Если очередь сообщений приложения в настоящее время не содержит сообщений, **запуска** вызовы [OnIdle](#onidle) для выполнения обработки времени простоя. Входящие сообщения попадают в [PreTranslateMessage](#pretranslatemessage) функции-члена для специальной обработки, а затем для функции Windows **TranslateMessage** для перевода на стандартной клавиатуре; Наконец,  **DispatchMessage** функция Windows.  
  
 **Запустите** переопределяется редко, но его можно переопределить для предоставления особое поведение.  
  
##  <a name="runautomated"></a>  CWinApp::RunAutomated  
 Эта функция вызывается для определения ли « **/Automation**«или» **-автоматизации**«параметр присутствует, которое указывает, была ли запущена клиентским приложением серверного приложения.  
  
```  
BOOL RunAutomated();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если параметр был найден. в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если он имеется, параметр удаляется из командной строки. Дополнительные сведения об OLE-автоматизации см. в статье [серверы автоматизации](../../mfc/automation-servers.md).  
  
##  <a name="runembedded"></a>  CWinApp::RunEmbedded  
 Эта функция вызывается для определения ли» **/Embedding**«или» **-Embedding**«параметр присутствует, которое указывает, была ли запущена клиентским приложением серверного приложения.  
  
```  
BOOL RunEmbedded();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если параметр был найден. в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если он имеется, параметр удаляется из командной строки. Дополнительные сведения о внедрении см. в статье [серверы: реализация сервера](../../mfc/servers-implementing-a-server.md).  
  
##  <a name="saveallmodified"></a>  CWinApp::SaveAllModified  
 Вызывается платформой для сохранения всех документов, когда фрейма главного окна приложения будет закрыта, или с помощью `WM_QUERYENDSESSION` сообщения.  
  
```  
virtual BOOL SaveAllModified();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если безопасный завершить работу приложения; 0, если не безопасно завершить приложение.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию эта функция-член вызывает [CDocument::SaveModified](../../mfc/reference/cdocument-class.md#savemodified) функции-члена в свою очередь для все измененные документы в приложении.  
  
##  <a name="selectprinter"></a>  CWinApp::SelectPrinter  
 Вызовите эту функцию-член, чтобы выбрать принтер и отпустите ранее выбранный в диалоговом окне печати принтера.  
  
```  
void SelectPrinter(
    HANDLE hDevNames,  
    HANDLE hDevMode,  
    BOOL bFreeOld = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `hDevNames`  
 Дескриптор [DEVNAMES](../../mfc/reference/devnames-structure.md) структура, определяющая драйвера, устройства и имена портов вывода конкретного принтера.  
  
 `hDevMode`  
 Дескриптор [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) структура, которая задает сведения об инициализации устройства и среде принтера.  
  
 *bFreeOld*  
 Освобождает ранее выбранный принтер.  
  
### <a name="remarks"></a>Примечания  
 Если оба `hDevMode` и `hDevNames` , **NULL**, `SelectPrinter` использует текущий принтер по умолчанию.  
  
##  <a name="sethelpmode"></a>  CWinApp::SetHelpMode  
 Задает тип справки приложения.  
  
```  
void SetHelpMode(AFX_HELP_TYPE eHelpType);
```  
  
### <a name="parameters"></a>Параметры  
 `eHelpType`  
 Указывает тип справки для использования. В разделе [CWinApp::m_eHelpType](#m_ehelptype) для получения дополнительной информации.  
  
### <a name="remarks"></a>Примечания  
 Задает тип справки приложения.  
  
 Чтобы задать тип справки приложения HTMLHelp, можно вызвать [EnableHTMLHelp](#enablehtmlhelp). При вызове метода `EnableHTMLHelp`, приложение должно использовать HTMLHelp как его приложение справки. Если требуется изменить для использования WinHelp, можно вызвать `SetHelpMode` и задайте `eHelpType` для **afxWinHelp**.  
  
##  <a name="setregistrykey"></a>  CWinApp::SetRegistryKey  
 В результате параметры приложения для сохранения в реестре вместо INI-файлы.  
  
```  
void SetRegistryKey(LPCTSTR lpszRegistryKey);  
void SetRegistryKey(UINT nIDRegistryKey);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszRegistryKey*  
 Указатель на строку, содержащую имя ключа.  
  
 *nIDRegistryKey*  
 Идентификатор строкового ресурса, содержащее имя раздела реестра.  
  
### <a name="remarks"></a>Примечания  
 Эта функция задает *m_pszRegistryKey*, который затем используется для `GetProfileInt`, `GetProfileString`, `WriteProfileInt`, и `WriteProfileString` функциями-членами `CWinApp`. При вызове этой функции в реестре также хранится список последних использовавшихся файлов (MRU). Раздел реестра обычно является название компании. Он хранится в ключе следующего вида: HKEY_CURRENT_USER\Software\\< имя компании\>\\< имя приложения\>\\< имя раздела\>\\< значение имя\>.  
  
##  <a name="supportsapplicationrecovery"></a>  CWinApp::SupportsApplicationRecovery  
 Определяет, восстанавливает ли диспетчер перезапуска приложения, неожиданно завершил работу.  
  
```  
virtual BOOL SupportsApplicationRecovery() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает, выполнено восстановление диспетчера перезапуска приложения. `FALSE` указывает диспетчер перезапуска — нет.  
  
##  <a name="supportsautosaveatinterval"></a>  CWinApp::SupportsAutosaveAtInterval  
 Определяет ли преждевременном диспетчера перезапуска открывать документы с регулярным интервалом.  
  
```  
virtual BOOL SupportsAutosaveAtInterval() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает, что преждевременном диспетчера перезапуска открытие документов; `FALSE` указывает диспетчер перезапуска — нет.  
  
##  <a name="supportsautosaveatrestart"></a>  CWinApp::SupportsAutosaveAtRestart  
 Определяет, является ли преждевременном диспетчер перезапуска при перезапуске открытые документы.  
  
```  
virtual BOOL SupportsAutosaveAtRestart() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает, что преждевременном диспетчера перезапуска открывать документы при повторном запуске приложения; `FALSE` указывает диспетчер перезапуска — нет.  
  
##  <a name="supportsrestartmanager"></a>  CWinApp::SupportsRestartManager  
 Определяет, поддерживает ли приложение диспетчера перезапуска.  
  
```  
virtual BOOL SupportsRestartManager() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Указывает, что приложение поддерживает диспетчер перезапуска; `FALSE` указывает не поддерживает приложение.  
  
##  <a name="unregister"></a>  CWinApp::Unregister  
 Отменяет регистрацию всех файлов, зарегистрированных объектов приложения.  
  
```  
virtual BOOL Unregister();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.  
  
### <a name="remarks"></a>Примечания  
 `Unregister` Функция отменяет регистрацию выполненных объект приложения и [зарегистрировать](#register) функции. Как правило обе функции называются неявным образом MFC и поэтому он не будет отображаться в коде.  
  
 Переопределите эту функцию для отмены регистрации пользовательского действия.  
  
##  <a name="unregistershellfiletypes"></a>  CWinApp::UnregisterShellFileTypes  
 Вызовите эту функцию-член отменить регистрацию всех типов документов приложения с помощью диспетчера файлов Windows.  
  
```  
void UnregisterShellFileTypes();
```  
  
##  <a name="winhelp"></a>  CWinApp::WinHelp  
 Вызовите эту функцию-член для вызова приложения WinHelp.  
  
```  
virtual void WinHelp(
    DWORD_PTR dwData,  
    UINT nCmd = HELP_CONTEXT);
```  
  
### <a name="parameters"></a>Параметры  
 `dwData`  
 Задает дополнительные данные. Значение, используемое зависит от значения `nCmd` параметра.  
  
 `nCmd`  
 Задает тип запрошенной справки. Список возможных значений и их влияние на `dwData` параметр, в разделе [WinHelp](http://msdn.microsoft.com/library/windows/desktop/bb762267) функции Windows.  
  
### <a name="remarks"></a>Примечания  
 Кроме того, платформа вызывает эту функцию для вызова приложения WinHelp.  
  
 Платформа автоматически закроется приложения WinHelp при завершении приложения.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#53](../../mfc/reference/codesnippet/cpp/cwinapp-class_28.cpp)]  
  
##  <a name="writeprofilebinary"></a>  CWinApp::WriteProfileBinary  
 Вызовите эту функцию-член для записи двоичных данных в указанный раздел реестра приложения или. INI-файл.  
  
```  
BOOL WriteProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE pData,  
    UINT nBytes);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Указывает строка, указывающая раздела, содержащего запись символом null. Если раздел не существует, он создается. Имя раздела является случай независимых; Строка может быть любое сочетание букв верхнего и нижнего регистра.  
  
 `lpszEntry`  
 Указывает символом null строку, которая содержит запись, в который будет записываться значение. Если запись в указанный раздел не существует, он создается.  
  
 `pData`  
 Указатель на записываемые данные.  
  
 `nBytes`  
 Содержит число байтов для записи.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="example"></a>Пример  
 В этом примере используется `CWinApp* pApp = AfxGetApp();` для получения класса CWinApp, иллюстрирующий способом, `WriteProfileBinary` и `GetProfileBinary` можно использовать из любой функции в приложениях MFC.  
  
 [!code-cpp[NVC_MFCWindowing#54](../../mfc/reference/codesnippet/cpp/cwinapp-class_29.cpp)]  
  
 Другой пример, см. пример для [CWinApp::GetProfileBinary](#getprofilebinary).  
  
##  <a name="writeprofileint"></a>  CWinApp::WriteProfileInt  
 Вызовите эту функцию-член для записи указанное значение в указанный раздел реестра приложения или. INI-файл.  
  
```  
BOOL WriteProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nValue);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Указывает строка, указывающая раздела, содержащего запись символом null. Если раздел не существует, он создается. Имя раздела является случай независимых; Строка может быть любое сочетание букв верхнего и нижнего регистра.  
  
 `lpszEntry`  
 Указывает символом null строку, которая содержит запись, в который будет записываться значение. Если запись в указанный раздел не существует, он создается.  
  
 `nValue`  
 Содержит значение для записи.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="example"></a>Пример  
 В этом примере используется `CWinApp* pApp = AfxGetApp();` для получения класса CWinApp, иллюстрирующий способом, `WriteProfileString`, `WriteProfileInt`, `GetProfileString`, и `GetProfileInt` можно использовать из любой функции в приложениях MFC.  
  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Другой пример, см. пример для [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="writeprofilestring"></a>  CWinApp::WriteProfileString  
 Вызовите эту функцию-член для записи указанную строку в указанный раздел реестра приложения или. INI-файл.  
  
```  
BOOL WriteProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszValue);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSection`  
 Указывает строка, указывающая раздела, содержащего запись символом null. Если раздел не существует, он создается. Имя раздела является случай независимых; Строка может быть любое сочетание букв верхнего и нижнего регистра.  
  
 `lpszEntry`  
 Указывает символом null строку, которая содержит запись, в который будет записываться значение. Если запись в указанный раздел не существует, он создается. Если этот параметр имеет `NULL`, разделе, указанном параметром `lpszSection` удаляется.  
  
 `lpszValue`  
 Указывает строку для записи. Если этот параметр имеет `NULL`, указанной в параметре `lpszEntry` параметр удаляется.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Другой пример, см. пример для [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="setappid"></a>  CWinApp::SetAppID  
 Явно задает идентификатор модели пользователя приложения для приложения. Этот метод должен вызываться, прежде чем будет предоставлен пользовательский интерфейс для пользователя (лучше всего является конструктором приложения).  
  
```  
void SetAppID(LPCTSTR lpcszAppID);
```  
  
### <a name="parameters"></a>Параметры  
 `lpcszAppID`  
 Указывает идентификатор модели пользователя приложения.  
  
### <a name="remarks"></a>Примечания  
  
## <a name="see-also"></a>См. также  
 [CWinThread-класс](../../mfc/reference/cwinthread-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Практическое руководство. Добавление поддержки диспетчера перезапуска](../../mfc/how-to-add-restart-manager-support.md)



