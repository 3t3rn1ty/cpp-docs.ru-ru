---
title: Класс COleClientItem | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
dev_langs:
- C++
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 89a277293cd4b192af0a8a069b82b1b1614490a7
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33378765"
---
# <a name="coleclientitem-class"></a>Класс COleClientItem
Определяет контейнерный интерфейс для элементов OLE.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class COleClientItem : public CDocItem  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleClientItem::COleClientItem](#coleclientitem)|Создает объект `COleClientItem`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleClientItem::Activate](#activate)|Открывает элемент OLE для операции, а затем выполняет указанную команду.|  
|[COleClientItem::ActivateAs](#activateas)|Активирует элемент другого типа.|  
|[COleClientItem::AttachDataObject](#attachdataobject)|Обращается к данным в OLE-объекта.|  
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Указывает, может ли приложение контейнера создать внедренный объект.|  
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Указывает, является ли приложение контейнера можно создать связанный объект.|  
|[COleClientItem::CanPaste](#canpaste)|Указывает, содержит ли буфер обмена элемента OLE встраиваемая или статическими.|  
|[COleClientItem::CanPasteLink](#canpastelink)|Указывает, содержит ли буфер ссылок на основе элемента OLE.|  
|[COleClientItem::Close](#close)|Закрывает ссылку на сервер, но не уничтожает элемента OLE.|  
|[COleClientItem::ConvertTo](#convertto)|Преобразует элемент в другой тип.|  
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Копирование элемента OLE в буфер обмена.|  
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Создает копию существующего элемента.|  
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Создает встроенного элемента из буфера обмена.|  
|[COleClientItem::CreateFromData](#createfromdata)|Создает внедренный элемент из объекта данных.|  
|[COleClientItem::CreateFromFile](#createfromfile)|Создает внедренный элемент из файла.|  
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Создание связанного элемента из буфера обмена.|  
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Создает связанный элемент из объекта данных.|  
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Создает связанный элемент из файла.|  
|[COleClientItem::CreateNewItem](#createnewitem)|Создает новый внедренный элемент, запустив приложение сервера.|  
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Создает статический элемент из буфера обмена.|  
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Создает статический элемент из объекта данных.|  
|[COleClientItem::Deactivate](#deactivate)|Деактивирует элемента.|  
|[COleClientItem::DeactivateUI](#deactivateui)|Пользовательский интерфейс приложения контейнера восстанавливает в исходное состояние.|  
|[COleClientItem::Delete](#delete)|Удаляет или закрывает объекта OLE, если он был связанный элемент.|  
|[COleClientItem::DoDragDrop](#dodragdrop)|Выполняет операцию перетаскивания и вставки.|  
|[COleClientItem::DoVerb](#doverb)|Выполняет указанную команду.|  
|[COleClientItem::Draw](#draw)|Рисование элемента OLE.|  
|[COleClientItem::GetActiveView](#getactiveview)|Возвращает представление, на котором активируется элемента на месте.|  
|[COleClientItem::GetCachedExtent](#getcachedextent)|Возвращает границы прямоугольника элемента OLE.|  
|[COleClientItem::GetClassID](#getclassid)|Возвращает идентификатор присутствует элемент класса.|  
|[COleClientItem::GetClipboardData](#getclipboarddata)|Возвращает данные, помещается в буфер обмена, вызвав `CopyToClipboard` функции-члена.|  
|[COleClientItem::GetDocument](#getdocument)|Возвращает `COleDocument` , содержащий элемент отсутствует.|  
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Получает текущее представление элемента для подготовки к просмотру.|  
|[COleClientItem::GetExtent](#getextent)|Возвращает границы прямоугольника элемента OLE.|  
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Извлекает дескриптор значка, связанного с сервером определенной CLSID.|  
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Возвращает метафайла, используемую для рисования значка элемента.|  
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Возвращает указатель в окне редактирования элемента на месте.|  
|[COleClientItem::GetItemState](#getitemstate)|Возвращает текущее состояние элемента.|  
|[COleClientItem::GetLastStatus](#getlaststatus)|Возвращает состояние последней операции OLE.|  
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Возвращает режим обновления для связанного элемента (дополнительная возможность).|  
|[COleClientItem::GetType](#gettype)|Возвращает тип объекта OLE (внедренные, связанные или статический).|  
|[COleClientItem::GetUserType](#getusertype)|Возвращает строку, описывающую тип данного элемента.|  
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Возвращает `TRUE` Если элемент является активным на месте.|  
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Возвращает **TRUE** Если связанный элемент находится в актуальном состоянии с его исходный документ.|  
|[COleClientItem::IsModified](#ismodified)|Возвращает `TRUE` , если элемент был изменен с момента последнего сохранения.|  
|[COleClientItem::IsOpen](#isopen)|Возвращает `TRUE` Если элемент в данный момент открыт в серверном приложении.|  
|[COleClientItem::IsRunning](#isrunning)|Возвращает `TRUE` Если элемента серверное приложение выполняется.|  
|[COleClientItem::OnActivate](#onactivate)|Вызывается платформой для оповещения элемента, его активации.|  
|[COleClientItem::OnActivateUI](#onactivateui)|Вызывается платформой для уведомления элемента, он активируется и отображать свой пользовательский интерфейс.|  
|[COleClientItem::OnChange](#onchange)|Вызывается, когда сервер переводит элемент OLE. Требуется реализация.|  
|[COleClientItem::OnDeactivate](#ondeactivate)|Вызывается платформой при деактивации элемента.|  
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Вызывается платформой при server удалил его интерфейс пользователя на месте.|  
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Вызывается платформой для получения данных для копирования в буфер обмена.|  
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Вызывается платформой для создания составного меню.|  
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Вызывается платформой для удаления меню контейнера из составного меню.|  
|[COleClientItem::OnSetMenu](#onsetmenu)|Вызывается платформой для установки и удаления составного меню.|  
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Вызывается платформой для отображения или скрытия панели элементов управления.|  
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Вызывается платформой для обновления заголовка фрейма окна.|  
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Повторной активации элемента и отменяет последнюю операцию редактирования по месту.|  
|[COleClientItem::Release](#release)|Освобождает соединение для связанного элемента OLE и закрывает его, если он был открыт. Уничтожает клиентский элемент.|  
|[COleClientItem::Reload](#reload)|Перезагружает элемент после вызова `ActivateAs`.|  
|[COleClientItem::Run](#run)|Запускается приложение, связанное с элементом.|  
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Задает текущее представление элемента для подготовки к просмотру.|  
|[COleClientItem::SetExtent](#setextent)|Задает ограничивающего прямоугольника элемента OLE.|  
|[COleClientItem::SetHostNames](#sethostnames)|Задает имена, сервер отображает при редактировании объекта OLE.|  
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Кэширует метафайла, используемую для рисования значка элемента.|  
|[COleClientItem::SetItemRects](#setitemrects)|Задает ограничивающего прямоугольника элемента.|  
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Задает режим обновления для связанного элемента (дополнительная возможность).|  
|[COleClientItem::SetPrintDevice](#setprintdevice)|Задает печати целевого устройства для этого элемента клиента.|  
|[COleClientItem::UpdateLink](#updatelink)|Обновляет кэш представления элемента.|  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleClientItem::CanActivate](#canactivate)|Вызывается платформой для определения, разрешен ли активация на месте.|  
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Вызывается платформой при изменении положения элемента.|  
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Вызывается платформой для отмены после активации.|  
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Вызывается платформой для отмены сведения о состоянии отмены для данного элемента.|  
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Вызывается платформой для получения прямоугольника обрезки координаты элемента.|  
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Вызывается платформой для получения позиции относительно представления.|  
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Вызывается платформой при активации элемента на месте.|  
|[COleClientItem::OnScrollBy](#onscrollby)|Вызывается платформой, чтобы прокрутить элемент в представлении.|  
|[COleClientItem::OnShowItem](#onshowitem)|Вызывается платформой для отображения объекта OLE.|  
  
## <a name="remarks"></a>Примечания  
 Объект OLE представляет данные, создается и обслуживается серверного приложения, который может быть «» встраивается в документ для отображения пользователю, чтобы быть одного документа. Результатом является элемент OLE и содержащего документа «составной документ».  
  
 Объект OLE могут быть внедрены или связаны. Если он встроен, его данные хранятся как часть составного документа. Если он связан, его данные хранятся как часть отдельный файл, созданный приложением сервера и ссылку на этот файл хранится в составных документов. Все элементы OLE содержат сведения, указав серверное приложение, который должен быть вызван для их изменения.  
  
 `COleClientItem` определяет несколько переопределяемые функции, которые вызываются в ответ на запросы из серверного приложения; Эти переопределяемости обычно в качестве уведомления. Это позволяет приложению сервера для информирования контейнера изменения, внесенные пользователем, при редактировании объекта OLE и получать сведения, необходимые во время редактирования.  
  
 `COleClientItem` может использоваться с любой [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), или [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) класса. Для использования `COleClientItem`, создайте класс, производный от него и реализации [OnChange](#onchange) функция-член, который определяет реакцию на изменения, внесенные в элемент контейнера. Для поддержки активации по месту, переопределите [OnGetItemPosition](#ongetitemposition) функции-члена. Эта функция предоставляет сведения о положении отображаемого элемента OLE.  
  
 Дополнительные сведения об использовании интерфейса контейнера см. в статьях [контейнеры: реализация контейнера](../../mfc/containers-implementing-a-container.md) и [активации](../../mfc/activation-cpp.md).  
  
> [!NOTE]
>  Пакет Windows SDK ссылается на внедренные и связанные элементы, как «объекты» и ссылается на типы элементов в виде «классы». Эта ссылка используется термин «item» для выделения объекта OLE из соответствующего объекта C++ и термин «тип» для различения категории OLE класс C++.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CDocItem](../../mfc/reference/cdocitem-class.md)  
  
 `COleClientItem`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxole.h  
  
##  <a name="activate"></a>  COleClientItem::Activate  
 Эта функция вызывается для выполнения указанной команды вместо [DoVerb](#doverb) , которая может выполнять собственную обработку, когда возникает исключение.  
  
```  
void Activate(
    LONG nVerb,  
    CView* pView,  
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `nVerb`  
 Указывает команду для выполнения. Он может принимать одно из следующих:  
  
|Значение|Значение|Символ|  
|-----------|-------------|------------|  
|- 0|первичный глагол|`OLEIVERB_PRIMARY`|  
|- 1|Команда получателя|(Нет)|  
|- 1|Отображение элемента для редактирования|`OLEIVERB_SHOW`|  
|- 2|Изменение элемента в отдельном окне|`OLEIVERB_OPEN`|  
|- 3|Скрытие элемента|`OLEIVERB_HIDE`|  
  
 Значение-1, обычно является псевдонимом для другой команды. Если открыть изменения не поддерживается, -2 действует так же, как -1. Для всех дополнительных значений в разделе [функция IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) в Windows SDK.  
  
 `pView`  
 Указатель на окно представления контейнер, содержащий элемент OLE; используется приложением сервера для активации на месте. Этот параметр должен быть **NULL** Если контейнер не поддерживает активацию на месте.  
  
 `lpMsg`  
 Указатель на сообщение, вызвавшее его, чтобы активировать.  
  
### <a name="remarks"></a>Примечания  
 Если серверное приложение было написано с помощью библиотеки классов Microsoft Foundation, эта функция приводит [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) функция-член соответствующего `COleServerItem` объекта для выполнения.  
  
 Если первичный глагол редактирования и равно нулю в `nVerb` параметр серверное приложение запускается для разрешить объекта OLE, который нужно изменить. Если приложение-контейнер поддерживает активацию на месте, изменение возможно на месте. Если контейнер не поддерживает активация на месте (или если указано, команда Open), сервер запускается в отдельном окне и изменение возможно существует. Как правило, при приложения-контейнера двойном щелчке элемента OLE значение первичный глагол в `nVerb` параметр определяет действие, которое может выполнить пользователь. Тем не менее, если сервер поддерживает только одно действие, необходимое этого действия, независимо от того, что значение указывается в `nVerb` параметра.  
  
 Дополнительные сведения см. в разделе [функция IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) в Windows SDK.  
  
##  <a name="activateas"></a>  COleClientItem::ActivateAs  
 Использует средства преобразования объекта OLE для активации элемента, как если бы он объект этого типа, заданного параметром `clsidNew`.  
  
```  
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,  
    REFCLSID clsidOld,  
    REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszUserType*  
 Указатель на строку, представляющую тип объекта пользователя, например «Документ Word».  
  
 *clsidOld*  
 Ссылка на класс текущего элемента по идентификатору. Идентификатор класса должно представлять тип фактического объекта, по мере сохранения, если он не является ссылка. В этом случае следует CLSID элемента, на который ссылается связь. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) автоматически предоставляет идентификатор правильный класс для элемента.  
  
 `clsidNew`  
 Ссылка на идентификатор целевого класса  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Это называется автоматически [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Он не вызывается обычно напрямую.  
  
##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject  
 Эта функция вызывается для инициализации [COleDataObject](../../mfc/reference/coledataobject-class.md) для доступа к данным в элементе OLE.  
  
```  
void AttachDataObject(COleDataObject& rDataObject) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *rDataObject*  
 Ссылка на `COleDataObject` объект, который будет инициализирована, чтобы разрешить доступ к данным в элементе OLE.  
  
##  <a name="canactivate"></a>  COleClientItem::CanActivate  
 Вызывается платформой, когда пользователь запрашивает встроенной активации элемента OLE; Эта функция возвращаемое значение определяет, разрешена ли активация на месте.  
  
```  
virtual BOOL CanActivate();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если разрешена активация на месте; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию позволяет встроенной активации, если контейнер имеет допустимый окна. Переопределите эту функцию для реализации специальную логику для принятия или отклоняет запрос на активацию. Например запрос на активацию может быть отклонен, если элемент OLE слишком маленькими, либо в настоящее время не отображается.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceSite::CanInPlaceActivate](http://msdn.microsoft.com/library/windows/desktop/ms691236) в Windows SDK.  
  
##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData  
 Проверяет, является ли приложение контейнера можно создать внедренный объект из заданного `COleDataObject` объекта.  
  
```  
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataObject`  
 Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объекта, из которого будет создаваться элемента OLE.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если контейнер можно создать внедренный объект из `COleDataObject` объект; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 `COleDataObject` Класс используется в передаче данных для извлечения данных в разных форматах из буфера обмена путем перетаскивания или из встроенного элемента OLE.  
  
 Контейнеры эту функцию можно использовать, чтобы решить включить или отключить их команд Вставить, изменить и Специальная вставка.  
  
 Дополнительные сведения см. в статье [объектов данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData  
 Проверяет, может ли приложение контейнера создать связанный объект из заданного `COleDataObject` объекта.  
  
```  
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataObject`  
 Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объекта, из которого будет создаваться элемента OLE.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если контейнер можно создать связанный объект из `COleDataObject` объекта.  
  
### <a name="remarks"></a>Примечания  
 `COleDataObject` Класс используется в передаче данных для извлечения данных в разных форматах из буфера обмена путем перетаскивания или из встроенного элемента OLE.  
  
 Чтобы решить включить или отключить их команды Специальная вставка и изменение связать эту функцию можно использовать контейнеры.  
  
 Дополнительные сведения см. в статье [объектов данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="canpaste"></a>  COleClientItem::CanPaste  
 Вызывайте эту функцию, чтобы увидеть, можно ли вставить из буфера обмена встроенного элемента OLE.  
  
```  
static BOOL PASCAL CanPaste();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если встроенного элемента OLE можно вставить из буфера обмена; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) и [OleQueryCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms683739) в Windows SDK.  
  
##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink  
 Вызывайте эту функцию, чтобы увидеть, является ли связанный элемент OLE можно вставить из буфера обмена.  
  
```  
static BOOL PASCAL CanPasteLink();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если связанный элемент OLE можно вставить из буфера обмена; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) и [OleQueryLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms690244) в Windows SDK.  
  
##  <a name="close"></a>  COleClientItem::Close  
 Эта функция вызывается для изменения состояния объекта OLE из активного состояния в загруженное состояние, то есть, загрузить его обработчиком в памяти, но сервер не работает.  
  
```  
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```  
  
### <a name="parameters"></a>Параметры  
 `dwCloseOption`  
 Флаг, указывающий, при каких обстоятельствах объекта OLE сохраняется при возвращении в загруженное состояние. Он может принимать одно из следующих значений:  
  
- `OLECLOSE_SAVEIFDIRTY` Сохранение элемента OLE.  
  
- `OLECLOSE_NOSAVE` Не сохраняйте элемента OLE.  
  
- `OLECLOSE_PROMPTSAVE` Запрос на необходимость сохранения элемента OLE.  
  
### <a name="remarks"></a>Примечания  
 Эта функция не имеет значения при объекта OLE не запущена.  
  
 Дополнительные сведения см. в разделе [IOleObject::Close](http://msdn.microsoft.com/library/windows/desktop/ms683922) в Windows SDK.  
  
##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem  
 Создает `COleClientItem` объекта и добавляет его в документе-контейнере коллекцию элементов документа, которая создает объект C++ и не выполняет инициализацию OLE.  
  
```  
COleClientItem(COleDocument* pContainerDoc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pContainerDoc`  
 Указатель на документ контейнера, который будет содержать этот элемент. Это может быть любой [COleDocument](../../mfc/reference/coledocument-class.md) производный класс.  
  
### <a name="remarks"></a>Примечания  
 Если передать **NULL** указатель, добавление не выполняется в документе-контейнере. Необходимо явным образом вызвать [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).  
  
 Необходимо вызовите один из следующих функций-членов создания перед использованием объекта OLE.  
  
- [CreateFromClipboard](#createfromclipboard)  
  
- [CreateFromData](#createfromdata)  
  
- [CreateFromFile](#createfromfile)  
  
- [CreateStaticFromClipboard](#createstaticfromclipboard)  
  
- [CreateStaticFromData](#createstaticfromdata)  
  
- [CreateLinkFromClipboard](#createlinkfromclipboard)  
  
- [CreateLinkFromData](#createlinkfromdata)  
  
- [CreateLinkFromFile](#createlinkfromfile)  
  
- [CreateNewItem](#createnewitem)  
  
- [CreateCloneFrom](#createclonefrom)  
  
##  <a name="convertto"></a>  COleClientItem::ConvertTo  
 Вызовите эту функцию-член для преобразования в тип, указанный в элемент `clsidNew`.  
  
```  
virtual BOOL ConvertTo(REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Параметры  
 `clsidNew`  
 Идентификатор класса типа целевого объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Это называется автоматически [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Прямой вызов необязателен.  
  
##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard  
 Эта функция используется для копирования в буфер обмена элемента OLE.  
  
```  
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```  
  
### <a name="parameters"></a>Параметры  
 `bIncludeLink`  
 **Значение TRUE,** Если сведения о связи должны копироваться в буфер обмена, позволяя связанный элемент вставленные; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 Как правило эта функция вызывается при написании обработчиков сообщений для команды Копировать или вырезать из меню "Правка". Выбор элемента необходимо реализовать в приложения-контейнера, если необходимо реализовать команды Копировать или Вырезать.  
  
 Дополнительные сведения см. в разделе [OleSetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms686623) в Windows SDK.  
  
##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom  
 Эта функция вызывается для создания копии указанного элемента OLE.  
  
```  
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```  
  
### <a name="parameters"></a>Параметры  
 *pSrcItem*  
 Указатель на элемент OLE дублирование.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Копия будет идентична исходного элемента. Эта функция используется для поддержки операций отмены.  
  
##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard  
 Эта функция вызывается для создания внедренного элемента из содержимого буфера обмена.  
  
```  
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Вы обычно эта функция вызывается из обработчика сообщений вставить команду в меню "Правка". (Команда Вставить включен платформой, если [CanPaste](#canpaste) функция-член возвращает ненулевое значение.)  
  
 Дополнительные сведения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createfromdata"></a>  COleClientItem::CreateFromData  
 Эта функция вызывается для создания внедренного элемента из `COleDataObject` объекта.  
  
```  
BOOL CreateFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataObject`  
 Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объекта, из которого будет создаваться элемента OLE.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Укажите операций передачи данных, таких как вставки из буфера обмена или операции перетаскивания и вставки `COleDataObject` объектов, содержащий сведения, предоставляемые серверного приложения. Обычно он используется в переопределении [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).  
  
 Дополнительные сведения см. в разделе [OleCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms691211), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile  
 Эта функция вызывается для создания встроенного элемента OLE из файла.  
  
```  
BOOL CreateFromFile(
    LPCTSTR lpszFileName,  
    REFCLSID clsid = CLSID_NULL,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszFileName`  
 Указатель на имя файла, из которого будет создаваться элемента OLE.  
  
 `clsid`  
 Зарезервировано для будущего использования.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Платформа вызывает эту функцию из [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) при выборе ОК в диалоговом окне Вставка объекта при выборе создания меню кнопки «файл».  
  
 Дополнительные сведения см. в разделе [OleCreateFromFile](http://msdn.microsoft.com/library/windows/desktop/ms690116), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard  
 Эта функция вызывается для создания связанного элемента из содержимого буфера обмена.  
  
```  
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Вы обычно эта функция вызывается из обработчика сообщений связать команду в меню "Правка". (Команда Вставить связь включена в реализации по умолчанию [COleDocument](../../mfc/reference/coledocument-class.md) если буфер обмена содержит объект OLE, который может быть связан с.)  
  
 Дополнительные сведения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData  
 Эта функция вызывается для создания связанного элемента из `COleDataObject` объекта.  
  
```  
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataObject`  
 Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объекта, из которого будет создаваться элемента OLE.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Вызовите это во время операции перетаскивания, если пользователь указывает, что необходимо создать ссылку. Он также может использоваться для обработки команд Вставить, изменить. Он вызывается платформой в `COleClientItem::CreateLinkFromClipboard` и [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) Если был выбран параметр ссылки.  
  
 Дополнительные сведения см. в разделе [OleCreateLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms680731), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile  
 Эта функция вызывается для создания связанного объекта OLE из файла.  
  
```  
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszFileName`  
 Указатель на имя файла, из которого будет создаваться элемента OLE.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Платформа вызывает эту функцию, если пользователь выбирает ОК в диалоговом окне Вставка объекта, если выбрано создание меню кнопки «файл» и установлен флажок. Вызывается из [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).  
  
 Дополнительные сведения см. в разделе [OleCreateLinkToFile](http://msdn.microsoft.com/library/windows/desktop/ms678434), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem  
 Эта функция вызывается для создания внедренного элемента; Эта функция запускает приложения сервера, которая позволяет пользователю создавать элемента OLE.  
  
```  
BOOL CreateNewItem(
    REFCLSID clsid,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `clsid`  
 Идентификатор, который однозначно определяет тип создаваемого элемента OLE.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Платформа вызывает эту функцию, если пользователь выбирает ОК в диалоговом окне Вставка объекта, если выбрана кнопка «Создать».  
  
 Дополнительные сведения см. в разделе [OleCreate](http://msdn.microsoft.com/library/windows/desktop/ms678409), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard  
 Эта функция вызывается для создания статического элемента из содержимого буфера обмена.  
  
```  
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Статический элемент содержит представления данных, но не собственные данные; поэтому его нельзя редактировать. Эта функция обычно вызывается при [CreateFromClipboard](#createfromclipboard) сбое функции-члена.  
  
 Дополнительные сведения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData  
 Эта функция вызывается для создания статического элемента из `COleDataObject` объекта.  
  
```  
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataObject`  
 Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объекта, из которого будет создаваться элемента OLE.  
  
 *Визуализации*  
 Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) в Windows SDK.  
  
 `cfFormat`  
 Задает формат данных буфер обмена для кэширования при создании объекта OLE.  
  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, используемая при *визуализации* — **OLERENDER_FORMAT** или **OLERENDER_DRAW**. Укажите значение для этого параметра только в том случае, если вы хотите указать формат дополнительных сведений Помимо буфера обмена с форматом, заданным `cfFormat`. Если этот параметр не указан, используются значения по умолчанию для других полей в **FORMATETC** структуры.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Статический элемент содержит представления данных, но не собственные данные; Следовательно его нельзя редактировать. Именно так же, как [CreateStaticFromClipboard](#createstaticfromclipboard) за исключением того, что статический элемент может быть создан из произвольный `COleDataObject`, а не только из буфера обмена.  
  
 Используется в [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) при выборе Static.  
  
 Дополнительные сведения см. в разделе [OleCreateStaticFromData](http://msdn.microsoft.com/library/windows/desktop/ms687290), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), и [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) в Windows SDK.  
  
##  <a name="deactivate"></a>  COleClientItem::Deactivate  
 Эта функция вызывается для деактивировать объекта OLE и освободить все связанные ресурсы.  
  
```  
void Deactivate();
```  
  
### <a name="remarks"></a>Примечания  
 Обычно деактивировать активный объект OLE на месте, при щелчке мышью на клиентскую область вне границ элемента. Обратите внимание, что деактивации объекта OLE удалит его состояние отмены, запрещая вызова [ReactivateAndUndo](#reactivateandundo) функции-члена.  
  
 Если приложение поддерживает отмены, не следует вызывать `Deactivate`; вместо этого вызовите [DeactivateUI](#deactivateui).  
  
 Дополнительные сведения см. в разделе [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) в Windows SDK.  
  
##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI  
 Эта функция вызывается, когда пользователь делает элемент, который был активирован на месте.  
  
```  
void DeactivateUI();
```  
  
### <a name="remarks"></a>Примечания  
 Эта функция пользовательского интерфейса из приложения контейнера восстанавливает в исходное состояние, скрытие любого меню и других элементов управления, которые были созданы для активации на месте.  
  
 Эта функция не сбрасывает сведения о состоянии отмены для элемента. Информация сохраняется, чтобы [ReactivateAndUndo](#reactivateandundo) позже может использоваться для выполнения команды отмены в серверном приложении, в случае, если команда undo контейнера выбирается сразу после деактивации элемента.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) в Windows SDK.  
  
##  <a name="delete"></a>  COleClientItem::Delete  
 Эта функция вызывается для удаления элемента OLE в документе-контейнере.  
  
```  
void Delete(BOOL bAutoDelete = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `bAutoDelete`  
 Указывает, является ли элемент удален из документа.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывает [выпуска](#release) функция-член, который в свою очередь удаляет объекта C++ для элемента, безвозвратно удаления объекта OLE из документа. Если внедренного объекта OLE собственные данные для элемента удаляется. Всегда закрывается серверу; Таким образом Если элемент является открыть ссылку, эта функция закрывает его.  
  
##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop  
 Вызовите `DoDragDrop` функции-члена для выполнения операции перетаскивания и вставки.  
  
```  
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,  
    CPoint ptOffset,  
    BOOL bIncludeLink = FALSE,  
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,  
    LPCRECT lpRectStartDrag = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpItemRect`  
 Прямоугольник элемента на экране в клиентских координатах (в пикселях).  
  
 `ptOffset`  
 Смещение от `lpItemRect` положением позиции мыши во время операции перетаскивания.  
  
 `bIncludeLink`  
 Задайте значение **TRUE** Если связать данные следует копировать в буфер обмена. Задайте для него значение **FALSE** Если серверное приложение не поддерживает ссылки.  
  
 `dwEffects`  
 Определяет эффекты, которые источник перетаскивания разрешает в операции перетаскивания.  
  
 `lpRectStartDrag`  
 Указатель на прямоугольник, который определяет, где фактически начинает перетаскивание. Дополнительные сведения см. в разделе "Примечания".  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение `DROPEFFECT`. Если это `DROPEFFECT_MOVE`, следует удалить исходных данных.  
  
### <a name="remarks"></a>Примечания  
 Операции перетаскивания и вставки не начинается немедленно. Он ожидает, пока курсор мыши выходит за пределы прямоугольника, определяемого `lpRectStartDrag` или пока не были пройдены указанного числа миллисекунд. Если `lpRectStartDrag` — **NULL**, размер прямоугольника равно одному пикселю.  
  
 Время задержки задается параметр раздела реестра. Время задержки можно изменить путем вызова [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) или [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Если время задержки не указан, используется значение по умолчанию 200 миллисекунд. Время задержки перетащите хранится следующим образом:  
  
-   Время задержки Windows NT перетащите хранится в HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.  
  
-   Время задержки перетащите 3.x Windows хранится в WIN. INI-файл, в разделе [Windows}.  
  
-   Время задержки Windows 95/98 перетащите хранится в кэшированная версия WIN. INI-ФАЙЛЕ.  
  
 Для перетащите Дополнительные сведения о том, как задержки сведения хранятся в реестре или. INI-файл, в разделе [WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) в Windows SDK.  
  
##  <a name="doverb"></a>  COleClientItem::DoVerb  
 Вызовите `DoVerb` для выполнения указанной команды.  
  
```  
virtual BOOL DoVerb(
    LONG nVerb,  
    CView* pView,
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `nVerb`  
 Указывает команду для выполнения. Он может включать одно из следующих:  
  
|Значение|Значение|Символ|  
|-----------|-------------|------------|  
|- 0|первичный глагол|`OLEIVERB_PRIMARY`|  
|- 1|Команда получателя|(Нет)|  
|- 1|Отображение элемента для редактирования|`OLEIVERB_SHOW`|  
|- 2|Изменение элемента в отдельном окне|`OLEIVERB_OPEN`|  
|- 3|Скрытие элемента|`OLEIVERB_HIDE`|  
  
 Значение-1, обычно является псевдонимом для другой команды. Если открыть изменения не поддерживается, -2 действует так же, как -1. Для всех дополнительных значений в разделе [функция IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) в Windows SDK.  
  
 `pView`  
 Указатель на окно представления; используется сервером для активации на месте. Этот параметр должен быть **NULL** Если приложение-контейнер не допускает активации на месте.  
  
 `lpMsg`  
 Указатель на сообщение, вызвавшее его, чтобы активировать.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если команда была выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывает [активировать](#activate) функции-члена для выполнения команды. Также перехватывает исключения и отображает окно сообщения для пользователя, если оно создается.  
  
 Если первичный глагол редактирования и равно нулю в `nVerb` параметр серверное приложение запускается для разрешить объекта OLE, который нужно изменить. Если приложение-контейнер поддерживает активацию на месте, изменение возможно на месте. Если контейнер не поддерживает активация на месте (или если указано, команда Open), сервер запускается в отдельном окне и изменение возможно существует. Как правило, при приложения-контейнера двойном щелчке элемента OLE значение первичный глагол в `nVerb` параметр определяет действие, которое может выполнить пользователь. Тем не менее, если сервер поддерживает только одно действие, необходимое этого действия, независимо от того, что значение указывается в `nVerb` параметра.  
  
##  <a name="draw"></a>  COleClientItem::Draw  
 Эта функция вызывается для отрисовки элемента OLE в указанный ограничивающего прямоугольника, с помощью заданного контекста устройств.  
  
```  
BOOL Draw(
    CDC* pDC,  
    LPCRECT lpBounds,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Указатель на [CDC](../../mfc/reference/cdc-class.md) объект, используемый для рисования элемента OLE.  
  
 `lpBounds`  
 Указатель на [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или `RECT` структура, определяющая ограничивающего прямоугольника для рисования объекта OLE (в логических единицах определяется контекст устройства).  
  
 `nDrawAspect`  
 Указывает аспект OLE элемента, то есть его отображения. Если `nDrawAspect` равно -1, устанавливается с помощью Последняя особенность [SetDrawAspect](#setdrawaspect) используется. Дополнительные сведения о возможных значениях этого флага см. в разделе [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Функция может использовать метафайла представление элемента OLE, созданного [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) функции-члена `COleServerItem`.  
  
 Как правило, использовать **нарисовать** для отображения на экране, передавая контекст устройства экрана как `pDC`. В этом случае необходимо указать только первые два параметра.  
  
 `lpBounds` Указывает прямоугольник в контексте целевого устройства (относительно его текущего режима сопоставления). Отрисовка может включать в себя масштаба рисунка и может использоваться приложением-контейнером для наложения представление, которое выполняет масштабирование между отображаемого представления и печатного изображения.  
  
 Дополнительные сведения см. в разделе [IViewObject::Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655) в Windows SDK.  
  
##  <a name="getactiveview"></a>  COleClientItem::GetActiveView  
 Возвращает представление, на котором она активирована на месте.  
  
```  
CView* GetActiveView() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на представления; в противном случае **NULL** Если элемент не активировано на месте.  
  
##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent  
 Эта функция вызывается для получения размера объекта OLE.  
  
```  
BOOL GetCachedExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Параметры  
 `lpSize`  
 Указатель на **размер** структуры или [CSize](../../atl-mfc-shared/reference/csize-class.md) объекта, который будет получать сведения о размере.  
  
 `nDrawAspect`  
 Указывает аспект объекта OLE, границы которого должны быть получены. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если успешно; 0, если элемент OLE является пустым.  
  
### <a name="remarks"></a>Примечания  
 Эта функция предоставляет те же сведения о [GetExtent](#getextent). Тем не менее, можно вызвать `GetCachedExtent` для получения сведений экстент во время обработки других обработчиков OLE, таких как [OnChange](#onchange). Измерения — в `MM_HIMETRIC` единицы.  
  
 Это возможно, так как `GetCachedExtent` использует [IViewObject2](http://msdn.microsoft.com/library/windows/desktop/ms691318) интерфейс, а не использовать [IOleObject](http://msdn.microsoft.com/library/windows/desktop/dd542709) интерфейс для получения величины этого элемента. **IViewObject2** COM-объект кэширует экстента данных, используемых в предыдущем вызове [IViewObject::Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655).  
  
 Дополнительные сведения см. в разделе [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) в Windows SDK.  
  
##  <a name="getclassid"></a>  COleClientItem::GetClassID  
 Возвращает идентификатор класса элемента в память, на который указывает `pClassID`.  
  
```  
void GetClassID(CLSID* pClassID) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `pClassID`  
 Указатель на идентификатор типа [CLSID](http://msdn.microsoft.com/library/windows/desktop/ms691424) для получения идентификатора класса. Сведения о **CLSID**, см. в Windows SDK.  
  
### <a name="remarks"></a>Примечания  
 Идентификатор класса — 128-разрядное число, которое однозначно определяет приложение, которое изменяет элемент.  
  
 Дополнительные сведения см. в разделе [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) в Windows SDK.  
  
##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData  
 Эта функция вызывается для получения `COleDataSource` объект, содержащий все данные, которые были бы расставлены в буфере обмена, путем вызова [CopyToClipboard](#copytoclipboard) функции-члена.  
  
```  
void GetClipboardData(
    COleDataSource* pDataSource,  
    BOOL bIncludeLink = FALSE,  
    LPPOINT lpOffset = NULL,  
    LPSIZE lpSize = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `pDataSource`  
 Указатель на [COleDataSource](../../mfc/reference/coledatasource-class.md) объекта, который будет получать данные, содержащиеся в элементе OLE.  
  
 `bIncludeLink`  
 **Значение TRUE,** Если связь данных должен быть включен; в противном случае **FALSE**.  
  
 `lpOffset`  
 Смещение курсора мыши от начала координат объекта в пикселях.  
  
 `lpSize`  
 Размер объекта в пикселях.  
  
### <a name="remarks"></a>Примечания  
 `GetClipboardData` вызывается как реализация по умолчанию [OnGetClipboardData](#ongetclipboarddata). Переопределить `OnGetClipboardData` только в том случае, если вы хотите предложить форматы данных, отличные от предлагаемых `CopyToClipboard`. Поместите в этих форматах `COleDataSource` объекта до или после вызова `CopyToClipboard`и затем передайте `COleDataSource` объект [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) функции. Например, если требуется позиция элемента OLE в документе-контейнере его отправляться в буфере обмена, можно определить собственный формат для передачи этой информации и поместите его в `COleDataSource` перед вызовом `CopyToClipboard`.  
  
##  <a name="getdocument"></a>  COleClientItem::GetDocument  
 Вызывайте эту функцию, чтобы получить указатель на документ, содержащий элемент OLE.  
  
```  
COleDocument* GetDocument() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на документ, содержащий элемент OLE. **Значение NULL** Если элемент не является частью документа.  
  
### <a name="remarks"></a>Примечания  
 Этот указатель позволяет получить доступ к `COleDocument` объект, который передается в качестве аргумента для `COleClientItem` конструктор.  
  
##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect  
 Вызовите `GetDrawAspect` функции-члена для определения текущего «аспекты» или отображения элемента.  
  
```  
DVASPECT GetDrawAspect() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение из `DVASPECT` перечисления, значения которой указаны в ссылке для [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Примечания  
 Пропорции указывается как элемент должен быть подготовлен к просмотру.  
  
##  <a name="getextent"></a>  COleClientItem::GetExtent  
 Эта функция вызывается для получения размера объекта OLE.  
  
```  
BOOL GetExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```  
  
### <a name="parameters"></a>Параметры  
 `lpSize`  
 Указатель на **размер** структуры или `CSize` объект, который будет получать сведения о размере.  
  
 `nDrawAspect`  
 Указывает аспект объекта OLE, границы которого должны быть получены. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если успешно; 0, если элемент OLE является пустым.  
  
### <a name="remarks"></a>Примечания  
 Если серверное приложение было написано с помощью библиотеки классов Microsoft Foundation, эта функция приводит [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) функция-член соответствующего `COleServerItem` объекта для вызова. Обратите внимание, что полученный размер может отличаться от размера последней установки [SetExtent](#setextent) функции-члена; размер, заданный свойством `SetExtent` рассматривается как предложение. Измерения — в `MM_HIMETRIC` единицы.  
  
> [!NOTE]
>  Не вызывайте `GetExtent` во время выполнения обработчика OLE, таких как [OnChange](#onchange). Вызовите [GetCachedExtent](#getcachedextent) вместо него.  
  
 Дополнительные сведения см. в разделе [IOleObject::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms692325) в Windows SDK.  
  
##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry  
 Вызовите эту функцию-член для получения дескриптора ресурс значка, связанного с сервером определенной CLSID.  
  
```  
HICON GetIconFromRegistry() const;  
  
static HICON GetIconFromRegistry(CLSID& clsid);
```  
  
### <a name="parameters"></a>Параметры  
 `clsid`  
 Ссылка на идентификатор CLSID для сервера, связанный со значком.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Допустимый дескриптор ресурс значка или **NULL** Если значок сервера или значок по умолчанию, не найден.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член не запустить сервер или получить значок динамически, даже если на сервере уже выполняется. Вместо этого данная функция-член открывает исполняемого образа сервера и извлекает статический значок, связанный с сервером, как она была зарегистрирована.  
  
##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile  
 Извлекает метафайла, используемую для рисования значка элемента.  
  
```  
HGLOBAL GetIconicMetafile();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор метафайла в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Если отсутствует текущий значок, возвращается значок по умолчанию. Это вызывается автоматически диалоговые окна MFC/OLE и обычно не вызывается напрямую.  
  
 Эта функция также вызывает [SetIconicMetafile](#seticonicmetafile) кэширование метафайла, предназначенную для последующего использования.  
  
##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow  
 Вызовите `GetInPlaceWindow` функцию-член, чтобы получить указатель на окно, в котором был открыт элемента для редактирования по месту.  
  
```  
CWnd* GetInPlaceWindow();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на окно редактирования элемента на месте; **NULL** Если элемент не активна или если его сервер недоступен.  
  
### <a name="remarks"></a>Примечания  
 Эта функция должен вызываться только для элементов, которые активно на месте.  
  
##  <a name="getitemstate"></a>  COleClientItem::GetItemState  
 Эта функция вызывается для получения текущего состояния объекта OLE.  
  
```  
UINT GetItemState() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект **COleClientItem::ItemState** перечислимое значение, может принимать одно из следующих действий: `emptyState`, **loadedState**, `openState`, `activeState`, `activeUIState`. Дополнительные сведения об этих состояниях см. в статье [контейнеры: состояния клиентских элементов](../../mfc/containers-client-item-states.md).  
  
### <a name="remarks"></a>Примечания  
 Чтобы получать уведомления при изменении состояния объекта OLE, используйте [OnChange](#onchange) функции-члена.  
  
 Дополнительные сведения см. в статье [контейнеры: состояния клиентских элементов](../../mfc/containers-client-item-states.md).  
  
##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus  
 Возвращает код состояния последней операции OLE.  
  
```  
SCODE GetLastStatus() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение `SCODE`.  
  
### <a name="remarks"></a>Примечания  
 Для члена функции, которые возвращают **BOOL** значение **FALSE**, или другой элемент функции, которые возвращают **NULL**, `GetLastStatus` возвращает более подробные сведения об ошибке. Имейте в виду, что большинство функций — членов OLE создавать исключения для более серьезных ошибок. Подробные сведения о Интерпретация `SCODE` зависит от базового вызова OLE, которые вернули последнего `SCODE` значение.  
  
 Дополнительные сведения о `SCODE`, в разделе [структуры из кодов ошибок модели COM](http://msdn.microsoft.com/library/windows/desktop/ms690088) документации по пакету Windows SDK.  
  
##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions  
 Эта функция вызывается для получения текущего значения параметра обновление связи для объекта OLE.  
  
```  
OLEUPDATE GetLinkUpdateOptions();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Одно из следующих значений:  
  
- `OLEUPDATE_ALWAYS` Обновите связанный элемент, когда это возможно. Этот параметр поддерживает автоматическое обновление связи переключатель в диалоговом окне связи.  
  
- `OLEUPDATE_ONCALL` Обновить связанный элемент только по запросу приложения-контейнера (когда [UpdateLink](#updatelink) вызове функции-члена). Этот параметр поддерживает обновление вручную связи переключатель в диалоговом окне связи.  
  
### <a name="remarks"></a>Примечания  
 Это является сложной операцией.  
  
 Эта функция вызывается автоматически [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) класса.  
  
 Дополнительные сведения см. в разделе [IOleLink::GetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680100) в Windows SDK.  
  
##  <a name="gettype"></a>  COleClientItem::GetType  
 Эта функция вызывается для определения внедренным или связанным объекта OLE или static.  
  
```  
OLE_OBJTYPE GetType() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Целое число без знака с одним из следующих значений:  
  
- `OT_LINK` Элемент OLE является ссылкой.  
  
- `OT_EMBEDDED` Внедренного объекта OLE.  
  
- `OT_STATIC` Элемент OLE является статическим, то есть, содержит только данные, не собственные данные и таким образом, не может быть изменен.  
  
##  <a name="getusertype"></a>  COleClientItem::GetUserType  
 Эта функция вызывается для получения видимыми строка, описывающая тип объекта OLE, например «Документ Word».  
  
```  
void GetUserType(
    USERCLASSTYPE nUserClassType,  
    CString& rString);
```  
  
### <a name="parameters"></a>Параметры  
 *nUserClassType*  
 Значение, указывающее нужный вариант строка, описывающая тип элемента OLE. Это может иметь одно из следующих значений:  
  
- `USERCLASSTYPE_FULL` Полное имя типа отображается для пользователя.  
  
- `USERCLASSTYPE_SHORT` Краткое имя (15 знаков) для использования в контекстных меню и диалоговое окно Изменение связей.  
  
- `USERCLASSTYPE_APPNAME` Имя класса обслуживания приложения.  
  
 `rString`  
 Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объект, к которому возвращается строка, описывающая тип элемента OLE.  
  
### <a name="remarks"></a>Примечания  
 Часто это запись в системную базу данных регистрации.  
  
 Если полное имя запрошенного, но недоступен, вместо него используется короткое имя. Если нет записи для типа элемента OLE не найден в базе данных регистрации, или если нет типов пользователь, зарегистрированный для типа элемента управления OLE, выберите тип пользователя в настоящее время хранятся в используется элемента OLE. Если имя типа этого пользователя является пустой строкой, используется «Неизвестный объект».  
  
 Дополнительные сведения см. в разделе [IOleObject::GetUserType](http://msdn.microsoft.com/library/windows/desktop/ms688643) в Windows SDK.  
  
##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive  
 Вызывайте эту функцию ли встроенная Активация элемента OLE.  
  
```  
BOOL IsInPlaceActive() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент OLE активен на месте; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Чаще всего для выполнения различных действий в зависимости от того, является ли элемент изменяется на месте. Функция проверяет, равен ли текущее состояние элемента либо `activeState` или `activeUIState`.  
  
##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate  
 Вызывайте эту функцию ли элемента OLE в актуальном состоянии.  
  
```  
BOOL IsLinkUpToDate() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент OLE является актуальным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Связанный элемент может устареть, если его исходный документ обновлена. Внедренный элемент, содержащий ссылки в нем можно аналогичным образом устареть. Функция выполняет проверку рекурсивного элемента OLE. Обратите внимание, что определение устарела объекта OLE может быть более дорогостоящим, чем фактически выполняет обновление.  
  
 Это называется автоматически [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) реализации.  
  
 Дополнительные сведения см. в разделе [IOleObject::IsUpToDate](http://msdn.microsoft.com/library/windows/desktop/ms686624) в Windows SDK.  
  
##  <a name="ismodified"></a>  COleClientItem::IsModified  
 Эта функция вызывается для объекта OLE ли «грязных» (изменено с момента последнего сохранения).  
  
```  
BOOL IsModified() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент OLE "грязный"; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [IPersistStorage::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) в Windows SDK.  
  
##  <a name="isopen"></a>  COleClientItem::IsOpen  
 Эта функция вызывается для объекта OLE ли открытым; то есть открывается в экземпляр серверное приложение, выполняющееся в отдельном окне.  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если открыт элемент OLE; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Он используется для определения времени рисования объекта с шаблон штриховки. Открытый объект должен иметь штриховая отображается поверх объекта. Можно использовать [CRectTracker](../../mfc/reference/crecttracker-class.md) объект для выполнения этой задачи.  
  
##  <a name="isrunning"></a>  COleClientItem::IsRunning  
 Вызывайте эту функцию, чтобы увидеть, работает ли элемент OLE; является ли элемент является загружен и запущен в серверном приложении.  
  
```  
BOOL IsRunning() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент OLE выполняется; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [OleIsRunning](http://msdn.microsoft.com/library/windows/desktop/ms688705) в Windows SDK.  
  
##  <a name="onactivate"></a>  COleClientItem::OnActivate  
 Вызывается платформой для оповещения элемента, он просто активации на месте.  
  
```  
virtual void OnActivate();
```  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что эта функция вызывается для указания, что сервер работает не для того, чтобы указать, что его пользовательский интерфейс был установлен в приложении-контейнере. На этом этапе объект не имеет активной пользовательский интерфейс (не `activeUIState`). Она не установлена его меню или панели инструментов. [OnActivateUI](#onactivateui) функция-член вызывается, когда это происходит.  
  
 Реализация по умолчанию вызывает [OnChange](#onchange) функцию-член с **OLE_CHANGEDSTATE** как параметр. Переопределите эту функцию для выполнения специальной обработки, когда элемент становится активным на месте.  
  
##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI  
 Платформа вызывает `OnActivateUI` , когда объект вводятся активное состояние пользовательского интерфейса.  
  
```  
virtual void OnActivateUI();
```  
  
### <a name="remarks"></a>Примечания  
 Объект установлены его панели инструментов и меню.  
  
 Реализация по умолчанию запоминает сервера `HWND` на более поздний срок **GetServerWindow** вызовов.  
  
##  <a name="onchange"></a>  COleClientItem::OnChange  
 Вызывается платформой, когда пользователь изменяет, сохраняет или закрывает элемента OLE.  
  
```  
virtual void OnChange(
    OLE_NOTIFICATION nCode,  
    DWORD dwParam);
```  
  
### <a name="parameters"></a>Параметры  
 `nCode`  
 По причине сервер изменен этот элемент. Он может принимать одно из следующих значений:  
  
- `OLE_CHANGED` Изменения внешнего вида элемента OLE.  
  
- `OLE_SAVED` Элемент OLE была сохранена.  
  
- `OLE_CLOSED` Элемент OLE был закрыт.  
  
- `OLE_CHANGED_STATE` Элемент OLE был изменен из одного состояния в другое.  
  
 `dwParam`  
 Если `nCode` — `OLE_SAVED` или `OLE_CLOSED`, этот параметр не используется. Если `nCode` — `OLE_CHANGED`, этот параметр задает пропорции объекта OLE, которая была изменена. Возможные значения см. в разделе `dwParam` параметр [COleClientItem::Draw](#draw). Если `nCode` — `OLE_CHANGED_STATE`, этот параметр является **COleClientItem::ItemState** значения перечисления и описывает состояние вводится. Он может иметь одно из следующих значений: `emptyState`, **loadedState**, `openState`, `activeState`, или `activeUIState`.  
  
### <a name="remarks"></a>Примечания  
 (Если серверное приложение создано с использованием библиотеки классов Microsoft Foundation, эта функция вызывается в ответ на `Notify` функциями-членами `COleServerDoc` или `COleServerItem`.) Реализация по умолчанию отмечает документа-контейнера, как измененный, если `nCode` — `OLE_CHANGED` или `OLE_SAVED`.  
  
 Для `OLE_CHANGED_STATE`, текущее состояние, возвращаемое из [GetItemState](#getitemstate) по-прежнему будет старое состояние, то есть состояния, которая была текущей до этого изменения состояния.  
  
 Переопределите эту функцию для реагирования на изменения в состоянии объекта OLE. Обычно обновлении внешнего вида элемента недействительный область, в котором отображается элемент. Вызовите реализацию базового класса в начале переопределения.  
  
##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition  
 Вызывается платформой для уведомления контейнера, в котором изменения расширения объекта OLE во время активации на месте.  
  
```  
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```  
  
### <a name="parameters"></a>Параметры  
 *rectPos*  
 Указывает расположение элемента относительно клиентской области его контейнера.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если позиции элемента успешно изменен; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию определяет новый прямоугольник видимой элемента OLE и вызывает [SetItemRects](#setitemrects) с новыми значениями. Реализация по умолчанию вычисляет Видимый прямоугольник для элемента и передает данные на сервер.  
  
 Переопределите эту функцию для применяются специальные правила для операции изменения размера или перемещения. Если приложение создано в MFC, этот вызов приводит, так как сервер называется [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).  
  
##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate  
 Вызывается платформой при переходе объекта OLE из активного состояния на месте ( `activeState`) в загруженное состояние, то есть отключается после активации на месте.  
  
```  
virtual void OnDeactivate();
```  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что эта функция вызывается для указания, что элемент OLE закрыто, не, его пользовательский интерфейс был удален из приложения-контейнера. Когда это происходит, [OnDeactivateUI](#ondeactivateui) вызвать функцию-член.  
  
 Реализация по умолчанию вызывает [OnChange](#onchange) функцию-член с **OLE_CHANGEDSTATE** как параметр. Переопределите эту функцию для выполнения специальной обработки при отключении активного элемента на месте. Например если команда undo поддерживаются в приложении контейнера, можно переопределить эту функцию, чтобы отменить состояния отмены, указывающее, что последняя операция, выполнить элемента OLE не может быть отменено, после деактивации элемента.  
  
##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo  
 Вызывается платформой, когда пользователь осуществляет команду отмены после активации элемента OLE на месте.  
  
```  
virtual void OnDeactivateAndUndo();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает [DeactivateUI](#deactivateui) отключить пользовательский интерфейс сервера. При реализации в приложении контейнера команда undo переопределите эту функцию. Во время переопределения вызова функции версии базового класса и затем отменить предыдущей команды в приложении.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceSite::DeactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms683743) в Windows SDK.  
  
##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI  
 Вызывается, когда пользователь делает неактивным элемент, который был активирован на месте.  
  
```  
virtual void OnDeactivateUI(BOOL bUndoable);
```  
  
### <a name="parameters"></a>Параметры  
 `bUndoable`  
 Указывает отменяемой внесения изменений.  
  
### <a name="remarks"></a>Примечания  
 Эта функция пользовательского интерфейса из приложения контейнера восстанавливает в исходное состояние, скрытие любого меню и других элементов управления, которые были созданы для активации на месте.  
  
 Если `bUndoable` — **FALSE**, контейнер следует отключить команда undo, фактически удаляя состояния отмены контейнера, так как он указывает, что последняя операция, выполненная на сервере не удастся.  
  
##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState  
 Вызывается платформой, когда пользователь выполняет действие, которое удаляет состояния отмены при редактировании объекта OLE.  
  
```  
virtual void OnDiscardUndoState();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию не выполняет никаких действий. При реализации в приложении контейнера команда undo переопределите эту функцию. Во время переопределения отказаться от состояния отмены приложения-контейнера.  
  
 Если сервер был записан с библиотеки классов Microsoft Foundation, сервер может привести к этой функции, которая вызывается путем вызова [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).  
  
 Дополнительные сведения см. в разделе [IOleInPlaceSite::DiscardUndoState](http://msdn.microsoft.com/library/windows/desktop/ms688642) в Windows SDK.  
  
##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData  
 Вызывается платформой для получения `COleDataSource` объект, содержащий все данные, которые были бы расставлены в буфере обмена, путем вызова либо [CopyToClipboard](#copytoclipboard) или [DoDragDrop](#dodragdrop) функции-члена.  
  
```  
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,  
    LPPOINT lpOffset,  
    LPSIZE lpSize);
```  
  
### <a name="parameters"></a>Параметры  
 `bIncludeLink`  
 Задайте значение **TRUE** Если связать данные следует копировать в буфер обмена. Задайте значение **FALSE** Если серверное приложение не поддерживает ссылки.  
  
 `lpOffset`  
 Указатель на Смещение курсора мыши от начала координат объекта в пикселях.  
  
 `lpSize`  
 Указатель на размер объекта в пикселях.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на [COleDataSource](../../mfc/reference/coledatasource-class.md) объект, содержащий данные из буфера обмена.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию эта функция вызывает [GetClipboardData](#getclipboarddata).  
  
##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect  
 Платформа вызывает `OnGetClipRect` функции-члена для получения координат прямоугольника обрезки элемента, который изменяется на месте.  
  
```  
virtual void OnGetClipRect(CRect& rClipRect);
```  
  
### <a name="parameters"></a>Параметры  
 *rClipRect*  
 Указатель на объект класса [CRect](../../atl-mfc-shared/reference/crect-class.md) , будет содержать координат прямоугольника обрезки элемента.  
  
### <a name="remarks"></a>Примечания  
 Координаты задаются в пикселях относительно клиентской области окна приложения контейнера.  
  
 Реализация по умолчанию просто возвращает клиентскую область представления, в которой элемент является активным на месте.  
  
##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition  
 Платформа вызывает `OnGetItemPosition` функции-члена для получения координат элемента, который изменяется на месте.  
  
```  
virtual void OnGetItemPosition(CRect& rPosition);
```  
  
### <a name="parameters"></a>Параметры  
 `rPosition`  
 Ссылка на [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, который будет содержать координаты расположения элемента.  
  
### <a name="remarks"></a>Примечания  
 Координаты задаются в пикселях относительно клиентской области окна приложения контейнера.  
  
 Реализация по умолчанию этой функции не выполняет никаких действий. Приложения, поддерживающие редактирования по месту требуется его реализации.  
  
##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext  
 Вызывается платформой при активации элемента на месте.  
  
```  
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,  
    CFrameWnd** ppDocFrame,  
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```  
  
### <a name="parameters"></a>Параметры  
 `ppMainFrame`  
 Указатель на указатель фрейма главного окна.  
  
 `ppDocFrame`  
 Указатель на указатель на окно фрейма документа.  
  
 `lpFrameInfo`  
 Указатель на [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) структуру, которая будет получать информацию об окне фрейма.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция используется для получения сведений о родительском окне объекта OLE.  
  
 Если контейнер является MDI-приложения, реализация по умолчанию возвращает указатель на [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) объекта в `ppMainFrame` и указатель на активный [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) объекта в `ppDocFrame`. Если контейнер является приложением SDI, реализация по умолчанию возвращает указатель на [CFrameWnd](../../mfc/reference/cframewnd-class.md) объекта в `ppMainFrame` и возвращает **NULL** в `ppDocFrame`. Реализация по умолчанию, а также заполняет члены `lpFrameInfo`.  
  
 Переопределить эту функцию только в том случае, если реализация по умолчанию не соответствуют приложения; Например, если приложение имеет парадигма пользовательского интерфейса, который отличается от SDI или MDI. Существует расширенная overridable.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceSite::GetWindowContext](http://msdn.microsoft.com/library/windows/desktop/ms694366) и [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) структуры в Windows SDK.  
  
##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus  
 Вызывается платформой при активации на месте для вставки меню приложения-контейнера в пустое меню.  
  
```  
virtual void OnInsertMenus(
    CMenu* pMenuShared,  
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```  
  
### <a name="parameters"></a>Параметры  
 `pMenuShared`  
 Указывает на пустое меню.  
  
 `lpMenuWidths`  
 Указывает на массив из шести **ДЛИННЫЕ** значений, указывающее, сколько меню в каждом из следующих групп меню: файл, изменить, контейнер, объект, в окне справки. Приложения-контейнера отвечает за файл, контейнер и окно группы меню, соответствующие элементам, 0, 2 и 4 данного массива.  
  
### <a name="remarks"></a>Примечания  
 Это меню, затем передается на сервер, который вставляет свой собственный меню, создание составного меню. Эта функция может вызываться несколько раз для построения несколько составного меню.  
  
 Реализация по умолчанию вставляет в `pMenuShared` меню контейнера в месте, то есть группы меню файл, контейнер и окна. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) используется для задания этого ресурса меню. Реализация по умолчанию также устанавливает соответствующие значения для элементов, 0, 2 и 4 в `lpMenuWidths`, в зависимости от ресурса меню. Переопределить эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для сопоставления ресурсов с типов документов. Если переопределить эту функцию, необходимо также переопределить [OnSetMenu](#onsetmenu) и [OnRemoveMenus](#onremovemenus). Существует расширенная overridable.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceFrame::InsertMenus](http://msdn.microsoft.com/library/windows/desktop/ms683987) в Windows SDK.  
  
##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus  
 Вызывается платформой для удаления из указанного составного меню меню контейнера, при завершении активации на месте.  
  
```  
virtual void OnRemoveMenus(CMenu* pMenuShared);
```  
  
### <a name="parameters"></a>Параметры  
 `pMenuShared`  
 Указывает составного меню, созданный путем вызова метода [OnInsertMenus](#oninsertmenus) функции-члена.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию удаляет из `pMenuShared` меню на месте контейнера, которая является, файл, контейнер и окно группы меню. Переопределить эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для сопоставления ресурсов с типов документов. Если эта функция переопределяется, возможно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnSetMenu](#onsetmenu) также. Существует расширенная overridable.  
  
 Подменю на `pMenuShared` может быть общим для нескольких составного меню, если сервер несколько раз вызывается `OnInsertMenus`. Поэтому не следует удалять вложенные в переопределении `OnRemoveMenus`; только следует отсоединить их.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceFrame::RemoveMenus](http://msdn.microsoft.com/library/windows/desktop/ms688685) в Windows SDK.  
  
##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy  
 Вызывается платформой для прокрутки элемента OLE в ответ на запросы с сервера.  
  
```  
virtual BOOL OnScrollBy(CSize sizeExtent);
```  
  
### <a name="parameters"></a>Параметры  
 *sizeExtent*  
 Указывает расстояния, в пикселях, могли выполнять прокрутку в x и y направлениях.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент был прокручивать; 0, если не выполнить прокрутку элемента.  
  
### <a name="remarks"></a>Примечания  
 Например если пользователь перемещает указатель за пределы видимой области во время выполнения редактирования по месту элемента OLE частично видимой, эта функция вызывается сохраняться видимость курсора. Реализация по умолчанию не выполняет никаких действий. Переопределите эту функцию для прокрутки элемента на заданную величину. Обратите внимание, что в результате прокрутки, видимую часть объекта OLE может изменить. Вызовите [SetItemRects](#setitemrects) обновляемого элемента Видимый прямоугольник.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceSite::Scroll](http://msdn.microsoft.com/library/windows/desktop/ms690291) в Windows SDK.  
  
##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu  
 Вызывается платформой два раза при активации на месте и окончания; в первый раз, чтобы установить составного меню и второй раз (с `holemenu` равно **NULL**) чтобы удалить его.  
  
```  
virtual void OnSetMenu(
    CMenu* pMenuShared,  
    HOLEMENU holemenu,  
    HWND hwndActiveObject);
```  
  
### <a name="parameters"></a>Параметры  
 `pMenuShared`  
 Указатель на составного меню, созданный путем вызова метода [OnInsertMenus](#oninsertmenus) функции-члена и `InsertMenu` функции.  
  
 `holemenu`  
 Дескриптор меню дескриптор, возвращенный **OleCreateMenuDescriptor** функция, или **NULL** при диспетчеризации код для удаления.  
  
 *hwndActiveObject*  
 Дескриптор окна редактирования для элемента OLE. Это окно, в который будет получать команды редактирования от OLE.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию устанавливает или удаляет составного меню, а затем вызывает [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831) функции для установки или удаления диспетчеризации кода. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения. Если эта функция переопределяется, возможно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnRemoveMenus](#onremovemenus) также. Существует расширенная overridable.  
  
 Дополнительные сведения см. в разделе [OleCreateMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms691415), [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831), и [IOleInPlaceFrame::SetMenu](http://msdn.microsoft.com/library/windows/desktop/ms693713) в Windows SDK.  
  
##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars  
 Вызывается платформой для отображения или скрытия панели приложения-контейнера элементов управления.  
  
```  
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,  
    BOOL bShow);
```  
  
### <a name="parameters"></a>Параметры  
 `pFrameWnd`  
 Указатель на фрейм окна приложения-контейнера. Это может быть фрейма главного окна или дочернего окна MDI.  
  
 `bShow`  
 Указывает ли панелей элементов управления должны быть отображены или скрыты.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов функции приводит к изменению в состоянии панели элементов управления; 0, если в результате вызова не меняется или `pFrameWnd` не указывает на контейнер окна фрейма.  
  
### <a name="remarks"></a>Примечания  
 Эта функция возвращает 0, если панелей элементов управления уже находятся в состоянии, указанном *bShow.* Такое может произойти, например, если скрыты панели элементов управления и `bShow` — **FALSE**.  
  
 Реализация по умолчанию удаляет панели инструментов в окне фрейма верхнего уровня.  
  
##  <a name="onshowitem"></a>  COleClientItem::OnShowItem  
 Вызывается платформой для отображения объекта OLE, станет полностью видимым во время редактирования.  
  
```  
virtual void OnShowItem();
```  
  
### <a name="remarks"></a>Примечания  
 Он используется, когда приложение контейнера поддерживает ссылки на внедренные элементы (то есть, в том случае, если производного класса документа из [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Эта функция вызывается во время активации на месте, либо когда объекта OLE источник связи, и пользователь хочет изменить его. Реализация по умолчанию активирует первое представление в документе-контейнере. Переопределите эту функцию, чтобы прокрутить документ, чтобы была видна элемента OLE.  
  
##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle  
 Вызывается платформой при активации на месте для обновления заголовка фрейма окна.  
  
```  
virtual BOOL OnUpdateFrameTitle();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если это функция успешно обновлены название рамки, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию не изменяет заголовок окна фрейма. Переопределить эту функцию, если требуется заголовок другой кадр для вашего приложения, например « *приложение server* - *элемента* в *имя_документа*» (как, «Microsoft Excel — электронной таблицы в отчете. ДОКУМЕНТ»). Существует расширенная overridable.  
  
##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo  
 Эта функция вызывается для повторной активации элемента OLE и отменить операцию последнее совершенное пользователем во время редактирования по месту.  
  
```  
BOOL ReactivateAndUndo();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Если команда undo поддерживает приложение контейнера, вызовите эту функцию, если пользователь нажимает кнопку команды отмены сразу после деактивации объекта OLE.  
  
 Если серверное приложение написано с помощью библиотеки классов Microsoft Foundation, эта функция приводит вызвать [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).  
  
 Дополнительные сведения см. в разделе [IOleInPlaceObject::ReactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms691372) в Windows SDK.  
  
##  <a name="release"></a>  COleClientItem::Release  
 Вызывайте эту функцию, чтобы очистить ресурсы, используемые объектом OLE.  
  
```  
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```  
  
### <a name="parameters"></a>Параметры  
 `dwCloseOption`  
 Флаг, указывающий, при каких обстоятельствах объекта OLE сохраняется при возвращении в загруженное состояние. Список возможных значений см. в разделе [COleClientItem::Close](#close).  
  
### <a name="remarks"></a>Примечания  
 **Выпуск** вызывается `COleClientItem` деструктор.  
  
 Дополнительные сведения см. в разделе [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) в Windows SDK.  
  
##  <a name="reload"></a>  COleClientItem::Reload  
 Закрывает и перезагружает элемента.  
  
```  
BOOL Reload();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Вызовите `Reload` функции после активации элемент как элемент другого типа с помощью вызова [ActivateAs](#activateas).  
  
##  <a name="run"></a>  COleClientItem::Run  
 Запускается приложение, связанное с этим элементом.  
  
```  
void Run();
```  
  
### <a name="remarks"></a>Примечания  
 Вызовите **запуска** функцию-член, чтобы запустить приложение сервера перед активацией элемента. Это делается автоматически [активировать](#activate) и [DoVerb](#doverb), поэтому он обычно не требуется для вызова этой функции. Эта функция вызывается, если это необходимо для запуска сервера, чтобы задать атрибут элемента, например [SetExtent](#setextent), перед выполнением [DoVerb](#doverb).  
  
##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect  
 Вызовите `SetDrawAspect` функция-член, задайте «аспекты» и представление элемента.  
  
```  
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```  
  
### <a name="parameters"></a>Параметры  
 `nDrawAspect`  
 Значение из перечисления `DVASPECT`. Этот параметр может принимать одно из следующих значений:  
  
- `DVASPECT_CONTENT` Элемент представлен таким образом, может быть отображен как внедренный объект внутри контейнера.  
  
- `DVASPECT_THUMBNAIL` Элемент отображается в представлении «эскиз», чтобы оно может отображаться в средстве просмотра.  
  
- `DVASPECT_ICON` Элемент будет представлен значок.  
  
- `DVASPECT_DOCPRINT` Элемент представляется, как если бы выводились с помощью команды «Печать» из меню «файл».  
  
### <a name="remarks"></a>Примечания  
 Пропорции определяет, как элемент должен быть обработан [нарисовать](#draw) при значение по умолчанию для этой функции `nDrawAspect` используется аргумент.  
  
 Эта функция вызывается автоматически изменить значок (и других диалоговых окнах, напрямую вызывать диалоговое окно Изменить значок) для включения отображения преобразованного в значок пропорции при запросе пользователем.  
  
##  <a name="setextent"></a>  COleClientItem::SetExtent  
 Вызывайте эту функцию, чтобы указать, сколько места доступно для объекта OLE.  
  
```  
void SetExtent(
    const CSize& size,  
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```  
  
### <a name="parameters"></a>Параметры  
 `size`  
 Объект [CSize](../../atl-mfc-shared/reference/csize-class.md) , содержащий сведения о размере.  
  
 `nDrawAspect`  
 Указывает аспект объекта OLE, границы которого должны быть заданы. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Примечания  
 Если серверное приложение было написано с помощью библиотеки классов Microsoft Foundation, в результате [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) функция-член соответствующего `COleServerItem` объекта для вызова. Элемент OLE затем соответствующим образом настроить его отображения. Размер должен быть в `MM_HIMETRIC` единицы. Эта функция вызывается при изменении пользователем размера объекта OLE или поддерживает определенные виды Согласование макета.  
  
 Дополнительные сведения см. в разделе [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330) в Windows SDK.  
  
##  <a name="sethostnames"></a>  COleClientItem::SetHostNames  
 Вызывайте эту функцию, чтобы указать имя приложения-контейнера и имя контейнера для встроенного элемента OLE.  
  
```  
void SetHostNames(
    LPCTSTR lpszHost,  
    LPCTSTR lpszHostObj);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszHost`  
 Указатель на видимое пользователю имя приложения-контейнера.  
  
 `lpszHostObj`  
 Указатель на строку идентификации контейнера, который содержит элемент OLE.  
  
### <a name="remarks"></a>Примечания  
 Если серверное приложение было написано с помощью библиотеки классов Microsoft Foundation, эта функция вызывает [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) функцию-член `COleServerDoc` документ, содержащий элемент OLE. Эта информация используется в заголовки окон при редактировании объекта OLE. Каждый раз, когда загружается документе-контейнере, платформа вызывает эту функцию для всех элементов OLE в документе. `SetHostNames` применяется только для встроенных элементов. Эта функция вызывается каждый раз, когда активируется встроенного элемента OLE для редактирования необязательно.  
  
 Это также называется автоматически с именем приложения и имя документа при загрузке объекта или при сохранении файла под другим именем. Соответственно не обычно требуется напрямую вызвать эту функцию.  
  
 Дополнительные сведения см. в разделе [IOleObject::SetHostNames](http://msdn.microsoft.com/library/windows/desktop/ms680642) в Windows SDK.  
  
##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile  
 Кэширует метафайла, используемую для рисования значка элемента.  
  
```  
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```  
  
### <a name="parameters"></a>Параметры  
 `hMetaPict`  
 Дескриптор метафайла, используемую для рисования значка элемента.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Используйте [GetIconicMetafile](#geticonicmetafile) для получения метафайл.  
  
 `hMetaPict` Параметр копируется в элемент; таким образом, `hMetaPict` освобождения вызывающим объектом.  
  
##  <a name="setitemrects"></a>  COleClientItem::SetItemRects  
 Вызовите эту функцию для задания ограничивающего прямоугольника или Видимый прямоугольник элемента OLE.  
  
```  
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,  
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *lprcPosRect*  
 Указатель на прямоугольник, содержащий границы объекта OLE, относительно его родительского окна, в клиентских координатах.  
  
 *lprcClipRect*  
 Указатель на прямоугольник, содержащий границы видимой части элемента OLE относительно его родительского окна, в клиентских координатах.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается с использованием реализации по умолчанию [OnChangeItemPosition](#onchangeitemposition) функции-члена. Эту функцию следует вызывать каждый раз, когда положения или видимую часть OLE элемента изменения. Обычно это означает вызов его из этого представления [OnSize](../../mfc/reference/cwnd-class.md#onsize) и [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) функции-члены.  
  
 Дополнительные сведения см. в разделе [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767) в Windows SDK.  
  
##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions  
 Вызывайте эту функцию для задания параметра обновление связи для представления указанного связанного элемента.  
  
```  
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```  
  
### <a name="parameters"></a>Параметры  
 *dwUpdateOpt*  
 Значение параметра обновление связи для этого элемента. Это значение должно быть одно из следующих значений:  
  
- `OLEUPDATE_ALWAYS` Обновите связанный элемент, когда это возможно. Этот параметр поддерживает автоматическое обновление связи переключатель в диалоговом окне связи.  
  
- `OLEUPDATE_ONCALL` Обновить связанный элемент только по запросу приложения-контейнера (когда [UpdateLink](#updatelink) вызове функции-члена). Этот параметр поддерживает обновление вручную связи переключатель в диалоговом окне связи.  
  
### <a name="remarks"></a>Примечания  
 Как правило не следует изменять параметры обновления, выбранного пользователем в диалоговом окне связи.  
  
 Дополнительные сведения см. в разделе [IOleLink::SetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680120) в Windows SDK.  
  
##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice  
 Вызывайте эту функцию, чтобы изменить печати целевого устройства для этого элемента.  
  
```  
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);  
BOOL SetPrintDevice(const PRINTDLG* ppd);
```  
  
### <a name="parameters"></a>Параметры  
 `ptd`  
 Указатель на [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) структуру данных, которая содержит сведения о новых печати целевого устройства. Может быть **NULL**.  
  
 `ppd`  
 Указатель на [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646940) структуру данных, которая содержит сведения о новых печати целевого устройства. Может быть **NULL**.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция обновляет печати целевое устройство для элемента, но не обновляет кэш презентации. Чтобы обновить кэш презентации для элемента, следует вызвать [UpdateLink](#updatelink).  
  
 Аргументы для этой функции содержат сведения, использует система OLE для идентификации целевого устройства. **PRINTDLG** структура содержит данные, используемые для инициализации общее диалоговое окно печати. После закрытия пользователем окно Windows возвращает сведения о выбора пользователя в этой структуре. `m_pd` Членом [CPrintDialog](../../mfc/reference/cprintdialog-class.md) объект **PRINTDLG** структуры.  
  
 Дополнительные сведения об этой структуры см. в разделе [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) в Windows SDK.  
  
 Дополнительные сведения см. в разделе [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) в Windows SDK.  
  
##  <a name="updatelink"></a>  COleClientItem::UpdateLink  
 Эта функция вызывается для немедленного обновления данных представления элемента OLE.  
  
```  
BOOL UpdateLink();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.  
  
### <a name="remarks"></a>Примечания  
 Для связанных элементов функция находит источник связи для получения новой презентации для элемента OLE. Этот процесс может потребоваться запуск одного или нескольких серверных приложений, которые может занять некоторое время. Для встроенных элементов работает рекурсивно, проверка, содержит ли встроенного элемента ссылки, которые могут быть устаревшими и их обновления. Пользователь может также вручную обновить отдельных ссылок, с помощью диалогового окна связи.  
  
 Дополнительные сведения см. в разделе [IOleLink::Update](http://msdn.microsoft.com/library/windows/desktop/ms692660) в Windows SDK.  
  
## <a name="see-also"></a>См. также  
 [Пример MFC MFCBIND](../../visual-cpp-samples.md)   
 [Пример MFC OCLIENT](../../visual-cpp-samples.md)   
 [Класс CDocItem](../../mfc/reference/cdocitem-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс COleServerItem](../../mfc/reference/coleserveritem-class.md)
