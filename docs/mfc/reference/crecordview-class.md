---
title: "CRecordView-класс | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CRecordView
- AFXDB/CRecordView
- AFXDB/CRecordView::CRecordView
- AFXDB/CRecordView::IsOnFirstRecord
- AFXDB/CRecordView::IsOnLastRecord
- AFXDB/CRecordView::OnGetRecordset
- AFXDB/CRecordView::OnMove
- AFXDB/CRecordView::OnMove
dev_langs:
- C++
helpviewer_keywords:
- CRecordView class
- ODBC recordsets, viewing records
- records, viewing ODBC
- views, ODBC
ms.assetid: 9b4b0897-bd50-4d48-a0b4-f3323f5ccc55
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 04ff47900037dcbaa12e2cba2c9a3e84caf54a69
ms.lasthandoff: 02/24/2017

---
# <a name="crecordview-class"></a>CRecordView-класс
Представление, которое отображает записи базы данных в элементах управления.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class AFX_NOVTABLE CRecordView : public CFormView  
```  
  
## <a name="members"></a>Члены  
  
### <a name="protected-constructors"></a>Защищенные конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CRecordView::CRecordView](#crecordview)|Создает объект `CRecordView`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CRecordView::IsOnFirstRecord](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записи в связанных записей.|  
|[CRecordView::IsOnLastRecord](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записи в связанных записей.|  
|[CRecordView::OnGetRecordset](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CRecordset`. ClassWizard переопределяет эту функцию для вас и при необходимости создает набор записей.|  
|[CRecordView::OnMove](#onmove)||  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CRecordView::OnMove](#onmove)|Если текущая запись была изменена, обновляет его в источнике данных, а затем переходит к указанной записи (следующего, предыдущего, первого или последнего).|  
  
## <a name="remarks"></a>Примечания  
 Это представление является представление формы, непосредственно подключенные к `CRecordset` объекта. Представление создается на основе ресурс шаблона диалоговых окон и отображает поля `CRecordset` в элементах управления шаблона диалогового окна. `CRecordView` Объект использует обмен данными (диалоговых окон DDX) и обмен полями записей (RFX) для автоматизации перемещения данных между элементами управления в форме и полями набора записей. `CRecordView`также предоставляет реализацию по умолчанию для перехода к первой, следующего, предыдущего или последней записи и интерфейс для обновления записи в данный момент в представлении.  
  
> [!NOTE]
>  Если вы работаете с классами объектов доступа к данным (DAO), а не классы Open Database Connectivity (ODBC), используйте класс [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) вместо. Дополнительные сведения см. в статье [Обзор: программирования баз данных](../../data/data-access-programming-mfc-atl.md).  
  
 Является наиболее распространенным способом для создание представления записей с помощью мастера приложений. Мастер приложений Tge создает класс представления записей и его класс связанных записей как часть приложения скелет начального уровня. Если не создать класс представления записей с помощью мастера приложений, можно создать ее позже с помощью классов. Если требуется просто одной форме, мастер приложений подход проще. ClassWizard позволяет решить, использование представления записей позже в процессе разработки. Использование классов для создания представления записей и записей отдельно и затем подключить их, самый гибкий подход, поскольку предоставляет больший контроль при именовании класс записей и его. H. CPP-файлов. Такой подход также позволяет иметь несколько представлений записей в одном классе набора записей.  
  
 Чтобы упростить для конечных пользователей для перемещения по записям в представлении записей, мастер приложения создает меню (и при необходимости инструментов) ресурсы для перемещения к первому следующего, предыдущего или последней записи. Если создать класс представления записей с помощью классов, необходимо создать эти ресурсы самостоятельно с меню и растрового изображения редакторов.  
  
 Сведения о реализации по умолчанию для перемещения по записям в разделе `IsOnFirstRecord` и `IsOnLastRecord` и статьи [использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
 `CRecordView`сохраняет сведения о положение пользователя в наборе записей, чтобы представление записей можно обновить пользовательский интерфейс. Когда пользователь переходит на любой конец набора записей, представление записей отключает объекты пользовательского интерфейса — например пунктов меню или кнопок панели инструментов — для перемещения в одном направлении.  
  
 Дополнительные сведения об объявлении и использование представления записей и классов набора записей в разделе «Проектирование и создание представления записей» в статье [представления записей](../../data/record-views-mfc-data-access.md). Дополнительные сведения о как запись представления работы и их использовании см. в статье [использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CView](../../mfc/reference/cview-class.md)  
  
 [CScrollView](../../mfc/reference/cscrollview-class.md)  
  
 [CFormView](../../mfc/reference/cformview-class.md)  
  
 `CRecordView`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdb.h  
  
##  <a name="crecordview"></a>CRecordView::CRecordView  
 При создании объекта типа производным от `CRecordView`, вызовите конструктор для инициализации объекта представления и определения ресурса диалогового окна, лежащие в основе представления либо форме.  
  
```  
explicit CRecordView(LPCTSTR lpszTemplateName);  
explicit CRecordView(UINT nIDTemplate);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszTemplateName`  
 Содержит нулем строку, являющуюся именем ресурс шаблона диалоговых окон.  
  
 `nIDTemplate`  
 Содержит идентификатор ресурс шаблона диалоговых окон.  
  
### <a name="remarks"></a>Примечания  
 Можно либо указать ресурс по имени (передавать строку в качестве аргумента конструктору) или по его Идентификатору (pass целое число без знака в качестве аргумента). Ресурс идентификатор рекомендуется использовать.  
  
> [!NOTE]
>  Производный класс *необходимо* предоставить свой собственный конструктор. В конструкторе производного класса, вызовите конструктор `CRecordView::CRecordView` с именем ресурса или идентификатор в качестве аргумента, как показано в следующем примере.  
  
 **CRecordView::OnInitialUpdate** вызовов `UpdateData`, который вызывает метод `DoDataExchange`. Этот первоначальный вызов `DoDataExchange` подключается `CRecordView` управляет (неявно) к `CRecordset` поля элементов данных, созданных классов. Эти данные-члены не должны использоваться до, после вызова метода базового класса **CFormView::OnInitialUpdate** функции-члена.  
  
> [!NOTE]
>  При использовании классов, мастер определяет `enum` значение `CRecordView::IDD`, он указывает в объявлении класса и использует его в списке инициализации членов конструктора.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCDatabase&#32;](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)]  
  
##  <a name="isonfirstrecord"></a>CRecordView::IsOnFirstRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnFirstRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является первой записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, созданных классов.  
  
 Если пользователь переходит к первой записи, платформа отключает все объекты пользовательского интерфейса для перехода к первому или предыдущей записи.  
  
##  <a name="isonlastrecord"></a>CRecordView::IsOnLastRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnLastRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является последней записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, создаваемых классов для поддержки пользовательский интерфейс для перемещения по записям.  
  
> [!CAUTION]
>  Результат этой функции надежен, за исключением того, что представление не может обнаружить конца набора данных, пока пользователь уже прошел его. Пользователю необходимо переместить за пределы последней записи перед представления записей можно указать, что его нужно отключить любые объекты пользовательского интерфейса для перемещения к следующей или последней записи. Если пользователь перемещает за последней записью и затем обратно до последней записи (или перед ним), представление записей можно отслеживать положение пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса. `IsOnLastRecord`также является ненадежным после вызова функции реализацию **OnRecordLast**, который обрабатывает `ID_RECORD_LAST` команды, или `CRecordset::MoveLast`.  
  
##  <a name="ongetrecordset"></a>CRecordView::OnGetRecordset  
 Возвращает указатель на `CRecordset`-производный объект, связанный с представлением записи.  
  
```  
virtual CRecordset* OnGetRecordset() = 0;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на `CRecordset`-производного объекта, если объект был успешно создан; в противном случае **NULL** указателя.  
  
### <a name="remarks"></a>Примечания  
 Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращает указатель на него. Если объявляется класс представления записей с помощью классов, мастер создает переопределение по умолчанию. Реализация по умолчанию для классов возвращает указатель набора записей, хранится в представлении записей, если таковой существует. Если нет, он создает объект набора записей типа, указанный с ClassWizard и вызывает его **откройте** член для открытия таблицы или выполнить запрос и затем возвращает указатель на объект.  
  
 Дополнительные сведения и примеры см. в статье [представления записей: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
##  <a name="onmove"></a>CRecordView::OnMove  
 Вызовите эту функцию-член для перемещения к другой записи в наборе записей и отобразить ее поля в элементах управления представления записей.  
  
```  
virtual BOOL OnMove(UINT nIDMoveCommand);
```  
  
### <a name="parameters"></a>Параметры  
 `nIDMoveCommand`  
 Одно из следующих значений ИД стандартных команд:  
  
- `ID_RECORD_FIRST`Перемещение к первой записи в наборе записей.  
  
- `ID_RECORD_LAST`Перейти к последней записи в наборе записей.  
  
- `ID_RECORD_NEXT`Перемещение на следующую запись в наборе записей.  
  
- `ID_RECORD_PREV`Переместите предыдущие записи в наборе записей.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает соответствующий **перемещение** функцию-член `CRecordset` объект, связанный с представлением записи.  
  
 По умолчанию `OnMove` обновление текущей записи в источнике данных, если пользователь изменил ее в представлении записей.  
  
 Мастер приложения создает ресурс меню с первой записи, последней записи, следующей записи и предыдущей записи пунктов меню. Если выбран параметр Закрепляемая панель инструментов приложения мастер также создает панель инструментов с кнопками, соответствующие этим командам.  
  
 При перемещении за последней записью в наборе записей, представление записей продолжают отображаться последней записи. При перемещении назад после первой записи в представлении записей продолжают отображаться первой записи.  
  
> [!CAUTION]
>  Вызов `OnMove` вызывает исключение, если набор записей не имеет записей. Вызов функции-обработчика обновить соответствующий пользовательский интерфейс — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, или **OnUpdateRecordPrev** , соответствующая операции перемещения для определить, является ли набор записей ни одной записи.  
  
## <a name="see-also"></a>См. также  
 [Класс CFormView](../../mfc/reference/cformview-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CRecordset](../../mfc/reference/crecordset-class.md)   
 [Класс CFormView](../../mfc/reference/cformview-class.md)

