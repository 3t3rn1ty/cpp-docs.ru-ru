---
title: "CRecordView-класс | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CRecordView
- AFXDB/CRecordView
- AFXDB/CRecordView::CRecordView
- AFXDB/CRecordView::IsOnFirstRecord
- AFXDB/CRecordView::IsOnLastRecord
- AFXDB/CRecordView::OnGetRecordset
- AFXDB/CRecordView::OnMove
dev_langs: C++
helpviewer_keywords:
- CRecordView [MFC], CRecordView
- CRecordView [MFC], IsOnFirstRecord
- CRecordView [MFC], IsOnLastRecord
- CRecordView [MFC], OnGetRecordset
- CRecordView [MFC], OnMove
- CRecordView [MFC], OnMove
ms.assetid: 9b4b0897-bd50-4d48-a0b4-f3323f5ccc55
caps.latest.revision: "25"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 6ffc45e73a2e56acf17bd1a7107e599967b3279b
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="crecordview-class"></a>CRecordView-класс
Представление, которое отображает записи базы данных в элементах управления.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class AFX_NOVTABLE CRecordView : public CFormView  
```  
  
## <a name="members"></a>Участники  
  
### <a name="protected-constructors"></a>Защищенные конструкторы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CRecordView::CRecordView](#crecordview)|Создает объект `CRecordView`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CRecordView::IsOnFirstRecord](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записью в связанных записей.|  
|[CRecordView::IsOnLastRecord](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записи в связанных записей.|  
|[CRecordView::OnGetRecordset](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CRecordset`. Мастер классов переопределяет эту функцию для вас и при необходимости создает набор записей.|  
|[CRecordView::OnMove](#onmove)||  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CRecordView::OnMove](#onmove)|При изменении текущей записи, обновляет их в источнике данных, а затем переходит к определенной записи (следующего, предыдущего, первого или последнего).|  
  
## <a name="remarks"></a>Примечания  
 Представление — это представление формы, непосредственно подключенные к `CRecordset` объекта. Представление создается на основе ресурс шаблона диалоговых окон и отображает поля `CRecordset` в элементах управления шаблона диалогового окна. `CRecordView` Объект использует обмен данными (диалоговых окон DDX) и обмен полями записей (RFX) для автоматизации перемещения данных между полями набора записей и элементов управления в форме. `CRecordView`также предоставляет реализацию по умолчанию для перемещения к первому следующего, предыдущего или последней записи и интерфейс для обновления записи в настоящее время для представления.  
  
> [!NOTE]
>  Если вы работаете с классами объектов доступа к данным (DAO), а не классы Open Database Connectivity (ODBC), используйте класс [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) вместо него. Дополнительные сведения см. в статье [Обзор: программирования баз данных](../../data/data-access-programming-mfc-atl.md).  
  
 Наиболее распространенным способом создания представления записи — с помощью мастера приложений. Мастер приложений Tge создает класс представления записей и его связанного набора записей класса как часть каркас начального приложения. Если не создать класс представления записей с помощью мастера приложений, можно создать ее позже с ClassWizard. Подход с использованием мастера приложений проще, если необходимо просто одной форме. Мастер классов позволяет решено использовать представление записей позже в процессе разработки. Использование классов для создания представления записей и набор записей отдельно и затем подключите их является самый гибкий подход, потому что он дает больший контроль при именовании класса набора записей и его. H ИЛИ. CPP-файлов. Такой подход также позволяет иметь несколько представлений записей для одного класса набор записей.  
  
 Чтобы облегчить процесс для конечных пользователей для перемещения по записям в представлении записей, мастер приложений создает меню (и при необходимости инструментов) ресурсы по переносу на первый следующего, предыдущего или последней записи. Если создать класс представления записей с помощью классов, необходимо создать эти ресурсы самостоятельно с меню и точечный рисунок редакторов.  
  
 Сведения о реализации по умолчанию для перемещения по записям см. в разделе `IsOnFirstRecord` и `IsOnLastRecord` и статьи [использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
 `CRecordView`сохраняет сведения о положение пользователя в наборе записей, чтобы представление записей можно обновить пользовательский интерфейс. Когда пользователь переходит на любом конце набора записей, представление записей отключает объекты пользовательского интерфейса — например, пункты меню или кнопки панели инструментов — для перемещения дальнейших в одном направлении.  
  
 Дополнительные сведения об объявлении и с помощью представления записей и классы набора записей. в разделе «Проектирование и создание представления записей» в статье [представления записей](../../data/record-views-mfc-data-access.md). Дополнительные сведения о как записи представления работы и способ их использования см. в статье [использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CView](../../mfc/reference/cview-class.md)  
  
 [CScrollView](../../mfc/reference/cscrollview-class.md)  
  
 [CFormView](../../mfc/reference/cformview-class.md)  
  
 `CRecordView`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdb.h  
  
##  <a name="crecordview"></a>CRecordView::CRecordView  
 При создании объекта типа производным от `CRecordView`, вызовите конструктор для инициализации объекта представления и определения ресурса диалогового окна, на котором основывается представление либо форме.  
  
```  
explicit CRecordView(LPCTSTR lpszTemplateName);  
explicit CRecordView(UINT nIDTemplate);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszTemplateName`  
 Содержит строку, являющуюся именем ресурс шаблона диалоговых окон символом null.  
  
 `nIDTemplate`  
 Содержит идентификатор ресурса шаблона диалогового окна.  
  
### <a name="remarks"></a>Примечания  
 Можно либо указать ресурс по имени (передавать строку в качестве аргумента конструктору) или по его Идентификатору (pass целое число без знака в качестве аргумента). Ресурс идентификатор рекомендуется использовать.  
  
> [!NOTE]
>  Производный класс *должен* предоставить свой собственный конструктор. В конструкторе производного класса, вызовите конструктор `CRecordView::CRecordView` с именем ресурса или идентификатор в качестве аргумента, как показано в следующем примере.  
  
 **CRecordView::OnInitialUpdate** вызовы `UpdateData`, который вызывает `DoDataExchange`. Это первый вызов `DoDataExchange` подключается `CRecordView` управляет (косвенно) с `CRecordset` поля элементов данных, созданных классов. Эти элементы данных не может использоваться до, после вызова метода базового класса **CFormView::OnInitialUpdate** функции-члена.  
  
> [!NOTE]
>  Если вы используете мастер классов, мастер определяет `enum` значение `CRecordView::IDD`, он указан в объявлении класса и использует его в списке инициализации членов для конструктора.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCDatabase#32](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)]  
  
##  <a name="isonfirstrecord"></a>CRecordView::IsOnFirstRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnFirstRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является первой записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, созданных классов.  
  
 Если пользователь переходит к первой записи, платформа отключает все объекты пользовательского интерфейса, которым у вас есть для перемещения к первому или предыдущей записи.  
  
##  <a name="isonlastrecord"></a>CRecordView::IsOnLastRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnLastRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является последней записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, которые ClassWizard записывает поддерживает пользовательский интерфейс для перемещения по записям.  
  
> [!CAUTION]
>  Результат этой функции является надежным, за исключением того, что представление не может обнаруживать конца набора данных, пока пользователь уже прошел его. Пользователь должен переместить после последней записи перед представления записей можно определить, что его необходимо отключить все объекты пользовательского интерфейса для перемещения к следующей или последней записи. Если пользователь перемещается за последней записи, а затем переходит назад на последнюю запись (или перед ним), представление записей можно отслеживать положение пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса. `IsOnLastRecord`также является ненадежным после вызова функции реализации **OnRecordLast**, который обрабатывает `ID_RECORD_LAST` команды, или `CRecordset::MoveLast`.  
  
##  <a name="ongetrecordset"></a>CRecordView::OnGetRecordset  
 Возвращает указатель на `CRecordset`-производный объект, связанный с представлением записи.  
  
```  
virtual CRecordset* OnGetRecordset() = 0;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на `CRecordset`-производного объекта, если объект был успешно создан; в противном случае **NULL** указателя.  
  
### <a name="remarks"></a>Примечания  
 Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращает указатель на него. Если объявить класс представления записей с помощью классов, мастер создает переопределение по умолчанию. Реализация по умолчанию ClassWizard возвращает указатель набора записей, хранится в представлении записей, если он существует. Если нет, он создает объект набора записей типа, указанный с ClassWizard и вызывает его **откройте** член для открытия таблицы или выполнить запрос и затем возвращает указатель на объект.  
  
 Дополнительные сведения и примеры см. в статье [представления записей: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
##  <a name="onmove"></a>CRecordView::OnMove  
 Вызовите эту функцию-член для перемещения в другой записи в наборе записей и отобразить ее поля в элементах управления представления записи.  
  
```  
virtual BOOL OnMove(UINT nIDMoveCommand);
```  
  
### <a name="parameters"></a>Параметры  
 `nIDMoveCommand`  
 Одно из следующих значений ID стандартную команду:  
  
- `ID_RECORD_FIRST`Перемещение к первой записи в наборе записей.  
  
- `ID_RECORD_LAST`Перейти к последней записи в наборе записей.  
  
- `ID_RECORD_NEXT`Перемещение к следующей записи в наборе записей.  
  
- `ID_RECORD_PREV`Перейти к предыдущей записи в наборе записей.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если перемещение прошло успешно; в противном случае значение 0, если запрос на перемещение запрещен.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает соответствующий **переместить** функцию-член `CRecordset` объект, связанный с представлением записи.  
  
 По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь был изменен в режиме записи.  
  
 В мастере приложений создает ресурс меню с пунктами меню первой записи, последнюю запись, следующая запись и предыдущей записи. Если выбран параметр Закрепляемая панель инструментов приложения мастер также создает панель инструментов с кнопками, соответствующий этим командам.  
  
 При перемещении за последней записью в наборе записей, представление записей продолжают отображаться последнюю запись. Если переместить назад после первой записи, представление записей продолжают отображаться первой записи.  
  
> [!CAUTION]
>  Вызов `OnMove` вызывает исключение, если набор записей не имеющей записей. Вызов функции-обработчика обновить соответствующий пользовательский интерфейс — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, или  **OnUpdateRecordPrev** — до соответствующей операции перемещения для определяет, имеет ли какие-либо записи набора записей.  
  
## <a name="see-also"></a>См. также  
 [Класс CFormView](../../mfc/reference/cformview-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [CRecordset-класс](../../mfc/reference/crecordset-class.md)   
 [Класс CFormView](../../mfc/reference/cformview-class.md)
