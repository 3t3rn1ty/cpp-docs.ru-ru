---
title: Класс CFileDialog | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.reviewer: ''
ms.suite: ''
ms.technology:
- cpp-windows
ms.tgt_pltfrm: ''
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
caps.latest.revision: 47
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 68c07bd6a172c704003ac2e4d83ef27fc1efc64a
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="cfiledialog-class"></a>Класс CFileDialog
Инкапсулирует стандартным диалоговым окном, используемый для открытия файла или файла операции сохранения.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CFileDialog : public CCommonDialog  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CFileDialog::CFileDialog](#cfiledialog)|Создает объект `CFileDialog`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CFileDialog::AddCheckButton](#addcheckbutton)|Добавляет кнопку с галочкой в диалоговом окне.|  
|[CFileDialog::AddComboBox](#addcombobox)|Добавляет поле со списком в диалоговом окне.|  
|[CFileDialog::AddControlItem](#addcontrolitem)|Добавляет элемент в контейнерный элемент управления в диалоговом окне.|  
|[CFileDialog::AddEditBox](#addeditbox)|Добавляет текстовое поле диалогового окна.|  
|[CFileDialog::AddMenu](#addmenu)|Добавляет меню диалогового окна.|  
|[CFileDialog::AddPlace](#addplace)|Перегружен. Добавляет папку в список помещает пользователь для открытия или сохранения элементов.|  
|[CFileDialog::AddPushButton](#addpushbutton)|Добавляет кнопку диалогового окна.|  
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Добавляет группе (также известный как переключатель) диалогового окна.|  
|[CFileDialog::AddSeparator](#addseparator)|Добавляет разделитель диалогового окна.|  
|[CFileDialog::AddText](#addtext)|Добавляет текстовое содержимое диалогового окна.|  
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Обновляет состояние `CFileDialog` в соответствии с параметрами и флаги, которые хранятся в `m_ofn` переменной-члена.|  
|[CFileDialog::DoModal](#domodal)|Отображает диалоговое окно и пользователь может сделать выбор.|  
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Включает раскрывающегося списка на **откройте** или **Сохранить** кнопку в диалоговом окне.|  
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Останавливает Добавление элементов в группу visual в диалоговом окне.|  
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Возвращает текущее состояние проверки кнопки (флажок) в диалоговом окне.|  
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Возвращает текущее состояние элемента в контейнерный элемент управления в диалоговом окне.|  
|[CFileDialog::GetControlState](#getcontrolstate)|Возвращает текущую видимость и включенные состояния для определенного элемента управления.|  
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Получает текущий текст в поле ввода.|  
|[CFileDialog::GetFileExt](#getfileext)|Возвращает расширение выбранного файла.|  
|[CFileDialog::GetFileName](#getfilename)|Возвращает имя файла, выбранного файла.|  
|[CFileDialog::GetFileTitle](#getfiletitle)|Возвращает название выбранного файла.|  
|[CFileDialog::GetFolderPath](#getfolderpath)|Возвращает путь в открытую папки или каталога для стиле обозревателя **откройте** или **Сохранить как** стандартным диалоговым окном.|  
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Извлекает внутренний объект COM для настраиваемый `CFileDialog` объекта.|  
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Извлекает внутренний объект COM для `CFileDialog` , используемая в качестве **откройте** диалоговое окно файла.|  
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Извлекает внутренний объект COM для `CFileDialog` , используемая в качестве **Сохранить** диалоговое окно файла.|  
|[CFileDialog::GetNextPathName](#getnextpathname)|Возвращает полный путь Далее выбранного файла.|  
|[CFileDialog::GetOFN](#getofn)|Извлекает `OPENFILENAME` структуры `CFileDialog` объекта.|  
|[CFileDialog::GetPathName](#getpathname)|Возвращает полный путь к выбранному файлу.|  
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Возвращает состояние только для чтения к выбранному файлу.|  
|[CFileDialog::GetResult](#getresult)|Возвращает выбор, внесенные пользователем в диалоговом окне.|  
|[CFileDialog::GetResults](#getresults)|Возвращает пользовательские настройки в диалоговом окне, который позволяет выбирать несколько элементов.|  
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Возвращает определенный элемент из указанного контейнера элементов управления в диалоговом окне.|  
|[CFileDialog::GetStartPosition](#getstartposition)|Возвращает позицию первого элемента в список имен файлов.|  
|[CFileDialog::HideControl](#hidecontrol)|Скрывает элемент управления, указанный в стиле обозревателя **откройте** или **Сохранить как** стандартным диалоговым окном.|  
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Определяет, если текущего диалогового окна в режиме выбора папки.|  
|[CFileDialog::MakeProminent](#makeprominent)|Окружение элемента управления в диалоговом окне, чтобы он важные моменты по сравнению с другими добавленных элементов управления.|  
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Удаляет элемент из контейнерного элемента управления в диалоговом окне.|  
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Задает текущее состояние кнопки «Проверка» (флажок) в диалоговом окне.|  
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Задает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.|  
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Задает текст элемента управления. Например текст, сопровождающий типа "переключатель" или в элементе меню.|  
|[CFileDialog::SetControlLabel](#setcontrollabel)|Задает текст, связанный с элементом управления, например текст кнопки или изменить метку поля.|  
|[CFileDialog::SetControlState](#setcontrolstate)|Задает текущую видимость и включенные состояния для определенного элемента управления.|  
|[CFileDialog::SetControlText](#setcontroltext)|Задает текст для указанного элемента управления в стиле обозревателя **откройте** или **Сохранить как** стандартным диалоговым окном.|  
|[CFileDialog::SetDefExt](#setdefext)|Задает расширение имени файла по умолчанию для стиле обозревателя **откройте** или **Сохранить как** стандартным диалоговым окном.|  
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Задает текущий текст в поле ввода.|  
|[CFileDialog::SetProperties](#setproperties)|Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.|  
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Задает выделен какой-либо элемент в группе или поле со списком в диалоговом окне.|  
|[CFileDialog::SetTemplate](#settemplate)|Задает поле шаблона диалогового окна для `CFileDialog` объекта.|  
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Объявляет visual группы в диалоговом окне. Последующие вызовы с любым методом «добавить» добавьте эти элементы в эту группу.|  
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Обновляет данные, хранящиеся в `m_ofn` переменной-члена для соответствия текущему состоянию диалоговым окном файла.|  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Вызывается при нажатии кнопки.|  
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Вызывается, когда этот флажок не установлен или снят.|  
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Вызывается, когда элемент управления быть активными.|  
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Обрабатывает `WM_NOTIFY CDN_SELCHANGE` сообщения.|  
|[CFileDialog::OnFileNameOK](#onfilenameok)|Проверяет указанное имя файла в диалоговом окне.|  
|[CFileDialog::OnFolderChange](#onfolderchange)|Обрабатывает `WM_NOTIFY CDN_FOLDERCHANGE` сообщения.|  
|[CFileDialog::OnInitDone](#oninitdone)|Обрабатывает `WM_NOTIFY CDN_INITDONE` сообщения.|  
|[CFileDialog::OnItemSelected](#onitemselected)|Вызывается, когда выбран элемент контейнера.|  
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Позволяет выполнять пользовательские действия при изменении выбора файла.|  
|[CFileDialog::OnShareViolation](#onshareviolation)|Дескрипторы совместно использовать нарушений.|  
|[CFileDialog::OnTypeChange](#ontypechange)|Обрабатывает `WM_NOTIFY CDN_TYPECHANGE` сообщения.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CFileDialog::m_ofn](#m_ofn)|Windows `OPENFILENAME` структуры. Предоставляет доступ к параметрам поле базовый файл диалогового окна.|  
  
## <a name="remarks"></a>Примечания  
 Общие диалоговые окна файлов позволяют реализовать Выбор файла диалоговые окна, например, **открыть файл** и **Сохранить как**, таким способом, который соответствует стандартам Windows.  
  
 Можно использовать `CFileDialog` как есть, предоставляемые конструктором, или можно наследовать класс из собственного диалогового окна `CFileDialog` и создание конструктора в соответствии с потребностями. В любом случае эти диалоговые будет работать как стандартные диалоговые окна MFC, поскольку они являются производными от [CCommonDialog класса](../../mfc/reference/ccommondialog-class.md). `CFileDialog` использует COMMDLG. DLL-файл, включенный в Windows.  
  
 Внешний вид и функциональные возможности `CFileDialog` с Windows Vista или более поздней версии, отличаются от более ранних версиях Windows. Значение по умолчанию `CFileDialog` автоматически использует новый Windows Vista или более поздней версии стиля без изменений кода программа, компиляции и выполнения в Windows Vista или более поздней версии. Используйте `bVistaStyle` параметра в конструктор, чтобы переопределить это автоматическое обновление вручную. Для автоматического обновления исключение пользовательские диалоговые окна. Они не преобразуются в новый стиль. Дополнительные сведения о конструкторе см. в разделе [CFileDialog::CFileDialog](#cfiledialog).  
  
> [!NOTE]
>  Идентификатор системы управления отличается в Windows Vista или более поздней версии из более ранних версий Windows, при использовании `CFileDialog`. Необходимо обновить все ссылки на `CFileDialog` элементов управления в коде, прежде чем можно будет перенести проекта из более ранней версии Windows.  
  
 Некоторые `CFileDialog` методы не поддерживаются в Windows Vista или более поздней версии. Проверьте раздел отдельных метод сведения о том, поддерживает ли метод. Кроме того следующие наследуемые функции не поддерживаются в Windows Vista или более поздней версии:  
  
- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)  
  
- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)  
  
 Сообщения windows для `CFileDialog` класс различаются в зависимости от операционной системы вы используете. Например, Windows XP не поддерживает [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) и [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) для `CFileDialog` класса. Тем не менее Windows Vista и более поздние операционные системы поддерживают их. Дополнительные сведения о различных сообщений, которые создаются и порядок, в котором они получены в разделе [CFileDialog пример: порядок ведения журнала событий](../../visual-cpp-samples.md).  
  
 Для использования `CFileDialog` , следует сначала создать объект с помощью `CFileDialog` конструктор. После создания диалоговым окном можно задать или изменить любые значения в [CFileDialog::m_ofn](#m_ofn) структуры для инициализации значения или состояния элементов управления диалогового окна. `m_ofn` Структуры имеет тип `OPENFILENAME`. Дополнительные сведения см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры в Windows SDK.  
  
 После инициализации элементы управления диалоговых окон, вызовите [CFileDialog::DoModal](#domodal) метод для отображения диалогового окна поле, чтобы пользователь может ввести путь и имя файла. `DoModal` Возвращает, является ли пользователь нажал кнопку Отмена (IDCANCEL) или ОК (IDOK). Если `DoModal` возвращает IDOK, можно использовать один из `CFileDialog` поместить открытые функции-члены для извлечения сведений в пользователем.  
  
> [!NOTE]
> В Windows Vista или более поздней версии, несколько вызовов [IFileDialog::SetFileTypes](http://msdn.microsoft.com/library/windows/desktop/bb775980) приводит к ошибке. Второй вызов `SetFileTypes` для любого экземпляра `CFileDialog` вернет `E_UNEXPECTED` в Windows Vista или более поздней версии. Некоторые `CFileDialog` вызов функции метод `SetFileTypes`. Например, два вызова к `CFileDialog::DoModal` для одного экземпляра `CFileDialog` приводит к возникновению ошибки [ASSERT](diagnostic-services.md#assert).  
  
 `CFileDialog` включает несколько защищенных членов, которые позволяют выполнять пользовательскую обработку нарушений общего ресурса, проверка правильности имени файла и уведомления об изменении в списке. Эти защищенные члены являются функции обратного вызова, большинство приложений не требуется использовать, так как по умолчанию обработка выполняется автоматически. Записи в схеме сообщений для этих функций не требуются, поскольку они являются стандартные виртуальные функции.  
  
 Можно использовать окна [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) функции, чтобы определить, произошла ли ошибка во время инициализации диалогового окна и Дополнительные сведения об ошибке.  
  
 Уничтожение `CFileDialog` объектов обрабатывается автоматически. Нет необходимости вызывать [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).  
  
 Чтобы пользователь мог выбрать несколько файлов, установите `OFN_ALLOWMULTISELECT` флаг перед вызовом метода `DoModal`. Вы должны предоставить свои собственные буфера имя файла для размещения возвращаемый список несколько имен файлов. Это можно сделать путем замены `m_ofn.lpstrFile` с использованием указателя на буфер распределения, после создания `CFileDialog`, но перед вызовом `DoModal`.  
  
 Кроме того, необходимо установить `m_ofn.nMaxFile` с помощью число символов в буфере, на который указывает `m_ofn.lpstrFile`. Если задать максимальное число файлов, необходимо выбрать для `n`, необходимый размер буфера является `n * (_MAX_PATH + 1) + 1`. Первый элемент, возвращается в буфер — это путь к папке, где были выбраны файлы. Для Windows Vista или более поздней версии в стиле диалоговым окнам строк имен каталогов и файлов, которые нулевым байтом, с дополнительный символ null после последнего имени файла. Этот формат позволяет стиле проводника диалоговым окнам для возврата длинные имена файлов, содержащие пробелы. Для старого стиля диалоговых окон строк имен каталогов и файлов разделенных пробелами и эта функция использует короткие имена файлов на имена файлов пробелами.  
  
 Ниже приведен пример, как использовать буфер для получения и вывода списка несколько имен файлов.  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Чтобы изменить размер буфера в ответ на выбор несколько имен файлов, необходимо наследовать новый класс из `CFileDialog` и Переопределите [CFileDialog::OnFileNameChange](#onfilenamechange) метод.  
  
 Если необходимо наследовать новый класс из `CFileDialog`, можно использовать схему сообщений для обработки сообщения. Чтобы расширить возможности обработки сообщений по умолчанию, создайте класс, производный от `CFileDialog`, добавить схему сообщений к новому классу и предоставляют функции-члены для новых сообщений. Вам не требуется задать функция-ловушка для настройки диалогового окна.  
  
 Чтобы настроить диалоговое окно, создайте класс, производный от `CFileDialog`укажите шаблон пользовательского диалогового окна и добавить схему сообщений для обработки сообщений уведомлений из расширенных элементов управления. Передайте любой необработанных сообщений базового класса. Необходимо настроить функцию-обработчик.  
  
 При использовании Windows Vista или более поздней версии стиль `CFileDialog`, нельзя использовать схемы сообщений и шаблоны диалоговых окон. Вместо этого необходимо использовать COM-интерфейсы для аналогичные функциональные возможности.  
  
 Дополнительные сведения об использовании `CFileDialog`, в разделе [классы общих диалоговых окон](../../mfc/common-dialog-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CDialog](../../mfc/reference/cdialog-class.md)  
  
 [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  
  
 `CFileDialog`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdlgs.h  
  
##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton  
 Добавляет кнопку с галочкой в диалоговом окне.  
  
```  
HRESULT AddCheckButton(
    DWORD dwIDCtl,  
    const CString& strLabel,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор "Проверить" для добавления.  
  
 `strLabel`  
 Проверьте имя кнопки.  
  
 `bChecked`  
 Логическое значение, указывающее текущее состояние "Проверить". `TRUE` Если флажок установлен; `FALSE` в противном случае  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addcombobox"></a>  CFileDialog::AddComboBox  
 Добавляет поле со списком в диалоговом окне.  
  
```  
HRESULT AddComboBox(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор поле со списком для добавления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem  
 Добавляет элемент в контейнерный элемент управления в диалоговом окне.  
  
```  
HRESULT AddControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления для добавления элемента.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
 `strLabel`  
 Текст элемента.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addeditbox"></a>  CFileDialog::AddEditBox  
 Добавляет текстовое поле диалогового окна.  
  
```  
HRESULT AddEditBox(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор поля ввода, для добавления.  
  
 `strText`  
 Имя поля редактирования.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addmenu"></a>  CFileDialog::AddMenu  
 Добавляет меню диалогового окна.  
  
```  
HRESULT AddMenu(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор для добавления меню.  
  
 `strLabel`  
 Имя меню.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addplace"></a>  CFileDialog::AddPlace  
 Добавляет папку в список помещает пользователь для открытия или сохранения элементов.  
  
```  
void AddPlace(
    LPCWSTR lpszFolder,  
    FDAP fdap = FDAP_TOP) throw();

 
void AddPlace(
    IShellItem* psi,  
    FDAP fdap = FDAP_TOP) throw();
```  
  
### <a name="parameters"></a>Параметры  
 `lpszFolder`  
 Путь к папке, чтобы сделать доступными для пользователя. Это может быть только папки.  
  
 `fdap`  
 Указывает расположение папки в списке.  
  
 `psi`  
 Указатель на IShellItem, представляющий папки должны быть доступны пользователю. Это может быть только папки.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton  
 Добавляет кнопку диалогового окна.  
  
```  
HRESULT AddPushButton(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор кнопки для добавления.  
  
 `strLabel`  
 Имя кнопки.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList  
 Добавляет группе (также известный как переключатель) диалогового окна.  
  
```  
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор группы переключателей для добавления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addseparator"></a>  CFileDialog::AddSeparator  
 Добавляет разделитель диалогового окна.  
  
```  
HRESULT AddSeparator(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Добавьте идентификатор разделителя.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="addtext"></a>  CFileDialog::AddText  
 Добавляет текст в диалоговом окне.  
  
```  
HRESULT AddText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор для добавления текста.  
  
 `strText`  
 Имя текстовой.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog  
 Обновляет текущее состояние [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основе значений, хранящихся в `m_ofn` структуру данных.  
  
```  
void ApplyOFNToShellDialog();
```  
  
### <a name="remarks"></a>Примечания  
 В версиях Windows, предшествующих Windows Vista, член [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) структуру данных постоянно был синхронизирован с состоянием `CFileDialog`. Любые изменения [m_ofn](#m_ofn) переменной-члена были немедленно отражаются в состояние диалогового окна. Кроме того, любые изменения состояния диалогового окна немедленно обновить `m_ofn` переменной-члена.  
  
 В Windows Vista или более поздней версии значения в `m_ofn` переменной-члена и состояние `CFileDialog` , не обязательно быть синхронизирована. Эта функция вызывает состояние `CFileDialog` обновляться в соответствии `m_ofn` структуры. Windows вызывает эту функцию автоматически во время [CFileDialog::DoModal](#domodal).  
  
 Дополнительные сведения об использовании `CFileDialog` класса в Windows Vista или более поздней версии, см. раздел [класс CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Пример  
  Далее приведен пример [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).  
  
##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog  
 Эта функция вызывается для создания стандартного диалогового окна файла Windows.  
  
```  
explicit CFileDialog(
    BOOL bOpenFileDialog,  
    LPCTSTR lpszDefExt = NULL,  
    LPCTSTR lpszFileName = NULL,  
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,  
    LPCTSTR lpszFilter = NULL,  
    CWnd* pParentWnd = NULL,  
    DWORD dwSize = 0,  
    BOOL bVistaStyle = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `bOpenFileDialog`  
 Параметр, указывающий тип диалогового окна для создания. Задайте для него значение `TRUE` для создания **Открытие файла** диалоговое окно. Задайте для него значение `FALSE` для создания **сохранить файл как** диалоговое окно.  
  
 [in] `lpszDefExt`  
 Расширение имени файла по умолчанию. Если пользователь не имеет известного расширения имени (у которого есть связь на компьютере пользователя) в поле имя файла, заданный модуль `lpszDefExt` автоматически добавляется к имени файла. Если этот параметр равен `NULL`, расширение не добавляется.  
  
 [in] `lpszFileName`  
 Исходное имя файла, отображаемый в поле имя файла. Если `NULL`, появляется не исходное имя файла.  
  
 [in] `dwFlags`  
 Сочетание одного или нескольких флагов, которые можно использовать для настройки диалогового окна. Описание этих флагов см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры в Windows SDK. При изменении `m_ofn.Flags` структуры элемента, используйте оператор побитового или изменения сохранить неповрежденную поведение по умолчанию.  
  
 [in] `lpszFilter`  
 Ряд пар строки, которые задают фильтры, можно применить к файлу. При указании фильтров файлов в списке файлов будут отображаться только те файлы, которые соответствуют критериям фильтра. Дополнительные сведения о работе с фильтры файлов см.  
  
 [in] `pParentWnd`  
 Указатель на родительский или владелец окно диалоговым окном файла.  
  
 [in] `dwSize`  
 Размер `OPENFILENAME` структуры. Это значение зависит от версии операционной системы. MFC позволяет определить соответствующий тип диалогового окна для создания этого параметра. Размер по умолчанию 0 означает, что код MFC определит размер поле правильный диалогового окна для использования в зависимости от версии операционной системы, на котором выполняется программа.  
  
 [in] `bVistaStyle`  
 **Примечание** этот параметр доступен в Visual Studio 2008 и более поздней версии и оно будет вызывать новый стиль окна, чтобы использовать только в том случае, если вы используете Windows Vista или более поздней версии.  
  
 Параметр, который определяет стиль диалогового окна файла. Задайте для него значение `TRUE` использовать новые диалоговые стиль Vista. В противном случае будет использоваться старый стиль диалоговых окон. В разделе «Примечания» для получения дополнительной информации выполняемым Vista.  
  
### <a name="remarks"></a>Примечания  
 Либо **Открытие файла** или **сохранить файл как** создается диалоговое окно, в зависимости от значения `bOpenFileDialog`.  
  
 Указание расширения по умолчанию с помощью `lpszDefExt` может не дать поведение, которое предполагается, что, поскольку редко является предсказуемым, какие модули имеют сопоставления файлов на компьютере пользователя. Если требуется больший контроль над добавления расширения по умолчанию, можно создать собственный класс, от `CFileDialog`и Переопределите `CFileDialog::OnFileNameOK` метод, чтобы выполнить собственную обработку расширения.  
  
 Чтобы разрешить пользователю выбирать несколько файлов, установите `OFN_ALLOWMULTISELECT` флаг перед вызовом метода [DoModal](#domodal). Вы должны предоставить свои собственные буфера имя файла для хранения возвращаемого списка несколько имен файлов. Это можно сделать путем замены `m_ofn.lpstrFile` с использованием указателя на буфер распределения, после создания [CFileDialog](../../mfc/reference/cfiledialog-class.md), но перед вызовом `DoModal`. Кроме того, необходимо установить `m_ofn.nMaxFile` число символов в буфере, на который указывает `m_ofn.lpstrFile`. Если задать максимальное число файлов, необходимо выбрать для `n`, необходимый размер буфера является `n`*(_MAX_PATH + 1) + 1. Пример:  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Чтобы разрешить пользователю изменять размер диалоговое окно с стиле проводника с помощью клавиатуры или мыши, установите `OFN_ENABLESIZING` флаг. Этот флаг установлен необходим только в том случае, если указать процедуру обработки или пользовательский шаблон. Флаг работает только с диалоговым окном в стиле обозревателя; Невозможно изменить размер старого стиля диалоговым окнам.  
  
 `lpszFilter` Параметр используется для определения типа, имени файла, файл должен обязательно должны выводиться в списке файлов. Первая строка в паре строка описывает фильтр; Вторая строка указывает расширение имени файла для использования. Можно указать несколько расширений, используя в качестве разделителя точку с запятой (символ «;»). Строка заканчивается с двумя "&#124;" символов, за которыми следует `NULL` символов. Можно также использовать [CString](../../atl-mfc-shared/using-cstring.md) объект для этого параметра.  
  
 Например [!INCLUDE[ofprexcel](../../mfc/reference/includes/ofprexcel_md.md)] позволяет пользователям открывать файлы, имеющие расширения .xlc (диаграмма)- или xls (листа), в частности. Фильтр для Excel может быть записан следующим образом:  
  
 [!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]  
  
 Тем не менее, если вы планируете использовать эту строку, чтобы непосредственно обновить `OPENFILENAME` структуру, следует заканчивать сравнения строк с нуль-символ '\0', а не знаки вертикальной черты ("&#124;").  
  
 `bVistaStyle` Параметр применим только в том случае, если в Windows Vista или более поздней версии. В более ранних версиях Windows этот параметр учитывается. Если `bVistaStyle` равно `TRUE`, при компиляции программы Visual Studio 2008 или более поздней версии, по-новому Vista **диалогового окна файла** будет использоваться. В противном случае предыдущие стиль MFC **диалогового окна файла** будет использоваться.  
  
 Диалоговые шаблоны не поддерживаются на основании диалоговые окна `bVistaStyle`  
  
### <a name="example"></a>Пример  
  Далее приведен пример [CFileDialog::DoModal](#domodal).  
  
##  <a name="domodal"></a>  CFileDialog::DoModal  
 Вызывайте эту функцию, чтобы отобразить диалоговое окно Windows общих файлов и разрешить пользователю просмотр файлов и каталогов и введите имя файла.  
  
```  
virtual INT_PTR DoModal();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 **IDOK** или **IDCANCEL**. Если **IDCANCEL** будет возвращен, вызовите Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) функцию, чтобы определить, произошла ли ошибка.  
  
 **IDOK** и **IDCANCEL** — константы, которые указывают, является ли пользователь выбрал кнопку OK или "Отмена".  
  
### <a name="remarks"></a>Примечания  
 Если требуется инициализировать различные параметры диалогового окна файла, задав члены **m_ofn** структуры, это следует сделать до вызова метода `DoModal`, но после создания объекта диалогового окна.  
  
 Например, если вы хотите разрешить пользователю выбирать несколько файлов, установите `OFN_ALLOWMULTISELECT` флаг перед вызовом метода `DoModal`, как показано в примере кода в этом разделе.  
  
 Когда пользователь нажимает кнопку, диалоговое окно «» кнопки ОК или "Отмена" или выбирает закрытия параметр в диалоговом управления меню, управление возвращается в приложение. Затем можно вызвать другие функции-члены для получения параметров или сведения о входных данных пользователя в диалоговом окне.  
  
 `DoModal` виртуальная функция переопределения из класса является `CDialog`.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]  
  
##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown  
 Позволяет раскрывающегося списка при открытии или «сохранить» в диалоговом окне.  
  
```  
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор из раскрывающегося списка.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup  
 Останавливает Добавление элементов в группу visual в диалоговом окне.  
  
```  
HRESULT EndVisualGroup();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращает значение S_OK, если успешно; в противном случае — значение типа ошибки.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState  
 Получает текущее состояние галочкой (флажок) в диалоговом окне.  
  
```  
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL& bChecked);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор флажок.  
  
 `bChecked`  
 Состояние флажка. `TRUE` Указывает, отмеченных; `FALSE` указывает этот флажок снят.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState  
 Извлекает текущее состояние элемента в контейнерный элемент управления в диалоговом окне.  
  
```  
HRESULT GetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
 `dwState`  
 Ссылка на переменную, которая получает одно из нескольких значений из перечисления CDCONTROLSTATE, которое указывает текущее состояние элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState  
 Получает текущую видимость и включенные состояния для определенного элемента управления.  
  
```  
HRESULT GetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор элемента управления.  
  
 `dwState`  
 Ссылка на переменную, которая получает одно или несколько значений из перечисления CDCONTROLSTATE, которое указывает текущее состояние элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText  
 Получает текущий текст в поле ввода.  
  
```  
HRESULT GetEditBoxText(
    DWORD dwIDCtl,  
    CString& strText);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор поля ввода.  
  
 `strText`  
 Текстовое значение.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getfileext"></a>  CFileDialog::GetFileExt  
 Эта функция вызывается для получения расширения имени файла, введенного в диалоговое окно.  
  
```  
CString GetFileExt() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Расширение имени файла.  
  
### <a name="remarks"></a>Примечания  
 Например если ввести имя файла — это данные. TXT, `GetFileExt` возвращает «TXT».  
  
 Если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` флаг установлен, эта строка содержит последовательность нулем строк с первой строки, являющейся путь к каталогу файловой группы выбран, за которыми следуют имена всех файлов, выбранных пользователем. Чтобы получить имена путей файлов, используйте [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функции-члены.  
  
##  <a name="getfilename"></a>  CFileDialog::GetFileName  
 Эта функция вызывается для получения имени имени файла, введенного в диалоговом окне.  
  
```  
CString GetFileName() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имя файла  
  
### <a name="remarks"></a>Примечания  
 Имя файла содержит префикс и расширение. Например `GetFileName` вернет «текст. DAT» для файла C:\FILES\TEXT.DAT.  
  
 Если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` набор флагов, необходимо вызвать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) для получения пути файла.  
  
##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle  
 Эта функция вызывается для получения название файла, введенного в диалоговое окно.  
  
```  
CString GetFileTitle() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Заголовок файла.  
  
### <a name="remarks"></a>Примечания  
 Заголовок файла содержит только его префикс, без пути или расширения. Например `GetFileTitle` возвращает «TEXT» для файла C:\FILES\TEXT.DAT.  
  
 Если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` флаг установлен, эта строка содержит последовательность нулем строк с первой строки, являющейся путь к каталогу файловой группы выбран, за которыми следуют имена всех файлов, выбранных пользователем. По этой причине использовать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функции-члены для получения следующего имени файла в списке.  
  
### <a name="example"></a>Пример  
  Далее приведен пример [CFileDialog::DoModal](#domodal).  
  
##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath  
 Вызовите эту функцию-член для извлечения пути открытые папки или каталога для стиле проводника открыть или сохранить как общее диалоговое окно.  
  
```  
CString GetFolderPath() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) объект, содержащий открытые папки или каталога.  
  
### <a name="remarks"></a>Примечания  
 Диалоговое окно должна быть создана с **OFN_EXPLORER** стиля; в противном случае, метод завершится с ошибкой с утверждением.  
  
 Этот метод можно вызвать только во время, откроется диалоговое окно. После закрытия диалогового эта функция больше не будет работать, а метод завершится с ошибкой с утверждением.  
  
##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize  
 Извлекает указатель на внутренний объект COM для данного [CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
```  
IFileDialogCustomize* GetIFileDialogCustomize();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на внутренний объект COM для `CFileDialog`. Это необходимо соответствующим образом освободить этот указатель.  
  
### <a name="remarks"></a>Примечания  
 Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет `bVistaStyle` значение `true`. Если эта функция используется при `bVistaStyle` — `false`, он вернет `NULL` в режиме выпуска и throw утверждение в режиме отладки.  
  
 Дополнительные сведения о `IFileDialogCustomize` интерфейса см. в разделе [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
### <a name="example"></a>Пример  
 В этом примере Получает внутренний COM-объекта. Чтобы запустить этот пример кода, его необходимо скомпилировать в Windows Vista или более поздней версии.  
  
 [!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]  
  
##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog  
 Извлекает указатель на внутренний объект COM для данного `CFileDialog`.  
  
```  
IFileOpenDialog* GetIFileOpenDialog();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на внутренний объект COM для `CFileDialog`. Это необходимо соответствующим образом освободить этот указатель.  
  
### <a name="remarks"></a>Примечания  
 Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет `bVistaStyle` значение `true`. Эта функция возвращает `NULL` Если `CFileDialog` не **откройте** диалоговое окно или если `bVistaStyle` равно `false`. В данном случае последний, функция возвращает только `NULL` в режиме выпуска - в режиме отладки исключений утверждения.  
  
 Дополнительные сведения о `IFileOpenDialog` интерфейса см. в разделе [IFileOpenDialog](http://msdn.microsoft.com/library/windows/desktop/bb775834).  
  
### <a name="example"></a>Пример  
 В этом примере Получает внутренний COM-объекта. Для выполнения этого кода, его необходимо скомпилировать в Windows Vista или более поздней версии.  
  
 [!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]  
  
##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog  
 Извлекает указатель на внутренний объект COM для данного `CFileDialog`.  
  
```  
IFileSaveDialog* GetIFileSaveDialog();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на внутренний объект COM для `CFileDialog`. Это необходимо соответствующим образом освободить этот указатель.  
  
### <a name="remarks"></a>Примечания  
 Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет `bVistaStyle` значение `true`. Эта функция возвращает `NULL` Если `CFileDialog` не **Сохранить** диалоговое окно или если `bVistaStyle` равно `false`. В данном случае последний, функция возвращает только `NULL` в режиме выпуска - в режиме отладки исключений утверждения.  
  
 Дополнительные сведения о `IFileSaveDialog` интерфейса см. в разделе [IFileSaveDialog](http://msdn.microsoft.com/library/windows/desktop/bb775688).  
  
### <a name="example"></a>Пример  
 В этом примере Получает внутренний COM-объекта. Чтобы запустить этот пример кода, его необходимо скомпилировать в Windows Vista или более поздней версии.  
  
 [!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]  
  
##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName  
 Эта функция вызывается для получения имени следующего файла из группы, выбранной в диалоговом окне.  
  
```  
CString GetNextPathName(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `pos`  
 Ссылку на **ПОЗИЦИИ** значение, возвращенное предыдущим `GetNextPathName` или `GetStartPosition` вызов функции. **Значение NULL** Если был достигнут конец списка.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Полный путь к файлу.  
  
### <a name="remarks"></a>Примечания  
 Путь имя файла включает заголовок файла и путь к каталогу целиком. Например `GetNextPathName` возвращает «C:\FILES\TEXT. DAT» для файла C:\FILES\TEXT.DAT. Можно использовать `GetNextPathName` в прямой итерации цикла, если установить начальное положение, с помощью вызова `GetStartPosition`.  
  
 Если выделение состоит только из одного файла, будет возвращаться имя этого файла.  
  
##  <a name="getofn"></a>  CFileDialog::GetOFN  
 Извлекает связанный **OPENFILENAME** структуры.  
  
```  
const OPENFILENAME& GetOFN() const;  
  
OPENFILENAME& GetOFN();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры.  
  
### <a name="remarks"></a>Примечания  
 Использовать второй версии этой функции для инициализации вида **Открытие файла** или **сохранить файл как** диалогового окна "," после его создания, но перед отображением с `DoModal` функции-члена. Например, можно задать **lpstrTitle** членом **m_ofn** к заголовку необходимо иметь диалоговое окно.  
  
##  <a name="getpathname"></a>  CFileDialog::GetPathName  
 Эта функция вызывается для получения полного пути файла, введенного в диалоговое окно.  
  
```  
CString GetPathName() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Полный путь к файлу.  
  
### <a name="remarks"></a>Примечания  
 Путь имя файла включает заголовок файла и путь к каталогу целиком. Например `GetPathName` возвращает «C:\FILES\TEXT. DAT» для файла C:\FILES\TEXT.DAT.  
  
 Если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` флаг установлен, эта строка содержит последовательность из null teminated строк с первой строки, являющейся путь к каталогу файловой группы выбран, за которым следует имена всех файлов, выбранных пользователем. По этой причине использовать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функции-члены для получения следующего имени файла в списке.  
  
### <a name="example"></a>Пример  
  Далее приведен пример [CFileDialog::DoModal](#domodal).  
  
##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref  
 Вызывайте эту функцию, чтобы определить, выделен ли флажок только для чтения в стандартных открытия файла и сохраните файл как диалоговые окна Windows.  
  
```  
BOOL GetReadOnlyPref() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Не равно нулю, если установлен флажок только для чтения, в диалоговом окне; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Можно скрыть, установив флажок только для чтения `OFN_HIDEREADONLY` стиля в `CFileDialog` конструктора.  
  
> [!NOTE]
> Windows Vista или более поздней версии стиль `CFileDialog` объекты не поддерживают эту функцию. Попытка использовать эту функцию в Windows Vista или более поздней версии стиль `CFileDialog` вызовет [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).   
  
##  <a name="getresult"></a>  CFileDialog::GetResult  
 Извлекает выбор, внесенные пользователем в диалоговом окне.  
  
```  
IShellItem* GetResult() throw();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на IShellItem, который представляет выбора пользователя.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getresults"></a>  CFileDialog::GetResults  
 Возвращает пользовательские настройки в диалоговом окне, который позволяет выбирать несколько элементов.  
  
```  
IShellItemArray* GetResults() throw();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на IShellItemArray, через который доступных элементов, выбранных в диалоговом окне.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem  
 Возвращает определенный элемент из указанного контейнера элемента управления в диалоговом окне.  
  
```  
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD& dwIDItem);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента, выбранного пользователем в элементе управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition  
 Вызовите эту функцию-член для получения позиции первого пути файла в списке, если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` значение флага.  
  
```  
POSITION GetStartPosition() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект **ПОЗИЦИИ** значение, которое может использоваться для итерации; **NULL** Если список пуст.  
  
##  <a name="hidecontrol"></a>  CFileDialog::HideControl  
 Вызовите эту функцию-член для скрытия указанного элемента управления в стиле проводника открыть или сохранить как общее диалоговое окно.  
  
```  
void HideControl(int nID);
```  
  
### <a name="parameters"></a>Параметры  
 `nID`  
 Идентификатор элемента управления, чтобы скрыть.  
  
### <a name="remarks"></a>Примечания  
 Диалоговое окно должна быть создана с **OFN_EXPLORER** стиля; в противном случае функция завершится сбоем с утверждением.  
  
##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode  
 Определяет, является ли текущее окно в режиме выбора папки.  
  
```  
BOOL IsPickFoldersMode() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 `TRUE` Если диалоговое окно находится в режиме выбора папки; в противном случае `FALSE`.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="m_ofn"></a>  CFileDialog::m_ofn  
 `m_ofn` — это структура типа `OPENFILENAME`. Данные в этой структуре представляет текущее состояние `CFileDialog`.  
  
### <a name="remarks"></a>Примечания  
 Использовать эту структуру для инициализации вида **Открытие файла** или **сохранить файл как** диалогового окна "," после его создания, но прежде чем использовать с [DoModal](#domodal) метод. Например, можно задать `lpstrTitle` членом `m_ofn` к заголовку необходимо иметь диалоговое окно.  
  
 С Windows Vista или более поздней версии стиль [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` не обязательно всегда соответствует состоянию диалогового окна. Он синхронизирован с диалоговым окном, в более ранних версиях Windows. В разделе [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) и [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) Дополнительные сведения о синхронизации `m_ofn` структуры и `CFileDialog` состояния в Windows Vista или более поздней версии.  
  
 Windows Vista или более поздней версии диалоговых окон стилей не поддерживают определенные элементы и флаги `CFileDialog`. В результате они не будет действовать.  
  
 Ниже приведен список элементов, которые не поддерживаются операционной системой Windows Vista или более поздней версии.  
  
- `lpstrCustomFilter`  
  
- `lpstrInitialDir`  
  
- `lCustData`  
  
- `lpfnHook`  
  
- `lpTemplateName`  
  
 Далее перечислены флаги не поддерживаются и поэтому не оказывают влияния при использовании Windows Vista или более поздней версии стиль `CFileDialog`:  
  
-   OFN_ENABLEHOOK  
  
-   OFN_ENABLEINCLUDENOTIFY  
  
-   OFN_ENABLETEMPLATE  
  
-   OFN_ENABLETEMPLATEHANDLE  
  
-   OFN_EXPLORER  
  
-   OFN_EXTENSIONDIFFERENT  
  
-   OFN_HIDEREADONLY  
  
-   OFN_LONGNAMES - эффективно всегда на Windows Vista или более поздней версии  
  
-   OFN_NOLONGNAMES - эффективно всегда отключен в Windows Vista или более поздней версии  
  
-   OFN_NONETWORKBUTTON - эффективно всегда на Windows Vista или более поздней версии  
  
-   OFN_READONLY  
  
-   OFN_SHOWHELP  
  
 Дополнительные сведения об этой структуры см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры в Windows SDK.  
  
##  <a name="makeprominent"></a>  CFileDialog::MakeProminent  
 Окружение элемента управления в диалоговом окне, чтобы он важные моменты по сравнению с другими элементами управления.  
  
```  
HRESULT MakeProminent(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked  
 Вызывается при нажатии кнопки.  
  
```  
virtual void OnButtonClicked(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор кнопки.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled  
 Вызывается, когда флажок устанавливается или снимается.  
  
```  
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор флажок.  
  
 `bChecked`  
 Помечен или нет.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating  
 Вызывается при активации элемента управления.  
  
```  
virtual void OnControlActivating(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNY` `изменений  
 Переопределите этот метод, если требуется обрабатывать `WM_NOTIFY` `CDN_SELCHANGE` сообщения.  
  
```  
virtual void OnFileNameChange();
```  
  
### <a name="remarks"></a>Примечания  
 Система отправляет `CDN_SELCHANGE` сообщений, когда пользователь выбирает новый файл или папку в списке файлов **откройте** или **Сохранить как** диалоговое окно. Переопределите этот метод, если вы хотите выполнять любые действия в ответ на данное сообщение.  
  
 Система отправляет это сообщение только в том случае, если диалоговое окно содержит OFN_EXPLORER включен. Дополнительные сведения о нем см. в разделе [CDN_SELCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646865). Сведения о флаге OFN_EXPLORER см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры и [открыть и сохранить диалоговым окнам](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK  
 Эту функцию можно переопределите только в том случае, если вы хотите предоставить пользовательскую проверку имен файлов, которые вводятся в стандартным диалоговым окном файла.  
  
```  
virtual BOOL OnFileNameOK();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 1, если имя файла не является допустимым именем файла; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция позволяет отклонять имя файла для какой-либо причине конкретного приложения. Как правило необязательно использовать эту функцию, так как платформа выполняет проверку по умолчанию имена файлов и отображает окно сообщения, если введено недопустимое имя файла.  
  
 Если возвращено значение 1, диалоговое окно будет отображаться для пользователя, введите другое имя файла. Процедуру диалогового окна закрывает диалоговое окно, если возвращается 0. Другие ненулевое значение, возвращают значения в данный момент зарезервированы и не должны использоваться.  
  
##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange  
 Переопределить эту функцию для обработки **WM_NOTIFYCDN_FOLDERCHANGE** сообщения.  
  
```  
virtual void OnFolderChange();
```  
  
### <a name="remarks"></a>Примечания  
 Уведомление отправляется при открытии новой папки в диалоговом окне Открытие или Сохранение документа.  
  
 Только в том случае, если диалоговое окно был создан с использованием стиля OFN_EXPLORER, отправляется уведомление. Дополнительные сведения о нем см. в разделе [CDN_FOLDERCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646859). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры и [открыть и сохранить диалоговым окнам](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="oninitdone"></a>  CFileDialog::OnInitDone  
 Переопределить эту функцию для обработки `WM_NOTIFY` `CDN_INITDONE` сообщения.  
  
```  
virtual void OnInitDone();
```  
  
### <a name="remarks"></a>Примечания  
 Система отправляет сообщение уведомления о завершении упорядочение элементов управления в системе **откройте** или **Сохранить как** диалоговое окно «», чтобы освободить место для элементов управления диалогового окна «дочернего».  
  
 Система отправляет это только в том случае, если диалоговое окно был создан с использованием стиля OFN_EXPLORER. Дополнительные сведения о нем см. в разделе [CDN_INITDONE](http://msdn.microsoft.com/library/windows/desktop/ms646863). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры и [открыть и сохранить диалоговым окнам](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
> [!NOTE]
> Windows Vista или более поздней версии диалоговых окон стилей не поддерживают эту функцию. Попытка использовать эту функцию в Windows Vista или более поздней версии диалогового окна файла стиль вызовет [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). 
  
##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected  
 Вызывается, когда выбирается элемент контейнера.  
  
```  
virtual void OnItemSelected(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify  
 Эта функция вызывается каждый раз, когда текущее выделение в поле со списком будет изменена.  
  
```  
virtual void OnLBSelChangedNotify(
    UINT nIDBox,  
    UINT iCurSel,  
    UINT nCode);
```  
  
### <a name="parameters"></a>Параметры  
 *nIDBox*  
 Идентификатор списка или поля со списком, в которой произошло выделение.  
  
 `iCurSel`  
 Индекс текущего выделенного фрагмента.  
  
 `nCode`  
 Код уведомления элемента управления. Этот параметр должен иметь одно из следующих значений:  
  
- **CD_LBSELCHANGE** указывает `iCurSel` является элемент, выбранный в поле со списком с единственным выбором.  
  
- **CD_LBSELSUB** указывает, что `iCurSel` больше не выбран в поле со списком множественного выбора.  
  
- **CD_LBSELADD** указывает, что `iCurSel` выбран в поле со списком множественного выбора.  
  
- **CD_LBSELNOITEMS** указывает, что в поле со списком множественного выбора выбора не существует.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию для предоставления обычной обработки изменения выбора в поле со списком. Например эта функция используется для отображения прав доступа или пользователь выбирает дату последнего изменения каждого файла.  
  
##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation  
 Переопределите эту функцию для предоставления обычной обработки нарушений общего ресурса.  
  
```  
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszPathName`  
 Путь к файлу, в котором произошло нарушение общего ресурса.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Одно из следующих значений:  
  
- **OFN_SHAREFALLTHROUGH** имя файла возвращается из диалогового окна.  
  
- **OFN_SHARENOWARN** требуются дальнейшие действия.  
  
- **OFN_SHAREWARN** пользователь получает стандартное сообщение предупреждения для этой ошибки.  
  
### <a name="remarks"></a>Примечания  
 Как правило необязательно использовать эту функцию, так как платформа предоставляет проверку нарушений общей папки по умолчанию и отображает окно сообщения при возникновении нарушения общего доступа.  
  
 Если вы хотите отключить проверку конфигурации общего ресурса, используйте оператор побитового или для объединения флаг **OFN_SHAREAWARE** с `m_ofn.Flags`.  
  
##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange  
 Переопределить эту функцию для обработки **WM_NOTIFYCDN_TYPECHANGE** сообщения.  
  
```  
virtual void OnTypeChange();
```  
  
### <a name="remarks"></a>Примечания  
 Уведомление отправляется, когда пользователь выбирает новый тип файлов в списке типов файлов в окне Открыть или сохранить как диалоговое окно.  
  
 Только в том случае, если диалоговое окно был создан с использованием стиля OFN_EXPLORER, отправляется уведомление. Дополнительные сведения о нем см. в разделе [CDN_TYPECHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646868). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) структуры и [открыть и сохранить диалоговым окнам](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem  
 Удаляет элемент из контейнерного элемента управления в диалоговом окне.  
  
```  
HRESULT RemoveControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор для удаления элемента из контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState  
 Задает текущее состояние кнопки «Проверка» (флажок) в диалоговом окне.  
  
```  
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор флажок.  
  
 `bChecked`  
 Состояние флажка. `TRUE` Указывает, отмеченных; `FALSE` указывает отсутствие флажка.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState  
 Задает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.  
  
```  
HRESULT SetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
 `dwState`  
 Одно или несколько значений из перечисления CDCONTROLSTATE, указывающие новое состояние элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText  
 Задает текст элемента управления. Например текст, сопровождающий типа "переключатель" или в элементе меню.  
  
```  
HRESULT SetControlItemText(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента.  
  
 `strLabel`  
 Текст элемента.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel  
 Задает текст, связанный с элементом управления, например текст кнопки или изменить метку поля.  
  
```  
HRESULT SetControlLabel(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор элемента управления.  
  
 `strLabel`  
 Имя элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState  
 Задает текущую видимость и включенные состояния для определенного элемента управления.  
  
```  
HRESULT SetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор элемента управления.  
  
 `dwState`  
 Одно или несколько значений из перечисления CDCONTROLSTATE, указывающие текущее состояние элемента управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setcontroltext"></a>  CFileDialog::SetControlText  
 Вызовите этот метод, чтобы задать текст для указанного элемента управления в стиле обозревателя **откройте** или **Сохранить как** диалоговое окно.  
  
```  
void SetControlText(
    int nID,  
    LPCSTR lpsz);

 
void SetControlText(
    int nID,  
    const wchar_t *lpsz);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `nID`  
 Идентификатор элемента управления, для которого требуется задать текст.  
  
 [in] `lpsz`  
 Указатель на строку, содержащую текст, задайте для элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Обе версии этой функции могут использоваться для приложений, использующих Юникод. Однако только версия с типом LPCSTR является допустимым для приложений, использующих [!INCLUDE[vcpransi](../../atl-mfc-shared/reference/includes/vcpransi_md.md)].  
  
 Чтобы использовать этот метод, необходимо создать диалоговое окно со стилем OFN_EXPLORER. В противном случае функции будут завершаться утверждения.  
  
##  <a name="setdefext"></a>  CFileDialog::SetDefExt  
 Вызывайте эту функцию, чтобы задать расширение имени файла по умолчанию для стиле проводника открыть или сохранить как общее диалоговое окно.  
  
```  
void SetDefExt(LPCSTR lpsz);
```  
  
### <a name="parameters"></a>Параметры  
 `lpsz`  
 Указатель на строку, содержащую расширение по умолчанию для использования объект диалогового окна. Это строка не должна содержать точку (.).  
  
### <a name="remarks"></a>Примечания  
 Диалоговое окно должна быть создана с **OFN_EXPLORER** стиля; в противном случае функция завершится сбоем с утверждением.  
  
##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText  
 Задает текущий текст в поле ввода.  
  
```  
HRESULT SetEditBoxText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор поля ввода.  
  
 `strText`  
 Текстовое значение.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setproperties"></a>  CFileDialog::SetProperties  
 Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.  
  
```  
BOOL SetProperties(LPCWSTR lpszPropList);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszPropList`  
 Список предварительно заданных свойств, разделенных точкой с запятой (";"). Список флагов см. в разделе `Flags` раздел [OPENFILENAME](http://msdn.microsoft.com/en-us/8cecfd45-f7c1-4f8d-81a0-4e7fecc3b104).  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem  
 Задает выделен какой-либо элемент в группе или поле со списком в диалоговом окне.  
  
```  
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор контейнерного элемента управления.  
  
 `dwIDItem`  
 Идентификатор элемента, выбранного пользователем в элементе управления.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="settemplate"></a>  CFileDialog::SetTemplate  
 Задает поле шаблона диалогового окна для [CFileDialog](../../mfc/reference/cfiledialog-class.md) объекта.  
  
```  
void SetTemplate(
    UINT nWin3ID,  
    UINT nWin4ID);

 
void SetTemplate(
    LPCTSTR lpWin3ID,  
    LPCTSTR lpWin4ID);
```  
  
### <a name="parameters"></a>Параметры  
 [in] `nWin3ID`  
 Содержит идентификатор ресурса шаблона для не обозревателя `CFileDialog` объекта. Этот шаблон используется только на Windows NT 3.51, или если стиль OFN_EXPLORER не присутствует.  
  
 [in] `nWin4ID`  
 Содержит идентификатор ресурса шаблона для обозревателя `CFileDialog` объекта. Этот шаблон используется только в [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] и более поздних версий, Windows 95 и более поздних версий, или когда имеется стиль OFN_EXPLORER.  
  
 [in] `lpWin3ID`  
 Содержит имя ресурса шаблона для не обозревателя `CFileDialog` объекта. Этот шаблон используется только на Windows NT 3.51, или если стиль OFN_EXPLORER не присутствует.  
  
 [in] `lpWin4ID`  
 Содержит имя ресурса шаблона обозревателя `CFileDialog` объекта. Этот шаблон используется только в [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] и более поздних версий, Windows 95 и более поздних версий, или когда имеется стиль OFN_EXPLORER.  
  
### <a name="remarks"></a>Примечания  
 Система будет использовать только один из указанные шаблоны. Система определяет, какой шаблон нужно использовать в зависимости от наличия стиль OFN_EXPLORER и операционной системы, приложения на. Указывая шаблон в стиле проводника и не Explorer, можно легко поддержки Windows NT 3.51 [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] и более поздних версиях Windows 95 и более поздние версии.  
  
> [!NOTE]
> Windows Vista или более поздней версии стиль диалоговых не поддерживает данную функцию. Попытка использовать эту функцию в Windows Vista или более поздней версии стиля ― диалоговое окно файла вызовет [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Альтернативой является использование настраиваемого диалогового окна. Дополнительные сведения об использовании пользовательского `CFileDialog`, в разделе [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup  
 Объявляет visual группы в диалоговом окне. Последующие вызовы с любым методом «добавить» добавьте эти элементы в эту группу.  
  
```  
HRESULT StartVisualGroup(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwIDCtl`  
 Идентификатор группы visual.  
  
 `strLabel`  
 Имя группы.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog  
 Обновления `m_ofn` структура данных [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основе текущего состояния внутреннего объекта.  
  
```  
void UpdateOFNFromShellDialog();
```  
  
### <a name="remarks"></a>Примечания  
 В версиях Windows, предшествующих Windows Vista, член [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) структуру данных постоянно был синхронизирован с состоянием `CFileDialog`. Любые изменения [m_ofn](#m_ofn) переменной-члена напрямую влияет на состояние диалогового окна. Кроме того любые изменения состояния диалогового окна немедленно m_ofn переменной-члена.  
  
 В Windows Vista или более поздней версии `m_ofn` структура данных не обновляется автоматически. Чтобы гарантировать точность данных в `m_ofn` переменную-член, необходимо вызвать `UpdateOFNFromShellDialog` функция перед доступом к данным. Windows вызывает эту функцию автоматически во время обработки [IFileDialog::OnFileOK](http://msdn.microsoft.com/library/windows/desktop/bb775879).  
  
 Дополнительные сведения об использовании `CFileDialog` класса в Windows Vista или более поздней версии, см. раздел [класс CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Пример  
 В этом примере обновляется `CFileDialog` перед его отображением. Перед обновлением `m_ofn` переменной-члена, нам нужно синхронизировать его с текущим состоянием диалогового окна.  
  
 [!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Класс CCommonDialog](../../mfc/reference/ccommondialog-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)

