---
title: "CMetaFileDC-класс | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMetaFileDC
- AFXEXT/CMetaFileDC
- AFXEXT/CMetaFileDC::CMetaFileDC
- AFXEXT/CMetaFileDC::Close
- AFXEXT/CMetaFileDC::CloseEnhanced
- AFXEXT/CMetaFileDC::Create
- AFXEXT/CMetaFileDC::CreateEnhanced
dev_langs:
- C++
helpviewer_keywords:
- CMetaFileDC class
- Windows metafiles [C++]
- metafiles, implementing
ms.assetid: ffce60fa-4181-4d46-9832-25e46fad4db4
caps.latest.revision: 23
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 040985df34f2613b4e4fae29498721aef15d50cb
ms.openlocfilehash: 4bff4d7601c4ffbc6fe5cbe73f5e057b79abf1e5
ms.lasthandoff: 02/24/2017

---
# <a name="cmetafiledc-class"></a>CMetaFileDC-класс
Реализует метафайл Windows, который содержит последовательность команд интерфейса графических устройств (GDI), которые можно воспроизвести для создания нужного изображения или текста.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CMetaFileDC : public CDC  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CMetaFileDC::CMetaFileDC](#cmetafiledc)|Создает объект `CMetaFileDC`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CMetaFileDC::Close](#close)|Закрывает контекст устройства и создает дескриптор метафайла.|  
|[CMetaFileDC::CloseEnhanced](#closeenhanced)|Закрывает контекст устройства расширенного метафайла и создает дескриптор расширенного метафайла.|  
|[CMetaFileDC::Create](#create)|Создает контекст устройства метафайл Windows и присоединяет его к `CMetaFileDC` объекта.|  
|[CMetaFileDC::CreateEnhanced](#createenhanced)|Создает контекст устройства метафайла для расширенного формата метафайла.|  
  
## <a name="remarks"></a>Примечания  
 Чтобы реализовать метафайл Windows, сначала создайте `CMetaFileDC` объекта. Вызвать `CMetaFileDC` конструктора, затем вызовите [создать](#create) функция-член, который создает контекст устройства метафайл Windows и присоединяет его к `CMetaFileDC` объекта.  
  
 После отправки `CMetaFileDC` объекта последовательность `CDC` GDI команды, предназначенные для того, чтобы воспроизвести. Только те команды GDI, созданные выходные данные, такие как `MoveTo` и `LineTo`, можно использовать.  
  
 После отправки нужных команд в метафайл вызвать **закрыть** функция-член, который закрывает контексты устройств метафайла и возвращает дескриптор метафайла. Затем `CMetaFileDC` объекта.  
  
 [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) затем можно использовать дескриптор метафайла для воспроизведения метафайл несколько раз. Метафайл можно также управлять функциями Windows например [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480), метафайл копирование на диск.  
  
 Когда метафайл больше не нужен, удалите его из памяти с [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) функции Windows.  
  
 Также можно реализовать `CMetaFileDC` объект так, чтобы он может обрабатывать оба выходные вызовов и атрибут GDI вызовы, например `GetTextExtent`. Такие метафайл является более гибким и несколько упрощает повторное использование общего кода GDI, которая часто состоит из набора выходных данных и атрибута вызовов. `CMetaFileDC` Класс наследует двух контекстах устройств `m_hDC` и `m_hAttribDC`, из `CDC`. `m_hDC` Контекст устройства обрабатывает все [CDC](../../mfc/reference/cdc-class.md) GDI вывод вызовов и `m_hAttribDC` контекст устройства обрабатывает все `CDC` атрибут вызывает GDI. Как правило эти два устройства контекстов см. на одном устройстве. В случае использования `CMetaFileDC`, DC атрибута задано значение **NULL** по умолчанию.  
  
 Создайте второй контекст устройства, который указывает на экране, принтера или устройства, отличного от метафайл, затем вызовите `SetAttribDC` функции-члена для связывания контекст устройства с `m_hAttribDC`. Вызовы GDI сведения будут направляться в новый `m_hAttribDC`. Вызовы GDI выходных данных будет отправлена `m_hDC`, который представляет метафайл.  
  
 Дополнительные сведения о `CMetaFileDC`, в разделе [контексты устройств](../../mfc/device-contexts.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CDC](../../mfc/reference/cdc-class.md)  
  
 `CMetaFileDC`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** файле afxext.h  
  
##  <a name="close"></a>CMetaFileDC::Close  
 Закрывает контекст устройства метафайла и создает дескриптор метафайла Windows, который можно использовать для воспроизведения метафайла с помощью [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) функции-члена.  
  
```  
HMETAFILE Close();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Является допустимым **HMETAFILE** Если функция выполнена успешно; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Дескриптор метафайла Windows может также использоваться для управления метафайла с функциями Windows, такие как [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480).  
  
 Удаление метафайл после использования, вызвав Windows [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) функции.  
  
##  <a name="closeenhanced"></a>CMetaFileDC::CloseEnhanced  
 Закрывает контекст устройства расширенного метафайла и возвращает дескриптор, который определяет расширенный формат метафайла.  
  
```  
HENHMETAFILE CloseEnhanced();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор расширенного метафайла, если выполнено успешно; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Приложение может использовать дескриптор расширенного метафайла, возвращаемый этой функцией для выполнения следующих задач:  
  
-   Изображение хранится в расширенный метафайл  
  
-   Создание копии расширенный метафайл  
  
-   Перечисление, изменить или скопировать отдельные записи в расширенный метафайл  
  
-   Получить необязательное описание содержимого метафайла из заголовка расширенного метафайла  
  
-   Получите копию заголовок расширенного метафайла  
  
-   Получение двоичных копии расширенный метафайл  
  
-   Перечислить цвета в палитре необязательно  
  
-   Преобразовать расширенный формат метафайла в Windows формате метафайла  
  
 Если приложение больше не нужна дескриптор расширенного метафайла, он должен освободить дескриптор путем вызова функции Win32 **DeleteEnhMetaFile** функции.  
  
##  <a name="cmetafiledc"></a>CMetaFileDC::CMetaFileDC  
 Создать `CMetaFileDC` объекта в два этапа.  
  
```  
CMetaFileDC();
```  
  
### <a name="remarks"></a>Примечания  
 Во-первых, вызовите `CMetaFileDC`, затем вызовите **создать**, который создает контекст устройства метафайл Windows и присоединяет его к `CMetaFileDC` объекта.  
  
##  <a name="create"></a>CMetaFileDC::Create  
 Создать `CMetaFileDC` объекта в два этапа.  
  
```  
BOOL Create(LPCTSTR lpszFilename = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszFilename*  
 Указывает строку, завершающуюся значением null. Задает имя файла для создания метафайла. Если *lpszFilename* — **NULL**, создается новый метафайл в памяти.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Во-первых, вызовите конструктор `CMetaFileDC`, затем вызовите **создать**, который создает контекст устройства метафайл Windows и присоединяет его к `CMetaFileDC` объекта.  
  
##  <a name="createenhanced"></a>CMetaFileDC::CreateEnhanced  
 Создает контекст устройства для расширенный формат метафайла.  
  
```  
BOOL CreateEnhanced(
    CDC* pDCRef,  
    LPCTSTR lpszFileName,  
    LPCRECT lpBounds,  
    LPCTSTR lpszDescription);
```  
  
### <a name="parameters"></a>Параметры  
 `pDCRef`  
 Идентифицирует устройство ссылку Расширенный метафайл.  
  
 `lpszFileName`  
 Указывает строку, завершающуюся значением null. Задает имя файла для расширенного метафайла, должен быть создан. Если этот параметр равен **NULL**, расширенный метафайл является на основе памяти и его содержимое, потеряны при уничтожении объекта или Win32 **DeleteEnhMetaFile** вызывается функция.  
  
 `lpBounds`  
 Указывает [RECT](../../mfc/reference/rect-structure1.md) структуру данных или [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, который указывает размеры в **HIMETRIC** единиц (с шагом.01 миллиметра) изображения для сохранения в расширенный метафайл.  
  
 `lpszDescription`  
 Указывает нулем строка, указывающая имя приложения, создавшего рисунок, а также его название.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор контекста устройства для расширенного метафайла, в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Этот контроллер домена может использоваться для хранения аппаратно независимые рисунка.  
  
 Windows использует устройство ссылку, идентифицируемый `pDCRef` параметр для записи разрешения и единиц устройства был записан рисунка. Если `pDCRef` параметр **NULL**, используется текущее устройство отображения для ссылки.  
  
 Члены левой или верхней `RECT` структуру данных, на который указывает `lpBounds` параметр должен быть меньше, чем члены вправо и вниз, соответственно. На рисунке включаются точек вдоль краев прямоугольника. Если `lpBounds` — **NULL**, интерфейса графических устройств (GDI) вычисляет размеры наименьший прямоугольник, можно заключить рисунок рисуется приложением. `lpBounds` Следует указать параметр, где это возможно.  
  
 Строка, на который указывает `lpszDescription` параметр должен содержать символ null между имя приложения и имя рисунка и должны завершить работу с двумя символами null — например, «XYZ графики Editor\0Bald Eagle\0\0, «где \0 представляет символ null. Если `lpszDescription` — **NULL**, нет соответствующей записи в заголовке расширенного метафайла.  
  
 Контроллер домена, созданные с помощью функции используются приложениями для хранения графические изображения в расширенный метафайл. Дескриптор, идентифицирующий этот контроллер домена может быть передан любой функции GDI.  
  
 После приложение сохраняет изображение в расширенный метафайл, его можно отобразить изображение на любом устройстве вывода путем вызова `CDC::PlayMetaFile` функции. При отображении рисунка, Windows использует прямоугольник, который указывает `lpBounds` параметров и данных разрешения от устройства ссылку для размещения и масштабирования изображения. Контекст устройства, возвращаемый этой функцией содержит же атрибуты по умолчанию, связанные с любого нового контроллера домена.  
  
 Приложения должны использовать Win32 **GetWinMetaFileBits** функцию для преобразования расширенный метафайл старый формат метафайла Windows.  
  
 Следует использовать имя файла для расширенного метафайла. Расширение EMF.  
  
## <a name="see-also"></a>См. также  
 [CDC-класс](../../mfc/reference/cdc-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)




