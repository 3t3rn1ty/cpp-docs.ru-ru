---
title: CMetaFileDC-класс | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMetaFileDC
- AFXEXT/CMetaFileDC
- AFXEXT/CMetaFileDC::CMetaFileDC
- AFXEXT/CMetaFileDC::Close
- AFXEXT/CMetaFileDC::CloseEnhanced
- AFXEXT/CMetaFileDC::Create
- AFXEXT/CMetaFileDC::CreateEnhanced
dev_langs:
- C++
helpviewer_keywords:
- CMetaFileDC [MFC], CMetaFileDC
- CMetaFileDC [MFC], Close
- CMetaFileDC [MFC], CloseEnhanced
- CMetaFileDC [MFC], Create
- CMetaFileDC [MFC], CreateEnhanced
ms.assetid: ffce60fa-4181-4d46-9832-25e46fad4db4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 6a588a848e7964a70f47d4cf29a5f5ef2741881d
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="cmetafiledc-class"></a>CMetaFileDC-класс
Реализует метафайл Windows, который содержит последовательность команд интерфейса графических устройств (GDI), которые можно воспроизвести для создания нужного изображения или текста.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CMetaFileDC : public CDC  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CMetaFileDC::CMetaFileDC](#cmetafiledc)|Создает объект `CMetaFileDC`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CMetaFileDC::Close](#close)|Закрывает контекст устройства и создает дескриптор метафайла.|  
|[CMetaFileDC::CloseEnhanced](#closeenhanced)|Закрывает контекст устройства расширенного метафайла и создает дескриптор расширенного метафайла.|  
|[CMetaFileDC::Create](#create)|Создает контекст устройства метафайла Windows и прикрепляет его к `CMetaFileDC` объекта.|  
|[CMetaFileDC::CreateEnhanced](#createenhanced)|Создает контекст устройства метафайла для расширенного формата метафайла.|  
  
## <a name="remarks"></a>Примечания  
 Чтобы реализовать метафайл Windows, сначала создайте `CMetaFileDC` объекта. Вызвать `CMetaFileDC` конструктора, затем вызовите [создать](#create) функция-член, который создает контекст устройства метафайла Windows и прикрепляет его к `CMetaFileDC` объекта.  
  
 После отправки `CMetaFileDC` объекта последовательность `CDC` GDI команды, предназначенные для того, чтобы воспроизвести. Только GDI команд, создание выходных данных, таких как `MoveTo` и `LineTo`, можно использовать.  
  
 После отправки нужные команды в метафайл вызвать **закрыть** функция-член, закрывает контексты устройств метафайла, и возвращает дескриптор метафайла. Затем `CMetaFileDC` объекта.  
  
 [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) дескриптора метафайла затем можно использовать для воспроизведения метафайла несколько раз. Метафайл можно также управлять функциями Windows например [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480), который копирует метафайл на диск.  
  
 При метафайла больше не нужен, он удаляется из памяти с [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) функции Windows.  
  
 Вы также можете реализовать `CMetaFileDC` объект так, чтобы она может обрабатывать оба выходные вызовов и атрибут GDI вызовы, например `GetTextExtent`. Такие метафайл является более гибким и несколько упрощает повторное использование общих GDI код, который часто состоит в себя вызовы выходных данных и атрибута. `CMetaFileDC` Класс наследует двух контекстах устройств `m_hDC` и `m_hAttribDC`, из `CDC`. `m_hDC` Контекст устройства обрабатывает все [CDC](../../mfc/reference/cdc-class.md) GDI вывода вызовов и `m_hAttribDC` контекст устройства обрабатывает все `CDC` атрибут вызывает GDI. Как правило эти контексты устройств два см. в том же самом устройстве. В случае использования `CMetaFileDC`, атрибут контроллер домена имеет значение **NULL** по умолчанию.  
  
 Создайте второй контекст устройства, который указывает на экране, принтер или устройства, отличного от метафайла, затем вызовите `SetAttribDC` функции-члена для связывания контекст устройства с `m_hAttribDC`. Вызовы GDI сведения теперь будет направлен на новый `m_hAttribDC`. Вызовы GDI выходных данных будет отправлена `m_hDC`, который представляет метафайл.  
  
 Дополнительные сведения о `CMetaFileDC`, в разделе [контексты устройств](../../mfc/device-contexts.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CDC](../../mfc/reference/cdc-class.md)  
  
 `CMetaFileDC`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxext.h  
  
##  <a name="close"></a>  CMetaFileDC::Close  
 Закрывает контексте устройства метафайла и создает дескриптор метафайла Windows, который можно использовать для воспроизведения с помощью метафайла [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) функции-члена.  
  
```  
HMETAFILE Close();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Является допустимым **HMETAFILE** Если функция выполнена успешно; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Дескриптор метафайла Windows может также использоваться для управления метафайла с функциями Windows, таких как [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480).  
  
 Удалить метафайла после использования, вызвав Windows [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) функции.  
  
##  <a name="closeenhanced"></a>  CMetaFileDC::CloseEnhanced  
 Закрывает контекст устройства расширенного метафайла и возвращает дескриптор, который идентифицирует расширенный формат метафайла.  
  
```  
HENHMETAFILE CloseEnhanced();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор расширенного метафайла, в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Приложение может использовать дескриптор расширенного метафайла, возвращаемое этой функцией, для выполнения следующих задач:  
  
-   Отображать изображение хранится в расширенный метафайл  
  
-   Создание копии Metafile — расширенный метафайл  
  
-   Перечисление, изменить или скопировать отдельных записей в расширенный метафайл  
  
-   Извлечь из заголовка расширенного метафайла необязательное описание содержимого метафайл  
  
-   Сохраните копию заголовок расширенного метафайла  
  
-   Сохраните копию двоичного Metafile — расширенный метафайл  
  
-   Перечислить цветов в палитре необязательно  
  
-   Преобразовать расширенный формат метафайла в формате Windows метафайл  
  
 Если приложение больше не нужна дескриптор расширенного метафайла, он должен освободить дескриптор, вызывая функцию Win32 **DeleteEnhMetaFile** функции.  
  
##  <a name="cmetafiledc"></a>  CMetaFileDC::CMetaFileDC  
 Создать `CMetaFileDC` объекта в два этапа.  
  
```  
CMetaFileDC();
```  
  
### <a name="remarks"></a>Примечания  
 Во-первых, вызовите `CMetaFileDC`, затем вызовите **создать**, который создает контекст устройства метафайла Windows и прикрепляет его к `CMetaFileDC` объекта.  
  
##  <a name="create"></a>  CMetaFileDC::Create  
 Создать `CMetaFileDC` объекта в два этапа.  
  
```  
BOOL Create(LPCTSTR lpszFilename = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszFilename*  
 Указывает строку, завершающуюся значением null. Задает имя файла для создания метафайла. Если *lpszFilename* — **NULL**, создается новый метафайл в памяти.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Во-первых, вызовите конструктор `CMetaFileDC`, затем вызовите **создать**, который создает контекст устройства метафайла Windows и прикрепляет его к `CMetaFileDC` объекта.  
  
##  <a name="createenhanced"></a>  CMetaFileDC::CreateEnhanced  
 Создает контекст устройства для расширенного формата метафайла.  
  
```  
BOOL CreateEnhanced(
    CDC* pDCRef,  
    LPCTSTR lpszFileName,  
    LPCRECT lpBounds,  
    LPCTSTR lpszDescription);
```  
  
### <a name="parameters"></a>Параметры  
 `pDCRef`  
 Определяет устройство ссылку для расширенного метафайла.  
  
 `lpszFileName`  
 Указывает строку, завершающуюся значением null. Задает имя файла для расширенного метафайла должен быть создан. Если этот параметр имеет **NULL**, расширенный метафайл — на основе памяти и ее содержимое, теряются при уничтожении объекта или Win32 **DeleteEnhMetaFile** функция.  
  
 `lpBounds`  
 Указывает на [RECT](../../mfc/reference/rect-structure1.md) структуру данных или [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта, который задает размеры в **HIMETRIC** единицы (приращением.01 мм) изображения для сохранения в расширенный метафайл.  
  
 `lpszDescription`  
 Указывает нулем строка, указывающая имя приложения, создавшего рисунок, а также его заголовок.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор контекста устройства для расширенного метафайла, в случае успешного выполнения; в противном случае **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Этот контроллер домена можно использовать для хранения аппаратно независимые рисунка.  
  
 Windows использует устройство ссылки определяется `pDCRef` параметр для записи разрешения и единицы устройства был записан рисунка. Если `pDCRef` параметр **NULL**, используется для ссылки на текущее устройство отображения.  
  
 Члены левую и верхнюю `RECT` структуру данных, на который указывает `lpBounds` параметр должен быть меньше, чем члены справа и снизу соответственно. На рисунке включаются точек вдоль границ прямоугольника. Если `lpBounds` — **NULL**, интерфейс графических устройств (GDI) вычисляет размеры наименьший прямоугольник, можно заключить рисунок рисуется приложением. `lpBounds` Параметр должен быть получен, где это возможно.  
  
 Строка, на который указывает `lpszDescription` параметр должен содержать символ null, от имени приложения и имени рисунок и должны завершить работу с двумя символами null — например, «XYZ графики Editor\0Bald Eagle\0\0, «где \0 представляет значение null символ. Если `lpszDescription` — **NULL**, отсутствует соответствующий запись в заголовке расширенного метафайла.  
  
 Приложения используют контроллера домена, созданные с помощью функции для хранения графики рисунок в расширенный метафайл. Дескриптор, идентифицирующий этот контроллер домена могут передаваться любой функции GDI.  
  
 После приложение сохраняет изображение в расширенный метафайл, он может отображать изображение на любом устройстве вывода путем вызова `CDC::PlayMetaFile` функции. При отображении на рисунке, Windows использует прямоугольник, который указывает `lpBounds` параметров и данных разрешения с устройства ссылку для размещения и масштабирования изображения. Контекст устройства, возвращаемое этой функцией содержит одинаковые атрибуты по умолчанию, связанные с любого нового контроллера домена.  
  
 Приложения должны использовать Win32 **GetWinMetaFileBits** функцию для преобразования расширенный метафайл старый формат метафайла Windows.  
  
 Имя файла для расширенного метафайла следует использовать. Расширение EMF.  
  
## <a name="see-also"></a>См. также  
 [CDC-класс](../../mfc/reference/cdc-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)



