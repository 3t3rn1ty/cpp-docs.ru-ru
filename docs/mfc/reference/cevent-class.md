---
title: "Класс CEvent | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CEvent
- AFXMT/CEvent
- AFXMT/CEvent::CEvent
- AFXMT/CEvent::PulseEvent
- AFXMT/CEvent::ResetEvent
- AFXMT/CEvent::SetEvent
- AFXMT/CEvent::Unlock
dev_langs:
- C++
helpviewer_keywords:
- synchronization objects, event
- synchronization classes, CEvent class
- CEvent class
ms.assetid: df676042-ce27-4702-800a-e73ff4f44395
caps.latest.revision: 27
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 040985df34f2613b4e4fae29498721aef15d50cb
ms.openlocfilehash: 9edadeec87cf04ae6166c173c65463d1509eb1d8
ms.lasthandoff: 02/24/2017

---
# <a name="cevent-class"></a>Класс CEvent
Представляет событие, которое представляет объект синхронизации, позволяющий одному потоку известить другой, что произошло событие поток.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CEvent : public CSyncObject  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CEvent::CEvent](#cevent)|Создает объект `CEvent`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CEvent::PulseEvent](#pulseevent)|Задает доступные события (сигнал) освобождает ожидающих потоков и устанавливает событие недоступен (несигнальное).|  
|[CEvent::ResetEvent](#resetevent)|Задает событие недоступен (несигнальное).|  
|[CEvent::SetEvent](#setevent)|Задает событие недоступен (сигнальное) и освобождает все ожидающие потоки.|  
|[CEvent::Unlock](#unlock)|Освобождает объект события.|  
  
## <a name="remarks"></a>Примечания  
 События полезны, когда поток должны знать, что для выполнения задачи. Например поток, который копирует данные в архив данных необходимо уведомление при доступности новых данных. С помощью `CEvent` объекту уведомлять копирования потока, если новые данные доступны, поток мог выполнить свою задачу как можно быстрее.  
  
 `CEvent`объекты имеют два типа: ручная и автоматическая.  
  
 Автоматическое `CEvent` объекта автоматически возвращает несигнальное состояние (недоступно) после выпуска по крайней мере один поток. По умолчанию `CEvent` объекта выполняется автоматически, если передается `TRUE` для `bManualReset` параметра во время конструирования.  
  
 Вручную `CEvent` объект остается в состоянии, установленном [SetEvent](#setevent) или [ResetEvent](#resetevent) до вызова другой функции. Чтобы вручную создать `CEvent` объекта, передайте `TRUE` для `bManualReset` параметра во время конструирования.  
  
 Для использования `CEvent` объекта, создания `CEvent` объекта, если это требуется. Укажите имя события, которое требуется ожидание, а также указать, что приложение должно изначально принадлежит. Также будут доступны после завершения работы конструктор возвращает событие. Вызов [SetEvent](#setevent) сигнал (сделать доступной) объект события, а затем вызовите метод [Unlock](#unlock) после доступа к управляемому ресурсу.  
  
 Альтернативный метод с помощью `CEvent` объектов является добавление переменной типа `CEvent` как данные-член класса, который вы хотите управлять. Во время создания управляемого объекта, вызовите конструктор `CEvent` член данных и укажите ли изначально сигнальным события, а также тип specifythe события объекта, имя события (если оно будет использоваться через границы процессов), а все параметры безопасности на атрибуты, которые нужно.  
  
 Для доступа к ресурсу, контролируются `CEvent` объекта таким образом, сначала создайте переменную любого типа [класс CSingleLock](../../mfc/reference/csinglelock-class.md) или [CMultiLock](../../mfc/reference/cmultilock-class.md) в методе доступа к ресурсу. Затем вызовите `Lock` метод блокировки объекта (например, [CMultiLock::Lock](../../mfc/reference/cmultilock-class.md#lock)). На этом этапе поток будет либо получить доступ к ресурсу, ожидания ресурса снимаются и получить доступ или дождаться освобождения ресурса, время ожидания и не смогут получить доступ к ресурсу. В любом случае ресурс осуществлялся в потокобезопасным способом. Для освобождения ресурса, вызовите `SetEvent` сигнала объект события, и затем использовать `Unlock` метод блокировки объекта (например, [CMultiLock::Unlock](../../mfc/reference/cmultilock-class.md#unlock)), или позволить объект блокировки выходит из области действия.  
  
 Дополнительные сведения об использовании `CEvent` объектов, в разделе [Многопоточность: использование классов синхронизации](../../parallel/multithreading-how-to-use-the-synchronization-classes.md).  
  
## <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_Utilities&#45;](../../mfc/codesnippet/cpp/cevent-class_1.cpp)]  
  
 [!code-cpp[NVC_MFC_Utilities&#46;](../../mfc/codesnippet/cpp/cevent-class_2.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CSyncObject](../../mfc/reference/csyncobject-class.md)  
  
 `CEvent`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxmt.h  
  
##  <a name="cevent"></a>CEvent::CEvent  
 Создает именованные `CEvent` объекта.  
  
```  
CEvent(
    BOOL bInitiallyOwn = FALSE,  
    BOOL bManualReset = FALSE,  
    LPCTSTR lpszName = NULL,  
    LPSECURITY_ATTRIBUTES lpsaAttribute = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `bInitiallyOwn`  
 Если **TRUE**, поток для **CMultilock** или `CSingleLock` объект включен. Необходимо отложить все потоки, желающих получить доступ к ресурсу.  
  
 *bManualReset*  
 Если **TRUE**, указывает, что объект события является событием вручную, в противном случае объект события автоматического события.  
  
 `lpszName`  
 Имя объекта `CEvent`. Должен быть указан, если объект будет использоваться через границы процессов. Если имя соответствует существующего события, конструктор создает новый `CEvent` объект, который ссылается на событие с этим именем. Если имя соответствует объект синхронизации, не является событием, построение завершится ошибкой. Если **NULL**, имя будет иметь значение null.  
  
 `lpsaAttribute`  
 Атрибуты безопасности для объекта события. Полное описание этой структуры см. в разделе [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) в [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
### <a name="remarks"></a>Примечания  
 Доступ или выпуска `CEvent` объекта, создайте [CMultiLock](../../mfc/reference/cmultilock-class.md) или [класс CSingleLock](../../mfc/reference/csinglelock-class.md) и вызовите его [блокировки](../../mfc/reference/csinglelock-class.md#lock) и [Unlock](../../mfc/reference/csinglelock-class.md#unlock) функции-члены.  
  
 Чтобы изменить состояние `CEvent` объекта несигнальное (потоки не нужна), вызовите [SetEvent](#setevent) или [PulseEvent](#pulseevent). Чтобы задать состояние `CEvent` объекта несигнальное (потоки должны ждать), вызовите [ResetEvent](#resetevent).  
  
> [!IMPORTANT]
>  После создания `CEvent` , используйте [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) чтобы убедиться, что объект взаимного исключения не существует. Если мьютекс существовал неожиданно, это может означать нелегальные процессы — занятие и может вы собираетесь использовать мьютекса злоумышленником. В этом случае соображениям безопасности рекомендуется закрыть дескриптор и продолжается как, если произошел сбой при создании объекта.  
  
##  <a name="pulseevent"></a>CEvent::PulseEvent  
 Задает состояние сигнала события (доступно), освобождает все ожидающие потоки и сбрасывает ее несигнальное (недоступно) автоматически.  
  
```  
BOOL PulseEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если событие вручную, все ожидающие потоки освобождаются, то событие включается в несигнальное и `PulseEvent` возвращает. Если автоматическое событие освобождается один поток, то событие включается в несигнальное и `PulseEvent` возвращает.  
  
 Если нет ожидающих потоков, или потоки не могут быть сняты немедленно, `PulseEvent` Задает несигнальное состояние события и возвращает.  
  
 `PulseEvent`использует базовый Win32 `PulseEvent` функции, которая может ненадолго удален из состояния ожидания при вызове асинхронных процедур в режиме ядра. Таким образом `PulseEvent` является ненадежным и должен использоваться не новые приложения. Дополнительные сведения см. в разделе [PulseEvent функция](http://msdn.microsoft.com/library/windows/desktop/ms684914).  
  
##  <a name="resetevent"></a>CEvent::ResetEvent  
 Задает состояние события несигнальное до явно задать до получения сигнала, [SetEvent](#setevent) функции-члена.  
  
```  
BOOL ResetEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 В результате все потоки, которым требуется доступ к событию ожидания.  
  
 Эта функция-член не используется автоматическое событиями.  
  
##  <a name="setevent"></a>CEvent::SetEvent  
 Задает состояние события, получает сигнал, освобождая все ожидающие потоки.  
  
```  
BOOL SetEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно, в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если событие вручную, это событие будет оставаться сигнал до [ResetEvent](#resetevent) вызывается. В этом случае могут поставляться более чем одним потоком. События выполняется автоматически, события остается сигнальным до освобождения одного потока. Система затем установит несигнальное состояние события. Если нет ожидающих потоков, состояние остается в сигнальном состоянии до освобождения одного потока.  
  
##  <a name="unlock"></a>CEvent::Unlock  
 Освобождает объект события.  
  
```  
BOOL Unlock();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если поток владеет объект события и событие автоматического события; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член вызывается потоков, которые в данный момент принадлежит событие автоматического освобождения после завершения, если их объект блокировки для повторного использования. Если объект блокировки не будут использоваться повторно, эта функция вызывается деструктор объекта блокировок.  
  
## <a name="see-also"></a>См. также  
 [Класс CSyncObject](../../mfc/reference/csyncobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)


