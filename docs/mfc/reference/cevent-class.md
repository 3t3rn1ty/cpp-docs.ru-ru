---
title: Класс CEvent | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CEvent
- AFXMT/CEvent
- AFXMT/CEvent::CEvent
- AFXMT/CEvent::PulseEvent
- AFXMT/CEvent::ResetEvent
- AFXMT/CEvent::SetEvent
- AFXMT/CEvent::Unlock
dev_langs:
- C++
helpviewer_keywords:
- CEvent [MFC], CEvent
- CEvent [MFC], PulseEvent
- CEvent [MFC], ResetEvent
- CEvent [MFC], SetEvent
- CEvent [MFC], Unlock
ms.assetid: df676042-ce27-4702-800a-e73ff4f44395
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 8450f4b4105f5302750ea0f369d0e6c1dc2925ab
ms.sourcegitcommit: c6b095c5f3de7533fd535d679bfee0503e5a1d91
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2018
ms.locfileid: "36950889"
---
# <a name="cevent-class"></a>Класс CEvent
Представляет событие, которое представляет объект синхронизации, позволяющий одному потоку известить другой, произошло событие поток.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CEvent : public CSyncObject  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CEvent::CEvent](#cevent)|Создает объект `CEvent`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CEvent::PulseEvent](#pulseevent)|Задает доступные события (сигнал) освобождает ожидающих потоков и задает событие на недоступный (несигнальное).|  
|[CEvent::ResetEvent](#resetevent)|Задает событие на недоступный (несигнальное).|  
|[CEvent::SetEvent](#setevent)|Освобождает все ожидающие потоки и задает событие недоступен (сигнальное).|  
|[CEvent::Unlock](#unlock)|Освобождает объект события.|  
  
## <a name="remarks"></a>Примечания  
 События полезны в тех случаях, когда поток должен знать, когда для выполнения задачи. Например поток, который копирует данные в архив данных должен уведомляться станут доступны новые данные. С помощью `CEvent` объекту уведомлять потока копирования, если новые данные доступны, как можно быстрее поток мог выполнить свою задачу.  
  
 `CEvent` объекты имеют два типа: ручная и автоматическая.  
  
 Автоматическое `CEvent` объект автоматически возвращает несигнальное состояние (недоступно) после выпуска по крайней мере один поток. По умолчанию `CEvent` объекта выполняется автоматически только при проведении `TRUE` для *bManualReset* параметра во время построения.  
  
 Ручной `CEvent` объект остается в состоянии, установленном [SetEvent](#setevent) или [ResetEvent](#resetevent) до вызова другой функции. Для создания ручного `CEvent` , передать `TRUE` для `bManualReset` параметра во время построения.  
  
 Для использования `CEvent` объектов, создания `CEvent` объекта, если это требуется. Укажите имя события, которое требуется ожидать, а также указать, что приложение должно изначально он принадлежит вам. Затем можно получить доступ к событие во время завершения работы конструктор возвращает. Вызовите [SetEvent](#setevent) сигнал (сделать доступными) объекта события, а затем вызовите метод [Unlock](#unlock) после доступа к управляемому ресурсу.  
  
 Альтернативный метод с помощью `CEvent` объектов является добавление переменной типа `CEvent` как данные-члены класса, который вы хотите контролировать. При создании управляемого объекта, вызывает конструктор `CEvent` элемент данных и указать ли изначально сигнальным события, а также specifythe тип добавляемого события объекта, имя события (если он будет использоваться в процессе границы) и любые атрибуты безопасности требуется.  
  
 Для доступа к ресурсу, контролируются `CEvent` таким образом, следует сначала создать переменную любого из этих типов [класс CSingleLock](../../mfc/reference/csinglelock-class.md) или тип [CMultiLock](../../mfc/reference/cmultilock-class.md) в методе доступа ресурса. Затем вызовите `Lock` метод блокировку объекта (например, [CMultiLock::Lock](../../mfc/reference/cmultilock-class.md#lock)). На этом этапе поток будет либо получить доступ к ресурс, Ожидание, ресурс освобождается и получить доступ или ожидать освобождения ресурса, время ожидания и не смогут получить доступ к ресурсу. В любом случае ресурс осуществлялся в потокобезопасным способом. Для освобождения ресурса, вызовите `SetEvent` указывают, объект события, а затем использовать `Unlock` метод блокировку объекта (например, [CMultiLock::Unlock](../../mfc/reference/cmultilock-class.md#unlock)), или оставить объект блокировки выходит из области действия.  
  
 Дополнительные сведения об использовании `CEvent` объектов, в разделе [Многопоточность: использование классов синхронизации](../../parallel/multithreading-how-to-use-the-synchronization-classes.md).  
  
## <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_Utilities#45](../../mfc/codesnippet/cpp/cevent-class_1.cpp)]  
  
 [!code-cpp[NVC_MFC_Utilities#46](../../mfc/codesnippet/cpp/cevent-class_2.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CSyncObject](../../mfc/reference/csyncobject-class.md)  
  
 `CEvent`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxmt.h  
  
##  <a name="cevent"></a>  CEvent::CEvent  
 Создает именованный или неименованный `CEvent` объекта.  
  
```  
CEvent(
    BOOL bInitiallyOwn = FALSE,  
    BOOL bManualReset = FALSE,  
    LPCTSTR lpszName = NULL,  
    LPSECURITY_ATTRIBUTES lpsaAttribute = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *bInitiallyOwn*  
 Если **TRUE**, поток для `CMultilock` или `CSingleLock` объекта включен. В противном случае необходимо дождаться все потоки, желающих получить доступ к ресурсу.  
  
 *bManualReset*  
 Если **TRUE**, указывает, что объект события ручного события, в противном случае объект события является автоматического события.  
  
 *lpszName*  
 Имя объекта `CEvent`. Необходимо указать, будет ли использоваться объекта через границы процессов. Если имя соответствует существующему событию, конструктор создает новый `CEvent` объект, который ссылается на событие с тем же именем. Если имя соответствует объект синхронизации, не является событием, построения завершится ошибкой. Если **NULL**, имя будет иметь значение null.  
  
 *lpsaAttribute*  
 Атрибуты безопасности для объекта события. Полное описание этой структуры см. в разделе [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) в Windows SDK.  
  
### <a name="remarks"></a>Примечания  
 Для доступа или освободить `CEvent` объектов, создания [CMultiLock](../../mfc/reference/cmultilock-class.md) или [класс CSingleLock](../../mfc/reference/csinglelock-class.md) и вызовите его [блокировки](../../mfc/reference/csinglelock-class.md#lock) и [Unlock](../../mfc/reference/csinglelock-class.md#unlock) функции-члены.  
  
 Чтобы изменить состояние `CEvent` объекта сигнальное (потоки не требовалось ожидать), вызовите [SetEvent](#setevent) или [PulseEvent](#pulseevent). Чтобы задать для состояния `CEvent` объекта несигнальное (потоки, должны ждать), вызовите [ResetEvent](#resetevent).  
  
> [!IMPORTANT]
>  После создания `CEvent` , используйте [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) чтобы убедиться, что объект взаимного исключения не существует. Если мьютекс существовал неожиданно, это может означать незаконных процесс занятие и может вы собираетесь использовать семафор злоумышленником. В этом случае соображениям безопасности рекомендуется закрыть этот дескриптор и продолжить как, если произошел сбой при создании объекта.  
  
##  <a name="pulseevent"></a>  CEvent::PulseEvent  
 Задает состояние события сигнальное (доступно), освобождает все ожидающие потоки и сбрасывает ее несигнальное (недоступно) автоматически.  
  
```  
BOOL PulseEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если событие выполняется вручную, все ожидающие потоки освобождаются, то событие включается в несигнальное и `PulseEvent` возвращает. Если событие выполняется автоматически, один поток освобождается, то событие включается в несигнальное и `PulseEvent` возвращает.  
  
 Если нет ожидающих потоков или потоки не могут быть сняты немедленно, `PulseEvent` Задает несигнальное состояние события и возвращает.  
  
 `PulseEvent` использует базовый Win32 `PulseEvent` функции, которая может ненадолго удален из состояния ожидания при вызове асинхронных процедур в режиме ядра. Таким образом `PulseEvent` не является достоверным и не должны использоваться в новых приложениях. Дополнительные сведения см. в разделе [PulseEvent функция](http://msdn.microsoft.com/library/windows/desktop/ms684914).  
  
##  <a name="resetevent"></a>  CEvent::ResetEvent  
 Задает состояние события несигнальное до явным образом задать до получения сигнала, [SetEvent](#setevent) функции-члена.  
  
```  
BOOL ResetEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 В этом случае все потоки, которым для доступа к данному событию ожидания.  
  
 Эта функция-член не используется автоматическое событиями.  
  
##  <a name="setevent"></a>  CEvent::SetEvent  
 Задает состояние события, получает сигнал, освобождая все ожидающие потоки.  
  
```  
BOOL SetEvent();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно, в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если событие выполняется вручную, это событие будет оставаться сигнал до [ResetEvent](#resetevent) вызывается. В этом случае могут быть сняты более одного потока. Если событие выполняется автоматически, событие останется сигнальное до снятия один поток. Система затем установит несигнальное состояние события. Если нет ожидающих потоков, состояние остается сигнальным, пока один поток не будет освобождена.  
  
##  <a name="unlock"></a>  CEvent::Unlock  
 Освобождает объект события.  
  
```  
BOOL Unlock();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если поток владеет объект события и события автоматического события; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член вызывается потоков, которые в настоящее время принадлежат автоматического события освобождаемый его после завершения, если их объект блокировки для повторного использования. Если объект блокировки не будут использоваться повторно, эта функция вызывается деструктор объекта блокировок.  
  
## <a name="see-also"></a>См. также  
 [Класс CSyncObject](../../mfc/reference/csyncobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)

