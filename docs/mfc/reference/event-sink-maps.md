---
title: "Maps приемника событий | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- vc.mfc.macros.maps
dev_langs:
- C++
helpviewer_keywords:
- event sink maps [MFC]
ms.assetid: a9757eb2-5f4a-45ec-a2cd-ce5eec85b16f
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 309474220f081a0eca67d0f83ead21c59eb649e5
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="event-sink-maps"></a>Схемы приемников событий
Если внедренный элемент управления OLE инициирует событие, контейнер элемента управления получает событие, используя механизм, называемый «картой приемника событий, «предоставляемые MFC. На этой карте приемника событий указывает функции обработчика для каждого конкретного события, а также параметры этих событий. Дополнительные сведения о схемы приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="event-sink-maps"></a>Схемы приемников событий  
  
|||  
|-|-|  
|[BEGIN_EVENTSINK_MAP](#begin_eventsink_map)|Начинается определение картой приемника событий.|  
|[DECLARE_EVENTSINK_MAP](#declare_eventsink_map)|Объявляет картой приемника событий.|  
|[END_EVENTSINK_MAP](#end_eventsink_map)|Завершает определение картой приемника событий.|  
|[ON_EVENT](#on_event)|Определяет обработчик событий для конкретного события.|  
|[ON_EVENT_RANGE](#on_event_range)|Определяет обработчик событий для конкретного события, инициированные из набора элементов управления OLE.|  
|[ON_EVENT_REFLECT](#on_event_reflect)|Получает события, создаваемые элемента управления, прежде чем они будут обработаны с контейнера элемента управления.|  
|[ON_PROPNOTIFY](#on_propnotify)|Определяет обработчик для обработки уведомления о свойств из элемента управления OLE.|  
|[ON_PROPNOTIFY_RANGE](#on_propnotify_range)|Определяет обработчик для обработки уведомлений свойство из набора элементов управления OLE.|  
|[ON_PROPNOTIFY_REFLECT](#on_propnotify_reflect)|Получает свойство уведомлений, отправленных с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.|  
  
##  <a name="begin_eventsink_map"></a>BEGIN_EVENTSINK_MAP  
 Начинается определение карте приемника событий.  
  
```   
BEGIN_EVENTSINK_MAP(theClass, baseClass)  
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Указывает, что имя класса элемента управления, которого приемник событий сопоставления.  
  
 `baseClass`  
 Указывает имя базового класса `theClass`.  
  
### <a name="remarks"></a>Примечания  
 В файле реализации (CPP), который определяет функции-члены класса, запустить карты приемник событий с `BEGIN_EVENTSINK_MAP` макрос, затем добавить макрос записи для каждого события получать уведомления о и завершить карты приемник событий с `END_EVENTSINK_MAP` макрос.  
  
 Дополнительные сведения о схемы приемников событий и управления OLE-контейнеры, см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="declare_eventsink_map"></a>DECLARE_EVENTSINK_MAP  
 OLE-контейнер может предоставить картой приемника событий для задания событий, которые будет уведомлен о контейнера.  
  
```   
DECLARE_EVENTSINK_MAP()   
```  
  
### <a name="remarks"></a>Примечания  
 Используйте `DECLARE_EVENTSINK_MAP` макрос в конце объявления класса. Затем в. CPP-файл, определяющий член, функции для класса, используйте `BEGIN_EVENTSINK_MAP` макрос, макрос записи для каждого события, чтобы получать уведомления о и `END_EVENTSINK_MAP` макрос для объявления в конец списка приемника событий.  
  
 Дополнительные сведения о схемы приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxwin.h  
  
##  <a name="end_eventsink_map"></a>END_EVENTSINK_MAP  
 Завершает определение карте приемника событий.  
  
```   
END_EVENTSINK_MAP()   
```  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event"></a>ON_EVENT  
 Используйте `ON_EVENT` макрос, чтобы определить функцию обработчика событий для события, создаваемые элемента управления OLE.  
  
```   
ON_EVENT(theClass, id, dispid, pfnHandler,  vtsParams) 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 `id`  
 Идентификатор элемента управления элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации событие, инициированное элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** возвращаемого значения и типы параметров, которые соответствуют параметрам события (в разделе `vtsParams`). Данная функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях карты диспетчеризации, таких как `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event_range"></a>ON_EVENT_RANGE  
 Используйте `ON_EVENT_RANGE` макрос, чтобы определить функцию обработчика событий для события, создаваемые любого элемента управления OLE, имеющих идентификатор элемента управления на непрерывный диапазон идентификаторов.  
  
```   
ON_EVENT_RANGE(theClass, idFirst, idLast, dispid, pfnHandler,  vtsParams)   
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 `idFirst`  
 Идентификатор элемента управления в диапазоне от первого элемента управления OLE.  
  
 `idLast`  
 Идентификатор элемента управления в диапазоне от последнего элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации событие, инициированное элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** типа возвращаемого значения, первый параметр типа **UINT** (по Идентификатору элемента управления) и дополнительный параметр типам, которые соответствуют параметры события (в разделе `vtsParams`). Данная функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Тип должен быть первая константа **VTS_I4**, для идентификатора элемента управления Это же константы, которые используются в операциях карты диспетчеризации, таких как `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="example"></a>Пример  
 В следующем примере демонстрируется обработчик событий для события MouseDown, реализованное для трех элементов управления ( `IDC_MYCTRL1` через `IDC_MYCTRL3`). Функция обработчика событий `OnRangeMouseDown`, объявленный в файле заголовка класса диалогового окна ( `CMyDlg`) как:  
  
 [!code-cpp[NVC_MFCAutomation#12](../../mfc/codesnippet/cpp/event-sink-maps_2.h)]  
  
 В следующем примере кода определяется в файле реализации класса диалогового окна.  
  
 [!code-cpp[NVC_MFCAutomation#13](../../mfc/codesnippet/cpp/event-sink-maps_3.cpp)]  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event_reflect"></a>ON_EVENT_REFLECT  
 `ON_EVENT_REFLECT` Макрос, при использовании событий приемником сопоставления класса-оболочки элемента управления OLE, получает событий, произошедших в элементе управления, прежде чем они будут обработаны с контейнера элемента управления.  
  
```   
ON_EVENT_REFLECT(theClass,  dispid, pfnHandler,  vtsParams) 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 DISPID  
 Идентификатор диспетчеризации событие, инициированное элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** возвращаемого значения и типы параметров, которые соответствуют параметрам события (в разделе `vtsParams`). Данная функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях карты диспетчеризации, таких как `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы.  
  
 Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_propnotify"></a>ON_PROPNOTIFY  
 Используйте `ON_PROPNOTIFY` макрос, чтобы определять запись карты приемник событий для обработки уведомления о свойств из элемента управления OLE.  
  
```   
ON_PROPNOTIFY(theClass, id, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 `id`  
 Идентификатор элемента управления элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчера свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **BOOL\***  параметра. Эту функцию следует задать для параметра **TRUE** позволяет изменить свойства и **FALSE** запретить. Данная функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** тип возвращаемого значения и **UINT** параметра. Данная функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
##  <a name="on_propnotify_range"></a>ON_PROPNOTIFY_RANGE  
 Используйте `ON_PROPNOTIFY_RANGE` макрос, чтобы определять запись карты приемник событий для обработки уведомлений свойства из любого элемента управления OLE, имеющих идентификатор элемента управления на непрерывный диапазон идентификаторов.  
  
```  
 
ON_PROPNOTIFY_RANGE(theClass, idFirst, idLast, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 `idFirst`  
 Идентификатор элемента управления в диапазоне от первого элемента управления OLE.  
  
 `idLast`  
 Идентификатор элемента управления в диапазоне от последнего элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчера свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **UINT** и **BOOL\***  параметров. Функция следует задать для параметра **TRUE** позволяет изменить свойства и **FALSE** запретить. Данная функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** тип возвращаемого значения и **UINT** параметра. Данная функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_propnotify_reflect"></a>ON_PROPNOTIFY_REFLECT  
 `ON_PROPNOTIFY_REFLECT` Макрос, при использовании событий приемником сопоставления класса-оболочки элемента управления OLE, Получает свойство уведомлений, отправленных с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.  
  
```  
 
ON_PROPNOTIFY_REFLECT(theClass, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот схеме событий приемника.  
  
 `dispid`  
 Идентификатор диспетчера свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **BOOL\***  параметра. Эту функцию следует задать для параметра **TRUE** позволяет изменить свойства и **FALSE** запретить. Данная функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** возвращаемый тип и без параметров. Данная функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
    
## <a name="see-also"></a>См. также  
 [Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
