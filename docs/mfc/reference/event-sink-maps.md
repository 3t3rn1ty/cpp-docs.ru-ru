---
title: "Сопоставляет приемника событий | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- vc.mfc.macros.maps
dev_langs:
- C++
helpviewer_keywords:
- event sink maps
ms.assetid: a9757eb2-5f4a-45ec-a2cd-ce5eec85b16f
caps.latest.revision: 14
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 17a158366f94d27b7a46917282425d652e6b9042
ms.openlocfilehash: 33bf66d18b499787a34b2da501bb3e8ead255459
ms.contentlocale: ru-ru
ms.lasthandoff: 02/24/2017

---
# <a name="event-sink-maps"></a>Схемы приемников событий
Если внедренный элемент управления OLE запускает событие, контейнера элемента управления получает событие, используя механизм, называемый «картой приемника событий, «предоставляемые MFC. На этой карте приемника событий определяет функции обработчика для каждого конкретного события, а также параметры таких событий. Дополнительные сведения о картах приемника событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="event-sink-maps"></a>Схемы приемников событий  
  
|||  
|-|-|  
|[BEGIN_EVENTSINK_MAP](#begin_eventsink_map)|Начинается определение картой приемника событий.|  
|[DECLARE_EVENTSINK_MAP](#declare_eventsink_map)|Объявляет картой приемника событий.|  
|[END_EVENTSINK_MAP](#end_eventsink_map)|Завершает определение картой приемника событий.|  
|[ON_EVENT](#on_event)|Задает обработчик событий для конкретного события.|  
|[ON_EVENT_RANGE](#on_event_range)|Задает обработчик событий для определенных событий, инициируемых с набором элементов управления OLE.|  
|[ON_EVENT_REFLECT](#on_event_reflect)|Получает события, создаваемые элемента управления, прежде чем они будут обработаны с контейнера элемента управления.|  
|[ON_PROPNOTIFY](#on_propnotify)|Определяет обработчик для обработки уведомления свойства из элемента управления OLE.|  
|[ON_PROPNOTIFY_RANGE](#on_propnotify_range)|Определяет обработчик для обработки уведомлений свойство из набора элементов управления OLE.|  
|[ON_PROPNOTIFY_REFLECT](#on_propnotify_reflect)|Получает свойство уведомлений, отправленных с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.|  
  
##  <a name="begin_eventsink_map"></a>BEGIN_EVENTSINK_MAP  
 Начинается определение вашей картой приемника событий.  
  
```   
BEGIN_EVENTSINK_MAP(theClass, baseClass)  
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Указывает, что имя класса элемента управления, сопоставления которых приемника событий.  
  
 `baseClass`  
 Указывает имя базового класса `theClass`.  
  
### <a name="remarks"></a>Примечания  
 В файле реализации (CPP), который определяет функции-члены класса, запустите картой приемника событий с `BEGIN_EVENTSINK_MAP` макрос, затем добавить макрос записи для каждого события получать уведомления об и завершить картой приемника событий с `END_EVENTSINK_MAP` макрос.  
  
 Дополнительные сведения о схемы приемников событий и контейнеры элементов управления OLE, см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="declare_eventsink_map"></a>DECLARE_EVENTSINK_MAP  
 OLE-контейнер позволяет картой приемника событий для задания событий, которые будет уведомляться контейнера.  
  
```   
DECLARE_EVENTSINK_MAP()   
```  
  
### <a name="remarks"></a>Примечания  
 Используйте `DECLARE_EVENTSINK_MAP` макрос в конце объявления класса. Затем в. CPP-файл, который определяет член функции для класса, используйте `BEGIN_EVENTSINK_MAP` макрос, макрос операции для каждого из событий, чтобы получать уведомления и `END_EVENTSINK_MAP` макрос для объявления в конец списка приемника событий.  
  
 Дополнительные сведения о картах приемника событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxwin.h  
  
##  <a name="end_eventsink_map"></a>END_EVENTSINK_MAP  
 Завершает определение вашей картой приемника событий.  
  
```   
END_EVENTSINK_MAP()   
```  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event"></a>ON_EVENT  
 Используйте `ON_EVENT` макрос, чтобы определить функцию обработчика событий для события, инициируемые элемента управления OLE.  
  
```   
ON_EVENT(theClass, id, dispid, pfnHandler,  vtsParams) 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 `id`  
 Идентификатор элемента управления элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации на событие, запускаемое с помощью элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** возвращаемого значения и типы параметров, соответствующих параметров событий (см. `vtsParams`). Функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях отправки карты, например `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из этих значений, разделенных пробелами (не запятые) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation&11;](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event_range"></a>ON_EVENT_RANGE  
 Используйте `ON_EVENT_RANGE` макрос, чтобы определить функцию обработчика событий для события, инициируемые любого элемента управления OLE, наличие идентификатор элемента управления на непрерывный диапазон идентификаторов.  
  
```   
ON_EVENT_RANGE(theClass, idFirst, idLast, dispid, pfnHandler,  vtsParams)   
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 `idFirst`  
 Идентификатор элемента управления, в диапазоне от первого элемента управления OLE.  
  
 `idLast`  
 Идентификатор элемента управления, в диапазоне от последнего элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации на событие, запускаемое с помощью элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** возвращаемый тип, первый параметр типа **UINT** (для управления Идентификатором) и типы дополнительных параметров, соответствующих параметров события (см. `vtsParams`). Функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Первая константа имеет тип **VTS_I4**, для идентификатора элемента управления Это же константы, которые используются в операциях отправки карты, например `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из этих значений, разделенных пробелами (не запятые) Указывает список параметров функции. Пример:  
  
 [!code-cpp[NVC_MFCAutomation&11;](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="example"></a>Пример  
 В следующем примере показан обработчик событий для событий MouseDown, реализовано для трех элементов управления ( `IDC_MYCTRL1` через `IDC_MYCTRL3`). Функция обработчика событий `OnRangeMouseDown`, объявляется в файле заголовка класса диалогового окна ( `CMyDlg`) как:  
  
 [!code-cpp[NVC_MFCAutomation&#12;](../../mfc/codesnippet/cpp/event-sink-maps_2.h)]  
  
 В следующем примере кода определяется в файле реализации класса диалогового окна.  
  
 [!code-cpp[NVC_MFCAutomation&#13;](../../mfc/codesnippet/cpp/event-sink-maps_3.cpp)]  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_event_reflect"></a>ON_EVENT_REFLECT  
 `ON_EVENT_REFLECT` Макрос, при использовании событий приемником сопоставления класса-оболочки элемента управления OLE, получает события, создаваемые элемента управления, прежде чем они будут обработаны с контейнера элемента управления.  
  
```   
ON_EVENT_REFLECT(theClass,  dispid, pfnHandler,  vtsParams) 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 Идентификатор DISPID  
 Идентификатор диспетчеризации на событие, запускаемое с помощью элемента управления.  
  
 `pfnHandler`  
 Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь **BOOL** возвращаемого значения и типы параметров, соответствующих параметров событий (см. `vtsParams`). Функция должна возвращать **TRUE** для указания событие было обработано; в противном случае **FALSE**.  
  
 `vtsParams`  
 Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях отправки карты, например `DISP_FUNCTION`.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы.  
  
 Один или несколько из этих значений, разделенных пробелами (не запятые) Указывает список параметров функции. Например:  
  
 [!code-cpp[NVC_MFCAutomation&11;](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_propnotify"></a>ON_PROPNOTIFY  
 Используйте `ON_PROPNOTIFY` макрос для определения запись карты приемника событий для обработки уведомления свойства из элемента управления OLE.  
  
```   
ON_PROPNOTIFY(theClass, id, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 `id`  
 Идентификатор элемента управления элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **BOOL\* ** параметр. Эту функцию следует присвоить параметру **TRUE** позволяет изменить свойства и **FALSE** запретить. Функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** тип возвращаемого значения и **UINT** параметр. Функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 `vtsParams` Аргумент является разделенный пробелами список значений из **VTS_** константы. Один или несколько из этих значений, разделенных пробелами (не запятые) Указывает список параметров функции. Например:  
  
 [!code-cpp[NVC_MFCAutomation&11;](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]  
  
 Указывает список, содержащий короткое целое число, за которым следует **BOOL**.  
  
 Список **VTS_** константы, в разделе [EVENT_CUSTOM](event-maps.md#event_custom).  
  
##  <a name="on_propnotify_range"></a>ON_PROPNOTIFY_RANGE  
 Используйте `ON_PROPNOTIFY_RANGE` макрос, определение запись карты приемника событий для обработки свойств уведомлений из любого элемента управления OLE, наличие идентификатор элемента управления на непрерывный диапазон идентификаторов.  
  
```  
 
ON_PROPNOTIFY_RANGE(theClass, idFirst, idLast, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 `idFirst`  
 Идентификатор элемента управления, в диапазоне от первого элемента управления OLE.  
  
 `idLast`  
 Идентификатор элемента управления, в диапазоне от последнего элемента управления OLE.  
  
 `dispid`  
 Идентификатор диспетчеризации свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **UINT** и **BOOL\* ** параметров. Функция следует присвоить параметру **TRUE** позволяет изменить свойства и **FALSE** запретить. Функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** тип возвращаемого значения и **UINT** параметр. Функция должна возвращать **TRUE** для указания, что уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
  
##  <a name="on_propnotify_reflect"></a>ON_PROPNOTIFY_REFLECT  
 `ON_PROPNOTIFY_REFLECT` Макрос, при использовании событий приемником сопоставления класса-оболочки элемента управления OLE, Получает свойство уведомлений, отправленных с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.  
  
```  
 
ON_PROPNOTIFY_REFLECT(theClass, dispid, pfnRequest, pfnChanged)  
 
```  
  
### <a name="parameters"></a>Параметры  
 `theClass`  
 Класс, к которому принадлежит этот картой приемника событий.  
  
 `dispid`  
 Идентификатор диспетчеризации свойства, участвующих в уведомлении.  
  
 `pfnRequest`  
 Указатель на функцию-член, который обрабатывает **OnRequestEdit** уведомления для этого свойства. Данная функция должна иметь **BOOL** тип возвращаемого значения и **BOOL\* ** параметр. Эту функцию следует присвоить параметру **TRUE** позволяет изменить свойства и **FALSE** запретить. Функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
 `pfnChanged`  
 Указатель на функцию-член, который обрабатывает **OnChanged** уведомления для этого свойства. Функция должна иметь **BOOL** возвращаемого значения и без параметров. Функция должна возвращать **TRUE** для указания уведомление было обработано; в противном случае **FALSE**.  
  
### <a name="requirements"></a>Требования  
  **Заголовок** afxdisp.h  
    
## <a name="see-also"></a>См. также  
 [Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)

