---
title: "CComboBox Class | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "reference"
f1_keywords: 
  - "CComboBox"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CComboBox - класс"
  - "поля со списком, CComboBox objects"
ms.assetid: 4e73b5df-0d2e-4658-9706-38133fb10513
caps.latest.revision: 25
caps.handback.revision: 13
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# CComboBox Class
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Предоставляет функциональные возможности полей со списком Windows.  
  
## Синтаксис  
  
```  
class CComboBox : public CWnd  
```  
  
## Члены  
  
### Открытые конструкторы  
  
|Имя|Описание|  
|---------|--------------|  
|[CComboBox::CComboBox](../Topic/CComboBox::CComboBox.md)|Создает объект `CComboBox`.|  
  
### Открытые методы  
  
|Имя|Описание|  
|---------|--------------|  
|[CComboBox::AddString](../Topic/CComboBox::AddString.md)|Добавляет строку в конец списка в списке поля со списком или в сортированной позиции для списков с учетом **CBS\_SORT**.|  
|[CComboBox::Clear](../Topic/CComboBox::Clear.md)|Удаляет \(снимите клиринги\) текущее выделение, при наличии таковой, в элементе управления "Поле ввода".|  
|[CComboBox::CompareItem](../Topic/CComboBox::CompareItem.md)|Вызываемый платформой, чтобы указать относительное положение нового элемента списка в сортированном определяемый пользователем поля со списком.|  
|[CComboBox::Copy](../Topic/CComboBox::Copy.md)|Копирует текущее выделение, при наличии таковой, в буфер обмена в формате **CF\_TEXT**.|  
|[CComboBox::Create](../Topic/CComboBox::Create.md)|Создает поля со списком и вложение его к объекту `CComboBox`.|  
|[CComboBox::Cut](../Topic/CComboBox::Cut.md)|Удаляет \(отрезки\) текущее выделение, при наличии таковой, в элементе управления "Поле ввода" и копиях удалено текста в буфер обмена в формате **CF\_TEXT**.|  
|[CComboBox::DeleteItem](../Topic/CComboBox::DeleteItem.md)|Вызываемый платформой, если элемент списка будет удалена из определяемого пользователем поля со списком.|  
|[CComboBox::DeleteString](../Topic/CComboBox::DeleteString.md)|Удаляет строку из списка поля со списком.|  
|[CComboBox::Dir](../Topic/CComboBox::Dir.md)|Добавляет список имен файлов в список поля со списком.|  
|[CComboBox::DrawItem](../Topic/CComboBox::DrawItem.md)|Вызываемый платформой, когда визуальных аспектов определяемого пользователем поля со списком.|  
|[CComboBox::FindString](../Topic/CComboBox::FindString.md)|Находит первую строку, содержащий указанный префикс в списке поля со списком.|  
|[CComboBox::FindStringExact](../Topic/CComboBox::FindStringExact.md)|Находит первую строку списка в поле со списком\), соответствующий указанной строки.|  
|[CComboBox::GetComboBoxInfo](../Topic/CComboBox::GetComboBoxInfo.md)|Получить данные об объекте `CComboBox`.|  
|[CComboBox::GetCount](../Topic/CComboBox::GetCount.md)|Получает число элементов в списке поля со списком.|  
|[CComboBox::GetCueBanner](../Topic/CComboBox::GetCueBanner.md)|Получает текст очереди, отображаемый для элемента управления " поле со списком.|  
|[CComboBox::GetCurSel](../Topic/CComboBox::GetCurSel.md)|Извлекает индекс выбранного в данный момент элемента, если они есть в списке поля со списком.|  
|[CComboBox::GetDroppedControlRect](../Topic/CComboBox::GetDroppedControlRect.md)|Получает координаты экрана видимого \(удаленный вниз\) списка в поле со списком.|  
|[CComboBox::GetDroppedState](../Topic/CComboBox::GetDroppedState.md)|Определяет, является ли список поле со списком отображаются \(удаленный вниз\).|  
|[CComboBox::GetDroppedWidth](../Topic/CComboBox::GetDroppedWidth.md)|Получает ширину разрешенная минимумом для части раскрывающегося списка в поле со списком.|  
|[CComboBox::GetEditSel](../Topic/CComboBox::GetEditSel.md)|Получает начальный и конечный позиции символа текущего выделения в элементе управления "Поле ввода" поля со списком.|  
|[CComboBox::GetExtendedUI](../Topic/CComboBox::GetExtendedUI.md)|Указывает, имеет ли поле со списком интерфейс пользователя по умолчанию или расширенный пользовательский интерфейс.|  
|[CComboBox::GetHorizontalExtent](../Topic/CComboBox::GetHorizontalExtent.md)|Возвращает ширину в пикселях, что часть списка в поле со списком можно выполнять горизонтальную прокрутку.|  
|[CComboBox::GetItemData](../Topic/CComboBox::GetItemData.md)|Извлекает приложение\- предоставленное 32 разрядное значение, связанное с указанным элементом поля со списком.|  
|[CComboBox::GetItemDataPtr](../Topic/CComboBox::GetItemDataPtr.md)|Извлекает приложение\-, предоставляемый пакетом обновления 32\-разрядный указатель, который связан с указанным элементом поля со списком.|  
|[CComboBox::GetItemHeight](../Topic/CComboBox::GetItemHeight.md)|Получает высоту элементов списка в поле со списком.|  
|[CComboBox::GetLBText](../Topic/CComboBox::GetLBText.md)|Получает строку из списка поля со списком.|  
|[CComboBox::GetLBTextLen](../Topic/CComboBox::GetLBTextLen.md)|Возвращает длину строки в списке поля со списком.|  
|[CComboBox::GetLocale](../Topic/CComboBox::GetLocale.md)|Извлекает код языка для поля со списком.|  
|[CComboBox::GetMinVisible](../Topic/CComboBox::GetMinVisible.md)|Возвращает минимальное количество видимых элементов в раскрывающемся списке текущего поля со списком.|  
|[CComboBox::GetTopIndex](../Topic/CComboBox::GetTopIndex.md)|Возвращает индекс первого элемента, видимого списка в поле со списком.|  
|[CComboBox::InitStorage](../Topic/CComboBox::InitStorage.md)|Preallocates блоки памяти для элементов и строк списка в поле со списком.|  
|[CComboBox::InsertString](../Topic/CComboBox::InsertString.md)|Вставляет строку в списке поля со списком.|  
|[CComboBox::LimitText](../Topic/CComboBox::LimitText.md)|Ограничивает длину текста, пользователь может вводить в элемент управления "Поле ввода" поля со списком.|  
|[CComboBox::MeasureItem](../Topic/CComboBox::MeasureItem.md)|Вызываемый платформой для определения измерения поля со списком, когда определенное пользователем поле со списком будет создано.|  
|[CComboBox::Paste](../Topic/CComboBox::Paste.md)|Вставляет данные из буфера обмена в элемент управления "Поле ввода" с текущей позиции курсора.  Данные вставляются только в случае, если буфер обмена содержит данные в формате **CF\_TEXT**.|  
|[CComboBox::ResetContent](../Topic/CComboBox::ResetContent.md)|Удаляет все элементы из списка и элемента управления "Поле ввода" поля со списком.|  
|[CComboBox::SelectString](../Topic/CComboBox::SelectString.md)|Ищет строки в списке поля со списком и, если строка найдено, выберите пункт строка в списке и копировать строки в элемент управления "Поле ввода".|  
|[CComboBox::SetCueBanner](../Topic/CComboBox::SetCueBanner.md)|Устанавливает текст очереди, отображаемый для элемента управления " поле со списком.|  
|[CComboBox::SetCurSel](../Topic/CComboBox::SetCurSel.md)|Выбирает строку в списке поля со списком.|  
|[CComboBox::SetDroppedWidth](../Topic/CComboBox::SetDroppedWidth.md)|Задает ширину минимально допустимую для части раскрывающегося списка в поле со списком.|  
|[CComboBox::SetEditSel](../Topic/CComboBox::SetEditSel.md)|Выбирает символы в элементе управления "Поле ввода" поля со списком.|  
|[CComboBox::SetExtendedUI](../Topic/CComboBox::SetExtendedUI.md)|Выбирает или интерфейс пользователя по умолчанию или расширенный пользовательский интерфейс для полей со списком, которое имеет стиль **CBS\_DROPDOWN** или **CBS\_DROPDOWNLIST**.|  
|[CComboBox::SetHorizontalExtent](../Topic/CComboBox::SetHorizontalExtent.md)|Задает ширину в пикселях, что часть списка в поле со списком можно выполнять горизонтальную прокрутку.|  
|[CComboBox::SetItemData](../Topic/CComboBox::SetItemData.md)|Устанавливает 32 разрядное значение, связанный с указанным элементом в поле со списком.|  
|[CComboBox::SetItemDataPtr](../Topic/CComboBox::SetItemDataPtr.md)|Устанавливает указатель 32 бита, связанный с указанным элементом в поле со списком.|  
|[CComboBox::SetItemHeight](../Topic/CComboBox::SetItemHeight.md)|Задает высоту элементов списка в поле со списком или высоту части элемента управления "Поле ввода" \(или статический\- text\) поля со списком.|  
|[CComboBox::SetLocale](../Topic/CComboBox::SetLocale.md)|Задает код языка для поля со списком.|  
|[CComboBox::SetMinVisibleItems](../Topic/CComboBox::SetMinVisibleItems.md)|Задает минимальное количество видимых элементов в раскрывающемся списке текущего поля со списком.|  
|[CComboBox::SetTopIndex](../Topic/CComboBox::SetTopIndex.md)|Указывает, что часть списка в поле со списком указывает элемент с указанным индексом в верхней части.|  
|[CComboBox::ShowDropDown](../Topic/CComboBox::ShowDropDown.md)|Показывает или скрывает список полей со списком, которое имеет стиль **CBS\_DROPDOWN** или **CBS\_DROPDOWNLIST**.|  
  
## Заметки  
 Поле со списком состоит из списка или статическим, объединенные с элементом управления или элементом управления "Поле ввода".  Часть списка элемента управления может отображаться все время или только списке, когда пользователь выбирает стрелку раскрывающегося списка рядом с элементом управления.  
  
 Выделенный элемент \(если существует\), то в списке отображается в статическом или элементе управления "Поле ввода".  Кроме того, если поле со списком имеет стиль раскрывающемся списке, то пользователь может ввести начальный знак одного из элементов в списке и список, если видимый, выбирает следующий элемент с тем же начальным символом.  
  
 В следующей таблице сравниваются 3 поле со списком [стили](../../mfc/reference/combo-box-styles.md).  
  
|Стиль|Если список отображается?|Статический или элемент управления "Поле ввода"?|  
|-----------|-------------------------------|------------------------------------------------------|  
|Простой|Всегда|Edit|  
|Раскрывающийся список|Удаленный вниз|Edit|  
|Раскрывающийся список|Удаленный вниз|Статический|  
  
 Можно создать объект `CComboBox` из шаблона диалогового окна или непосредственно в коде.  В обоих случаях сначала вызвать конструктор `CComboBox` для создания объекта `CComboBox`; затем вызовите функцию\-член [Создание](../Topic/CComboBox::Create.md) для создания элемента управления и вложить его к объекту `CComboBox`.  
  
 Если нужно обрабатывать сообщения уведомлений Windows, отправленные полем со списком с родительским элементом \(обычно класс, производный от `CDialog`\), то добавление функции\-члена записи и обработчика сообщений сообщение\- сопоставления в родительский класс для каждого сообщения.  
  
 Каждая запись сообщение\-сопоставления принимает следующую форму:  
  
 Уведомление **\(**`id`**,**`memberFxn`**\)ON\_**  
  
 где `id` задает идентификатор дочернего окна элемента управления " поле со списком, отправляющее уведомление и `memberFxn` имя родительского функции\-члена был написан для обработки уведомления.  
  
 Родительский прототип функции следующим образом:  
  
 **afx\_msg** `void` `memberFxn` **\( \);**  
  
 Порядок, в котором будут отправлены некоторых уведомлений не удается спрогнозировать.  В частности, уведомление **CBN\_SELCHANGE** может возникнуть, то перед или после уведомлением **CBN\_CLOSEUP**.  
  
 Потенциальных записей сообщение\- сопоставления следующие:  
  
-   **ON\_CBN\_CLOSEUP** \(Windows 3.1 и более поздней версии\). Список полей со списком закрыл.  Это сообщение уведомления не отправлено для поля со списком, которое имеет стиль [CBS\_SIMPLE](../../mfc/reference/combo-box-styles.md).  
  
-   **ON\_CBN\_DBLCLK** Пользователь дважды щелкает строка в списке поля со списком.  Это сообщение уведомления только отправлено для поля со списком с учетом **CBS\_SIMPLE**.  Для поля со списком с учетом [CBS\_DROPDOWN](../../mfc/reference/combo-box-styles.md) или [CBS\_DROPDOWNLIST](../../mfc/reference/combo-box-styles.md), дважды щелкнув не может произойти, поскольку один пункт скрывать списка.  
  
-   **ON\_CBN\_DROPDOWN** Список полей со списком рядом раскрывающегося \(сделайте видимым\).  Это сообщение уведомления может использоваться только для поля со списком с учетом **CBS\_DROPDOWN** или **CBS\_DROPDOWNLIST**.  
  
-   **ON\_CBN\_EDITCHANGE** Принимало действие, которое пользователь может изменять текст в части элемента управления "Поле ввода" поля со списком.  В отличие от сообщение **CBN\_EDITUPDATE** это сообщение отправлено после Windows обновляет экран.  Он не отправлять если поле со списком имеет стиль **CBS\_DROPDOWNLIST**.  
  
-   **ON\_CBN\_EDITUPDATE** Часть элемента управления "Поле ввода" в поле со списком рядом с текстом измененных отображением.  Это сообщение уведомления отправлено после того как элемент управления форматировал текст, но прежде, чем он отображает текст.  Он не отправлять если поле со списком имеет стиль **CBS\_DROPDOWNLIST**.  
  
-   **ON\_CBN\_ERRSPACE** Поле со списком " не может выделить достаточно памяти для особому соответствовать требованию.  
  
-   **ON\_CBN\_SELENDCANCEL** \(Windows 3.1 и более поздней версии\). Указывает, что выделение пользователя должно быть отменено.  Пользователь щелкает элемент и выберите пункт другие окна или элемент управления, чтобы скрыть список поля со списком.  Это сообщение уведомления отправлено до того, как сообщение уведомления **CBN\_CLOSEUP**, чтобы указать, что выделение пользователя должно быть игнорирован.  **CBN\_SELENDCANCEL** Или сообщение уведомления **CBN\_SELENDOK** отправлены даже если сообщение уведомления **CBN\_CLOSEUP** не отправлено \(как в случае с учетом поля со списком **CBS\_SIMPLE** \).  
  
-   **ON\_CBN\_SELENDOK** Пользователь выбирает элемент, а затем нажмите клавишу ВВОД или щелкните стрелку ВНИЗ или клавиши со стрелками, чтобы скрыть список поля со списком.  Это сообщение уведомления отправлено до того, как сообщение **CBN\_CLOSEUP**, чтобы указать, что выделение пользователя должно считаться допустимым.  **CBN\_SELENDCANCEL** Или сообщение уведомления **CBN\_SELENDOK** отправлены даже если сообщение уведомления **CBN\_CLOSEUP** не отправлено \(как в случае с учетом поля со списком **CBS\_SIMPLE** \).  
  
-   **ON\_CBN\_KILLFOCUS** Поле со списком теряет фокус ввода.  
  
-   **ON\_CBN\_SELCHANGE** Выделение в списке поля со списком перед изменением в результате пользователя или щелкните в списке или при изменении выделения с помощью клавиш со стрелками.  При обработке это сообщение, текст в элементе управления "Поле ввода" поля со списком можно только получить через `GetLBText` или другую подобную функции.  Невозможно использовать `GetWindowText`.  
  
-   **ON\_CBN\_SETFOCUS** Поле со списком получает фокус ввода.  
  
 При создании объекта `CComboBox` в диалоговое окно \(через ресурс диалогового окна\), то объект `CComboBox` автоматически уничтожается, когда пользователь закрывает диалоговое окно.  
  
 Если внедрение объект `CComboBox` внутри другой объект окна, нет необходимости удалить его.  При создании объекта `CComboBox` в стеке, он удален автоматически.  При создании объекта `CComboBox` в куче с помощью функции **новый**, необходимо вызвать метод **удалить** в объекте, чтобы удалить его, если поле со списком Windows удалено.  
  
 **Примечание** Если нужно обрабатывать сообщения, и `WM_KEYDOWN``WM_CHAR` подкласс управления, правка и списка полей со списком, создавать производные классы от `CEdit` и `CListBox` и добавить обработчики для этих сообщений к производным классам.  Дополнительные сведения см. в разделе [http:\/\/support.microsoft.com\/default.aspx?scid\=kb;en\-us;Q174667](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q174667) и [CWnd::SubclassWindow](../Topic/CWnd::SubclassWindow.md).  
  
## Иерархия наследования  
 [CObject](../Topic/CObject%20Class.md)  
  
 [CCmdTarget](../Topic/CCmdTarget%20Class.md)  
  
 [CWnd](../Topic/CWnd%20Class.md)  
  
 `CComboBox`  
  
## Требования  
 **Заголовок:** afxwin.h  
  
## См. также  
 [MFC просматривает CTRLBARS](../../top/visual-cpp-samples.md)   
 [Класс CWnd](../Topic/CWnd%20Class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CWnd](../Topic/CWnd%20Class.md)   
 [CButton Class](../../mfc/reference/cbutton-class.md)   
 [CEdit Class](../Topic/CEdit%20Class.md)   
 [CListBox Class](../Topic/CListBox%20Class.md)   
 [CScrollBar Class](../../mfc/reference/cscrollbar-class.md)   
 [CStatic Class](../Topic/CStatic%20Class.md)   
 [CDialog Class](../../mfc/reference/cdialog-class.md)