---
title: "COleControl-класс | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 128bd124c2536d86c8b673b54abc4b5505526b41
ms.openlocfilehash: 7f98ac382549509874bd570307a05ccea5ed657a
ms.contentlocale: ru-ru
ms.lasthandoff: 05/10/2017

---
# <a name="colecontrol-class"></a>COleControl-класс
Мощный базовый класс для разработки элементов управления OLE.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Создает объект `COleControl`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Извлекает текущий внешний вид элемента управления.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Возвращает значение свойства BackColor окружения.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Возвращает имя элемента управления, как указано в качестве контейнера.|  
|[COleControl::AmbientFont](#ambientfont)|Возвращает значение свойства шрифта окружения.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Возвращает значение свойства ForeColor окружения.|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Возвращает идентификатор языка контейнера.|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Возвращает тип единиц, используемые контейнером.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Определяет, отображаются ли маркеры захвата.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Определяет, отображаются ли штриховки.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Возвращает тип выравнивания текста, указанного в качестве контейнера.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Определяет, если элемент управления должен отвечать на действия пользовательского интерфейса.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Определяет режим контейнера.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Уведомляет контейнера, что связанное свойство было изменено.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Запрашивает разрешение для изменения значения свойства.|  
|[COleControl::ClientToParent](#clienttoparent)|Преобразует точку относительно элемента управления источника на момент относительно начала координат своего контейнера.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Корректирует прямоугольник курсор, если он перекрывается элементом управления.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Эта функция вызывается после изменения набора мнемоник, обрабатываются элементом управления.|  
|[COleControl::DisplayError](#displayerror)|Отображает биржевой события ошибок для элемента управления пользователя.|  
|[COleControl::DoClick](#doclick)|Реализация акций `DoClick` метод.|  
|[COleControl::DoPropExchange](#dopropexchange)|Сериализует свойства `COleControl` объекта.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Перерисовывает элемента управления OLE, подклассом элемента управления Windows Forms.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Включает поддержку Простая рамка для элемента управления.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Сериализует ширину и высоту элемента управления.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Выполняет сериализацию стандартных свойств элемента управления.|  
|[COleControl::ExchangeVersion](#exchangeversion)|Сериализует номер версии элемента управления.|  
|[COleControl::FireClick](#fireclick)|Запускает акции `Click` событий.|  
|[COleControl::FireDblClick](#firedblclick)|Запускает акции `DblClick` событий.|  
|[COleControl::FireError](#fireerror)|Запускает акции `Error` событий.|  
|[COleControl::FireEvent](#fireevent)|Запускает пользовательское событие.|  
|[COleControl::FireKeyDown](#firekeydown)|Запускает акции `KeyDown` событий.|  
|[COleControl::FireKeyPress](#firekeypress)|Запускает акции `KeyPress` событий.|  
|[COleControl::FireKeyUp](#firekeyup)|Запускает акции `KeyUp` событий.|  
|[COleControl::FireMouseDown](#firemousedown)|Запускает акции `MouseDown` событий.|  
|[COleControl::FireMouseMove](#firemousemove)|Запускает акции `MouseMove` событий.|  
|[COleControl::FireMouseUp](#firemouseup)|Запускает акции `MouseUp` событий.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Инициирует событие при изменении состояния готовности элемента управления.|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Изменяет поведение активации по умолчанию элемент управления, поддерживающий `IPointerInactive` интерфейса.|  
|[COleControl::GetAmbientProperty](#getambientproperty)|Возвращает значение указанного свойства окружения.|  
|[COleControl::GetAppearance](#getappearance)|Возвращает значение стандартных свойств внешнего вида.|  
|[COleControl::GetBackColor](#getbackcolor)|Возвращает значение свойства BackColor акций.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Возвращает значение свойства BorderStyle акций.|  
|[COleControl::GetCapture](#getcapture)|Определяет, имеет ли объект элемента управления без окон, активированные захват мыши.|  
|[COleControl::GetClassID](#getclassid)|Получает идентификатор класса элемента управления OLE.|  
|[COleControl::GetClientOffset](#getclientoffset)|Возвращает разницу между в верхний левый угол прямоугольной области элемента управления и в верхнем левом углу клиентской области.|  
|[COleControl::GetClientRect](#getclientrect)|Получает размер клиентской области элемента управления.|  
|[COleControl::GetClientSite](#getclientsite)|Запрашивает объект для указателя на текущий сайт клиента в пределах своего контейнера.|  
|[COleControl::GetControlFlags](#getcontrolflags)|Получает флаг настройки элемента управления.|  
|[COleControl::GetControlSize](#getcontrolsize)|Возвращает положение и размер элемента управления OLE.|  
|[COleControl::GetDC](#getdc)|Предоставляет средства для управления без окна для получения контекста устройства из контейнера.|  
|[COleControl::GetEnabled](#getenabled)|Возвращает значение свойства Enabled акции.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Извлекает указатель на объект расширенного элемента управления, относящиеся к контейнеру.|  
|[COleControl::GetFocus](#getfocus)|Определяет, является ли элемент управления имеет фокус.|  
|[COleControl::GetFont](#getfont)|Возвращает значение свойство Font.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Возвращает показатели `CFontHolder` объекта.|  
|[COleControl::GetForeColor](#getforecolor)|Возвращает значение свойства ForeColor акций.|  
|[COleControl::GetHwnd](#gethwnd)|Возвращает значение свойства биржевых hWnd.|  
|[COleControl::GetMessageString](#getmessagestring)|Предоставляет текст строки состояния для пункта меню.|  
|[COleControl::GetNotSupported](#getnotsupported)|Запрещает доступ к значению свойства элемента управления для пользователя.|  
|[COleControl::GetReadyState](#getreadystate)|Возвращает состояние готовности элемента управления.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Возвращает прямоугольник элемента управления относительно его контейнера.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Возвращает показатели свойство Font.|  
|[COleControl::GetText](#gettext)|Возвращает значение стандартного свойства Text или Caption.|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Переопределите, чтобы разрешить безоконном управления целевого объекта перетаскивания и операции перетаскивания.|  
|[COleControl::InitializeIIDs](#initializeiids)|Информирует базового класса со значениями IID элемент управления будет использовать.|  
|[COleControl::InternalGetFont](#internalgetfont)|Возвращает `CFontHolder` объект для свойство Font.|  
|[COleControl::InternalGetText](#internalgettext)|Получает стандартное свойство заголовок или текст.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Задает состояние готовности элемента управления и вызывает событие изменения состояния готовности.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Делает недействительной область отображаемого элемента управления, вызывает его перерисовку.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Делает недействительной клиентскую область окном контейнера в пределах заданной области. Можно использовать для повторной отрисовки элементов управления без окон в регионе.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Разрешает специализированные загрузку элемента управления OLE.|  
|[COleControl::IsModified](#ismodified)|Определяет, изменилось ли состояние элемента управления.|  
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Указывает, поддерживает ли контейнер оптимизированное Рисование для текущей операции рисования.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Вызывается, чтобы определить, если элемент управления подклассом Windows элементов управления.|  
|[COleControl::Load](#load)|Сбрасывает все предыдущие асинхронные данные и инициализирует новую загрузку асинхронного свойства элемента управления.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Определяет, если элемент управления можно отключить с помощью контейнера.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Вызывается, когда изменяется внешнее свойство.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Вызывается при изменении стандартных свойств внешнего вида.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Вызывается при изменении свойства BackColor акций.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Вызывается при изменении стандартных свойства BorderStyle.|  
|[COleControl::OnClick](#onclick)|Вызывается срабатывание stock щелкните событие.|  
|[COleControl::OnClose](#onclose)|Уведомляет элемент управления, `IOleControl::Close` был вызван.|  
|[COleControl::OnDoVerb](#ondoverb)|Вызывается после выполнения команды управления.|  
|[COleControl::OnDraw](#ondraw)|Вызывается, когда запрашивается перерисовку элемента управления.|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Вызывается контейнером для элемента управления, получив команду перерисовать себя с помощью контекста устройства метафайла.|  
|[COleControl::OnEdit](#onedit)|Вызывается контейнером для активации пользовательского интерфейса элемента управления OLE.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Вызывается при изменении свойства Enabled акции.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Вызывается контейнером для перечисления команд элементов управления.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Вызывается, когда обработчики событий подключением и отключением от элемента управления.|  
|[COleControl::OnFontChanged](#onfontchanged)|Вызывается при изменении свойство Font.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Вызывается при изменении стандартных свойств цвет переднего плана.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Вызывается при фиксации или разморозить, события элемента управления.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Уведомляет элемент управления, `IOleObject::GetColorSet` был вызван.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Назначенный сведения в контейнер.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Вызывается для получения строки для представления значения свойства.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Запрашивает дескриптор меню элемента управления, которой будут объединены с помощью меню контейнера.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Переопределите, чтобы получить отображаемый размер элемента управления, наиболее близкое к предложенный размер и степени режиме.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Возвращает строки, представляющие возможные значения для свойства.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Возвращает значение, соответствующее заранее определенной строки.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Переопределите, чтобы получить размер областей отображения элемента управления (можно использовать для включения двухпроходный рисования).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Переопределите, чтобы преобразовать размер элемента управления в прямоугольник, начиная с указанной позиции.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Переопределите, чтобы получить сведения о состоянии представления элемента управления.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Вызывается контейнером при деактивации пользовательского интерфейса элемента управления.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Переопределение, чтобы быть контейнер для неактивных системой управления версиями диспетчеризации указатель мыши `WM_MOUSEMOVE` сообщений для элемента управления.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Переопределение, чтобы быть контейнер для неактивных системой управления версиями диспетчеризации указатель мыши `WM_SETCURSOR` сообщений для элемента управления.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Вызывается после сработал стандартное событие KeyDown.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Вызывается после стандартное событие Нажатие клавиши было запущено.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Вызывается после сработал стандартное событие KeyUp.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Указывает, какую страницу свойств для редактирования свойства.|  
|[COleControl::OnMnemonic](#onmnemonic)|Вызывается, когда была нажата назначенная клавиша элемента управления.|  
|[COleControl::OnProperties](#onproperties)|Вызывается, когда вызывается команда «Свойства» элемента управления.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Переопределите, чтобы запрос ли заданная точка перекрывается отображение элемента управления.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Переопределите, чтобы запрос ли в любой момент в данном прямоугольнике перекрывается отображение элемента управления.|  
|[COleControl::OnRenderData](#onrenderdata)|Вызывается платформой для извлечения данных в указанном формате.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Вызывается платформой для извлечения данных из файла в указанном формате.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Вызывается платформой для извлечения данных из глобальной памяти в указанном формате.|  
|[COleControl::OnResetState](#onresetstate)|Восстанавливает значения по умолчанию свойств элемента управления.|  
|[COleControl::OnSetClientSite](#onsetclientsite)|Уведомляет элемент управления, `IOleControl::SetClientSite` был вызван.|  
|[COleControl::OnSetData](#onsetdata)|Заменяет элемент управления данных с другим значением.|  
|[COleControl::OnSetExtent](#onsetextent)|Вызывается после изменения расширения элемента управления.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Вызывается после были изменены размеры элемента управления.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Вызывается, когда элемент был активирован пользовательского интерфейса.|  
|[COleControl::OnTextChanged](#ontextchanged)|Вызывается при изменении акций текста или заголовка.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Обрабатывает сообщения окна (кроме клавиатуры и мыши сообщений) для элементов управления без окон.|  
|[COleControl::ParentToClient](#parenttoclient)|Преобразует точку относительно контейнера источника на момент относительно исходного элемента управления.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Уведомляет контейнера закрыт модального диалогового окна.|  
|[COleControl::PreModalDialog](#premodaldialog)|Уведомляет контейнер, в котором модального диалогового окна будет отображаться.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Удаляет и повторно создает окна элемента управления.|  
|[COleControl::Refresh](#refresh)|Вызывает принудительную закраску внешнего вида элемента управления.|  
|[COleControl::ReleaseCapture](#releasecapture)|Освобождает захват мыши.|  
|[COleControl::ReleaseDC](#releasedc)|Освобождает контекст устройства отображения контейнера элемента управления без окна.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Сбрасывает родительского окна элемента управления.|  
|[COleControl::ResetStockProps](#resetstockprops)|Инициализирует `COleControl` стандартные свойства значениями по умолчанию.|  
|[COleControl::ResetVersion](#resetversion)|Инициализирует номер версии для заданного значения.|  
|[COleControl::ScrollWindow](#scrollwindow)|Позволяет элементу управления без окон для прокрутки области в пределах его активного изображения на месте на экране.|  
|[COleControl::SelectFontObject](#selectfontobject)|Выбор пользовательского свойства шрифта в контексте устройства.|  
|[COleControl::SelectStockFont](#selectstockfont)|Выбирает свойство Font в контексте устройства.|  
|[COleControl::SerializeExtent](#serializeextent)|Выполняет сериализацию или инициализирует место отображения элемента управления.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Сериализует или инициализирует `COleControl` стандартные свойства.|  
|[COleControl::SerializeVersion](#serializeversion)|Выполняет сериализацию или инициализирует сведения о версии элемента управления.|  
|[COleControl::SetAppearance](#setappearance)|Задает значение свойства Appearance акций.|  
|[COleControl::SetBackColor](#setbackcolor)|Задает значение свойства BackColor акций.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Задает значение свойства BorderStyle акций.|  
|[COleControl::SetCapture](#setcapture)|В результате окна контейнера элемента управления необходимо выполнить владения захвата мыши на имени элемента управления.|  
|[COleControl::SetControlSize](#setcontrolsize)|Задает положение и размер элемента управления OLE.|  
|[COleControl::SetEnabled](#setenabled)|Задает значение свойства Enabled акций.|  
|[COleControl::SetFocus](#setfocus)|В результате элемент управления контейнера окно владение фокус ввода от имени элемента управления.|  
|[COleControl::SetFont](#setfont)|Задает значение свойство Font.|  
|[COleControl::SetForeColor](#setforecolor)|Задает значение свойства ForeColor акций.|  
|[COleControl::SetInitialSize](#setinitialsize)|Задает размер элемента управления OLE, при первом отображении в контейнере.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Изменяет измененном состоянии элемента управления.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Указывает, что произошел сбой запроса редактирования.|  
|[COleControl::SetNotSupported](#setnotsupported)|Предотвращает изменение значения свойства элемента управления для пользователя.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Задает прямоугольник элемента управления относительно его контейнера.|  
|[COleControl::SetText](#settext)|Задает значение свойства Text или Caption акций.|  
|[COleControl::ThrowError](#throwerror)|Указывает, произошла ошибка в элементе управления OLE.|  
|[COleControl::TransformCoords](#transformcoords)|Преобразования координировать значения между контейнером и элементом управления.|  
|[COleControl::TranslateColor](#translatecolor)|Преобразует **OLE_COLOR** значение **COLORREF** значение.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Определяет свойства окружения будет ли доступен при очередном элемент управления будет загружен.|  
|[COleControl::WindowProc](#windowproc)|Содержит процедуры Windows `COleControl` объекта.|  
  
### <a name="protected-methods"></a>Защищенные методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Вызывается платформой, когда внешний вид элемента управления должен быть обновлен.|  
|[COleControl::DrawMetafile](#drawmetafile)|Вызывается платформой при использовании контексте устройства метафайла.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Включает вызов метода автоматизации.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Вызывается платформой для инициализации списка форматов данных, поддерживаемый данным элементом управления.|  
  
## <a name="remarks"></a>Примечания  
 Производное от `CWnd`, этот класс наследует все функциональные возможности объекта окна Windows, а также дополнительные функциональные возможности, относящиеся к OLE, например событием и возможность поддержки методы и свойства.  
  
 Элементы управления OLE, могут быть вставлены в OLE-приложения контейнера и взаимодействия с контейнером с помощью двустороннее системы событием и предоставление методов и свойств в контейнер. Обратите внимание, что стандартная OLE-контейнеры поддерживают только основные функциональные возможности элемента управления OLE. Они не поддерживающие расширенные функциональные возможности элемента управления OLE. Формирование событий возникает, когда события отправляются в контейнер, в результате некоторые действия, происходящие в элементе управления. В свою очередь контейнер взаимодействует с элементом управления, используя предоставленный набор методов и свойств, аналогично функции-члены и данные-члены класса C++. Такой подход позволяет разработчику управлять внешним видом элемента управления и уведомлять контейнера, когда происходят определенные действия.  
  
## <a name="windowless-controls"></a>Элементы управления без окон  
 Элементы управления OLE может быть используется встроенная активация без окна. Без окон элементы управления обладают значительные преимущества.  
  
-   Элементы управления без окон может быть прозрачным и непрямоугольные  
  
-   Элементы управления без окон уменьшить экземпляр размер и время создания объекта  
  
 Элементы управления не обязательно окна. Службы, которые предлагает окна легко могут быть предоставлены посредством одного общего окна (обычно контейнера) и большой объем кода диспетчеризации. Наличие окна является главным образом это ненужное усложнение в объекте.  
  
 При использовании активации без окна контейнера (которая имеет окна) отвечает за предоставление служб, которые бы в противном случае были предоставлены с помощью элемента управления собственного окна. Например если элемент управления должен запросить фокус клавиатуры, запрос захват мыши или получить контекст устройства, эти операции управляются контейнером. `COleControl` [Функции-члены без окон операции](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) вызова этих операций в контейнере.  
  
 При включении активации без окна делегаты контейнер входных сообщений для элемента управления `IOleInPlaceObjectWindowless` интерфейса (расширение [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) без окон поддержки). `COleControl`в реализации этого интерфейса передает эти сообщения через схему сообщений для элемента управления, после настройки мыши координирует соответствующим образом. Можно обрабатывать указанные сообщения, как обычные окна сообщения, добавив соответствующие записи в схеме сообщений.  
  
 В элементе управления без окон, следует всегда использовать `COleControl` вместо соответствующих функций-членов `CWnd` функций-членов и их связанные функции Windows API.  
  
 Объекты OLE-элемент управления можно также создать окно только в том случае, когда они становятся активными, однако возрастает объем работы, необходимого для перехода неактивные активный и скорость перехода выходит из строя. Существуют случаи, когда это проблема: в качестве примера рассмотрим сетка текстовых полей. Когда курсора вверх и вниз по столбцу, каждый элемент управления должны быть на месте активации и деактивации затем. Скорость перехода неактивные активный непосредственно влияют на скорость прокрутки.  
  
 Дополнительные сведения о разработке инфраструктуры управления OLE, см. в статьях [элементы управления MFC ActiveX](../../mfc/mfc-activex-controls.md) и [Обзор: создание программы управления MFC ActiveX](../../mfc/reference/mfc-activex-control-wizard.md). Сведения по оптимизации элементы управления OLE, включая элементы управления без окон и мерцания разделе [элементы управления MFC ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 Возвращает значение свойства BackColor окружения.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущее значение контейнера окружения свойства BackColor, если таковые имеются. Если это свойство не поддерживается, эта функция возвращает цвет фона определяемые системой Windows.  
  
### <a name="remarks"></a>Примечания  
 Свойства BackColor окружения доступен для всех элементов управления и определяется контейнера. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 Контейнер для элемента управления назначено имя используется в сообщениях об ошибках, отображаемых для пользователя.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имя элемента управления OLE. Значение по умолчанию — пустая строка.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 Возвращает значение свойства шрифта окружения.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на интерфейс диспетчеризации окружения шрифт контейнера. Значение по умолчанию — **NULL**. Если возврат не равно **NULL**, вы несете ответственность за освобождение шрифта путем вызова его [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) функции-члена.  
  
### <a name="remarks"></a>Примечания  
 Внешнее свойство шрифта определяется контейнера и доступны для всех элементов управления. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 Возвращает значение свойства ForeColor окружения.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущее значение контейнера ForeColor свойств окружения, если таковые имеются. Если не поддерживается, эта функция возвращает цвет текста определяемые системой Windows.  
  
### <a name="remarks"></a>Примечания  
 Внешнее свойство ForeColor доступна для всех элементов управления и определяется контейнера. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientlocaleid"></a>COleControl::AmbientLocaleID  
 Возвращает идентификатор языка контейнера.  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение свойства LocaleID контейнера, если таковые имеются. Если это свойство не поддерживается, эта функция возвращает 0.  
  
### <a name="remarks"></a>Примечания  
 Элемент управления можно использовать код языка адаптировать его пользовательский интерфейс для конкретных языков. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 Извлекает текущую настройку внешнего вида объекта управления.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Внешний вид элемента управления:  
  
- **0** плоский внешний вид  
  
- **1** трехмерной визуализации  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается для получения текущего значения **DISPID_AMBIENT_APPEARANCE** свойства для элемента управления.  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 Возвращает тип единиц, используемые контейнером.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Строка, содержащая окружения ScaleUnits контейнера. Если это свойство не поддерживается, эта функция возвращает строку нулевой длины.  
  
### <a name="remarks"></a>Примечания  
 Внешнее свойство ScaleUnits контейнера можно использоваться для отображения позиций или измерений, помеченные выбранный блок, например твипов или сантиметры. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 Определяет, разрешает ли контейнер элемента управления для отображения маркеры захвата для себя, когда активны.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если должна отображаться маркеры захвата; в противном случае — 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 Определяет, разрешает ли контейнер элемента управления для отображения окна с заштрихованного шаблона, когда активный пользовательского интерфейса.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если необходимо отобразить заштрихованного шаблон; в противном случае — 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 Определяет выравнивание текста окружения предпочитаемого контейнера элемента управления.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Состояние окружения свойства TextAlign контейнера. Если это свойство не поддерживается, эта функция возвращает 0.  
  
 Ниже приведен список допустимых возвращаемых значений.  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|0|Обычное выравнивание (номера справа, текст слева).|  
|1|Выравнивание по левому краю|  
|2|Center|  
|3|По правому краю|  
  
### <a name="remarks"></a>Примечания  
 Это свойство доступно для всех внедренные элементы управления и определяется контейнера. Обратите внимание, что контейнер не должен поддерживать это свойство.  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 Определяет, если контейнер хочет управления реагировать на действия пользовательского интерфейса.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления должен отвечать на действия пользовательского интерфейса. в противном случае — 0. Если это свойство не поддерживается, эта функция возвращает 0.  
  
### <a name="remarks"></a>Примечания  
 Например, контейнер может присвоить это **TRUE** в режиме конструктора.  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 Определяет, является ли контейнер в режим конструктора или в пользовательском режиме.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если контейнер находится в режиме пользователя. в противном случае значение 0 (в режиме конструктора). Если это свойство не поддерживается, эта функция возвращает значение TRUE.  
  
### <a name="remarks"></a>Примечания  
 Например, контейнер может присвоить это **FALSE** в режиме конструктора.  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 Указывает, изменилось значение связанного свойства.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчеризации связанное свойство элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Оно должно вызываться каждый раз при изменении свойства даже в случаях, где это изменение не было сделано с помощью свойства значение метода. Помните, особенно связанных свойств, которые сопоставляются с переменными-членами. Каждый раз такой член изменения переменных, `BoundPropertyChanged` должен вызываться.  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 Запрашивает разрешение у `IPropertyNotifySink` интерфейс для изменения значения свойства привязки, предоставляемые элементом управления.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчеризации связанное свойство элемента управления.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если изменения разрешены; в противном случае — 0. Значение по умолчанию — ненулевое значение.  
  
### <a name="remarks"></a>Примечания  
 Если разрешения, элемент управления не следует допускать значение изменения свойства. Это можно сделать, пропускается или переводя другой действие, которое была предпринята попытка изменить значение свойства.  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 Преобразует координаты `pPoint` в координаты родительского элемента.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lprcBounds`  
 Указатель на границы элемента управления OLE в контейнере. Область всего элемента управления, включая границы и полосы прокрутки, но не клиентской области.  
  
 `pPoint`  
 Указатель на точку области клиента OLE было преобразовано в координатах (контейнер) родительского элемента.  
  
### <a name="remarks"></a>Примечания  
 На входе `pPoint` относительно начала координат клиентской области элемента управления OLE (верхний левый угол клиентской области элемента управления). На выходе `pPoint` относительно начала координат (верхний левый угол контейнера) родительского элемента.  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 Корректирует прямоугольник курсора, если оно полностью или частично охвачено непрозрачный перекрывающиеся объекты.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `lpRect`  
 На входе, указатель на [RECT](../../mfc/reference/rect-structure1.md) структуру, содержащую курсор области скорректирована. На выходе области скорректированное курсора или **NULL** если прямоугольник курсор полностью поддерживается.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Курсор находится мигающей линии, блока или точечного рисунка, который обычно указывает, где будет вставлен текст или графика.  
  
 Объект без окон невозможно безопасно Показать курсор без проверки ли курсор частично или полностью скрыто перекрывающихся объектов. Для этого можно использовать объект `ClipCaretRect` для получения курсора изменены (reduced) для обеспечения она помещается в области обрезки.  
  
 Объекты, создание курсор должен отправить прямоугольника, курсор `ClipCaretRect` и использовать настроенную прямоугольник для курсора. Если курсор полностью скрыт, этот метод будет возвращать **FALSE** и курсор не должен отображаться на всех в этом случае.  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 Создает объект `COleControl`.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Примечания  
 Эта функция обычно не вызывается напрямую. Вместо этого элемента управления OLE обычно создается путем своей фабрики класса.  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 Эта функция вызывается при изменении набора мнемоник, поддерживаемый данным элементом управления.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Примечания  
 При получении этого уведомления, контейнер элемента управления получает новый набор мнемоник путем вызова [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Обратите внимание, что контейнер не должен отвечать на это уведомление.  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 Вызывается платформой, после обработки стандартное событие ошибки (если обработчик событий подавить отображение ошибки).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Параметры  
 *SCODE*  
 Значение кода состояния в отчетах. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Описание сообщение об ошибке.  
  
 *lpszSource*  
 Имя модуля, вызвавший ошибку (как правило, имя модуля управления OLE).  
  
 `lpszHelpFile`  
 Имя файла справки, содержащий описание ошибки.  
  
 `nHelpID`  
 Идентификатор контекста справки сообщаемый ошибки.  
  
### <a name="remarks"></a>Примечания  
 Поведение по умолчанию отображает окно сообщения, содержащего описание ошибки, содержащихся в `lpszDescription`.  
  
 Переопределите эту функцию, чтобы настроить способ отображения ошибок.  
  
##  <a name="doclick"></a>COleControl::DoClick  
 Имитирует мыши выберите действие на элементе управления.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Примечания  
 Переопределяемый `COleControl::OnClick` будет вызываться функция-член и stock щелкните событие будет запускаться, если поддерживаемый данным элементом управления.  
  
 Эта функция поддерживается `COleControl` базовый класс как биржевые метод с именем DoClick. Дополнительные сведения см. в статье [элементы управления ActiveX: методы](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 Вызывается платформой, когда загружается или сохраняется элемент управления из представления постоянное хранилище, например, поток или свойство набора.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Параметры  
 `pPX`  
 Указатель на объект `CPropExchange`. Структура предоставляет этот объект для формирования контекста обмена свойства, включая его направление.  
  
### <a name="remarks"></a>Примечания  
 Эта функция обычно вызывает **PX_** семейство функций, чтобы загрузить или сохранить определенные пользовательские свойства элемента управления OLE.  
  
 При использовании мастера элементов управления для создания проекта элемента управления OLE переопределенная версия этой функции выполняет сериализацию стандартных свойств, поддерживаемых `COleControl` на вызов функции базового класса, `COleControl::DoPropExchange`. Как добавить пользовательские свойства элемента управления OLE необходимо будет изменить эту функцию для сериализации нового свойства. Дополнительные сведения о сериализации см. в статье [элементы управления ActiveX: сериализация](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 Перерисовывает элемента управления OLE, подклассом элемента управления Windows Forms.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Указатель на контекст устройства контейнера элемента управления.  
  
 `rcBounds`  
 Область, в котором будет отображаться элемент управления.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается для правильно обрабатывать Рисование неактивную элемента управления OLE. Эту функцию следует использовать, только если OLE управления подклассов элемента управления Windows Forms и должен быть вызван в `OnDraw` функции элемента управления.  
  
 Дополнительные сведения о данной функции и создание подкласса элемента управления Windows Forms см. в статье [элементы управления ActiveX: Создание подкласса элемента управления Windows Forms](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 Вызывается платформой, когда внешний вид элемента управления должен быть обновлен.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Указатель на контекст устройства.  
  
 `rc`  
 Прямоугольная область для отрисовки.  
  
### <a name="remarks"></a>Примечания  
 Эта функция напрямую вызывает переопределяемый `OnDraw` функции.  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 Вызывается платформой при использовании контексте устройства метафайла.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Указатель на контекст устройства метафайла.  
  
 `rc`  
 Прямоугольная область для отрисовки.  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 Позволяет характеристика Простая рамка для элемента управления OLE.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Примечания  
 Эта характеристика позволяет элементу управления для поддержки visual вложения из других элементов управления, но не true вложения OLE. Примером такого с несколькими элементами управления внутри области группы. Эти элементы управления не содержится OLE, но они находятся в одном поле группы.  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 Сериализует или инициализирует входит в область элемента управления (его измерений в **HIMETRIC** ед.).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Параметры  
 `pPX`  
 Указатель на [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта. Структура предоставляет этот объект для формирования контекста обмена свойства, включая его направление.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция обычно вызывается реализация по умолчанию `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 Выполняет сериализацию или инициализирует состояние стандартных свойств элемента управления.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Параметры  
 `pPX`  
 Указатель на [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта. Структура предоставляет этот объект для формирования контекста обмена свойства, включая его направление.  
  
### <a name="remarks"></a>Примечания  
 Эта функция обычно вызывается реализация по умолчанию `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 Выполняет сериализацию или инициализирует состояние сведения о версии элемента управления.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `pPX`  
 Указатель на объект `CPropExchange`. Структура предоставляет этот объект для формирования контекста обмена свойства, включая его направление.  
  
 `dwVersionDefault`  
 Текущий номер версии элемента управления.  
  
 `bConvert`  
 Указывает, является ли постоянных данных должны быть преобразованы в формат последней версии при сохранении или сохраняется в том же формате, который был загружен.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если функция выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Как правило, это будет Первая функция, вызываемая с переопределением элемента управления `COleControl::DoPropExchange`. При загрузке, эта функция считывает число версий постоянных данных и устанавливает атрибут version [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта соответствующим образом. При сохранении, эта функция записывает номер версии постоянных данных.  
  
 Дополнительные сведения о сохраняемости и управления версиями см. в статье [элементы управления ActiveX: сериализация](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 Вызывается платформой при щелчке мышью по активный элемент управления.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматического срабатывания события Click, схема событий для элемента управления необходимо иметь stock щелкните определенных событий.  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 Вызывается платформой при двойном щелчке мыши на активный элемент управления.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматического инициирования события Двойное нажатие кнопки, карты события элемента управления должны быть биржевых двойное нажатие кнопки события, определенного.  
  
##  <a name="fireerror"></a>COleControl::FireError  
 Запускает стандартное событие ошибки.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Параметры  
 *SCODE*  
 Значение кода состояния в отчетах. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Описание сообщение об ошибке.  
  
 `nHelpID`  
 Идентификатор справки сообщение об ошибке.  
  
### <a name="remarks"></a>Примечания  
 Это событие предоставляет способ сигналов, в соответствующих местах в коде, что произошла ошибка в элементе управления. В отличие от других стандартных событий, таких как щелчок или MouseMove ошибка никогда не вызывается платформой.  
  
 Чтобы сообщить об ошибке, возникающее во время функция get свойства, функция set свойства или метода автоматизации, вызовите [COleControl::ThrowError](#throwerror).  
  
 Реализация элемента управления OLE Stock ошибка, событие использует `SCODE` значение. Если элемент управления использует это событие и предназначен для использования в Visual Basic 4.0, вы получите ошибки, так как `SCODE` значение не поддерживается в Visual Basic.  
  
 Чтобы устранить эту проблему, вручную измените `SCODE` параметр в элементе управления. ODL-файла в **длинные**. Кроме того, любое пользовательское событие, метод или свойство, использующий `SCODE` параметра также приводит к тому же проблема.  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 Запускает событие определяемой пользователем из элемента управления с любым количеством необязательных аргументов.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчеризации событий срабатывание.  
  
 `pbParams`  
 Дескриптор для типов параметров событий.  
  
### <a name="remarks"></a>Примечания  
 Обычно эта функция не должен вызываться напрямую. Вместо этого будет вызывать функции формирование событий в разделе карты событий объявления класса элемента управления.  
  
 `pbParams` Аргумент является разделенный пробелами список **VTS_**. Одно или несколько из этих значений, разделенных пробелами (не запятыми), составляют список параметров функции. Ниже приведены возможные значения.  
  
|Символ|Тип параметра|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Дополнительные variant константы определены для всех типов variant, за исключением элемента **VTS_FONT** и **VTS_PICTURE**, обеспечивающие указатель константы данных variant. Эти константы именуются **VTS_P** `constantname` соглашение. Например **VTS_PCOLOR** — это указатель на **VTS_COLOR** константой.  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 Вызывается платформой при нажатии клавиши, во время активного пользовательского интерфейса элемента управления.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Параметры  
 `pnChar`  
 Указатель на значение виртуального кода клавиши нажатой клавише. Список стандартных кодов виртуального ключа см. в разделе Winuser.h  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматического срабатывания события KeyDown, карты события элемента управления должны быть биржевых определенные события KeyDown.  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 Вызывается платформой, когда нажимается и отпускается, когда пользовательский элемент управления активен пользовательского интерфейса внутри контейнера ключа.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Параметры  
 `pnChar`  
 Указатель на значение символа нажатой клавиши.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Получатель события может изменить `pnChar`, например, преобразование всех символов нижнего регистра в верхний регистр. Если требуется проверить измененную символ, переопределите `OnKeyPressEvent`.  
  
 Для автоматического срабатывания KeyPress-событие возникает, карты события элемента управления должны быть биржевых KeyPress-событие определено.  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 Вызывается платформой при отпускании клавиши, когда пользовательский элемент управления активен пользовательского интерфейса внутри контейнера.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Параметры  
 `pnChar`  
 Указатель на значение виртуального кода клавиши выпущено ключа. Список стандартных кодов виртуального ключа см. в разделе Winuser.h  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматической обработке KeyUp события происходят карты события элемента управления должны быть биржевых KeyUp события, определенного.  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 Вызывается платформой при нажатии кнопки мыши над активного пользовательского элемента управления.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Параметры  
 `nButton`  
 Нажата кнопка мыши числовое значение. Он может содержать один из следующих значений:  
  
- **LEFT_BUTTON** нажатой левую кнопку мыши.  
  
- **MIDDLE_BUTTON** была нажата средняя кнопка мыши вниз.  
  
- **RIGHT_BUTTON** нажатой правой кнопки мыши.  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
 *x*  
 Координата по оси x курсор при нажатой кнопке мыши. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
 *y*  
 Координата по оси y курсор при нажатой кнопке мыши. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматического срабатывания MouseDown-событие возникает, карты события элемента управления должны быть биржевых MouseDown-событие определено.  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 Вызывается платформой, когда курсор перемещается над активного пользовательского элемента управления.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Параметры  
 `nButton`  
 Числовое значение из кнопок мыши нажата. Содержит комбинацию из следующих значений:  
  
- **LEFT_BUTTON** левая кнопка мыши была нажата вниз в ходе выполнения действия.  
  
- **MIDDLE_BUTTON** средняя кнопка мыши была нажата вниз в ходе выполнения действия.  
  
- **RIGHT_BUTTON** правая кнопка мыши была нажата вниз в ходе выполнения действия.  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
 *x*  
 Координата по оси x для курсора. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
 *y*  
 Координата по оси y курсора. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматической обработке происходят события MouseMove карты событий элемента управления должны быть биржевых MouseMove события, определенного.  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 Вызывается платформой при отпускании кнопки мыши над активного пользовательского элемента управления.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Параметры  
 `nButton`  
 Числовое значение была отпущена кнопка мыши. Он может принимать одно из следующих значений:  
  
- **LEFT_BUTTON** был выпущен левой кнопки мыши.  
  
- **MIDDLE_BUTTON** был выпущен средней кнопки мыши.  
  
- **RIGHT_BUTTON** был выпущен правой кнопки мыши.  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
 *x*  
 Координата по оси x курсор во время выпуска кнопки мыши. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
 *y*  
 Координата по оси y курсора во время выпуска кнопки мыши. Координата указывается относительно левого верхнего угла окна элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Если это событие определяется как пользовательское событие, определяется во время возникновения события.  
  
 Для автоматической обработке происходят события MouseUp карты событий элемента управления должны быть биржевых MouseUp-событие, определенное.  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 Инициирует событие с текущим значением состояние готовности элемента управления.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Примечания  
 Состояние готовности может принимать одно из следующих значений:  
  
 **READYSTATE_UNINITIALIZED**  
 Состояние инициализации по умолчанию  
  
 **READYSTATE_LOADING**  
 В настоящее время загрузки его свойства элемента управления  
  
 **READYSTATE_LOADED**  
 Элемент управления был инициализирован.  
  
 **READYSTATE_INTERACTIVE**  
 Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.  
  
 `READYSTATE_COMPLETE`  
 Элемент управления имеет все данные  
  
 Используйте [GetReadyState](#getreadystate) для определения готовности текущего элемента управления.  
  
 [InternalSetReadyState](#internalsetreadystate) примет значение, указанное в состояние готовности, а затем вызывает `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 Изменяет поведение активации по умолчанию элемент управления, поддерживающий `IPointerInactive` интерфейса.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Сочетание флагов из **POINTERINACTIVE** перечисления. Ниже приведены возможные флаги.  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 Объект должен быть активирован, когда указатель мыши пересекает его во время операции перемещения мыши на месте.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 Объект следует деактивировать, когда указатель мыши покидает объекта во время операции перемещения мыши.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 Объект должен быть активирован при перемещении мыши над ним во время перетаскивания на месте операции перетаскивания.  
  
### <a name="remarks"></a>Примечания  
 Когда `IPointerInactive` интерфейс включен, будут делегировать контейнера `WM_SETCURSOR` и `WM_MOUSEMOVE` сообщения к нему. `COleControl`в реализации этого интерфейса передает эти сообщения через схему сообщений для элемента управления, после настройки мыши координирует соответствующим образом.  
  
 Каждый раз, когда контейнер получает `WM_SETCURSOR` или `WM_MOUSEMOVE` сообщение с указатель мыши над неактивным объектом с поддержкой `IPointerInactive`, он должен вызывать `GetActivationPolicy` на интерфейс и возврата флагов из **POINTERINACTIVE** перечисления.  
  
 Можно обработать эти сообщения так же, как обычные оконных сообщений, добавив соответствующие записи в схеме сообщений. В обработчиков, избегайте использования `m_hWnd` переменную-член (или все функции-члены, он используется) без предварительной проверки, что его значение не равно **NULL**.  
  
 Любой объект, предназначенный для более чем установить указатель мыши и/или срабатывание события перемещения мыши, таких как обеспечить специальные визуальную обратную связь, должен возвращать **POINTERINACTIVE_ACTIVATEONENTRY** флаг и нарисуйте отзыв только в том случае, когда активны. Если объект возвращает этот флаг, контейнер следует активировать ее на месте немедленно и переслать его же сообщения, которая запустила вызов `GetActivationPolicy`.  
  
 Если оба **POINTERINACTIVE_ACTIVATEONENTRY** и **POINTERINACTIVE_DEACTIVATEONLEAVE** флаги возвращаются, то объект будет активирован, только когда указатель мыши находится над объектом. Если только **POINTERINACTIVE_ACTIVATEONENTRY** флаг возвращается, то объект будет активироваться только после при первом входе мыши объект.  
  
 Вы также можете неактивный элемент управления быть целевым объектом перетаскивания OLE и операция перетаскивания. Это требует активации элемента управления в момент, когда пользователь перетаскивает объект, так что окна элемента управления могут быть зарегистрированы в качестве цели перетаскивания. Чтобы во время перетаскивания успешной активации, возвращают **POINTERINACTIVE_ACTIVATEONDRAG** флаг:  
  
 [!code-cpp[NVC_MFCAxCtl #1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 Сообщаются сведения путем `GetActivationPolicy` не должны кэшироваться контейнером. Вместо этого данный метод должен вызываться при каждом входе мыши неактивным объектом.  
  
 Если объект неактивные не запрашивает быть активирована, когда указатель мыши перемещается на его месте, контейнера должен отправлять последующие `WM_SETCURSOR` сообщений для этого объекта путем вызова [OnInactiveSetCursor](#oninactivesetcursor) до тех пор, пока остается указатель мыши над объектом.  
  
 Включение `IPointerInactive` интерфейс обычно означает, что требуется, чтобы элемент управления, чтобы обеспечить возможность обработки сообщений мыши все время. Для получения этого поведения в контейнер, который не поддерживает `IPointerInactive` интерфейса, необходимо будет управлять всегда активировано при отображении, то есть элемент управления должен иметь **OLEMISC_ACTIVATEWHENVISIBLE** флаг среди прочих флаги. Однако во избежание этого флага из вступают в силу в контейнере, который поддерживает `IPointerInactive`, можно также указать **OLEMISC_IGNOREACTIVATEWHENVISIBLE** флаг:  
  
 [!code-cpp[NVC_MFCAxCtl #10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 Возвращает значение внешнее свойство контейнера.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Параметры  
 *dwDispid*  
 Идентификатор диспетчеризации требуемое внешнее свойство.  
  
 `vtProp`  
 Тип variant тег, который указывает тип значения должен быть возвращен в `pvProp`.  
  
 `pvProp`  
 Указатель на адрес переменной, которая будет принимать значение свойства или возвращаемое значение. Фактический тип указателя this должен соответствует типу, заданному параметром `vtProp`.  
  
|vtProp|Тип pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**короткий\***|  
|`VT_I4`|**Long\***|  
|`VT_R4`|**число с плавающей запятой\***|  
|`VT_R8`|**Double\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если поддерживается внешнее свойство; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Если вы используете `GetAmbientProperty` для извлечения свойства окружения DisplayName и ScaleUnits установите `vtProp` для `VT_BSTR` и `pvProp` для **CString\***. Чтобы получить свойства шрифта окружения, задайте `vtProp` для **VT_FONT** и `pvProp` для **LPFONTDISP\***.  
  
 Обратите внимание, что функции уже были предоставлены для общих свойств окружения, такие как [AmbientBackColor](#ambientbackcolor) и [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 Реализует функцию Get стандартных свойств внешнего вида элемента управления.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращаемое значение, указывающее текущую настройку внешнего вида как **короткие** ( `VT_I2`) значение в случае успешного выполнения. Это значение равно нулю, если внешний вид элемента управления является плоской и 1, если внешний вид элемента управления является 3D.  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 Реализует функцию Get стандартное свойство цвет фона элемента управления.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращаемое значение, указывающее текущий цвет фона, что **OLE_COLOR** значение в случае успешного выполнения. Это значение можно преобразовать в **COLORREF** значение с помощью вызова `TranslateColor`.  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 Реализует функцию Get стандартное свойство BorderStyle элемента управления.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 1, если элемент управления имеет обычный границы; 0, если элемент управления не имеет рамки.  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 Определяет, является ли `COleControl` объект имеет захват мыши.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если элемент управления активирован и без окон, возвращает **это** Если элемент управления в настоящее время имеет захват мыши (в зависимости от контейнера элемента управления), или **NULL** , если он не поддерживает запись.  
  
 В противном случае возвращает `CWnd` объекта, который получил захват мыши (то же, что `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Примечания  
 Активированная неоконным получает мыши при записи [SetCapture](#setcapture) вызывается.  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 Вызывается платформой для извлечения идентификатора класса элемента управления OLE.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Параметры  
 *pclsid*  
 Указатель на расположение идентификатора класса.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов не был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Обычно реализуется [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 Возвращает разницу между в верхний левый угол прямоугольной области элемента управления и в верхнем левом углу клиентской области.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *pdxOffset*  
 Указатель на горизонтальное смещение клиентской области элемента управления OLE.  
  
 *pdyOffset*  
 Указатель на вертикальное смещение клиентской области элемента управления OLE.  
  
### <a name="remarks"></a>Примечания  
 Элемент управления OLE имеет прямоугольную область в пределах своего контейнера. Клиентской области элемента управления — это область элемента управления, за исключением границы и полосы прокрутки. Смещение, извлекается с `GetClientOffset` разницы в верхний левый угол прямоугольной области элемента управления и левой верхней части клиентской области. Если элемент управления имеет неклиентские элементы, отличные от стандартных границ и полос прокрутки, переопределяют эту функцию-член для указания смещения.  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 Получает размер клиентской области элемента управления.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lpRect`  
 Указатель на `RECT` структуру, содержащую размеры клиентской области элемента управления без окон, то есть размер элемента управления, за вычетом границы окна, кадры, полосы прокрутки и т. д. `lpRect` Указывает размер клиентской области элемента управления, не его положение.  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 Запрашивает объект для указателя на текущий сайт клиента в пределах своего контейнера.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на текущий сайт клиента элемента управления в его контейнере.  
  
### <a name="remarks"></a>Примечания  
 Возвращенный указатель указывает на экземпляр `IOleClientSite`. `IOleClientSite` Интерфейс, реализуемый контейнерами, является представлением объекта контекста: где он прикреплен в документе, где он получает свое хранилище, пользовательский интерфейс и другие ресурсы.  
  
##  <a name="getcontrolflags"></a>COleControl::GetControlFlags  
 Получает флаг настройки элемента управления.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Оператором OR сочетание флагов из перечисления ControlFlags:  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Примечания  
 По умолчанию `GetControlFlags` возвращает `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Если задано, функция использует begin рисования, предназначенная для элементов управления OLE, а не [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (значение по умолчанию).  
  
 `clipPaintDC`  
 Если не задано, отключает вызов `IntersectClipRect` внесенных `COleControl` и повышает скорость. При использовании активации без окна флаг не оказывает влияния.  
  
 `pointerInactive`  
 Если задано, обеспечивает взаимодействие с мышью элемент управления неактивен, включив `COleControl`реализация `IPointerInactive` интерфейс, который по умолчанию отключена.  
  
 `noFlickerActivate`  
 Если задано, устраняет необходимость дополнительных операций лишние рисования и сопутствующее видимое мерцание. Используется, если элемент управления самостоятельно прорисовывающий одинаково в активным и неактивным состоянием. При использовании активации без окна флаг не оказывает влияния.  
  
 `windowlessActivate`  
 Если значение, указывающее, элемент управления использует активации без окна.  
  
 `canOptimizeDraw`  
 Если задано, указывает, что элемент управления будет выполнять оптимизированное Рисование Если контейнер поддерживает его.  
  
 Дополнительные сведения о `GetControlFlags` и другие виды оптимизации, элементов управления OLE, в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 Получает размер окна элемента управления OLE.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Параметры  
 *PCX*  
 Задает ширину элемента управления в пикселях.  
  
 *pcy*  
 Задает высоту элемента управления в пикселях.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что все координаты для элемента управления windows относительно верхнего левого угла элемента управления.  
  
##  <a name="getdc"></a>COleControl::GetDC  
 Предоставляет для объекта без окон контекст устройства get экрана (или совместимые) из контейнера.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Параметры  
 *lprcRect*  
 Указатель на прямоугольник управления без окна хочет перерисовывает в клиентские координаты элемента управления. **Значение NULL** означает полный объект экстента.  
  
 `dwFlags`  
 Атрибуты рисования контекст устройства. Следующие варианты:  
  
- **OLEDC_NODRAW** означает, что объект не будет использоваться контекст устройства для выполнения любое изображение просто, но для получения сведений об устройстве отображения. Контейнер должен просто передайте окна контроллера домена без дополнительной обработки.  
  
- **OLEDC_PAINTBKGND** запросов, что контейнер в качестве фона перед возвратом контроллера домена. Объект следует использовать этот флаг, если он запрашивает контроллер домена для перерисовки области с прозрачным фоном.  
  
- **OLEDC_OFFSCREEN** информирует контейнера, который хочет объекта отрисовки в битовом изображении, которое следует копировать на экране. Объект должен использовать этот флаг, при его должен выполнять операции рисования создает большой объем мерцание. Контейнер может поддерживать этот запрос или нет. Тем не менее, если этот флаг не установлен, контейнер должен передать обратно на экране контроллера домена. Это позволяет выполнять операции прямой экран, например отображение выделения объектам (через **XOR** операции).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на контекст устройства отображения для контейнера `CWnd` клиентской области Если успешно; в противном случае возвращает значение **NULL**. Контекст устройства отображения можно использовать в последующих функций GDI для рисования в клиентской области окна контейнера.  
  
### <a name="remarks"></a>Примечания  
 [ReleaseDC](#releasedc) освобождаемый контекст после рисования необходимо вызвать функцию-член. При вызове `GetDC`, объекты передачи они хотят привлечь в своих собственных клиентских координат прямоугольника. `GetDC`преобразует их в координаты клиентской области контейнера. Объект не должен запросить нужный рисования прямоугольник, превышающий области собственного клиентского прямоугольника, размер которой можно получить с помощью [метода GetClientRect](#getclientrect). Это предотвращает случайно рисование которых они не должно быть объектов.  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 Реализует функцию Get элемента управления stock свойство Enabled.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления включен; в противном случае — 0.  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 Получает указатель на объект, который обслуживается контейнер, который представляет элемент управления с расширенный набор свойств.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на контейнер расширенных объект элемента управления. Если отсутствует объект, значение равно **NULL**.  
  
 Этот объект может быть подвергнуты его `IDispatch` интерфейса. Можно также использовать `QueryInterface` получить другие доступные интерфейсы, предоставляемые объектом. Тем не менее объект не требуется для поддержки конкретного набора интерфейсов. Обратите внимание, полагаясь на конкретные компоненты объекта расширенного элемента управления контейнера ограничивает переносимость в другие контейнеры произвольный элемент управления.  
  
### <a name="remarks"></a>Примечания  
 Функция, которая вызывает данную функцию, отвечает за освобождение указатель после завершения работы с объектом. Обратите внимание, что контейнер не требуется для поддержки этого объекта.  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 Определяет, является ли `COleControl` объекте находится фокус.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если элемент управления активирован и без окон, возвращает **это** Если элемент управления в данный момент имеет фокус клавиатуры (в зависимости от контейнера элемента управления), или **NULL** , если он не имеет фокус.  
  
 В противном случае возвращает `CWnd` объекта, имеющего фокус (то же, что `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Примечания  
 Активированная неоконным получает фокус при [SetFocus](#setfocus) вызывается.  
  
##  <a name="getfont"></a>COleControl::GetFont  
 Реализует свойство Font функцию Get.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на интерфейс диспетчеризации шрифта для элемента управления stock свойства шрифта.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что вызывающий объект должен освободить объект после завершения. В реализации элемента управления, используйте `InternalGetFont` для доступа к объект шрифта элемента управления. Дополнительные сведения об использовании шрифтов в элементе управления см. в статье [элементы управления ActiveX: использование шрифтов в элементе управления ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 Измеряет показатели текст для любого `CFontHolder` объектов, принадлежащих данному элементу управления.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Параметры  
 `lptm`  
 Указатель на [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) структуры.  
  
 `fontHolder`  
 Ссылка на [CFontHolder](../../mfc/reference/cfontholder-class.md) объекта.  
  
### <a name="remarks"></a>Примечания  
 Можно выбрать с помощью такого шрифта [COleControl::SelectFontObject](#selectfontobject) функции. `GetFontTextMetrics`Инициализирует `TEXTMETRIC` структуры, на который указывает `lptm` с допустимым метрики сведения о `fontHolder`, шрифт в случае успешного выполнения или заполнить структуру нулями, если выполнена успешно. Следует использовать эту функцию вместо [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) при визуальное элемент управления, возможно, элементы управления, как и любой внедренного объекта OLE, необходимые для визуализации сами в метафайл.  
  
 `TEXTMETRIC` Структуру для шрифта по умолчанию используется при обновлении [SelectFontObject](#selectfontobject) функция. Следует вызвать метод `GetFontTextMetrics` только после выбора для обеспечения информации, он предоставляет свойство Font является допустимым.  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 Реализует функцию Get стандартное свойство цвет переднего плана.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращаемое значение, указывающее текущий цвет как **OLE_COLOR** значение в случае успешного выполнения. Это значение можно преобразовать в [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) значение с помощью вызова `TranslateColor`.  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 Реализует функцию Get свойства биржевых hWnd.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор окна элемента управления OLE, при его наличии; в противном случае **NULL**.  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 Вызывается платформой для получения короткую строку с описанием назначения элемента меню, обозначенную `nID`.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `nID`  
 Идентификатор элемента меню.  
  
 `rMessage`  
 Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объекта, через который будут возвращены строки.  
  
### <a name="remarks"></a>Примечания  
 Это можно использовать для получения сообщений для отображения в строке состояния, снимая выделения пункта меню. Реализация по умолчанию пытается загрузить строку ресурса с `nID`.  
  
##  <a name="getnotsupported"></a>COleControl::GetNotSupported  
 Запрещает доступ к значению свойства элемента управления для пользователя.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Примечания  
 Вызывайте эту функцию вместо функции Get любого свойства, где получение свойства элемента управления пользователем не поддерживается. Примером может служить свойство, которое доступно только для записи.  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 Возвращает состояние готовности элемента управления.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Состояние готовности элемента управления, одно из следующих значений:  
  
 **READYSTATE_UNINITIALIZED**  
 Состояние инициализации по умолчанию  
  
 **READYSTATE_LOADING**  
 В настоящее время загрузки его свойства элемента управления  
  
 **READYSTATE_LOADED**  
 Элемент управления был инициализирован.  
  
 **READYSTATE_INTERACTIVE**  
 Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.  
  
 `READYSTATE_COMPLETE`  
 Элемент управления имеет все данные  
  
### <a name="remarks"></a>Примечания  
 Большая часть простых элементов управления не требуется для различения **LOADED** и `INTERACTIVE`. Тем не менее элементы управления, поддерживающие свойства пути данных не может быть готовые для интерактивного до получения хотя бы некоторые данные асинхронно. Элемент управления должен пытаться стать интерактивный как можно быстрее.  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 Получает координаты прямоугольника элемента управления относительно контейнера, выраженный в единицах устройства.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `lpRect`  
 Указатель на структуру прямоугольник, в который будут скопированы координаты элемента управления.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления является активным на месте; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Прямоугольник допустимо только в том случае, если элемент управления является активным на месте.  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 Измеряет показатели текста для элемента управления свойство Font, которое может быть установлено с [SelectStockFont](#selectstockfont) функции.  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Параметры  
 `lptm`  
 Указатель на [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) структуры.  
  
### <a name="remarks"></a>Примечания  
 `GetStockTextMetrics` Функция будет инициализировать `TEXTMETRIC` структуры, на который указывает `lptm` с допустимым метрики сведения в случае успешного выполнения или заполнения структуры нулями, если выполнена успешно. Используйте эту функцию вместо [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) при визуальное элемент управления, возможно, элементы управления, как и любой внедренного объекта OLE, необходимые для визуализации самостоятельно в метафайл.  
  
 `TEXTMETRIC` Структуру для шрифта по умолчанию используется при обновлении `SelectStockFont` функция. Эту функцию следует вызывать только после выбора биржевых шрифта, чтобы обеспечить сведения, которые он предоставляет является допустимым.  
  
##  <a name="gettext"></a>COleControl::GetText  
 Реализует функцию Get стандартное свойство Text или Caption.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущее значение элемента управления текстовую строку или строку нулевой длины, если строка не существует.  
  
> [!NOTE]
>  Дополнительные сведения о `BSTR` тип данных, в разделе [типы данных](../../mfc/reference/data-types-mfc.md) в разделе макросы и глобальные объекты.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что код, вызывающий эту функцию необходимо вызвать `SysFreeString` строки, возвращаемых для свободных ресурсов. В реализации элемента управления, используйте `InternalGetText` для доступа к свойству Text или Caption биржевых элемента управления.  
  
##  <a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget  
 Переопределить `GetWindowlessDropTarget` при необходимости элемент управления без окон для целевого объекта OLE операции перетаскивания.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на объект `IDropTarget` интерфейса. Так как он не имеет окна, не удалось зарегистрировать объект без окон `IDropTarget` интерфейса. Тем не менее, участвовать в операции перетаскивания, объект без окон можно по-прежнему реализовывать интерфейс и вернуть его в `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Примечания  
 Как правило это потребует, окна элемента управления быть зарегистрированы в качестве цели перетаскивания. Но так как элемент управления не имеет окна свои собственные, контейнер будет использовать отдельное окно местом назначения. Он просто должен предоставить реализацию `IDropTarget` интерфейс, к которому контейнера можно делегат вызывает в соответствующее время. Пример:  
  
 [!code-cpp[NVC_MFCAxCtl #2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 Информирует базового класса со значениями IID элемент управления будет использовать.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Параметры  
 *piidPrimary*  
 Указатель на идентификатор интерфейса элемента управления первичный интерфейс диспетчеризации.  
  
 *piidEvents*  
 Указатель на идентификатор интерфейса для интерфейса события элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Вызовите эту функцию в конструктор элемента управления для информирования базового класса элемента управления будет использовать идентификаторы интерфейсов.  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 Обращается к свойство Font элемента управления  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ссылку на [CFontHolder](../../mfc/reference/cfontholder-class.md) , содержащий биржевых объект шрифта.  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 Обращается к стандартное свойство Text или Caption элемента управления.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ссылка на элемент управления текстовую строку.  
  
##  <a name="internalsetreadystate"></a>COleControl::InternalSetReadyState  
 Задает состояние готовности элемента управления.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Параметры  
 *lNewReadyState*  
 Состояние готовности, чтобы задать для элемента управления, одно из следующих значений:  
  
 **READYSTATE_UNINITIALIZED**  
 Состояние инициализации по умолчанию  
  
 **READYSTATE_LOADING**  
 В настоящее время загрузки его свойства элемента управления  
  
 **READYSTATE_LOADED**  
 Элемент управления был инициализирован.  
  
 **READYSTATE_INTERACTIVE**  
 Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.  
  
 `READYSTATE_COMPLETE`  
 Элемент управления имеет все данные  
  
### <a name="remarks"></a>Примечания  
 Большая часть простых элементов управления не требуется для различения **LOADED** и `INTERACTIVE`. Тем не менее элементы управления, поддерживающие свойства пути данных не может быть готовые для интерактивного до получения хотя бы некоторые данные асинхронно. Элемент управления должен пытаться стать интерактивный как можно быстрее.  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 Заставляет элемент управления перерисовывает себя.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `lpRect`  
 Указатель на область элемента управления необходимо сделать недействительным.  
  
 `bErase`  
 Указывает, является ли фон в пределах области обновления для удаления при обработке в область обновления.  
  
### <a name="remarks"></a>Примечания  
 Если `lpRect` имеет **NULL** значение, весь элемент управления перерисовывается. Если `lpRect` не **NULL**, это указывает на часть элемента управления прямоугольник, который необходимо сделать недействительным. В случаях, когда элемент управления не имеет окна, или в настоящее время не активен, прямоугольник учитывается, и выполняется вызов для сайта клиента [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) функции-члена. Используйте эту функцию вместо `CWnd::InvalidateRect` или `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 Делает недействительной клиентскую область окном контейнера в пределах заданной области.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `pRgn`  
 Указатель на [CRgn](../../mfc/reference/crgn-class.md) объект, который определяет область отображения объекта OLE, который требуется сделать недействительной в клиентских координатах, содержащего окна. Если этот параметр имеет **NULL**, область является весь объект.  
  
 `bErase`  
 Указывает, является ли фон в пределах области недействительным для удаления. Если **TRUE**, удаляются в фоновом режиме. Если **FALSE**, фон не изменяется.  
  
### <a name="remarks"></a>Примечания  
 Это можно использовать для повторной отрисовки неоконные элементы управления в контейнере. Недопустимая область, а также других областей в область обновления помечен для прорисовки при следующем [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) отправляется сообщение.  
  
 Если `bErase` — **TRUE** в любой части области обновления удаляются фон всей области не только в данной части.  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 Разрешает специализированные загрузку элемента управления OLE.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления преобразуется; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 При преобразовании форму, которая использует VBX элементов управления на ту, которая использует элементы управления OLE, может потребоваться специальные загрузки кода для элементов управления OLE. Например, при загрузке экземпляра элемента управления OLE, может потребоваться вызов [PX_Font](persistence-of-ole-controls.md#px_font) в ваш `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl #3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 Тем не менее элементы управления VBX отсутствует в объект шрифта. Каждое свойство шрифта была сохранена по отдельности. В этом случае используется `IsConvertingVBX` для различения этих двух случаях:  
  
 [!code-cpp[NVC_MFCAxCtl #4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Другой случай бы, если элемент управления VBX сохранены собственных двоичных данных (в его **VBM_SAVEPROPERTY** обработчик сообщений), и элемент управления OLE сохраняет его двоичных данных в другом формате. Если требуется, чтобы элемент управления OLE обратную совместимость с элементом управления VBX, можно считать в обоих старые и новые форматы, используя `IsConvertingVBX` функции, обращая внимание на ли при загрузке VBX элемент управления или элемент управления OLE.  
  
 В элементе управления `DoPropExchange` функции, чтобы проверяет это условие и значение true, если выполнить нагрузки код, предназначенный для этого преобразования (например, приведенных выше примерах). Если элемент управления не преобразуется, чтобы выполнить код обычной нагрузкой. Эта возможность применяется только к элементам управления, выполняется преобразование из VBX аналогами.  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 Включает вызов метода автоматизации.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления был инициализирован; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация framework **IDispatch::Invoke** вызовы **IsInvokeAllowed** ли заданная функция (определяется `dispid`), могут быть вызваны. По умолчанию для элемента управления OLE выполняется для автоматизации методов для вызова только в том случае, если элемент управления был инициализирован; Тем не менее **IsInvokeAllowed** является виртуальной функции и может быть переопределен при необходимости (например, при использовании элемента управления в качестве сервера автоматизации). Дополнительные сведения см. в статье базы знаний Q166472, «Практическое руководство: использование элемента управления OLE как сервера автоматизации.» Статьи базы знаний можно найти по адресу [http://support.microsoft.com](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 Определяет, был ли изменен состояние элемента управления.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если состояние элемента управления был изменен с момента последнего сохранения; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Состояние элемента управления изменяется при изменении значения свойства.  
  
##  <a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw  
 Определяет, поддерживает ли контейнер оптимизированное Рисование для текущей операции рисования.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 **Значение TRUE,** Если контейнер поддерживает оптимизированного рисования для текущей операции рисования; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 Если поддерживаются оптимизированное рисование элемента управления требуется не выберите старых объектов (перья, кисти, шрифты, т. д.) в контексте устройства после завершения рисования.  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 Вызывается платформой, чтобы определить, если элемент управления подклассом Windows элементов управления.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элемент управления подклассом; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Необходимо переопределить эту функцию и вернуть **TRUE** Если ваш OLE управления подклассов элемента управления Windows Forms.  
  
##  <a name="load"></a>COleControl::Load  
 Сбрасывает все предыдущие данные загружены асинхронно и инициирует новый загрузку асинхронного свойства элемента управления.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Параметры  
 *strNewPath*  
 Указатель на строку, содержащую путь, который ссылается на абсолютный путь свойства элемента управления для асинхронного.  
  
 *prop*  
 Объект [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) объект, реализующий свойство асинхронной элемента управления.  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 Запрещает деактивация управления контейнера.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Параметры  
 `bLock`  
 **Значение TRUE,** при активном состоянии на месте элемента управления должен быть заблокирован; **FALSE** Если это должен быть разблокирован.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если блокировка выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что каждый блокировки управления должны составлять пару с разблокирование элемента управления после завершения. Только должна заблокировать элемент управления в течение короткого, такие как при обработке события.  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 Вызывается платформой при изменении значения внешнее свойство контейнера.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Параметры  
 *dispID*  
 Идентификатор диспетчера свойства окружения, изменен, или **DISPID_UNKNOWN** при изменении нескольких свойств.  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 Вызывается платформой, когда изменилось значение свойства Appearance акций.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Примечания  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию. Реализация по умолчанию вызывает `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 Вызывается платформой, когда изменилось значение свойства BackColor акций.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию. Реализация по умолчанию вызывает `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 Вызывается платформой, когда изменилось значение свойства BorderStyle акций.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает `InvalidateControl`.  
  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию.  
  
##  <a name="onclick"></a>COleControl::OnClick  
 Вызывается платформой, когда была нажата кнопка мыши или был вызван метод DoClick.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Параметры  
 *iButton*  
 Индекс кнопки мыши. Может принимать одно из следующих значений:  
  
- **LEFT_BUTTON** была нажата левая кнопка мыши.  
  
- **MIDDLE_BUTTON** была нажата средняя кнопка мыши.  
  
- **RIGHT_BUTTON** правая кнопка мыши была нажата.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает `COleControl::FireClick`.  
  
 Переопределите эту функцию-член для изменения или расширения обработку по умолчанию.  
  
##  <a name="onclose"></a>COleControl::OnClose  
 Вызывается платформой, когда контейнер элемента управления называется **IOleControl::Close** функции.  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Параметры  
 `dwSaveOption`  
 Флаг, указывающий, должен быть сохранен объект перед загрузкой. Допустимые значения:  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Примечания  
 По умолчанию `OnClose` сохраняет объект элемента управления, если он был изменен и `dwSaveOption` либо `OLECLOSE_SAVEIFDIRTY` или `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 Вызывается платформой, когда контейнер вызывает **функция IOleObject::DoVerb** функции-члена.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `iVerb`  
 Индекс должен быть вызван команды управления.  
  
 `lpMsg`  
 Указатель на сообщение Windows, вызвавшего команду, которую необходимо вызвать.  
  
 `hWndParent`  
 Дескриптор родительского окна элемента управления. Если выполнение команды создает окна (или windows), `hWndParent` следует использовать в качестве родительского.  
  
 `lpRect`  
 Указатель на структуру RECT координаты элемента управления относительно контейнера, в который будут скопированы.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию использует `ON_OLEVERB` и `ON_STDOLEVERB` сообщений записи карты, чтобы определить правильный вызываемой функции.  
  
 Переопределите эту функцию, чтобы изменить обработку команды по умолчанию.  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 Вызывается платформой для отрисовки элемента управления OLE в ограничивающем прямоугольнике указанного с помощью заданного контекста устройств.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Контекст устройства, в котором происходит рисунком.  
  
 `rcBounds`  
 Прямоугольная область элемента управления, включая границы.  
  
 `rcInvalid`  
 Прямоугольная область элемента управления, который является недопустимым.  
  
### <a name="remarks"></a>Примечания  
 `OnDraw`обычно вызывается для отображения на экране, передача контекста устройства экрана как `pDC`. `rcBounds` Указывает прямоугольник в контексте целевого устройства (относительно его текущего режима сопоставления). `rcInvalid` Параметра является фактический прямоугольник, который является недопустимым. В некоторых случаях это будет область меньше, чем `rcBounds`.  
  
##  <a name="ondrawmetafile"></a>COleControl::OnDrawMetafile  
 Вызывается платформой для отрисовки элемента управления OLE в указанный ограничивающий прямоугольник, используя указанный метафайл контекст устройства.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Контекст устройства, в котором происходит рисунком.  
  
 `rcBounds`  
 Прямоугольная область элемента управления, включая границы.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает [OnDraw](#ondraw) функции.  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 Элемент управления активироваться через UI.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `lpMsg`  
 Указатель на сообщение Windows, которое вызвало команду.  
  
 `hWndParent`  
 Дескриптор родительского окна элемента управления.  
  
 `lpRect`  
 Указатель на прямоугольник, используемые элементом управления в контейнере.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Это имеет тот же эффект, что и вызов элемента управления `OLEIVERB_UIACTIVATE` команды.  
  
 Эта функция обычно используется в качестве функция-обработчик `ON_OLEVERB` сообщений записи карты. Это делает доступными команду «Правка» в меню «Объект» элемента управления. Пример:  
  
 [!code-cpp[NVC_MFCAxCtl #5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 Вызывается платформой, когда изменилось значение свойства Enabled акции.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию. Реализация по умолчанию вызывает [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 Вызывается платформой, когда контейнер вызывает **IOleObject::EnumVerbs** функции-члена.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Параметры  
 `ppenumOleVerb`  
 Указатель на **IEnumOLEVERB** объекта, который перечисляет команды управления.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если доступны команды; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию перечисляет `ON_OLEVERB` записи в схеме сообщений.  
  
 Переопределите эту функцию, чтобы изменить способ перечислением команд по умолчанию.  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 Вызывается платформой, когда обработчик событий подключения или отключения от элемента управления OLE.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Параметры  
 `bAdvise`  
 **Значение TRUE,** указывает, что обработчик событий был связан с элемента управления. **FALSE** указывает, что обработчик событий был отключен от элемента управления.  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 Вызывается платформой, когда биржевых значение свойства Font изменилось.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает `COleControl::InvalidateControl`. Если элемент управления является создание подкласса элемента управления Windows Forms, реализация по умолчанию также отправляет **WM_SETFONT** сообщение в окно элемента управления.  
  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCAxCtl #6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 Вызывается платформой, когда изменилось значение свойства ForeColor биржевых.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает `InvalidateControl`.  
  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию.  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 Вызывается структурой после вызовов контейнера **метод интерфейса IOleControl::FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Параметры  
 `bFreeze`  
 **Значение TRUE,** Если элемент управления обработки событий зафиксирована; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию не выполняет никаких действий.  
  
 Если требуется дополнительное поведение, когда обработка событий заморожен или разморозить переопределите эту функцию.  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 Вызывается платформой, когда контейнер вызывает **IViewObject::GetColorSet** функции-члена.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Параметры  
 `ptd`  
 Указывает целевое устройство, для которого должны отображаться изображение. Если это значение равно **NULL**, изображения, которые должны отображаться для целевого устройства по умолчанию обычно устройство отображения.  
  
 `hicTargetDev`  
 Задает сведения контекста на целевом устройстве обозначается `ptd`. Этот параметр может быть контекста устройства, но не обязательно. If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 Указатель на местоположение, куда необходимо скопировать набор цветов, которые будут использоваться. Если функция не возвращает набор цветов, **NULL** возвращается.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если возвращается набор допустимым цветом; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Контейнер вызывает эту функцию для получения всех цветов, необходимых для отрисовки элемента управления OLE. Контейнер может использовать цвет наборов, полученных в сочетании с цветами, необходимые для установки общую цветовую палитру. Реализация по умолчанию возвращает **FALSE**.  
  
 Переопределите эту функцию для выполнения специальной обработки этого запроса.  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 Вызывается платформой, когда контейнер элемента управления запрашивает сведения об элементе управления.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Параметры  
 `pControlInfo`  
 Указатель на [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) структуру, чтобы быть заполнено.  
  
### <a name="remarks"></a>Примечания  
 Эта информация состоит в описание назначенным клавишам элемента управления. Заполняет реализацию по умолчанию `pControlInfo` с информацией по умолчанию.  
  
 Если элемент управления должен обработать назначенным клавишам переопределите эту функцию.  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 Вызывается платформой для получения строку, представляющую текущее значение свойства, идентифицируемого по `dispid`.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчера свойства элемента управления.  
  
 `strValue`  
 Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объекта, через который будут возвращены строки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если строка была возвращена в *strValue;* иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элемент управления имеет свойства, значение которого невозможно напрямую преобразовать в строку и необходимо, чтобы значение свойства для отображения в браузере указанный контейнер свойства.  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 Вызывается платформой при активации для получения меню, чтобы объединить в существующее меню контейнера пользовательского интерфейса элемента управления.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Дескриптор меню элемента управления или **NULL** Если элемент управления не имеет ни одного. Реализация по умолчанию возвращает **NULL**.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения о слиянии ресурсов OLE см. в статье [меню и ресурсы (OLE)](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 Вызывается платформой в ответ в контейнер **IViewObjectEx::GetNaturalExtent** запроса.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Параметры  
 `dwAspect`  
 Указывает способ представления объекта. Представления включают содержимое, значок, эскиза или печатном документе. Допустимые значения берутся из перечисления [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) или **DVASPECT2**.  
  
 *Индекс*  
 Часть объекта, который представляет интерес. В настоящее время только -1 является допустимым.  
  
 `ptd`  
 Указывает на [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) структуру, определяющую целевое устройство, для которого возвращается размер объекта.  
  
 `hicTargetDev`  
 Указывает информационный контекст для целевого устройства, указанного по `ptd` параметра, из которого объект может извлечь метрики устройства и проверки возможности устройства. Если `ptd` — **NULL**, объект должен игнорировать значение в `hicTargetDev` параметра.  
  
 *pExtentInfo*  
 Указывает на **DVEXTENTINFO** структура, которая задает изменение размера данных. **DVEXTENTINFO** структура:  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 Член структуры `dwExtentMode` может принимать одно из двух значений:  
  
- **DVEXTENT_CONTENT** запрос, как элемент управления должен быть точно по размеру содержимого (оснастка размер)  
  
- **DVEXTENT_INTEGRAL** при изменении размера, передать предлагаемый размер элемента управления  
  
 `psizel`  
 Указывает объем данных, возвращаемых элементом управления. Возвращаемый изменения размера данных имеет значение -1 для любого измерения, которая не была скорректирована.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если она успешно возвращает или изменяется размер; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Переопределить эту функцию, чтобы вернуть размер отображения объекта ближайшим предлагаемый размер и степени режиме в **DVEXTENTINFO** структуры. Реализация по умолчанию возвращает **FALSE** и делает каких-либо корректировок по размеру.  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 Вызывается платформой для получения набора стандартных строк, представляющих возможные значения для свойства.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчера свойства элемента управления.  
  
 `pStringArray`  
 Массив строк, заполняется значением возвращают значения.  
  
 `pCookieArray`  
 Объект `DWORD` заполнено возвращаемые значения массива.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если элементы были добавлены к `pStringArray` и `pCookieArray`.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элемент управления имеет свойство с набором возможных значений, которые могут быть представлены строками. Для каждого элемента, добавляемого `pStringArray`, следует добавить соответствующий элемент «куки-файл для *pCookieArray.* Эти значения «cookie» позже могут быть переданы платформой для `COleControl::OnGetPredefinedValue` функции.  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 Вызывается платформой для получения значения, соответствующий одному из стандартных строк были возвращены переопределение `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчера свойства элемента управления.  
  
 `dwCookie`  
 Значение файла cookie, возвращенный ранее методом переопределения `COleControl::OnGetPredefinedStrings`.  
  
 `lpvarOut`  
 Указатель на **VARIANT** структуры, через который будет возвращаться значение свойства.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если возвращено в `lpvarOut`; в противном случае — 0.  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 Вызывается платформой в ответ в контейнер [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) запроса.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Параметры  
 *dwDrawAspect*  
 `DWORD`описания, какая форма или аспект, объекта будет отображаться. Допустимые значения берутся из перечисления [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) или **DVASPECT2**.  
  
 *Индекс*  
 Часть объекта, который представляет интерес. В настоящее время только -1 является допустимым.  
  
 `ptd`  
 Указывает на [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) структуру, определяющую целевое устройство, для которого возвращается размер объекта.  
  
 *lpsizel*  
 Указывает место, где возвращен размер объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если сведения о степени успешно возвращен; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элемент управления использует два прохода отрисовки, а его непрозрачный и прозрачный части имеют различные размеры.  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 Вызывается платформой в ответ в контейнер **IViewObjectEx::GetRect** запроса.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Параметры  
 `dwAspect`  
 `DWORD`описания, какая форма или аспект, объекта будет отображаться. Допустимые значения берутся из перечисления [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) или **DVASPECT2**:  
  
- `DVASPECT_CONTENT`Ограничивающий прямоугольник всего объекта целиком. Верхний левый угол источника объекта и размер равен экстента, возвращенных **GetViewExtent***.*  
  
- **DVASPECT_OPAQUE** объекты с прямоугольной области непрозрачный возвращают этот прямоугольник. Остальные — ошибочными.  
  
- **DVASPECT_TRANSPARENT** прямоугольник, охватывающие все части прозрачным или неправильную.  
  
 `pRect`  
 Указывает на [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) структура прямоугольник, в котором должен быть нарисован объект. Этот параметр определяет расположение и растяжение объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если прямоугольника размер в объект успешно возвращен; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Размер объекта преобразуется в `OnGetViewRect` в прямоугольник, начиная с указанной позиции (по умолчанию используется в верхний левый угол отображения). Переопределите эту функцию, если элемент управления использует два прохода отрисовки, а его непрозрачный и прозрачный части имеют различные размеры.  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 Вызывается платформой в ответ в контейнер **IViewObjectEx::GetViewStatus** запроса.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Одно из значений **Просмотр СОСТОЯНИЯ** перечисления, если успешно; в противном случае — 0. Любое сочетание следующих доступны следующие значения:  
  
 **VIEWSTATUS_OPAQUE**  
 Объект является непрозрачным. Если этот бит не задано, объект содержит прозрачной части. Этот бит применяется только к аспекты, связанные с содержимым и не `DVASPECT_ICON` или `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 Объект имеет непрозрачный фон (состоящие в сплошным цветом, а не узором). Этот бит имеет смысл только тогда, когда **VIEWSTATUS_OPAQUE** устанавливается и применяется только к аспекты, связанные с содержимым и не `DVASPECT_ICON` или `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 Поддерживает **DVASPECT_OPAQUE**. Все **IViewObjectEx** методов, которые принимают вид рисования, как параметр может быть вызван с этого аспекта.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 Поддерживает **DVASPECT_TRANSPARENT**. Все **IViewObjectEx** методов, которые принимают вид рисования, как параметр может быть вызван с этого аспекта.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элемент управления использует два прохода отрисовки. Реализация по умолчанию возвращает **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 Вызывается платформой при деактивации пользовательского интерфейса элемента управления.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация следует скрыть все панели инструментов, отображаемого элементом `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 Вызывается контейнером для неактивного объекта под указателем мыши при получении `WM_MOUSEMOVE` сообщения.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Параметры  
 `lprcBounds`  
 Объект, ограничивающего прямоугольника в клиентские координаты окна. Указывает объекту его точное положение и размер на экране при `WM_MOUSEMOVE` было получено сообщение.  
  
 *x*  
 Координата x расположения мыши в клиентских координатах окна.  
  
 *y*  
 Координата y расположения мыши в клиентских координатах, содержащего окна.  
  
 `dwKeyState`  
 Указывает текущее состояние из сочетания клавиш на клавиатуре. Допустимые значения может быть несколько флагов **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_LBUTTON**, **MK_MBUTTON**, и **MK_RBUTTON**.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что клиентские координаты окна (в пикселях) используются для передачи позиции указателя мыши. Это стало возможным благодаря также передает прямоугольник, ограничивающий объект в той же системе координат.  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 Вызывается контейнером для неактивного объекта под указателем мыши при получении `WM_SETCURSOR` сообщения.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Параметры  
 `lprcBounds`  
 Объект, ограничивающего прямоугольника в клиентские координаты окна. Указывает объекту его точное положение и размер на экране при `WM_SETCURSOR` было получено сообщение.  
  
 *x*  
 Координата x расположения мыши в клиентских координатах окна.  
  
 *y*  
 Координата y расположения мыши в клиентских координатах, содержащего окна.  
  
 *dwMouseMsg*  
 Идентификатор сообщения мыши, для которого `WM_SETCURSOR` произошла.  
  
 *bSetAlways*  
 Указывает, должен ли объект установите курсор. Если **TRUE**, объект, который необходимо наборе курсора, если **FALSE**, курсор не обязана установите курсор и должен возвращать **S_FALSE** в этом случае.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что клиентские координаты окна (в пикселях) используются для передачи позиции указателя мыши. Это стало возможным благодаря также передает прямоугольник, ограничивающий объект в той же системе координат.  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 Вызывается платформой, после обработки события KeyDown акций.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Параметры  
 `nChar`  
 Значение виртуального кода клавиши нажатой клавише. Список стандартных кодов виртуального ключа см. в разделе Winuser.h  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элементу управления требуется доступ к ключевой информации после инициировать событие.  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 Вызывается структурой после бумагу произошло событие Нажатие клавиши.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Параметры  
 `nChar`  
 Содержит значение виртуального кода клавиши нажатой клавиши. Список стандартных кодов виртуального ключа см. в разделе Winuser.h  
  
### <a name="remarks"></a>Примечания  
 Обратите внимание, что `nChar` значения были изменены в контейнере.  
  
 Переопределите эту функцию, если требуется уведомление после возникновения этого события.  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 Вызывается платформой, после обработки события KeyDown акций.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Параметры  
 `nChar`  
 Значение виртуального кода клавиши нажатой клавише. Список стандартных кодов виртуального ключа см. в разделе Winuser.h  
  
 `nShiftState`  
 Содержит сочетание следующих флагов.  
  
- **SHIFT_MASK** в ходе выполнения действия была нажата клавиша SHIFT.  
  
- **CTRL_MASK** в ходе выполнения действия была нажата клавиша CTRL.  
  
- **ALT_MASK** была нажата клавиша ALT в ходе выполнения действия.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию, если элементу управления требуется доступ к ключевой информации после инициировать событие.  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 Вызывается платформой для получения идентификатора класса страницы свойств, реализующий редактирования указанного свойства.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Параметры  
 `dispid`  
 Идентификатор диспетчера свойства элемента управления.  
  
 `lpclsid`  
 Указатель на **CLSID** структуры через которого будет возвращено ИД класса.  
  
 *pbPageOptional*  
 Возвращает индикатор ли использование страницы указанное свойство является необязательным.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если идентификатор класса был возвращен в `lpclsid`; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Переопределите эту функцию для предоставления способ вызова страницы свойств элемента управления из контейнера свойства браузера.  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 Вызывается платформой, когда контейнер было обнаружено, что была нажата назначенная клавиша элемента управления OLE.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Параметры  
 `pMsg`  
 Указатель на сообщение Windows, созданное нажатием назначенной клавиши.  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 Вызывается платформой, когда вызывается команда свойства элемента управления в контейнере.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `lpMsg`  
 Указатель на сообщение Windows, которое вызвало команду.  
  
 `hWndParent`  
 Дескриптор родительского окна элемента управления.  
  
 `lpRect`  
 Указатель на прямоугольник, используемые элементом управления в контейнере.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию отображает диалоговое окно свойств модальным.  
  
 Эта функция используется для отображения страницы свойств элемента управления. Вызвать `OnProperties` функцию, передавая дескриптор родительского элемента управления в `hWndParent` параметра. В этом случае значения `lpMsg` и `lpRect` параметры игнорируются.  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 Вызывается платформой в ответ в контейнер **IViewObjectEx::QueryHitPoint** запроса.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Параметры  
 `dwAspect`  
 Указывает способ представления объекта. Допустимые значения берутся из перечисления [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) или **DVASPECT2**.  
  
 `pRectBounds`  
 Указатель на `RECT` структура ограничивающего прямоугольника клиентской области элемента управления OLE.  
  
 `ptlLoc`  
 Указатель на **ТОЧКИ** структуры указана точка для проверки нажатия. Точка, задаваемая в координаты области клиента OLE.  
  
 `lCloseHint`  
 Расстояние, которое определяет «закрыть», чтобы точка проверки нажатия.  
  
 `pHitResult`  
 Указатель на результат нажатия запроса. Одно из следующих значений:  
  
- **HITRESULT_OUTSIDE** `ptlLoc` находится за пределами OLE объекта, а не закрыто.  
  
- **HITRESULT_TRANSPARENT** *ptlLoc* находится в границах объекта OLE, но не близко к изображения. Например, может быть точка середине прозрачный круг **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` — внутри или за пределами OLE-объекта, но достаточно близко к объекту, чтобы считаться внутри. Это значение может использоваться в небольших, тонкая или подробные объекты. Даже если точка находится за пределами ограничивающего прямоугольника объекта может по-прежнему будет закрыть (это требуется для прерывания в небольших объектов).  
  
- **HITRESULT_HIT** `ptlLoc` находится в пределах изображения объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если результат нажатия успешно возвращен; в противном случае — 0. Попадания в точку имеет перекрывающиеся область отображения элемента управления OLE.  
  
### <a name="remarks"></a>Примечания  
 Запросы, пересекаются ли прямоугольник отображения объекта заданная точка (попаданий в точку). `QueryHitPoint`можно переопределить для проверки попадания для нестандартной объектов.  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 Вызывается платформой в ответ в контейнер **IViewObjectEx::QueryHitRect** запроса.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Параметры  
 `dwAspect`  
 Указывает способ представления объекта. Допустимые значения берутся из перечисления [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) или **DVASPECT2**.  
  
 `pRectBounds`  
 Указатель на `RECT` структура ограничивающего прямоугольника клиентской области элемента управления OLE.  
  
 *prcLoc*  
 Указатель на `RECT` структура прямоугольника для проверки попадания в точку (перекрываются с прямоугольником объекта) относительно верхнего левого угла объекта.  
  
 `lCloseHint`  
 Не используется.  
  
 `pHitResult`  
 Указатель на результат нажатия запроса. Одно из следующих значений:  
  
- **HITRESULT_OUTSIDE** выполнен щелчок без точки в прямоугольнике OLE-объекта.  
  
- **HITRESULT_HIT** по крайней мере одна точка в прямоугольнике бы попадание в объекте.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если результат нажатия успешно возвращен; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Запросы, пересекаются ли прямоугольник отображения объекта любую точку в данном прямоугольнике (достигает прямоугольник). `QueryHitRect`можно переопределить для проверки попадания для нестандартной объектов.  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 Вызывается платформой для извлечения данных в указанном формате.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Параметры  
 `lpFormatEtc`  
 Указывает на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, задающая формат, в котором запрашиваются сведения.  
  
 `lpStgMedium`  
 Указывает на [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) структура, в которой должны быть возвращены данные.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Указанный формат является одним помещенный в объект управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) или [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) функции-члены для отложенной подготовки к просмотру. Реализация по умолчанию эта функция вызывает `OnRenderFileData` или `OnRenderGlobalData`соответственно, если указанный носитель памяти или в файл. Если запрошенный формат `CF_METAFILEPICT` или свойство постоянное значение формата, реализация по умолчанию отображает соответствующие данные и возвращает ненулевое значение. В противном случае возвращает значение 0 и не выполняет никаких действий.  
  
 Если *lpStgMedium -> tymed* — **TYMED_NULL**, **STGMEDIUM** следует выделять и заполнены в соответствии с *lpFormatEtc -> tymed*. В противном случае **TYMED_NULL**, **STGMEDIUM** должно быть заполнено на месте с данными.  
  
 Переопределите эту функцию для предоставления данных в запрошенном пользователем формате и средних. В зависимости от данных может потребоваться переопределить один из версии этих функций вместо него. Если данные хранятся в малых и фиксированного размера, переопределяют `OnRenderGlobalData`. Если данные в файле или является переменного размера, переопределите `OnRenderFileData`.  
  
 Дополнительные сведения см. в разделе **FORMATETC** и **STGMEDIUM** структур в [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 Вызывается платформой для извлечения данных в указанном формате, если среда хранения — это файл.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Параметры  
 `lpFormatEtc`  
 Указывает на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, задающая формат, в котором запрашиваются сведения.  
  
 `pFile`  
 Указывает на [CFile](../../mfc/reference/cfile-class.md) объект, в котором должен быть подготовлен к просмотру данные.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Указанный формат является одним помещенный в объект управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) функции-члена для отложенной подготовки к просмотру. Реализация по умолчанию эта функция просто возвращает **FALSE**.  
  
 Переопределите эту функцию для предоставления данных в запрошенном пользователем формате и средних. В зависимости от данных может потребоваться переопределить один из версии этих функций вместо него. Если для обработки нескольких носителей, необходимо переопределить `OnRenderData`. Если данные в файле или является переменного размера, переопределите `OnRenderFileData`.  
  
 Дополнительные сведения см. в разделе **FORMATETC** структуры в [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 Вызывается платформой для получения данных в указанном формате, если указанный носитель является глобальной памяти.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Параметры  
 `lpFormatEtc`  
 Указывает на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, задающая формат, в котором запрашиваются сведения.  
  
 `phGlobal`  
 Указывает дескриптор глобальной памяти, в котором данные тоже должны быть возвращены. Если выделена память, этот параметр может иметь **NULL**.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Указанный формат является одним помещенный в объект управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) функции-члена для отложенной подготовки к просмотру. Реализация по умолчанию эта функция просто возвращает **FALSE**.  
  
 Если `phGlobal` — **NULL**, затем новый `HGLOBAL` следует выделять и возвращаются в `phGlobal`. В противном случае `HGLOBAL` заданные `phGlobal` должно быть заполнено с данными. Объем данных помещаются в `HGLOBAL` не должен превышать текущий размер блока памяти. Кроме того блок не может быть перемещен к значению большего размера.  
  
 Переопределите эту функцию для предоставления данных в запрошенном пользователем формате и средних. В зависимости от данных может потребоваться переопределить один из версии этих функций вместо него. Если для обработки нескольких носителей, необходимо переопределить `OnRenderData`. Если данные в файле или является переменного размера, переопределите `OnRenderFileData`.  
  
 Дополнительные сведения см. в разделе **FORMATETC** структуры в [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 Вызывается платформой, если свойства элемента управления должны быть установлены в значения по умолчанию.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает [DoPropExchange](#dopropexchange), передав `CPropExchange` объекта, вызывавшего свойства, чтобы задать значения по умолчанию.  
  
 Модуль записи управления можно вставить код инициализации для элемента управления OLE в этом overridable. Эта функция вызывается, когда [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) или [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) происходит сбой, или [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) или [IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) вызывается без вызова либо **IPersistStream::Load** или **IPersistStorage::Load**.  
  
##  <a name="onsetclientsite"></a>COleControl::OnSetClientSite  
 Вызывается платформой, когда контейнер элемента управления называется **IOleControl::SetClientSite** функции.  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Примечания  
 По умолчанию `OnSetClientSite` проверяет, загружены ли свойства пути данных и если это так, вызывает `DoDataPathPropExchange`.  
  
 Переопределите эту функцию для выполнения специальной обработки данного уведомления. В частности переопределение этой функции должно вызывать базовый класс.  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 Вызывается платформой для замены данных элемента управления с заданными данными.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Параметры  
 `lpFormatEtc`  
 Указатель на [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) структура, задающая формат данных.  
  
 `lpStgMedium`  
 Указатель на [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) структуры, в которой хранятся данные.  
  
 `bRelease`  
 **Значение TRUE,** , если элемент управления должен освободить среду хранения; **FALSE** Если элемент управления не должен освободить среду хранения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Если данные в свойстве постоянные формата, реализация по умолчанию соответствующим образом изменяет состояние элемента управления. В противном случае реализация по умолчанию не выполняет никаких действий. Если `bRelease` — **TRUE**, затем вызов **ReleaseStgMedium** осуществляется; в противном случае значение not.  
  
 Переопределите эту функцию для замены данных элемента управления с заданными данными.  
  
 Дополнительные сведения см. в разделе **FORMATETC** и **STGMEDIUM** структур в [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 Вызывается платформой, когда область элемента управления необходимо изменить, в результате вызова [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Параметры  
 `lpSizeL`  
 Указатель на **размера** структуру, которую использует длинных целых чисел для представления ширину и высоту элемента управления, выраженное в **HIMETRIC** единицы.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если изменения размера был принят; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию обрабатывает изменения размеров элемента управления экстента. Если элемент управления является активным на месте, вызов в контейнер **OnPosRectChanged** становится.  
  
 Переопределите эту функцию для изменения по умолчанию изменение размеров элемента управления.  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 Вызывается платформой для вызова реализации [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Параметры  
 *lpRectPos*  
 Указатель на структуру RECT, определяющий новое положение и размеры относительно контейнера элемента управления.  
  
 `lpRectClip`  
 Указатель на `RECT` структуру указывая прямоугольной области, в которую будет обрезаться элемента управления.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если изменение положения была принята; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию автоматически обеспечивает изменение положения и размера окна элемента управления и возвращает **TRUE**.  
  
 Переопределите эту функцию, чтобы изменить поведение по умолчанию для данной функции.  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 Вызывается платформой, когда элемент управления будет активироваться через UI.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию не выполняет никаких действий.  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 Вызывается платформой при изменении стандартных значение свойства заголовок или текст.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает `InvalidateControl`.  
  
 Если уведомление после изменения этого свойства требуется переопределите эту функцию.  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 Вызывается платформой в ответ в контейнер **IOleInPlaceObjectWindowless::OnWindowMessage** запроса.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Параметры  
 `msg`  
 Идентификатор сообщения как пройденный операционной системой Windows.  
  
 `wParam`  
 Как пройденный операционной системой Windows. Задает дополнительные сведения для конкретного сообщения. Содержимое этого параметра зависит от значения `msg` параметра.  
  
 `lParam`  
 Как пройденный операционной системой Windows. Задает дополнительные сведения для конкретного сообщения. Содержимое этого параметра зависит от значения `msg` параметра.  
  
 *plResult*  
 Код результата Windows. Указывает результат обработки сообщения и зависит от отправляемого сообщения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Обрабатывает сообщения окна для элементов управления без окон. `COleControl`в `OnWindowlessMessage` можно использовать для окна сообщения, отличные от сообщения мыши и клавиатуры. `COleControl`предоставляет [SetCapture](#setcapture) и [SetFocus](#setfocus) специально для того, чтобы получить фокус клавиатуры и захвата мыши для поддерживающих OLE-объекты.  
  
 Поскольку объекты без окон не имеют окна, они должны механизма, позволяющего диспетчеризации сообщений контейнера к ним. Без окон OLE-объекта получает сообщения от своего контейнера, с использованием `OnWindowMessage` метод `IOleInPlaceObjectWindowless` интерфейса (расширение [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) без окон поддержки). `OnWindowMessage`не принимает `HWND` параметра.  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 Преобразует координаты `pPoint` в клиентских координатах.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Параметры  
 `lprcBounds`  
 Указатель на границы элемента управления OLE в контейнере. Область всего элемента управления, включая границы и полосы прокрутки, но не клиентской области.  
  
 `pPoint`  
 Указатель на родительский (контейнер) укажите перевести в координаты клиентской области элемента управления.  
  
 `bHitTest`  
 Указывает ли попадания на точку.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если `bHitTest` — **FALSE**, возвращает **HTNOWHERE**. Если `bHitTest` — **TRUE**, возвращает расположение, в котором родительский (контейнер) точки приобретенных в клиентской области элемента управления OLE, и является одним из следующих мыши проверки нажатия значения:  
  
- **HTBORDER** на границе элемента, у которого нет границы для изменения размера окна.  
  
- **HTBOTTOM** в нижнем горизонтальной границы окна.  
  
- **HTBOTTOMLEFT** в левом нижнем углу границы окна.  
  
- **HTBOTTOMRIGHT** в правом нижнем углу границы окна.  
  
- **HTCAPTION** в области заголовка окна.  
  
- **HTCLIENT** в клиентской области.  
  
- **HTERROR** на фон экрана или Разделительная линия между windows (то же, что **HTNOWHERE** за исключением того, **DefWndProc** функции Windows создает звуковой сигнал в случае ошибки).  
  
- **HTGROWBOX** в поле размер.  
  
- **HTHSCROLL** в горизонтальной полосы прокрутки.  
  
- **HTLEFT** в левой границы окна.  
  
- **HTMAXBUTTON** в максимально увеличить кнопки.  
  
- **HTMENU** в области меню.  
  
- **HTMINBUTTON** кнопки в свести к минимуму.  
  
- **HTNOWHERE** на фон экрана или Разделительная линия между окнами.  
  
- **HTREDUCE** кнопки в свести к минимуму.  
  
- **HTRIGHT** на правой границе окна.  
  
- **HTSIZE** в поле размер (то же, что **HTGROWBOX**).  
  
- **HTSYSMENU** в оконном меню или кнопка закрытия в дочернем окне.  
  
- **HTTOP** в верхнем горизонтальной границы окна.  
  
- **HTTOPLEFT** в левом верхнем углу границы окна.  
  
- **HTTOPRIGHT** в правом верхнем углу границы окна.  
  
- **HTTRANSPARENT** в окне в данный момент закрывается другим окном.  
  
- **HTVSCROLL** в вертикальной полосы прокрутки.  
  
- **HTZOOM** в максимально увеличить кнопки.  
  
### <a name="remarks"></a>Примечания  
 На входе `pPoint` относительно начала координат (верхний левый угол контейнера) родительского элемента. На выходе `pPoint` относительно начала координат клиентской области элемента управления OLE (верхний левый угол клиентской области элемента управления).  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 Уведомляет контейнера закрыт модального диалогового окна.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `hWndParent`  
 Дескриптор родительского окна модального диалогового окна.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается после отображения любой модальным диалоговым окном. Эту функцию необходимо вызывать, чтобы контейнер можно включить любой окон верхнего уровня отключена `PreModalDialog`. Эта функция должны составлять пару с помощью вызова `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 Уведомляет контейнер, в котором модального диалогового окна будет отображаться.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `hWndParent`  
 Дескриптор родительского окна модального диалогового окна.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается перед отображением любой модальным диалоговым окном. Эту функцию необходимо вызвать, чтобы контейнер можно отключить все его окон верхнего уровня. После отображения модального диалогового окна необходимо вызвать `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 Удаляет и повторно создает окна элемента управления.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Примечания  
 Это может потребоваться, если необходимо изменить разряды стилей окон.  
  
##  <a name="refresh"></a>COleControl::Refresh  
 Вызывает перерисовку элемента управления OLE.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Примечания  
 Эта функция поддерживается `COleControl` базовый класс как биржевые метод с именем обновления. Это позволяет пользователям элемента управления OLE для отрисовки элемента управления в определенное время. Дополнительные сведения об этом см. в статье [элементы управления ActiveX: методы](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 Освобождает захват мыши.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Если элемент управления в настоящее время имеет захват мыши, освобождается сбора данных. В противном случае эта функция не делает ничего.  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 Освобождает контекст устройства отображения контейнера элемента управления без окна, делая возможным контекст устройства для использования другими приложениями.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Определяет контекст устройства контейнером освобождается.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Приложение должно вызвать `ReleaseDC` для каждого вызова [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 Задает родительский объект элемента управления.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Параметры  
 *hWndOuter*  
 Дескриптор окна элемента управления.  
  
 `hWndParent`  
 Дескриптор родительского окна новый.  
  
### <a name="remarks"></a>Примечания  
 Эта функция вызывается для сброса родительского окна элемента управления.  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 Инициализирует состояние `COleControl` стандартные свойства значениями по умолчанию.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Примечания  
 Свойства являются: внешний вид, цвет фона, BorderStyle, заголовок, включено, шрифт, цвет переднего плана, hWnd и текста. Описание стандартных свойств см. в разделе [элементы управления ActiveX: Добавление свойств Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Можно повысить производительность двоичных инициализации элемента управления с помощью `ResetStockProps` и `ResetVersion` для переопределения `COleControl::OnResetState`. См. следующий пример. Дополнительные сведения по оптимизации инициализации см. в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCAxCtl #7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 Инициализирует номер версии для указанного значения.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Параметры  
 `dwVersionDefault`  
 Номер версии для назначения элемента управления.  
  
### <a name="remarks"></a>Примечания  
 Можно повысить производительность двоичных инициализации элемента управления с помощью `ResetVersion` и `ResetStockProps` для переопределения `COleControl::OnResetState`. Можно найти в [ResetStockProps](#resetstockprops). Дополнительные сведения по оптимизации инициализации см. в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 Позволяет без окон OLE-объекта для прокрутки области в пределах своего активного изображения на месте на экране.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `xAmount`  
 Указывает, в единицах устройства, горизонтальной прокрутки. Этот параметр должен быть отрицательным для прокрутки влево.  
  
 `yAmount`  
 Уровень единицы устройства, вертикальной прокрутки. Этот параметр должен быть отрицательным для прокрутки вверх.  
  
 `lpRect`  
 Указывает на [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или RECT-структура, которая задает часть клиентской области объекта OLE для прокрутки, в клиентских координатах, содержащего окна. Если `lpRect` — **NULL**, прокручивать весь объект OLE клиентской области.  
  
 `lpClipRect`  
 Указывает на `CRect` объекта или `RECT` структуру, которая задает прямоугольник отсечения для. Оказались лишь пикселей внутри прямоугольника. BITS за пределами прямоугольника не затрагиваются, даже если они находятся в `lpRect` прямоугольник. Если `lpClipRect` — **NULL**, отсечение не выполняется в прямоугольник прокрутки.  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 Выбирает шрифт в контексте устройства.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Указатель на объект контекста устройства.  
  
 `fontHolder`  
 Ссылка на [CFontHolder](../../mfc/reference/cfontholder-class.md) объект, представляющий шрифт для выбора.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на ранее выбранный шрифт. После завершения всех операций рисования, использующие код, вызывающий *fontHolder,* ранее выбранный шрифт должен повторно выбрать путем передачи его в качестве параметра [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 Выбирает свойство Font в контексте устройства.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Параметры  
 `pDC`  
 Контекст устройства, в который будут выбираться шрифта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на ранее выбранным `CFont` объекта. Следует использовать [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) выбрать этот шрифт обратно в контексте устройства при завершении.  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 Выполняет сериализацию или инициализирует состояние места на экране, назначенное элементу управления.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Параметры  
 `ar`  
 Объект `CArchive` объект для сериализации в.  
  
### <a name="remarks"></a>Примечания  
 Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeExtent`, `SerializeStockProps`, и `SerializeVersion` для переопределения **COleControl::Serialize**. См. следующий пример. Дополнительные сведения по оптимизации инициализации см. в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFCAxCtl #8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 Сериализует или инициализирует состояние `COleControl` стандартные свойства: внешний вид, цвет фона, BorderStyle, заголовков, включено, шрифта, цвет переднего плана и текста.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Параметры  
 `ar`  
 Объект `CArchive` объект для сериализации в.  
  
### <a name="remarks"></a>Примечания  
 Описание стандартных свойств см. в разделе [элементы управления ActiveX: Добавление свойств Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeStockProps`, `SerializeExtent`, и `SerializeVersion` для переопределения **COleControl::Serialize**. Пример см. в разделе кода на [SerializeExtent](#serializeextent). Дополнительные сведения по оптимизации инициализации см. в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 Выполняет сериализацию или инициализирует состояние сведения о версии элемента управления.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `ar`  
 Объект `CArchive` объект для сериализации в.  
  
 `dwVersionDefault`  
 Текущий номер версии элемента управления.  
  
 `bConvert`  
 Указывает, является ли постоянные данные должны быть преобразованы в формат последней версии при его сохранении, или сохраняется в том же формате, он находился перед его загрузки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Номер версии элемента управления. Если загружается архива, `SerializeVersion` возвращает номер версии, загруженные из этого архива. В противном случае возвращается текущая загруженная версия.  
  
### <a name="remarks"></a>Примечания  
 Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeVersion`, `SerializeExtent`, и `SerializeStockProps` для переопределения **COleControl::Serialize**. Пример см. в разделе кода на [SerializeExtent](#serializeextent). Дополнительные сведения по оптимизации инициализации см. в разделе [элементы управления ActiveX: оптимизация](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 Задает значение свойства, биржевые внешний вид элемента управления.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Параметры  
 *sAppearance*  
 Объект **короткие** ( `VT_I2`) значение, которое используется для внешнего вида элемента управления. Нулевое значение задает внешний вид элемента управления значение Обычное и значение 1 задает внешний вид элемента управления в 3D.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения о стандартных свойств см. в разделе [элементы управления ActiveX: свойства](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 Задает значение свойства BackColor биржевых элемента управления.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Параметры  
 *dwBackColor*  
 **OLE_COLOR** значение, которое используется для рисования элемента управления фона.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения об использовании этого свойства и других связанных свойств, см. в статье [элементы управления ActiveX: свойства](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 Задает значение свойства BorderStyle биржевых элемента управления.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Параметры  
 *sBorderStyle*  
 Новый стиль границы для элемента управления. 0 указывает без границы, а 1 — обычный границы.  
  
### <a name="remarks"></a>Примечания  
 Окно управления будет создана повторно и `OnBorderStyleChanged` вызывается.  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 В результате окна контейнера элемента управления необходимо выполнить владения захвата мыши на имени элемента управления.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на **CWnd** объект window, появлялось ввод данных мышью.  
  
### <a name="remarks"></a>Примечания  
 Если элемент управления активирован и без окон, эта функция приводит окна контейнера элемента управления необходимо выполнить владения захвата мыши на имени элемента управления. В противном случае эта функция приводит самим вступили владения захвата мыши элементом управления (то же, что `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 Задает размер окна элемента управления OLE и уведомляет контейнера, в котором изменение сайта элемента управления.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Параметры  
 `cx`  
 Задает новую ширину элемента управления в пикселях.  
  
 `cy`  
 Задает новую высоту элемента управления в пикселях.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция не должна использоваться в конструкторе элемента управления.  
  
 Обратите внимание, что все координаты для элемента управления windows относительно верхнего левого угла элемента управления.  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 Задает значение свойства Enabled элемента управления акции.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Параметры  
 `bEnabled`  
 **Значение TRUE,** Если элемент управления должен быть включен; в противном случае **FALSE**.  
  
### <a name="remarks"></a>Примечания  
 После установки этого свойства **OnEnabledChange** вызывается.  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 В результате элемент управления контейнера окно владение фокус ввода от имени элемента управления.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на **CWnd** объект window, ранее имевший фокус ввода, или **NULL** Если окно не.  
  
### <a name="remarks"></a>Примечания  
 Если элемент управления активирован и без окон, эта функция вызывает элемент управления контейнера окно владение фокус ввода, от имени элемента управления. Фокус ввода направляет ввод с клавиатуры в окне контейнера, а контейнер передает все последующие клавиатуры сообщения OLE-объекта, который вызывает `SetFocus`. Его утрачивает любого окна, ранее имевший фокус ввода.  
  
 Если элемент управления не без окон, эта функция приводит самого вступили владение фокус ввода элемента управления (то же, что `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>COleControl::SetFont  
 Задает свойство Font элемента управления.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Параметры  
 *pFontDisp*  
 Указатель на интерфейс диспетчеризации шрифта.  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 Задает значение свойства ForeColor биржевых элемента управления.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Параметры  
 *dwForeColor*  
 **OLE_COLOR** значение, которое используется для рисования элемента управления переднего плана.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения об использовании этого свойства и других связанных свойств, см. в статье [элементы управления ActiveX: свойства](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 Вызывается платформой для инициализации списка форматов данных, поддерживаемый данным элементом управления.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию указывает два формата: `CF_METAFILEPICT` и постоянного набора свойств.  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 Задает размер элемента управления OLE, при первом отображении в контейнере.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Параметры  
 `cx`  
 Начальная ширина элемента управления OLE в пикселях.  
  
 `cy`  
 Исходную высоту элемента управления OLE в пикселях.  
  
### <a name="remarks"></a>Примечания  
 Вызовите эту функцию в конструкторе таким образом, чтобы задать исходный размер элемента управления. Начальный размер измеряется в единицы устройства или пикселей. Рекомендуется выполнить, этот вызов в конструктор элемента управления.  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 Изменяет измененном состоянии элемента управления.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 `bModified`  
 Новое значение для элемента управления изменить флаг. **Значение TRUE,** указывает, что состояние элемента управления был изменен; **FALSE** показывает, что состояние элемента управления просто сохранен.  
  
### <a name="remarks"></a>Примечания  
 Вызов этой функции при возникновении изменений, может повлиять на постоянное состояние элемента управления. Например, при изменении значения свойства постоянные, вызовите эту функцию с `bModified` **TRUE**.  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 Указывает, что произошел сбой запроса редактирования.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Примечания  
 Вызывайте эту функцию при `BoundPropertyRequestEdit` завершается ошибкой. Эта функция вызывает исключение типа **COleDispScodeException** для указания, что операция установки не была разрешена.  
  
##  <a name="setnotsupported"></a>COleControl::SetNotSupported  
 Предотвращает изменение значения свойства элемента управления для пользователя.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Примечания  
 Вызывайте эту функцию вместо функция Set любого свойства, где изменение значения свойства элемента управления пользователем, не поддерживается. Примером может служить свойство, которое доступно только для чтения.  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 Задает координаты прямоугольника элемента управления относительно контейнера, выраженный в единицах устройства.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 `lpRect`  
 Указатель на прямоугольник, содержащий новые координаты элемента управления относительно контейнера.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если вызов был успешным; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Элемент управления является открытым, изменяется; в противном случае контейнера **OnPosRectChanged** функция.  
  
##  <a name="settext"></a>COleControl::SetText  
 Задает значение стандартного заголовок или текст свойства элемента управления.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Параметры  
 `pszText`  
 Указатель на строку символов.  
  
### <a name="remarks"></a>Примечания  
 Убедитесь, стандартных свойств заголовка и текста как сопоставлены то же значение. Это означает, что любые изменения, внесенные в одно из свойств автоматически изменит оба свойства. Как правило элемент управления должен поддерживать stock заголовок или текст свойства, но не оба.  
  
##  <a name="throwerror"></a>COleControl::ThrowError  
 Указывает на возникновение ошибки в элементе управления.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Параметры  
 `sc`  
 Значение кода состояния в отчетах. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `nDescriptionID`  
 Идентификатор строкового ресурса исключения должна быть зафиксирована.  
  
 `nHelpID`  
 Идентификатор справки раздела для создания отчета.  
  
 `pszDescription`  
 Строка, содержащая описание исключения, о которой сообщается.  
  
### <a name="remarks"></a>Примечания  
 Эта функция должен вызываться только из внутри функции Get или Set для свойства OLE или реализации метода автоматизации OLE. Если вам нужно указывают ошибки, возникающие в другое время, должен срабатывать стандартное событие ошибки.  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 Преобразует значения между координат **HIMETRIC** и единицами измерения собственного контейнера.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Параметры  
 *lpptlHimetric*  
 Указатель на **POINTL** структура, содержащая координаты в **HIMETRIC** единицы.  
  
 *lpptfContainer*  
 Указатель на **POINTF** структура, содержащая координаты в размер единицы контейнера.  
  
 `flags`  
 Сочетание следующих значений:  
  
- **XFORMCOORDS_POSITION** позицию в контейнере.  
  
- **XFORMCOORDS_SIZE** размер в контейнере.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** преобразования **HIMETRIC** устройства в единицы контейнера.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** преобразование единиц контейнера **HIMETRIC** единицы.  
  
### <a name="remarks"></a>Примечания  
 Первые два флаги **XFORMCOORDS_POSITION** и **XFORMCOORDS_SIZE**, указывают ли координаты должны рассматриваться как позиция или размер. Оставшиеся два флага указывают направление преобразования.  
  
##  <a name="translatecolor"></a>COleControl::TranslateColor  
 Преобразует значение цвета из **OLE_COLOR** тип данных, который [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) тип данных.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 `clrColor`  
 Объект **OLE_COLOR** тип данных. Дополнительные сведения см. в разделе Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) функции.  
  
 `hpal`  
 Дескриптор палитры необязательно; может быть **NULL**.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Значение 32-разрядный цвет RGB (красный, зеленый, синий), которое определяет сплошной цвет ближайший к `clrColor` значение, которое может представлять устройства.  
  
### <a name="remarks"></a>Примечания  
 Эта функция полезна для преобразования стандартных свойств основной цвет и цвет фона для **COLORREF** типы, используемые [CDC](../../mfc/reference/cdc-class.md) функции-члены.  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 Определяет, должен ли элемент управления использовать значения свойствам окружения как значения по умолчанию, если впоследствии загружается из постоянного состояния.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение указывает, что свойства окружения будет допустимым; в противном случае значение свойства окружения не допустимы.  
  
### <a name="remarks"></a>Примечания  
 В некоторые контейнеры, элемент управления может не имеет доступа к свойствам окружения при первом вызове переопределение метода `COleControl::DoPropExchange`. Это происходит, если контейнер вызывает [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) или [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) до вызова метода [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (то есть, в том случае, если она не учитывает **OLEMISC_SETCLIENTSITEFIRST** бит состояния).  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 Содержит процедуры Windows `COleControl` объекта.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Параметры  
 `message`  
 Указывает сообщение Windows для обработки.  
  
 `wParam`  
 Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.  
  
 `lParam`  
 Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Возвращаемое значение отправленных сообщений.  
  
### <a name="remarks"></a>Примечания  
 Эта функция используется для перенаправления конкретного сообщения через схему сообщений элемента управления.  
  
## <a name="see-also"></a>См. также  
 [Образец CIRC3 MFC](../../visual-cpp-samples.md)   
 [Пример MFC TESTHELP](../../visual-cpp-samples.md)   
 [Класс COlePropertyPage](../../mfc/reference/colepropertypage-class.md)   
 [CWnd-класс](../../mfc/reference/cwnd-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CFontHolder](../../mfc/reference/cfontholder-class.md)   
 [Класс CPictureHolder](../../mfc/reference/cpictureholder-class.md)

