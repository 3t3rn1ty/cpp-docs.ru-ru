---
title: "CDaoRecordView-класс | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CDaoRecordView
dev_langs:
- C++
helpviewer_keywords:
- CDaoRecordView class
- data-bound controls [C++], DAO controls
- data binding [C++], DAO views
- bound controls [C++], displaying database data
- application wizards [C++], creating record views
- controls [MFC], data binding
ms.assetid: 5aa7d0e2-bd05-413e-b216-80c404ce18ac
caps.latest.revision: 23
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 11aa318e84e89835ceb710725590f3c3e6387fcd
ms.lasthandoff: 02/24/2017

---
# <a name="cdaorecordview-class"></a>CDaoRecordView-класс
Представление, которое отображает записи базы данных в элементах управления.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class AFX_NOVTABLE CDaoRecordView : public CFormView  
```  
  
## <a name="members"></a>Члены  
  
### <a name="protected-constructors"></a>Защищенные конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoRecordView::CDaoRecordView](#cdaorecordview)|Создает объект `CDaoRecordView`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoRecordView::IsOnFirstRecord](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записи в связанных записей.|  
|[CDaoRecordView::IsOnLastRecord](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записи в связанных записей.|  
|[CDaoRecordView::OnGetRecordset](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CDaoRecordset`. ClassWizard переопределяет эту функцию для вас и при необходимости создает набор записей.|  
|[CDaoRecordView::OnMove](#onmove)|Если текущая запись была изменена, обновляет его в источнике данных, а затем переходит к указанной записи (следующего, предыдущего, первого или последнего).|  
  
## <a name="remarks"></a>Примечания  
 Это представление является представление формы, непосредственно подключенные к `CDaoRecordset` объекта. Представление создается на основе ресурс шаблона диалоговых окон и отображает поля `CDaoRecordset` в элементах управления шаблона диалогового окна. `CDaoRecordView` Объект использует обмен данными (диалоговых окон DDX) и обмен полями записей DAO (DFX) для автоматизации перемещения данных между элементами управления в форме и полями набора записей. `CDaoRecordView`также предоставляет реализацию по умолчанию для перехода к первой, следующего, предыдущего или последней записи и интерфейс для обновления записи в данный момент в представлении.  
  
> [!NOTE]
>  Классы баз данных DAO отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». Вы можете по-прежнему обращаться к источникам данных ODBC с помощью классов DAO. классы DAO обычно предлагают превосходит возможности, поскольку они используют ядро базы данных Microsoft Jet.  
  
 Является наиболее распространенным способом для создание представления записей с помощью мастера приложений. Мастер приложения создает класс представления записей и его класс связанных записей как часть приложения скелет начального уровня.  
  
 Если требуется просто одной форме, мастер приложений подход проще. ClassWizard позволяет решить, использование представления записей позже в процессе разработки. Если не создать класс представления записей с помощью мастера приложений, можно создать ее позже с помощью классов. Использование классов для создания представления записей и записей отдельно и затем подключить их, самый гибкий подход, поскольку предоставляет больший контроль при именовании класс записей и его. H. CPP-файлов. Такой подход также позволяет иметь несколько представлений записей в одном классе набора записей.  
  
 Чтобы упростить для конечных пользователей для перемещения по записям в представлении записей, мастер приложения создает меню (и при необходимости инструментов) ресурсы для перемещения к первому следующего, предыдущего или последней записи. Если создать класс представления записей с помощью классов, необходимо создать эти ресурсы самостоятельно с меню и растрового изображения редакторов.  
  
 Сведения о реализации по умолчанию для перемещения по записям в разделе `IsOnFirstRecord` и `IsOnLastRecord` и статьи [использование представления записей](../../data/using-a-record-view-mfc-data-access.md), который действует как `CRecordView` и `CDaoRecordView`.  
  
 `CDaoRecordView`сохраняет сведения о положение пользователя в наборе записей, чтобы представление записей можно обновить пользовательский интерфейс. Когда пользователь переходит на любой конец набора записей, представление записей отключает объекты пользовательского интерфейса — например пунктов меню или кнопок панели инструментов — для перемещения в одном направлении.  
  
 Дополнительные сведения об объявлении и использование представления записей и классов набора записей в разделе «Проектирование и создание представления записей» в статье [представления записей](../../data/record-views-mfc-data-access.md). Дополнительные сведения о как запись представления работы и их использовании см. в статье [использование представления записей](../../data/using-a-record-view-mfc-data-access.md). Все упомянутые выше статьи применимы в обоих `CRecordView` и `CDaoRecordView`.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CView](../../mfc/reference/cview-class.md)  
  
 [CScrollView](../../mfc/reference/cscrollview-class.md)  
  
 [CFormView](../../mfc/reference/cformview-class.md)  
  
 `CDaoRecordView`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="a-namecdaorecordviewa--cdaorecordviewcdaorecordview"></a><a name="cdaorecordview"></a>CDaoRecordView::CDaoRecordView  
 При создании объекта типа производным от `CDaoRecordView`, вызовите конструктор для инициализации объекта представления и определения ресурса диалогового окна, лежащие в основе представления либо форме.  
  
```  
explicit CDaoRecordView(LPCTSTR lpszTemplateName);  
explicit CDaoRecordView(UINT nIDTemplate);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszTemplateName`  
 Содержит нулем строку, являющуюся именем ресурс шаблона диалоговых окон.  
  
 `nIDTemplate`  
 Содержит идентификатор ресурс шаблона диалоговых окон.  
  
### <a name="remarks"></a>Примечания  
 Можно либо указать ресурс по имени (передавать строку в качестве аргумента конструктору) или по его Идентификатору (pass целое число без знака в качестве аргумента). Ресурс идентификатор рекомендуется использовать.  
  
> [!NOTE]
>  Производный класс должен предоставить собственный конструктор. В конструкторе производного класса, вызовите конструктор `CDaoRecordView::CDaoRecordView` имя ресурса или идентификатор в качестве аргумента.  
  
 **CDaoRecordView::OnInitialUpdate** вызовов `CWnd::UpdateData`, который вызывает метод `CWnd::DoDataExchange`. Этот первоначальный вызов `DoDataExchange` подключается `CDaoRecordView` управляет (неявно) к `CDaoRecordset` поля элементов данных, созданных классов. Эти данные-члены не должны использоваться до, после вызова метода базового класса **CFormView::OnInitialUpdate** функции-члена.  
  
> [!NOTE]
>  При использовании классов, мастер определяет `enum` значение `CDaoRecordView::IDD` в объявлении класса и использует его во время инициализации элемента списка для конструктора.  
  
 [!code-cpp[NVC_MFCDatabase&#35;](../../mfc/codesnippet/cpp/cdaorecordview-class_1.cpp)]  
  
##  <a name="a-nameisonfirstrecorda--cdaorecordviewisonfirstrecord"></a><a name="isonfirstrecord"></a>CDaoRecordView::IsOnFirstRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnFirstRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является первой записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, созданных классов.  
  
 Если пользователь переходит к первой записи, отключает framework, пользовательский интерфейс объекты (например, элементы меню или кнопки панели инструментов) необходимо для перемещения к первому или предыдущей записи.  
  
##  <a name="a-nameisonlastrecorda--cdaorecordviewisonlastrecord"></a><a name="isonlastrecord"></a>CDaoRecordView::IsOnLastRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnLastRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является последней записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, создаваемых классов для поддержки пользовательский интерфейс для перемещения по записям.  
  
> [!CAUTION]
>  Результат этой функции надежен, за исключением того, что представление не удается обнаружить конца набора данных, пока пользователь уже прошел его. Пользователь может потребоваться переместить за пределы последней записи, прежде чем представления записей можно указать, что его нужно отключить любые объекты пользовательского интерфейса для перемещения к следующей или последней записи. Если пользователь перемещает за последней записью и затем обратно до последней записи (или перед ним), представление записей можно отслеживать положение пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса.  
  
##  <a name="a-nameongetrecordseta--cdaorecordviewongetrecordset"></a><a name="ongetrecordset"></a>CDaoRecordView::OnGetRecordset  
 Возвращает указатель на `CDaoRecordset`-производный объект, связанный с представлением записи.  
  
```  
virtual CDaoRecordset* OnGetRecordset() = 0;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на `CDaoRecordset`-производного объекта, если объект был успешно создан; в противном случае **NULL** указателя.  
  
### <a name="remarks"></a>Примечания  
 Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращает указатель на него. Если объявляется класс представления записей с помощью классов, мастер создает переопределение по умолчанию. Реализация по умолчанию для классов возвращает указатель набора записей, хранится в представлении записей, если таковой существует. Если нет, он создает объект набора записей типа, указанный с ClassWizard и вызывает его **откройте** член для открытия таблицы или выполнить запрос и затем возвращает указатель на объект.  
  
 Дополнительные сведения и примеры см. в статье [представления записей: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
##  <a name="a-nameonmovea--cdaorecordviewonmove"></a><a name="onmove"></a>CDaoRecordView::OnMove  
 Вызовите эту функцию-член для перемещения к другой записи в наборе записей и отобразить ее поля в элементах управления представления записей.  
  
```  
virtual BOOL OnMove(UINT nIDMoveCommand);
```  
  
### <a name="parameters"></a>Параметры  
 `nIDMoveCommand`  
 Одно из следующих значений ИД стандартных команд:  
  
- `ID_RECORD_FIRST`Перемещение к первой записи в наборе записей.  
  
- `ID_RECORD_LAST`Перейти к последней записи в наборе записей.  
  
- `ID_RECORD_NEXT`Перемещение на следующую запись в наборе записей.  
  
- `ID_RECORD_PREV`Переместите предыдущие записи в наборе записей.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает соответствующую функцию перемещения элемента из `CDaoRecordset` объект, связанный с представлением записи.  
  
 По умолчанию `OnMove` обновление текущей записи в источнике данных, если пользователь изменил ее в представлении записей.  
  
 Мастер приложения создает ресурс меню с первой записи, последней записи, следующей записи и предыдущей записи пунктов меню. При выборе параметра Первичная панель инструментов приложения мастер также создает панель инструментов с кнопками, соответствующие этим командам.  
  
 При перемещении за последней записью в наборе записей, представление записей продолжают отображаться последней записи. При перемещении назад после первой записи в представлении записей продолжают отображаться первой записи.  
  
> [!CAUTION]
>  Вызов `OnMove` вызывает исключение, если набор записей не имеет записей. Вызов функции-обработчика обновить соответствующий пользовательский интерфейс — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, или **OnUpdateRecordPrev** , соответствующая операции перемещения для определить, является ли набор записей ни одной записи.  
  
## <a name="see-also"></a>См. также  
 [Класс CFormView](../../mfc/reference/cformview-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)   
 [Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)   
 [Класс CFormView](../../mfc/reference/cformview-class.md)

