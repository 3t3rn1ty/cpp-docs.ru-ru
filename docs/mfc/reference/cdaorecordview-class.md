---
title: CDaoRecordView-класс | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CDaoRecordView
- AFXDAO/CDaoRecordView
- AFXDAO/CDaoRecordView::CDaoRecordView
- AFXDAO/CDaoRecordView::IsOnFirstRecord
- AFXDAO/CDaoRecordView::IsOnLastRecord
- AFXDAO/CDaoRecordView::OnGetRecordset
- AFXDAO/CDaoRecordView::OnMove
dev_langs:
- C++
helpviewer_keywords:
- CDaoRecordView [MFC], CDaoRecordView
- CDaoRecordView [MFC], IsOnFirstRecord
- CDaoRecordView [MFC], IsOnLastRecord
- CDaoRecordView [MFC], OnGetRecordset
- CDaoRecordView [MFC], OnMove
ms.assetid: 5aa7d0e2-bd05-413e-b216-80c404ce18ac
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: a228a545061c4807688014b62907c4c41a82151e
ms.sourcegitcommit: c6b095c5f3de7533fd535d679bfee0503e5a1d91
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2018
ms.locfileid: "36952308"
---
# <a name="cdaorecordview-class"></a>CDaoRecordView-класс
Представление, которое отображает записи базы данных в элементах управления.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class AFX_NOVTABLE CDaoRecordView : public CFormView  
```  
  
## <a name="members"></a>Участники  
  
### <a name="protected-constructors"></a>Защищенные конструкторы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CDaoRecordView::CDaoRecordView](#cdaorecordview)|Создает объект `CDaoRecordView`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание:|  
|----------|-----------------|  
|[CDaoRecordView::IsOnFirstRecord](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записью в связанных записей.|  
|[CDaoRecordView::IsOnLastRecord](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записи в связанных записей.|  
|[CDaoRecordView::OnGetRecordset](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CDaoRecordset`. Мастер классов переопределяет эту функцию для вас и при необходимости создает набор записей.|  
|[CDaoRecordView::OnMove](#onmove)|При изменении текущей записи, обновляет их в источнике данных, а затем переходит к определенной записи (следующего, предыдущего, первого или последнего).|  
  
## <a name="remarks"></a>Примечания  
 Представление — это представление формы, непосредственно подключенные к `CDaoRecordset` объекта. Представление создается на основе ресурс шаблона диалоговых окон и отображает поля `CDaoRecordset` в элементах управления шаблона диалогового окна. `CDaoRecordView` Объект использует обмен данными (диалоговых окон DDX) и обмен полями записей DAO (DFX) для автоматизации перемещения данных между полями набора записей и элементов управления в форме. `CDaoRecordView` также предоставляет реализацию по умолчанию для перемещения к первому следующего, предыдущего или последней записи и интерфейс для обновления записи в данный момент в представлении.  
  
> [!NOTE]
>  Классы баз данных DAO отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». Вы можете по-прежнему доступ к источникам данных ODBC с помощью классов DAO. классы DAO обычно обеспечивают превосходную возможности, так как они используют ядро базы данных Microsoft Jet.  
  
 Наиболее распространенным способом создания представления записи — с помощью мастера приложений. В мастере приложений создает класс представления записей и его связанного набора записей класса как часть каркас начального приложения.  
  
 Подход с использованием мастера приложений проще, если необходимо просто одной форме. Мастер классов позволяет решено использовать представление записей позже в процессе разработки. Если не создать класс представления записей с помощью мастера приложений, можно создать ее позже с ClassWizard. Использование классов для создания представления записей и набор записей отдельно и затем подключите их является самый гибкий подход, потому что он дает больший контроль при именовании класса набора записей и его. H ИЛИ. CPP-файлов. Такой подход также позволяет иметь несколько представлений записей для одного класса набор записей.  
  
 Чтобы облегчить процесс для конечных пользователей для перемещения по записям в представлении записей, мастер приложений создает меню (и при необходимости инструментов) ресурсы по переносу на первый следующего, предыдущего или последней записи. Если создать класс представления записей с помощью классов, необходимо создать эти ресурсы самостоятельно с меню и точечный рисунок редакторов.  
  
 Сведения о реализации по умолчанию для перемещения по записям см. в разделе `IsOnFirstRecord` и `IsOnLastRecord` и статьи [использование представления записей](../../data/using-a-record-view-mfc-data-access.md), которая применяется к обоим `CRecordView` и `CDaoRecordView`.  
  
 `CDaoRecordView` сохраняет сведения о положение пользователя в наборе записей, чтобы представление записей можно обновить пользовательский интерфейс. Когда пользователь переходит на любом конце набора записей, представление записей отключает объекты пользовательского интерфейса — например, пункты меню или кнопки панели инструментов — для перемещения дальнейших в одном направлении.  
  
 Дополнительные сведения об объявлении и с помощью представления записей и классы набора записей. в разделе «Проектирование и создание представления записей» в статье [представления записей](../../data/record-views-mfc-data-access.md). Дополнительные сведения о как записи представления работы и способ их использования см. в статье [использование представления записей](../../data/using-a-record-view-mfc-data-access.md). Все статьи, упомянутых выше применяются к обеим версиям `CRecordView` и `CDaoRecordView`.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CView](../../mfc/reference/cview-class.md)  
  
 [CScrollView](../../mfc/reference/cscrollview-class.md)  
  
 [CFormView](../../mfc/reference/cformview-class.md)  
  
 `CDaoRecordView`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="cdaorecordview"></a>  CDaoRecordView::CDaoRecordView  
 При создании объекта типа производным от `CDaoRecordView`, вызовите конструктор для инициализации объекта представления и определения ресурса диалогового окна, на котором основывается представление либо форме.  
  
```  
explicit CDaoRecordView(LPCTSTR lpszTemplateName);  
explicit CDaoRecordView(UINT nIDTemplate);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszTemplateName*  
 Содержит строку, являющуюся именем ресурс шаблона диалоговых окон символом null.  
  
 *nIDTemplate*  
 Содержит идентификатор ресурса шаблона диалогового окна.  
  
### <a name="remarks"></a>Примечания  
 Можно либо указать ресурс по имени (передавать строку в качестве аргумента конструктору) или по его Идентификатору (pass целое число без знака в качестве аргумента). Ресурс идентификатор рекомендуется использовать.  
  
> [!NOTE]
>  Производный класс должен предоставить свой собственный конструктор. В конструкторе производного класса, вызовите конструктор `CDaoRecordView::CDaoRecordView` с именем ресурса или идентификатор в качестве аргумента.  
  
 `CDaoRecordView::OnInitialUpdate` вызовы `CWnd::UpdateData`, который вызывает `CWnd::DoDataExchange`. Это первый вызов `DoDataExchange` подключается `CDaoRecordView` управляет (косвенно) с `CDaoRecordset` поля элементов данных, созданных классов. Эти элементы данных не может использоваться до, после вызова метода базового класса `CFormView::OnInitialUpdate` функции-члена.  
  
> [!NOTE]
>  Если вы используете мастер классов, мастер определяет **перечисления** значение `CDaoRecordView::IDD` в объявлении класса и использует его в инициализации членов списка для конструктора.  
  
 [!code-cpp[NVC_MFCDatabase#35](../../mfc/codesnippet/cpp/cdaorecordview-class_1.cpp)]  
  
##  <a name="isonfirstrecord"></a>  CDaoRecordView::IsOnFirstRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnFirstRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является первой записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, созданных классов.  
  
 Если пользователь переходит к первой записи, отключает framework, пользовательского интерфейса объектов (например, пункты меню или кнопки панели инструментов) имеется для перемещения к первому или предыдущей записи.  
  
##  <a name="isonlastrecord"></a>  CDaoRecordView::IsOnLastRecord  
 Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записи в объекте набора записей, связанный с этим представлением записи.  
  
```  
BOOL IsOnLastRecord();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если текущая запись является последней записи в наборе записей; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Эту функцию можно использовать для создания собственных реализаций по умолчанию обработчики обновления команд, которые ClassWizard записывает поддерживает пользовательский интерфейс для перемещения по записям.  
  
> [!CAUTION]
>  Результат этой функции является надежным, за исключением того, что представление не удается обнаружить конца набора данных, пока пользователь уже прошел его. Пользователь может потребоваться переместить курсор на последнюю запись перед представления записей можно определить, что его необходимо отключить все объекты пользовательского интерфейса для перемещения к следующей или последней записи. Если пользователь перемещается за последней записи, а затем переходит назад на последнюю запись (или перед ним), представление записей можно отслеживать положение пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса.  
  
##  <a name="ongetrecordset"></a>  CDaoRecordView::OnGetRecordset  
 Возвращает указатель на `CDaoRecordset`-производный объект, связанный с представлением записи.  
  
```  
virtual CDaoRecordset* OnGetRecordset() = 0;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на `CDaoRecordset`-производного объекта, если объект был успешно создан; в противном случае **NULL** указателя.  
  
### <a name="remarks"></a>Примечания  
 Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращает указатель на него. Если объявить класс представления записей с помощью классов, мастер создает переопределение по умолчанию. Реализация по умолчанию ClassWizard возвращает указатель набора записей, хранится в представлении записей, если он существует. Если нет, он создает объект набора записей типа, указанный с ClassWizard и вызывает его `Open` член для открытия таблицы или выполнить запрос и затем возвращает указатель на объект.  
  
 Дополнительные сведения и примеры см. в статье [представления записей: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).  
  
##  <a name="onmove"></a>  CDaoRecordView::OnMove  
 Вызовите эту функцию-член для перемещения в другой записи в наборе записей и отобразить ее поля в элементах управления представления записи.  
  
```  
virtual BOOL OnMove(UINT nIDMoveCommand);
```  
  
### <a name="parameters"></a>Параметры  
 *nIDMoveCommand*  
 Одно из следующих значений ID стандартную команду:  
  
- `ID_RECORD_FIRST` Перемещение к первой записи в наборе записей.  
  
- `ID_RECORD_LAST` Перейти к последней записи в наборе записей.  
  
- `ID_RECORD_NEXT` Перемещение к следующей записи в наборе записей.  
  
- `ID_RECORD_PREV` Перейти к предыдущей записи в наборе записей.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если перемещение прошло успешно; в противном случае значение 0, если запрос на перемещение запрещен.  
  
### <a name="remarks"></a>Примечания  
 Реализация по умолчанию вызывает соответствующие перемещения функцию-член `CDaoRecordset` объект, связанный с представлением записи.  
  
 По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь был изменен в режиме записи.  
  
 В мастере приложений создает ресурс меню с пунктами меню первой записи, последнюю запись, следующая запись и предыдущей записи. При выборе параметра Первичная панель инструментов приложения мастер также создает панель инструментов с кнопками, соответствующий этим командам.  
  
 При перемещении за последней записью в наборе записей, представление записей продолжают отображаться последнюю запись. Если переместить назад после первой записи, представление записей продолжают отображаться первой записи.  
  
> [!CAUTION]
>  Вызов `OnMove` вызывает исключение, если набор записей не имеющей записей. Вызов функции-обработчика обновить соответствующий пользовательский интерфейс — `OnUpdateRecordFirst`, `OnUpdateRecordLast`, `OnUpdateRecordNext`, или `OnUpdateRecordPrev` — до соответствующей операции перемещения для определяет, имеет ли какие-либо записи набора записей.  
  
## <a name="see-also"></a>См. также  
 [Класс CFormView](../../mfc/reference/cformview-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)   
 [Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)   
 [Класс CFormView](../../mfc/reference/cformview-class.md)
