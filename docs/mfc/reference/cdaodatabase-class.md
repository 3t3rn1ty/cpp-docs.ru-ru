---
title: "Класс CDaoDatabase | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CDaoDatabase
- AFXDAO/CDaoDatabase
- AFXDAO/CDaoDatabase::CDaoDatabase
- AFXDAO/CDaoDatabase::CanTransact
- AFXDAO/CDaoDatabase::CanUpdate
- AFXDAO/CDaoDatabase::Close
- AFXDAO/CDaoDatabase::Create
- AFXDAO/CDaoDatabase::CreateRelation
- AFXDAO/CDaoDatabase::DeleteQueryDef
- AFXDAO/CDaoDatabase::DeleteRelation
- AFXDAO/CDaoDatabase::DeleteTableDef
- AFXDAO/CDaoDatabase::Execute
- AFXDAO/CDaoDatabase::GetConnect
- AFXDAO/CDaoDatabase::GetName
- AFXDAO/CDaoDatabase::GetQueryDefCount
- AFXDAO/CDaoDatabase::GetQueryDefInfo
- AFXDAO/CDaoDatabase::GetQueryTimeout
- AFXDAO/CDaoDatabase::GetRecordsAffected
- AFXDAO/CDaoDatabase::GetRelationCount
- AFXDAO/CDaoDatabase::GetRelationInfo
- AFXDAO/CDaoDatabase::GetTableDefCount
- AFXDAO/CDaoDatabase::GetTableDefInfo
- AFXDAO/CDaoDatabase::GetVersion
- AFXDAO/CDaoDatabase::IsOpen
- AFXDAO/CDaoDatabase::Open
- AFXDAO/CDaoDatabase::SetQueryTimeout
- AFXDAO/CDaoDatabase::m_pDAODatabase
- AFXDAO/CDaoDatabase::m_pWorkspace
dev_langs:
- C++
helpviewer_keywords:
- database classes [C++], DAO
- CDaoDatabase class, vs. CDatabase class
- CDaoDatabase class, and workspace
- CDaoDatabase class
- CDatabase class, vs. CDaoDatabase class
ms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d
caps.latest.revision: 23
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: c173ea0c0132752c08504053d9b00cdec8d3f69b
ms.lasthandoff: 02/24/2017

---
# <a name="cdaodatabase-class"></a>Класс CDaoDatabase
Представляет подключение к базе данных, с помощью которого можно выполнять действия с данными.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CDaoDatabase : public CObject  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::CDaoDatabase](#cdaodatabase)|Создает объект `CDaoDatabase`. Вызов **откройте** для подключения к базе данных объекта.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::CanTransact](#cantransact)|Возвращает ненулевое значение, если база данных поддерживает транзакции.|  
|[CDaoDatabase::CanUpdate](#canupdate)|Возвращает ненулевое значение, если `CDaoDatabase` является обновляемым объектом (не только для чтения).|  
|[CDaoDatabase::Close](#close)|Закрывает соединение с базой данных.|  
|[CDaoDatabase::Create](#create)|Создает объект основной базы данных DAO и инициализирует `CDaoDatabase` объекта.|  
|[CDaoDatabase::CreateRelation](#createrelation)|Определяет новую связь между таблицами в базе данных.|  
|[CDaoDatabase::DeleteQueryDef](#deletequerydef)|Удаляет объект querydef, сохраняются в базе данных QueryDefs-коллекция.|  
|[CDaoDatabase::DeleteRelation](#deleterelation)|Удаление существующей связи между таблицами в базе данных.|  
|[CDaoDatabase::DeleteTableDef](#deletetabledef)|Удаляет определение таблицы в базе данных. Это удаляет реальная таблица и все его данные.|  
|[CDaoDatabase::Execute](#execute)|Выполняет запрос. Вызов **Execute** для запроса, возвращающего результаты вызывает исключение.|  
|[CDaoDatabase::GetConnect](#getconnect)|Возвращает строку подключения, используемые для подключения `CDaoDatabase` объекта в базе данных. Используется для ODBC.|  
|[CDaoDatabase::GetName](#getname)|Возвращает имя базы данных в настоящее время используется.|  
|[CDaoDatabase::GetQueryDefCount](#getquerydefcount)|Возвращает количество запросов, определенные в базе данных.|  
|[CDaoDatabase::GetQueryDefInfo](#getquerydefinfo)|Возвращает сведения о указанный запрос, определенный в базе данных.|  
|[CDaoDatabase::GetQueryTimeout](#getquerytimeout)|Возвращает число секунд после базу данных, которая операции запроса истекает время ожидания. Влияет на все последующие откройте, добавить новые, обновлять и изменять операции и других операций в источнике данных ODBC (только), такие как **Execute** вызовов.|  
|[CDaoDatabase::GetRecordsAffected](#getrecordsaffected)|Возвращает число записей, затронутых последнее обновление, изменить или добавить операцию или путем вызова **Execute**.|  
|[CDaoDatabase::GetRelationCount](#getrelationcount)|Возвращает количество отношения, определенные между таблицами в базе данных.|  
|[CDaoDatabase::GetRelationInfo](#getrelationinfo)|Возвращает сведения о указанного отношения, определенные между таблицами в базе данных.|  
|[CDaoDatabase::GetTableDefCount](#gettabledefcount)|Возвращает количество таблиц в базе данных.|  
|[CDaoDatabase::GetTableDefInfo](#gettabledefinfo)|Возвращает сведения об указанной таблице в базе данных.|  
|[CDaoDatabase::GetVersion](#getversion)|Возвращает версию компонента database engine, связанные с базой данных.|  
|[CDaoDatabase::IsOpen](#isopen)|Возвращает ненулевое значение, если `CDaoDatabase` объект в данный момент подключен к базе данных.|  
|[CDaoDatabase::Open](#open)|Устанавливает подключение к базе данных.|  
|[CDaoDatabase::SetQueryTimeout](#setquerytimeout)|Задает число секунд после базу данных, которая операции (на источники данных ODBC только) запроса истекает время ожидания. Влияет на все последующие открытия, добавить новые, обновления и удаления операций.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::m_pDAODatabase](#m_pdaodatabase)|Указатель на объект базы данных DAO.|  
|[CDaoDatabase::m_pWorkspace](#m_pworkspace)|Указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объект, который содержит базу данных и определяет его место транзакций.|  
  
## <a name="remarks"></a>Примечания  
 Сведения о поддерживаемых форматах базы данных в разделе [GetName](../../mfc/reference/cdaoworkspace-class.md#getname) функции-члена. Может иметь одно или несколько `CDaoDatabase` объектов в каждый момент времени в заданной» рабочей области, «представленный [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта. Рабочая область поддерживает коллекцию открытых объектов базы данных, именем коллекции баз данных.  
  
> [!NOTE]
>  Классы баз данных DAO Библиотеки MFC отличаются от классов базы данных MFC на основе ODBC. Все имена классов DAO базы данных имеют префикс «CDao». Класс `CDaoDatabase` предоставляет интерфейс подобен классу ODBC [CDatabase](../../mfc/reference/cdatabase-class.md). Основное различие заключается в, `CDatabase` обращается к СУБД через Open Database Connectivity (ODBC) и драйвер ODBC для этой СУБД. `CDaoDatabase`обращается к данным через доступ объект данным (DAO) зависимости базы данных Microsoft Jet. В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классов MFC на основе ODBC; классы на основе DAO доступны данные, включая посредством драйверов ODBC, через свои собственные компонента database engine. Классы на основе DAO также поддерживают операции языка определения данных (DDL), например добавление таблиц с помощью классов, без непосредственного вызова DAO.  
  
## <a name="usage"></a>Использование  
 Можно создать объекты базы данных неявно при создании объектов наборов записей. Но можно также создать объекты базы данных явным образом. Для использования существующей базы данных явным образом с `CDaoDatabase`, выполните одно из следующих действий:  
  
-   Создать `CDaoDatabase` объекта, передать указатель на открытый [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта.  
  
-   Или создать `CDaoDatabase` объекта без указания рабочей области (MFC создает временную рабочую объект).  
  
 Чтобы создать новый Microsoft Jet (. Базы данных MDB), создания `CDaoDatabase` и вызовите его [создать](#create) функции-члена. Сделать *не* вызвать **откройте** после **создать**.  
  
 Чтобы открыть существующую базу данных, создания `CDaoDatabase` и вызовите его [откройте](#open) функции-члена.  
  
 Любой из этих методов добавляет объект базы данных DAO коллекции баз данных рабочей области и открывает подключение к данным. При построении затем [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md), или [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) объектов для работы с подключенной базы данных, передайте конструкторов для этих объектов указатель на `CDaoDatabase` объект. После завершения соединения с помощью вызова [закрыть](#close) члена функции и уничтожать `CDaoDatabase` объекта. **Закрыть** закрывает все наборы записей, ранее не закрыт.  
  
## <a name="transactions"></a>Транзакции  
 Обработка транзакций базы данных предоставляется на уровне рабочей области — в разделе [BeginTrans](../../mfc/reference/cdaoworkspace-class.md#begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#committrans), и [отката](../../mfc/reference/cdaoworkspace-class.md#rollback) функции-члены класса `CDaoWorkspace`.  
  
## <a name="odbc-connections"></a>Подключения ODBC  
 Для работы с источниками данных ODBC рекомендуется присваивать внешних таблиц Microsoft Jet (. База данных MDB).  
  
## <a name="collections"></a>Коллекции  
 Каждая база данных хранит свои собственные коллекции tabledef, querydef, набор записей и отношения объектов. Класс `CDaoDatabase` предоставляет функции-члены для управления этими объектами.  
  
> [!NOTE]
>  Объекты хранятся в DAO, не в объекте базы данных MFC. MFC предоставляет классы для объектов tabledef и querydef, набор записей, но не для связи объектов.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 `CDaoDatabase`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="cantransact"></a>CDaoDatabase::CanTransact  
 Вызовите эту функцию-член для определения того, допускает ли базы данных транзакции.  
  
```  
BOOL CanTransact();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если база данных поддерживает транзакции. в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Транзакции управляются из рабочей базы данных.  
  
##  <a name="canupdate"></a>CDaoDatabase::CanUpdate  
 Вызов этой функции-члена для определения ли `CDaoDatabase` объект позволяет обновлений.  
  
```  
BOOL CanUpdate();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если `CDaoDatabase` объектов позволяет обновления; в противном случае — 0, указывающее, либо, которые передается **TRUE** в `bReadOnly` при открытии `CDaoDatabase` объекта, или что сама база данных только для чтения. В разделе [откройте](#open) функции-члена.  
  
### <a name="remarks"></a>Примечания  
 Сведения о возможности обновления базы данных см. в разделе «Обновляемые свойства» в справке DAO.  
  
##  <a name="cdaodatabase"></a>CDaoDatabase::CDaoDatabase  
 Создает объект `CDaoDatabase`.  
  
```  
CDaoDatabase(CDaoWorkspace* pWorkspace = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *pWorkspace*  
 Указатель на `CDaoWorkspace` объект, который будет содержать новый объект базы данных. Чтобы принять значение по умолчанию **NULL**, конструктор создает временную `CDaoWorkspace` объекта с помощью рабочей области по умолчанию DAO. Можно получить указатель на объект рабочей области через [m_pWorkspace](#m_pworkspace) данные-член.  
  
### <a name="remarks"></a>Примечания  
 После создания объекта, если вы создаете новый Microsoft Jet (. MDB) базы данных, вызывающие этот объект [создать](#create) функции-члена. Если, вместо этого открыть существующую базу данных, вызывающие этот объект [откройте](#open) функции-члена.  
  
 После завершения работы с объектом, следует вызвать его [закрыть](#close) член функции, а затем уничтожить `CDaoDatabase` объекта.  
  
 Может оказаться удобным для внедрения `CDaoDatabase` объект в классе документа.  
  
> [!NOTE]
>  Объект `CDaoDatabase` объекта также создается неявно при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объекта без передачи указателя на существующую `CDaoDatabase` объекта. Этот объект базы данных закрывается при закрытии объекта набора записей.  
  
##  <a name="close"></a>CDaoDatabase::Close  
 Вызовите эту функцию-член для отключения от базы данных и закройте все открытые наборы записей, tabledefs и querydefs, связанные с базой данных.  
  
```  
virtual void Close();
```  
  
### <a name="remarks"></a>Примечания  
 Рекомендуется закрыть эти объекты самостоятельно перед вызовом функции-члена. Закрытие `CDaoDatabase` объекта он удаляется из коллекции баз данных в связанном [рабочей](../../mfc/reference/cdaoworkspace-class.md). Поскольку **закрыть** не разрушает `CDaoDatabase` объекта, повторного использования объекта при открытии той же базе данных или другой базы данных.  
  
> [!CAUTION]
>  Вызов [обновление](../../mfc/reference/cdaorecordset-class.md#update) функции-члена (если имеются ожидающие изменения) и **закрыть** функции-члена для всех объектов открыть набор записей, прежде чем закрыть базу данных. При выходе из функции, который объявляет [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) или `CDaoDatabase` объектов в стеке, база данных закрывается, все несохраненные изменения будут потеряны, все незавершенные транзакции откатываются и все ожидающие изменения в данные будут потеряны.  
  
> [!CAUTION]
>  При попытке закрыть объект базы данных, пока открыты все объекты набора записей или при попытке закрытия объекта рабочей области, пока открыты любые объекты базы данных, принадлежащих конкретной рабочей области, эти объекты набора записей будут закрыты и любые ожидающие обновления или изменения будет выполнен откат. При попытке закрытия объекта рабочей области, пока открыты любые объекты базы данных, размещенные в нем операцию закрывает все объекты базы данных, принадлежащих этому объекту конкретной рабочей области, что может привести к объекты незакрытые recordset закрывается. Если не закрыть объект базы данных, MFC отчеты Сбой утверждения в отладочных сборках.  
  
 Если объект базы данных, определенные вне области функции и выхода из функции, не закрывая его, объект базы данных будет оставаться открытым, пока не будет явно закрыт или модуль, в котором определен выходит за рамки.  
  
##  <a name="create"></a>CDaoDatabase::Create  
 Чтобы создать новый Microsoft Jet (. MDB) базы данных, вызвать эту функцию-член, после создания `CDaoDatabase` объекта.  
  
```  
virtual void Create(
    LPCTSTR lpszName,  
    LPCTSTR lpszLocale = dbLangGeneral,  
    int dwOptions = 0);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строковое выражение, представляющее имя создаваемого файла базы данных. Он может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Необходимо указать имя. Если не указать расширение файла. Добавляется MDB. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, такие как «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB». Только Microsoft Jet (. Файлы базы данных MDB) могут быть созданы с помощью функции-члена. (Необходимые двойной обратной косой черты в строковых литералах так как «\\» escape-символом C++.)  
  
 `lpszLocale`  
 Строковое выражение, используемое, чтобы указать порядок сортировки при создании базы данных. Значение по умолчанию — **dbLangGeneral**. Доступны следующие значения:  
  
- **dbLangGeneral** английский, немецкий, французский, португальский, итальянский и испанский современных  
  
- **dbLangArabic** арабский  
  
- **dbLangCyrillic** русский  
  
- **dbLangCzech** чешский  
  
- **dbLangDutch** нидерландский  
  
- **dbLangGreek** греческий  
  
- **dbLangHebrew** иврит  
  
- **dbLangHungarian** венгерский  
  
- **dbLangIcelandic** исландская  
  
- **dbLangNordic** Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)  
  
- **dbLangNorwdan** норвежский и датский  
  
- **dbLangPolish** польский  
  
- **dbLangSpanish** испанский (традиционный)  
  
- **dbLangSwedfin** шведский и финский  
  
- **dbLangTurkish** турецкий  
  
 `dwOptions`  
 Целое число, указывающее один или несколько параметров. Доступны следующие значения:  
  
- **dbEncrypt** создания зашифрованной базы данных.  
  
- **dbVersion10** создать базу данных Microsoft Jet версии 1.0.  
  
- **dbVersion11** создать базу данных Microsoft Jet версии 1.1.  
  
- **dbVersion20** создать базу данных Microsoft Jet версии 2.0.  
  
- **dbVersion30** создать базу данных Microsoft Jet версии 3.0.  
  
 Если опустить константа Шифрование незашифрованной базы данных создается. Можно указать только одну версию константа. Если опустить константа версии, создается база данных, использует базы данных Microsoft Jet версии 3.0.  
  
> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если реализация безопасности пользователя и пароль, чтобы непосредственно считать файл на диске двоичные, составляющее базы данных.  
  
### <a name="remarks"></a>Примечания  
 **Создание** создает файл базы данных и базового объекта базы данных DAO и инициализирует объект C++. Объект добавляется в коллекцию связанных рабочей базы данных. Объект базы данных находится в открытом состоянии; не следует вызывать **откройте** после **создать**.  
  
> [!NOTE]
>  С **создать**, можно создать только Microsoft Jet (. Базы данных MDB). Не удается создать ISAM баз данных или баз данных ODBC.  
  
##  <a name="createrelation"></a>CDaoDatabase::CreateRelation  
 Вызовите эту функцию-член для установления связи между одно или несколько полей в основной таблице в базе данных и одно или несколько полей во внешней таблице (другой таблицы в базе данных).  
  
```  
void CreateRelation(
    LPCTSTR lpszName,  
    LPCTSTR lpszTable,  
    LPCTSTR lpszForeignTable,  
    long lAttributes,  
    LPCTSTR lpszField,  
    LPCTSTR lpszForeignField);  
  
void CreateRelation(CDaoRelationInfo& relinfo);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Уникальное имя объекта связи. Имя должно начинаться с буквы и может содержать не более 40 символов. Он может включать цифры и символы подчеркивания, но не может содержать знаки пунктуации и пробелы.  
  
 `lpszTable`  
 Имя главной таблицы в связи. Если таблица не существует, MFC создает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 `lpszForeignTable`  
 Имя внешней таблицы в связи. Если таблица не существует, MFC создает исключение типа `CDaoException`.  
  
 `lAttributes`  
 Длинное значение, содержащее сведения о типе связи. Это значение можно использовать для обеспечения ссылочной целостности, среди прочего. Можно использовать оператор побитового или ( **|**) для объединения любое из следующих значений (при условии, что комбинация имеет смысл):  
  
- **dbRelationUnique** отношения один к одному.  
  
- **dbRelationDontEnforce** связь не применяется (не ссылочной целостности).  
  
- **dbRelationInherited** существует связь в долгосрочной базы данных, который содержит две вложенные таблицы.  
  
- **dbRelationUpdateCascade** обновления происходит каскадом (Дополнительные сведения о каскадные см. примечания).  
  
- **dbRelationDeleteCascade** удаления происходит каскадом.  
  
 *lpszField*  
 Указатель на нулем строка, содержащая имя поля в основной таблице (с именем, `lpszTable`).  
  
 *lpszForeignField*  
 Указатель на нулем строка, содержащая имя поля в таблице внешнего (с именем, `lpszForeignTable`).  
  
 *relinfo*  
 Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) , содержащий сведения о связи, необходимо создать.  
  
### <a name="remarks"></a>Примечания  
 Связь не может включать в запрос или подключенной таблицы из внешней базы данных.  
  
 Используйте первая версия функции, подразумевающие отношение одного поля в каждой из двух таблиц. Используйте вторую версию, если отношение включает в себя несколько полей. Максимальное число полей в отношении: 14.  
  
 Это действие создает объект отношения DAO, но это деталь реализации MFC, поскольку инкапсуляция MFC отношения объектов, содержащихся в классе `CDaoDatabase`. MFC предоставляет класс отношений.  
  
 При установке связи атрибутов объекта, чтобы активировать операции каскадного ядро СУБД автоматически обновляет или удаляет записи в одну или несколько таблиц, при внесении изменений в связанные таблицы первичного ключа.  
  
 Например предположим, что установить связь каскадного удаления таблицы Customers и Orders, таблица. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другие таблицы, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.  
  
 Дополнительные сведения см. в разделе «CreateRelation метод» в справке DAO.  
  
##  <a name="deletequerydef"></a>CDaoDatabase::DeleteQueryDef  
 Вызовите эту функцию-член для удаления указанного querydef — сохраненный запрос — от `CDaoDatabase` QueryDefs-коллекция объекта.  
  
```  
void DeleteQueryDef(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя сохраненного запроса для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого запроса больше не определен в базе данных.  
  
 Дополнительные сведения о создании объектов querydef см [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md). Объект querydef становится связанным с конкретным `CDaoDatabase` объекта при создании `CDaoQueryDef` объекта, передать указатель на объект базы данных.  
  
##  <a name="deleterelation"></a>CDaoDatabase::DeleteRelation  
 Вызовите эту функцию-член для удаления существующей связи из коллекции отношений объекта базы данных.  
  
```  
void DeleteRelation(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя столбца для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого отношения больше не существует.  
  
 Дополнительные сведения см. в разделе «Метод Delete», в справке DAO.  
  
##  <a name="deletetabledef"></a>CDaoDatabase::DeleteTableDef  
 Вызовите эту функцию-член для удаления указанной таблицы и все ее данные из `CDaoDatabase` TableDefs-коллекция объекта.  
  
```  
void DeleteTableDef(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя tabledef для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого этой таблицы в базе данных больше не определен.  
  
> [!NOTE]
>  Будьте очень внимательны при удалении системных таблиц.  
  
 Дополнительные сведения о создании объектов tabledef см [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md). Объект tabledef становится связанным с конкретным `CDaoDatabase` объекта при создании `CDaoTableDef` объекта, передать указатель на объект базы данных.  
  
 Дополнительные сведения см. в разделе «Метод Delete», в справке DAO.  
  
##  <a name="execute"></a>CDaoDatabase::Execute  
 Вызов этой функции-члена для выполнения запроса или инструкции SQL в базе данных.  
  
```  
void Execute(
    LPCTSTR lpszSQL,  
    int nOptions = dbFailOnError);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSQL`  
 Указатель нулем строку, содержащую допустимый команду SQL для выполнения.  
  
 `nOptions`  
 Целое число, указывающее параметры, относящиеся к целостности запроса. Можно использовать оператор побитового или ( **|**) для объединения любой из следующих констант (предоставляемых комбинация смысл — например, не будут объединены **dbInconsistent** с **dbConsistent**):  
  
- **dbDenyWrite** запретить разрешение на запись для других пользователей.  
  
- **dbInconsistent** несогласованных обновлений (по умолчанию).  
  
- **dbConsistent** согласованности обновлений.  
  
- **dbSQLPassThrough** к серверу SQL. Вызывает инструкцию SQL, чтобы передать источника данных ODBC для обработки.  
  
- **dbFailOnError** откат обновлений при возникновении ошибки.  
  
- **dbSeeChanges** формирования ошибки во время выполнения, если другой пользователь изменяет редактировании данных.  
  
> [!NOTE]
>  Если оба **dbInconsistent** и **dbConsistent** включаются или если ни один не включены, результатом является значение по умолчанию. Для объяснения этих констант см. в разделе «Выполнить метод» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 **Выполнение** работает только для запросов или передаваемые запросы SQL, которые не возвращают результаты. Он не работает для запросов select, которые возвращают записи.  
  
 Для определения и сведения о запросах действия см. в разделах «Запрос» и «Выполнить метод» в справке DAO.  
  
> [!TIP]
>  Синтаксически правильные инструкции SQL и соответствующие разрешения **Execute** функции-члена не произойдет, даже если не одной строки будут изменены или удалены. Таким образом, всегда используйте **dbFailOnError** параметр при использовании **Execute** функции-члена для выполнения обновления или удаления запроса. Этот параметр предписывает MFC для создания исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md) и выполняет откат всех успешных изменений, если любой из записей, затронутых заблокированы и не может обновить или удалить. Обратите внимание, что всегда можно вызвать `GetRecordsAffected` чтобы увидеть сколько записей были затронуты.  
  
 Вызов [GetRecordsAffected](#getrecordsaffected) функции-члена объекта базы данных, чтобы определить количество записей, затронутых последней **Execute** вызова. Например `GetRecordsAffected` возвращает сведения о количестве записей удалены, обновляемых или вставляемых при выполнении запроса. Возвращенное число не будет отражать изменения в связанных таблицах, когда cascade обновляет или удаляет вступают в силу.  
  
 **Выполнение** не возвращает набор записей. С помощью **Execute** на запрос, который выбирает записи вызывает MFC для создания исключения типа `CDaoException`. (Имеется не `ExecuteSQL` аналогична функции-члена `CDatabase::ExecuteSQL`.)  
  
##  <a name="getconnect"></a>CDaoDatabase::GetConnect  
 Вызов этой функции-члена для получения строки подключения, используемые для подключения `CDaoDatabase` объекта в базе данных ODBC или ISAM.  
  
```  
CString GetConnect();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если строка соединения [откройте](#open) вызван успешно на источнике данных ODBC; в противном случае — пустая строка. Для Microsoft Jet (. Базы данных MDB), строка всегда пуста, если не задать его для использования с **dbSQLPassThrough** параметр, используемый с [Execute](#execute) функции-члена или используется при открытии набора записей.  
  
### <a name="remarks"></a>Примечания  
 Строка содержит сведения об источнике открыть базу данных или базы данных, используемый в запросе к серверу. Строка подключения состоит из спецификатора типа базы данных и ноль или несколько параметров, разделенных точкой с запятой.  
  
> [!NOTE]
>  С помощью классов MFC DAO для подключения к источнику данных через ODBC является менее эффективным, чем подключение через подключенной таблицы.  
  
> [!NOTE]
>  Строка подключения используется для передачи дополнительных сведений к ODBC и некоторые драйверы ISAM, при необходимости. Для не используется. Базы данных MDB. Для базовых таблиц базы данных Microsoft Jet, строка подключения является пустой строкой ("») за исключением случаев, когда его использовать для запроса к серверу как описано в разделе выше значение, возвращают.  
  
 В разделе [откройте](#open) функции-члена Описание способа создания строки подключения. После настройки строки подключения **откройте** вызов, можно позже использовать его проверка параметра, чтобы определить тип, путь, идентификатор, пароль или ODBC источника данных базы данных.  
  
##  <a name="getname"></a>CDaoDatabase::GetName  
 Вызовите эту функцию-член для получения имя базы данных, открытые в настоящий момент, которое является именем существующего файла базы данных или имя зарегистрированного источника данных ODBC.  
  
```  
CString GetName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Полный путь и имя файла базы данных в случае успешного выполнения; в противном случае — пустой [CString](../../atl-mfc-shared/reference/cstringt-class.md).  
  
### <a name="remarks"></a>Примечания  
 Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например, «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB.» (Необходимые двойной обратной косой черты в строковых литералах так как «\\» escape-символом C++.)  
  
 Например, можно отобразить это имя в заголовке. Если происходит ошибка при извлечении имени, MFC создает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
> [!NOTE]
>  Для повышения производительности при осуществляется внешние базы данных, рекомендуется подключить таблицы внешней базы данных для базы данных Microsoft Jet (. MDB) вместо непосредственного подключения к источнику данных.  
  
 Тип базы данных указывается файл или каталог, который указывает путь, как показано ниже:  
  
|Путь указывает на...|Тип базы данных|  
|--------------------------|-------------------|  
|. MDB-файлу|База данных Microsoft Jet (Microsoft Access)|  
|Каталог, содержащий. Файлы DBF|базы данных dBASE|  
|Каталог, содержащий. XLS-файлов|База данных Microsoft Excel|  
|Каталог, содержащий. Файлы PDX|Базы данных Paradox|  
|Каталог, содержащий файлы базы данных соответствующим образом отформатированный текст|Базы данных формата текста|  
  
 Для баз данных ODBC, например SQL Server и Oracle строка подключения базы данных определяет имя источника данных (DSN), зарегистрированный с ODBC.  
  
##  <a name="getquerydefcount"></a>CDaoDatabase::GetQueryDefCount  
 Вызовите эту функцию-член для получения числа запросов, определенных в коллекции QueryDefs базы данных.  
  
```  
short GetQueryDefCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число запросов, определенных в базе данных.  
  
### <a name="remarks"></a>Примечания  
 `GetQueryDefCount`полезно, если необходимо перебрать все querydefs в QueryDefs-коллекция. Для получения сведений о данного запроса в коллекции, в разделе [GetQueryDefInfo](#getquerydefinfo).  
  
##  <a name="getquerydefinfo"></a>CDaoDatabase::GetQueryDefInfo  
 Вызовите эту функцию-член для получения различных типов сведений о запросе, определенных в базе данных.  
  
```  
void GetQueryDefInfo(
    int nIndex,  
    CDaoQueryDefInfo& querydefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetQueryDefInfo(
    LPCTSTR lpszName,  
    CDaoQueryDefInfo& querydefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс предопределенного запроса в базу данных QueryDefs-коллекция, для поиска по индексу.  
  
 *querydefinfo*  
 Ссылку на [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) объекта, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, определяющие, какой набор записей для извлечения. Ниже перечислены доступные параметры и что они могут вызывать функцию возврата о набор записей:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя типа  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения об основном: Дата создания, Дата последнего обновления, возвращает записи, с возможностью записи  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: время ожидания ODBC SQL, подключение,  
  
 `lpszName`  
 Строка, содержащая имя запроса, определенные в базе данных, для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии функции предоставляются для выбора запроса по индексу в коллекции QueryDefs базы данных или имя запроса.  
  
 Описание сведений, возвращаемых в *querydefinfo*, в разделе [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. Если запрос один уровень информации, вы получаете все предыдущие уровни также сведения.  
  
##  <a name="getquerytimeout"></a>CDaoDatabase::GetQueryTimeout  
 Вызовите эту функцию-член для получения текущее количество секунд, по истечении которого истекло в последующих операциях в подключенной базе данных.  
  
```  
short GetQueryTimeout();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Короткое целое число, содержащее значение времени ожидания в секундах.  
  
### <a name="remarks"></a>Примечания  
 Операция может времени из-за проблем доступа к сети, время обработки запроса слишком и т. д. Пока действует параметр, он влияет на все открытые, добавить новые, обновления и удаления все наборы записей, связанный с этим `CDaoDatabase` объекта. Текущее значение времени ожидания можно изменить с помощью [SetQueryTimeout](#setquerytimeout). Изменить значение времени ожидания запроса для набора записей после открытия не приводит к изменению значения для набора записей. Например, последующие [перемещение](../../mfc/reference/cdaorecordset-class.md#move) операции не используют новое значение. Значение по умолчанию изначально установлено при инициализации ядра базы данных.  
  
 Значение по умолчанию для времени ожидания запросов берется из реестра Windows. Если не существует параметра реестра, значение по умолчанию — 60 секунд. Не все базы данных поддерживают возможность задать значение времени ожидания запроса. Если задано значение 0, время ожидания запроса без ожидания; и взаимодействия с базой данных может перестать отвечать на запросы. Такое поведение может быть полезным во время разработки. Если вызов завершается сбоем, MFC создает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.  
  
##  <a name="getrecordsaffected"></a>CDaoDatabase::GetRecordsAffected  
 Вызов этой функции-члена для определения количества записей, затронутых последней вызов [Execute](#execute) функции-члена.  
  
```  
long GetRecordsAffected();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Длинное целое число, содержащее количество обработанных записей.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение содержит число записей удалены, обновляемых или вставляемых в запрос на запуск с **Execute**. Возвращенное число не будет отражать изменения в связанных таблицах, когда cascade обновляет или удаляет вступают в силу.  
  
 Дополнительные сведения см. в разделе «Свойство RecordsAffected» в справке DAO.  
  
##  <a name="getrelationcount"></a>CDaoDatabase::GetRelationCount  
 Вызовите эту функцию-член для получения номера отношения, определенные между таблицами в базе данных.  
  
```  
short GetRelationCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество отношения, определенные между таблицами в базе данных.  
  
### <a name="remarks"></a>Примечания  
 **GetRelationCount** полезно, если необходимо перебрать все отношения, определенные в коллекции связей базы данных. Для получения сведений о данное отношение в коллекции, в разделе [GetRelationInfo](#getrelationinfo).  
  
 Для объяснения концепции связи, рассмотрим таблицу Suppliers и таблицу продуктов, которая может иметь отношение один ко многим. В этом отношении одного поставщика можно указать более одного продукта. Другие отношения один к одному "и" многие ко многим.  
  
##  <a name="getrelationinfo"></a>CDaoDatabase::GetRelationInfo  
 Вызовите эту функцию-член для получения сведений о указанное отношение в коллекции связей базы данных.  
  
```  
void GetRelationInfo(
    int nIndex,  
    CDaoRelationInfo& relinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetRelationInfo(
    LPCTSTR lpszName,  
    CDaoRelationInfo& relinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс в коллекции связей базы данных, для поиска по индексу объект связи.  
  
 *relinfo*  
 Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) объекта, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, определяющие, какие отношения для извлечения. Ниже перечислены доступные параметры и что они могут вызывать функцию возврата о связи:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя таблицы, внешние таблицы  
  
- `AFX_DAO_SECONDARY_INFO`Атрибуты поля сведений  
  
 Сведения о поле — [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) объект, содержащий поля из главной таблицы, участвующие в связи.  
  
 `lpszName`  
 Строка, содержащая имя объекта отношения для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии этой функции предоставляют доступ по индексу или по имени. Описание сведений, возвращаемых в *relinfo*, в разделе [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. При запросе информации на одном уровне, можно также получить информацию об любой предыдущих уровней.  
  
> [!NOTE]
>  Если установить связь атрибутов объекта для активации операций cascade ( **dbRelationUpdateCascades** или **dbRelationDeleteCascades**), ядро базы данных Microsoft Jet автоматически обновляет или удаляет записи в одном или нескольких других таблиц, при внесении изменений в связанные первичного ключа таблицы. Например предположим, что установить связь каскадного удаления таблицы Customers и Orders, таблица. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другие таблицы, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.  
  
##  <a name="gettabledefcount"></a>CDaoDatabase::GetTableDefCount  
 Вызовите эту функцию-член для получения числа таблиц, определенные в базе данных.  
  
```  
short GetTableDefCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество tabledefs, определенные в базе данных.  
  
### <a name="remarks"></a>Примечания  
 `GetTableDefCount`полезно, если необходимо перебрать все tabledefs в коллекции TableDefs базы данных. Чтобы получить сведения о данной таблицы в коллекции, в разделе [GetTableDefInfo](#gettabledefinfo).  
  
##  <a name="gettabledefinfo"></a>CDaoDatabase::GetTableDefInfo  
 Вызовите эту функцию-член для получения различных типов сведений о таблице, определенные в базе данных.  
  
```  
void GetTableDefInfo(
    int nIndex,  
    CDaoTableDefInfo& tabledefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetTableDefInfo(
    LPCTSTR lpszName,  
    CDaoTableDefInfo& tabledefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс объекта tabledef в коллекции TableDefs базы данных, для поиска по индексу.  
  
 `tabledefinfo`  
 Ссылку на [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) объекта, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, указывающие, какие сведения о таблице для получения. Ниже перечислены доступные параметры и что они могут вызывать функцию возврата о связи:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя обновляемой, атрибуты  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения об основном: Дата создания, Дата последнего обновления, имя исходной таблицы, подключение  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: правила проверки, проверки текст, число записей  
  
 `lpszName`  
 Имя объекта tabledef для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии функции предоставляются для выбора таблицы индекс в коллекции TableDefs базы данных или имя таблицы.  
  
 Описание сведений, возвращаемых в `tabledefinfo`, в разделе [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. Если вы запрашиваете информацию на одном уровне, вы получите сведения всех предыдущих уровней.  
  
> [!NOTE]
>  `AFX_DAO_ALL_INFO` Предоставляет информацию, может быть медленным для получения. В этом случае подсчет строк в таблице может быть очень много времени, если существует много записей.  
  
##  <a name="getversion"></a>CDaoDatabase::GetVersion  
 Вызовите эту функцию-член для определения версии файла базы данных Microsoft Jet.  
  
```  
CString GetVersion();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию файла базы данных, связанный с объектом.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение представляет номер версии в формате "основная.дополнительная «";» например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точки и номер версии (0). Версии до даты, 1.0, 1.1, 2.0 и 3.0.  
  
 Дополнительные сведения см. в разделе «Свойство Version» в справке DAO.  
  
##  <a name="isopen"></a>CDaoDatabase::IsOpen  
 Вызов этой функции-члена для определения ли `CDaoDatabase` объект открыт в данный момент в базе данных.  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если `CDaoDatabase` объект, открытые в настоящий момент; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="m_pdaodatabase"></a>CDaoDatabase::m_pDAODatabase  
 Содержит указатель на интерфейс OLE для базового объекта базы данных DAO `CDaoDatabase` объекта.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот указатель, если требуется прямой доступ к интерфейсу DAO.  
  
 Сведения о вызовах DAO напрямую, в разделе [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
##  <a name="m_pworkspace"></a>CDaoDatabase::m_pWorkspace  
 Содержит указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объект, содержащий объект базы данных.  
  
### <a name="remarks"></a>Примечания  
 Использовать этот указатель, если требуется прямой доступ к рабочей области — например, для получения ссылки на другие объекты базы данных в рабочей области базы данных коллекции.  
  
##  <a name="open"></a>CDaoDatabase::Open  
 Необходимо вызвать эту функцию-член для инициализации нового созданного `CDaoDatabase` объект, представляющий существующую базу данных.  
  
```  
virtual void Open(
    LPCTSTR lpszName,  
    BOOL bExclusive = FALSE,  
    BOOL bReadOnly = FALSE,  
    LPCTSTR lpszConnect = _T(""));
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строковое выражение, которое является именем существующего Microsoft Jet (. Файл базы данных MDB). Если имя файла имеет расширение, оно является обязательным. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, такие как «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB.» (Необходимые двойной обратной косой черты в строковых литералах так как «\\» escape-символом C++.)  
  
 Некоторые соображения при использовании `lpszName`. Если он:  
  
-   Ссылается на базу данных, которая уже открыта для монопольного доступа другим пользователем, MFC выдает исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md). Перехватить это исключение, чтобы пользователь знать, что база данных недоступна.  
  
-   Является пустой строкой («») и *lpszConnect* — «ODBC;», отображается диалоговое окно со списком всех зарегистрированных имен источников данных ODBC, поэтому пользователь может выбрать базу данных. Следует избегать прямые подключения к источникам данных ODBC; Вместо этого используйте подключенной таблицы.  
  
-   В противном случае не ссылаться на существующую базу данных или допустимое имя источника данных ODBC, MFC выдает исключения типа `CDaoException`.  
  
> [!NOTE]
>  Дополнительные сведения о кодах ошибок DAO см. в разделе DAOERR. H-файл. Дополнительные сведения см. в разделе «Перехватываемая ошибками доступа к данным» в справке DAO.  
  
 `bExclusive`  
 Логическое значение, равное **TRUE** должен быть открыт для монопольного доступа (неиспользуемому совместно) базы данных и **FALSE** Если база данных будет открыт для общего доступа. Если этот аргумент опущен, база данных открыта для общего доступа.  
  
 `bReadOnly`  
 Логическое значение, равное **TRUE** должен быть открыт для доступа только для чтения базы данных и **FALSE** Если база данных будет открыт для чтения и записи. Если этот аргумент опущен, база данных открыта для чтения и записи. Все зависимые наборы записей, наследуют этот атрибут.  
  
 `lpszConnect`  
 Строковое выражение, используемое для открытия базы данных. Эта строка представляет ODBC подключения аргументов. Необходимо указать аргументы эксклюзивное и только для чтения для предоставления строки источника. Если база данных является база данных Microsoft Jet (. MDB), эта строка пуста (»»). Синтаксис для значения по умолчанию — **_T**(«») — предоставляет переносимость Юникода как ANSI для построения приложения.  
  
### <a name="remarks"></a>Примечания  
 **Откройте** связывает базу данных с основной объект DAO. Объект базы данных нельзя использовать для создания набора записей, tabledef или querydef объектов, пока не инициализирован. **Откройте** добавляет объект базы данных в коллекцию связанных рабочей базы данных.  
  
 Используйте параметры следующим образом:  
  
-   При открытии Microsoft Jet (. Базы данных MDB), используйте `lpszName` параметр и передать, или пустая строка для `lpszConnect` параметр или передайте Строка пароля формы «; PWD = пароль» при защищенной паролем базы данных (. MDB базы данных только).  
  
-   При открытии источника данных ODBC, передайте допустимую строку подключения ODBC в `lpszConnect` и пустая строка в `lpszName`.  
  
 Дополнительные сведения см. в разделе «Метод OpenDatabase» в справке DAO.  
  
> [!NOTE]
>  Для повышения производительности при доступе к внешним базам данных, включая ISAM баз данных и источники данных ODBC, рекомендуется подключить таблицы внешней базы данных для базы данных Microsoft Jet Database engine (. MDB) вместо непосредственного подключения к источнику данных.  
  
 Возможна при подключении к времени ожидания Если, например, СУБД узел недоступен. Если попытка соединения завершается неудачно, **откройте** исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 Оставшиеся примечания относятся только к базам данных ODBC:  
  
 Если база данных находится в базе данных ODBC и параметров в вашей **откройте** вызов не содержат достаточно сведений для подключения, драйвер ODBC открывает диалоговое окно, чтобы получить необходимую информацию от пользователя. При вызове **откройте**, строки подключения, `lpszConnect`, хранится в частном порядке и по телефону [GetConnect](#getconnect) функции-члена.  
  
 При желании можно открыть собственное диалоговое перед вызовом метода **откройте** для получения сведений от пользователя, таких как пароль, затем добавьте эти сведения в строку подключения, передаваемый **откройте**. Или вы можете сохранить строку подключения, передайте (возможно, в реестре Windows), можно использовать следующий раз приложение вызывает **откройте** на `CDaoDatabase` объект.  
  
 Можно также использовать строки подключения для нескольких уровней авторизацию входа (для другой `CDaoDatabase` объекта) или для передачи другие сведения для конкретной базы данных.  
  
##  <a name="setquerytimeout"></a>CDaoDatabase::SetQueryTimeout  
 Вызовите эту функцию-член для переопределения количество секунд перед выполнением последующих операций на время ожидания подключенной базы данных по умолчанию.  
  
```  
void SetQueryTimeout(short nSeconds);
```  
  
### <a name="parameters"></a>Параметры  
 `nSeconds`  
 Чтобы разрешить до попытки запроса в секундах время ожидания.  
  
### <a name="remarks"></a>Примечания  
 Операция может времени из-за проблем доступа к сети, время обработки запроса слишком и т. д. Вызов `SetQueryTimeout` перед открытием набора записей или перед вызовом набора записей [AddNew](../../mfc/reference/cdaorecordset-class.md#addnew), [обновление](../../mfc/reference/cdaorecordset-class.md#update), или [удаление](../../mfc/reference/cdaorecordset-class.md#delete) функции-члены, если требуется изменить значение времени ожидания запроса. Параметр влияет на все последующие [откройте](../../mfc/reference/cdaorecordset-class.md#open), `AddNew`, **обновление**, и **удаление** вызовы все наборы записей, связанный с этим `CDaoDatabase` объекта. Изменить значение времени ожидания запроса для набора записей после открытия не приводит к изменению значения для набора записей. Например, последующие [перемещение](../../mfc/reference/cdaorecordset-class.md#move) операции не используют новое значение.  
  
 Значение по умолчанию для времени ожидания запросов составляет 60 секунд. Не все базы данных поддерживают возможность задать значение времени ожидания запроса. Если задано значение 0, время ожидания запроса без ожидания; взаимодействие с базой данных может перестать отвечать на запросы. Такое поведение может быть полезным во время разработки.  
  
 Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.  
  
## <a name="see-also"></a>См. также  
 [CObject-класс](../../mfc/reference/cobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [CDatabase-класс](../../mfc/reference/cdatabase-class.md)   
 [Класс CDaoException](../../mfc/reference/cdaoexception-class.md)

