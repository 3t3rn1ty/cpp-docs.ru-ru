---
title: "Класс CDaoDatabase | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CDaoDatabase
- AFXDAO/CDaoDatabase
- AFXDAO/CDaoDatabase::CDaoDatabase
- AFXDAO/CDaoDatabase::CanTransact
- AFXDAO/CDaoDatabase::CanUpdate
- AFXDAO/CDaoDatabase::Close
- AFXDAO/CDaoDatabase::Create
- AFXDAO/CDaoDatabase::CreateRelation
- AFXDAO/CDaoDatabase::DeleteQueryDef
- AFXDAO/CDaoDatabase::DeleteRelation
- AFXDAO/CDaoDatabase::DeleteTableDef
- AFXDAO/CDaoDatabase::Execute
- AFXDAO/CDaoDatabase::GetConnect
- AFXDAO/CDaoDatabase::GetName
- AFXDAO/CDaoDatabase::GetQueryDefCount
- AFXDAO/CDaoDatabase::GetQueryDefInfo
- AFXDAO/CDaoDatabase::GetQueryTimeout
- AFXDAO/CDaoDatabase::GetRecordsAffected
- AFXDAO/CDaoDatabase::GetRelationCount
- AFXDAO/CDaoDatabase::GetRelationInfo
- AFXDAO/CDaoDatabase::GetTableDefCount
- AFXDAO/CDaoDatabase::GetTableDefInfo
- AFXDAO/CDaoDatabase::GetVersion
- AFXDAO/CDaoDatabase::IsOpen
- AFXDAO/CDaoDatabase::Open
- AFXDAO/CDaoDatabase::SetQueryTimeout
- AFXDAO/CDaoDatabase::m_pDAODatabase
- AFXDAO/CDaoDatabase::m_pWorkspace
dev_langs: C++
helpviewer_keywords:
- CDaoDatabase [MFC], CDaoDatabase
- CDaoDatabase [MFC], CanTransact
- CDaoDatabase [MFC], CanUpdate
- CDaoDatabase [MFC], Close
- CDaoDatabase [MFC], Create
- CDaoDatabase [MFC], CreateRelation
- CDaoDatabase [MFC], DeleteQueryDef
- CDaoDatabase [MFC], DeleteRelation
- CDaoDatabase [MFC], DeleteTableDef
- CDaoDatabase [MFC], Execute
- CDaoDatabase [MFC], GetConnect
- CDaoDatabase [MFC], GetName
- CDaoDatabase [MFC], GetQueryDefCount
- CDaoDatabase [MFC], GetQueryDefInfo
- CDaoDatabase [MFC], GetQueryTimeout
- CDaoDatabase [MFC], GetRecordsAffected
- CDaoDatabase [MFC], GetRelationCount
- CDaoDatabase [MFC], GetRelationInfo
- CDaoDatabase [MFC], GetTableDefCount
- CDaoDatabase [MFC], GetTableDefInfo
- CDaoDatabase [MFC], GetVersion
- CDaoDatabase [MFC], IsOpen
- CDaoDatabase [MFC], Open
- CDaoDatabase [MFC], SetQueryTimeout
- CDaoDatabase [MFC], m_pDAODatabase
- CDaoDatabase [MFC], m_pWorkspace
ms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d
caps.latest.revision: "23"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: c72946edb68212e09ab93e9d36d2dfa8afd5630e
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="cdaodatabase-class"></a>Класс CDaoDatabase
Представляет подключение к базе данных, с помощью которого можно выполнять действия с данными.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CDaoDatabase : public CObject  
```  
  
## <a name="members"></a>Члены  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::CDaoDatabase](#cdaodatabase)|Создает объект `CDaoDatabase`. Вызовите **откройте** подключение объекта в базе данных.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::CanTransact](#cantransact)|Возвращает ненулевое значение, если базы данных поддерживает транзакции.|  
|[CDaoDatabase::CanUpdate](#canupdate)|Возвращает ненулевое значение, если `CDaoDatabase` является обновляемым объектом (не только для чтения).|  
|[CDaoDatabase::Close](#close)|Закрывает подключение к базе данных.|  
|[CDaoDatabase::Create](#create)|Создает базового объекта базы данных DAO и инициализирует `CDaoDatabase` объекта.|  
|[CDaoDatabase::CreateRelation](#createrelation)|Определяет новую связь между таблицами в базе данных.|  
|[CDaoDatabase::DeleteQueryDef](#deletequerydef)|Удаляет объект querydef, сохраненные в базе данных QueryDefs-коллекция.|  
|[CDaoDatabase::DeleteRelation](#deleterelation)|Удаление существующей связи между таблицами в базе данных.|  
|[CDaoDatabase::DeleteTableDef](#deletetabledef)|Удаляет определение таблицы в базе данных. При этом будет удалено действительную таблицу и все его данные.|  
|[CDaoDatabase::Execute](#execute)|Выполняет запрос. Вызов **Execute** для запроса, возвращающего результаты приводит к возникновению исключения.|  
|[CDaoDatabase::GetConnect](#getconnect)|Возвращает строку подключения, используемую для подключения `CDaoDatabase` объекта в базе данных. Используется для ODBC.|  
|[CDaoDatabase::GetName](#getname)|Возвращает имя базы данных в настоящее время используется.|  
|[CDaoDatabase::GetQueryDefCount](#getquerydefcount)|Возвращает количество запросов, определенные в базе данных.|  
|[CDaoDatabase::GetQueryDefInfo](#getquerydefinfo)|Возвращает сведения о указанный запрос, определенный в базе данных.|  
|[CDaoDatabase::GetQueryTimeout](#getquerytimeout)|Возвращает количество секунд, после которого базы данных операций запросов выдаст ошибку времени ожидания. Влияет на все последующие открыть, добавить новый, обновить и изменить операции и других операций в источнике данных ODBC (только), такие как **Execute** вызовов.|  
|[CDaoDatabase::GetRecordsAffected](#getrecordsaffected)|Возвращает число записей, затронутых последнего обновления, можно изменить или добавить операцию или с помощью вызова **Execute**.|  
|[CDaoDatabase::GetRelationCount](#getrelationcount)|Возвращает количество взаимоотношений, определенных между таблицами в базе данных.|  
|[CDaoDatabase::GetRelationInfo](#getrelationinfo)|Возвращает сведения о указанного отношения, определенные между таблицами в базе данных.|  
|[CDaoDatabase::GetTableDefCount](#gettabledefcount)|Возвращает количество таблиц, определенных в базе данных.|  
|[CDaoDatabase::GetTableDefInfo](#gettabledefinfo)|Возвращает сведения об указанной таблице в базе данных.|  
|[CDaoDatabase::GetVersion](#getversion)|Возвращает версию компонента database engine, связанные с базой данных.|  
|[CDaoDatabase::IsOpen](#isopen)|Возвращает ненулевое значение, если `CDaoDatabase` объект в данный момент подключен к базе данных.|  
|[CDaoDatabase::Open](#open)|Устанавливает подключение к базе данных.|  
|[CDaoDatabase::SetQueryTimeout](#setquerytimeout)|Задает число секунд после базу данных, которая операций (на источники данных ODBC только) запросов выдаст ошибку времени ожидания. Влияет на все последующие откройте, добавить новый, обновить и операции удаления.|  
  
### <a name="public-data-members"></a>Открытые члены данных  
  
|Имя|Описание|  
|----------|-----------------|  
|[CDaoDatabase::m_pDAODatabase](#m_pdaodatabase)|Указатель базового объекта базы данных DAO.|  
|[CDaoDatabase::m_pWorkspace](#m_pworkspace)|Указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объект, который содержит базу данных и определяет его место транзакций.|  
  
## <a name="remarks"></a>Примечания  
 Сведения о поддерживаемых форматах базы данных см. в разделе [GetName](../../mfc/reference/cdaoworkspace-class.md#getname) функции-члена. Может иметь один или несколько `CDaoDatabase` объектов в каждый момент времени в заданной» рабочей области «представленный [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта. Рабочая область поддерживает коллекцию открытых объектов базы данных, именем коллекции баз данных.  
  
> [!NOTE]
>  Классы баз данных MFC DAO отличаются от классов базы данных MFC на основе ODBC. Все имена классов DAO базы данных имеют префикс «CDao». Класс `CDaoDatabase` предоставляет интерфейс аналогичен классу ODBC [CDatabase](../../mfc/reference/cdatabase-class.md). Основное отличие заключается в, `CDatabase` обращается к СУБД через Open Database Connectivity (ODBC) и драйвер ODBC для этого СУБД. `CDaoDatabase`обращается к данным через данных Access Object (DAO) в зависимости от базы данных Microsoft Jet. В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классы MFC на основе ODBC; классы на основе DAO доступны данные, включая через драйверы ODBC, через свои собственные компонента database engine. Классы на основе DAO также поддерживают операции языка определения данных (DDL), например добавление таблиц с помощью классов, без необходимости непосредственный вызов DAO.  
  
## <a name="usage"></a>Использование  
 Можно создать объекты базы данных неявно при создании объекта набора записей. Однако можно также создать объекты базы данных явным образом. Для использования существующей базы данных явным образом с `CDaoDatabase`, выполните одно из следующих действий:  
  
-   Создать `CDaoDatabase` объекта, передавая указатель на открытый [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта.  
  
-   Или создать `CDaoDatabase` объект без указания рабочей области (MFC создает объект временную рабочую область).  
  
 Чтобы создать новый Microsoft Jet (. Базы данных MDB), создания `CDaoDatabase` и вызовите его [создать](#create) функции-члена. Сделать *не* вызвать **откройте** после **создать**.  
  
 Чтобы открыть существующую базу данных, создания `CDaoDatabase` и вызовите его [откройте](#open) функции-члена.  
  
 Любой из этих методов добавляет объект базы данных DAO коллекции баз данных рабочей области и открывает подключение к данным. При построении затем [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md), или [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) объектов для работы с подключенной базы данных, передайте конструкторы для этих объектов указатель на `CDaoDatabase` объект. После завершения работы с соединение, вызовите [закрыть](#close) члена функции и уничтожать `CDaoDatabase` объекта. **Закрыть** закрывает все наборы записей, ранее не закрыт.  
  
## <a name="transactions"></a>Транзакции  
 Обработка транзакций базы данных предоставляется на уровне рабочей области — в разделе [BeginTrans](../../mfc/reference/cdaoworkspace-class.md#begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#committrans), и [отката](../../mfc/reference/cdaoworkspace-class.md#rollback) функции-члены класса `CDaoWorkspace` .  
  
## <a name="odbc-connections"></a>Подключения ODBC  
 Рекомендуемый способ работы с источниками данных ODBC — присоединение внешних таблиц для Microsoft Jet (. База данных MDB).  
  
## <a name="collections"></a>Коллекции  
 Каждая база данных поддерживает собственный коллекции tabledef, querydef, набор записей и отношения объектов. Класс `CDaoDatabase` предоставляет функции-члены для манипулирования этих объектов.  
  
> [!NOTE]
>  Объекты хранятся в DAO, не в объекте базы данных MFC. MFC предоставляет классы для объектов tabledef и querydef, набор записей, но не для связи объектов.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 `CDaoDatabase`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxdao.h  
  
##  <a name="cantransact"></a>CDaoDatabase::CanTransact  
 Вызовите эту функцию-член для определения, является ли база данных позволяет транзакции.  
  
```  
BOOL CanTransact();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если базы данных поддерживает транзакции. в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Управление транзакциями выполняется в базе данных рабочей области.  
  
##  <a name="canupdate"></a>CDaoDatabase::CanUpdate  
 Вызовите эту функцию-член для определения ли `CDaoDatabase` объект разрешает обновления.  
  
```  
BOOL CanUpdate();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если `CDaoDatabase` объекта позволяет обновлять; иначе — 0, указывающее, либо, которые передана **TRUE** в `bReadOnly` при открытии `CDaoDatabase` объекта или что сама база данных только для чтения. В разделе [откройте](#open) функции-члена.  
  
### <a name="remarks"></a>Примечания  
 Сведения о возможности обновления базы данных см. в разделе «Обновляемые свойства» в справке DAO.  
  
##  <a name="cdaodatabase"></a>CDaoDatabase::CDaoDatabase  
 Создает объект `CDaoDatabase`.  
  
```  
CDaoDatabase(CDaoWorkspace* pWorkspace = NULL);
```  
  
### <a name="parameters"></a>Параметры  
 *pWorkspace*  
 Указатель на `CDaoWorkspace` объект, который будет содержать новый объект базы данных. Чтобы принять значение по умолчанию **NULL**, конструктор создает временную `CDaoWorkspace` объект, который использует рабочая область по умолчанию DAO. Можно получить указатель на объект рабочей области через [m_pWorkspace](#m_pworkspace) члена данных.  
  
### <a name="remarks"></a>Примечания  
 После создания объекта, если вы создаете новый Microsoft Jet (. MDB) базы данных, вызывающие этот объект [создать](#create) функции-члена. При наличии, вместо этого Открытие существующей базы данных, вызывающие этот объект [откройте](#open) функции-члена.  
  
 После завершения работы с объектом, необходимо вызвать его [закрыть](#close) члена функции и затем удалите `CDaoDatabase` объекта.  
  
 Может оказаться удобным для внедрения `CDaoDatabase` объект в классе документа.  
  
> [!NOTE]
>  Объект `CDaoDatabase` объекта также создается неявно при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объект не передается указатель на существующий `CDaoDatabase` объекта. Этот объект базы данных был закрыт при закрытии объекта набора записей.  
  
##  <a name="close"></a>CDaoDatabase::Close  
 Вызовите эту функцию-член для отключения от базы данных и закройте все открытые наборы записей, tabledefs и querydefs, связанные с базой данных.  
  
```  
virtual void Close();
```  
  
### <a name="remarks"></a>Примечания  
 Рекомендуется закрыть эти объекты самостоятельно перед вызовом этой функции-члена. Закрытие `CDaoDatabase` объект удаляется из коллекции баз данных в соответствующем [рабочей](../../mfc/reference/cdaoworkspace-class.md). Поскольку **закрыть** не уничтожает `CDaoDatabase` объекта, можно повторно использовать объект, открыв той же базе данных или другой базе данных.  
  
> [!CAUTION]
>  Вызовите [обновление](../../mfc/reference/cdaorecordset-class.md#update) функции-члена (если имеются ожидающие изменения) и **закрыть** функции-члена для всех объектов открыть набор записей, прежде чем закрыть базу данных. При выходе из функции, которая объявляет [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) или `CDaoDatabase` объектов в стеке, база данных закрывается, все несохраненные изменения будут потеряны, все отложенные транзакции выполняется откат и все несохраненные изменения в данные будут потеряны.  
  
> [!CAUTION]
>  При попытке закрыть объект базы данных, пока открыты все объекты набора записей или при попытке закрытия объекта рабочей области, пока открыты объекты базы данных, принадлежащих определенной рабочей области, эти объекты набора записей будут закрыты и все имеющиеся обновления или изменения будут выполнен откат. При попытке закрытия объекта рабочей области, пока открыты объекты базы данных, размещенные в нем операцию закрывает все объекты базы данных, принадлежащих этому объекту определенную рабочую область, что может привести к объекты незакрытые набора записей, которые будут закрыты. Если вы не закроете объект базы данных, MFC сообщает Сбой утверждения в сборках для отладки.  
  
 Если выйти из функции, не закрывая его объект базы данных, определенные вне области функции, объект базы данных будет оставаться открытым, пока не будет явно закрыт или модуль, в котором определен выходит за пределы области.  
  
##  <a name="create"></a>CDaoDatabase::Create  
 Чтобы создать новый Microsoft Jet (. MDB) базы данных, вызовите эту функцию-член, после создания `CDaoDatabase` объекта.  
  
```  
virtual void Create(
    LPCTSTR lpszName,  
    LPCTSTR lpszLocale = dbLangGeneral,  
    int dwOptions = 0);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строковое выражение, представляющее имя создаваемого файла базы данных. Это может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Необходимо указать имя. Если не указать расширение файла. Добавляется MDB. Ваша сеть поддерживает универсальный соглашение об именах (UNC), можно также указать сетевой путь, например «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB». Только Microsoft Jet (. Файлы MDB) базы данных могут создаваться с помощью этой функции-члена. (В строковые литералы требуются двойную обратную косую черту, так как "\\" escape-символ C++.)  
  
 `lpszLocale`  
 Строковое выражение, используемое, чтобы указать порядок сортировки при создании базы данных. Значение по умолчанию — **dbLangGeneral**. Доступны следующие значения:  
  
- **dbLangGeneral** английский, немецкий, французский, португальский, итальянский и современной  
  
- **dbLangArabic** арабский  
  
- **dbLangCyrillic** русский  
  
- **dbLangCzech** чешский  
  
- **dbLangDutch** голландский  
  
- **dbLangGreek** греческая  
  
- **dbLangHebrew** иврит  
  
- **dbLangHungarian** венгерский  
  
- **dbLangIcelandic** исландская  
  
- **dbLangNordic** Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)  
  
- **dbLangNorwdan** норвежский и датский  
  
- **dbLangPolish** польского языка  
  
- **dbLangSpanish** испанский (традиционный)  
  
- **dbLangSwedfin** шведский и финский  
  
- **dbLangTurkish** для турецкого языка  
  
 `dwOptions`  
 Целое число, которое указывает один или несколько параметров. Доступны следующие значения:  
  
- **dbEncrypt** создания зашифрованной базы данных.  
  
- **dbVersion10** создать базу данных с базы данных Microsoft Jet версии 1.0.  
  
- **dbVersion11** создать базу данных с помощью базы данных Microsoft Jet версии 1.1.  
  
- **dbVersion20** создать базу данных с помощью базы данных Microsoft Jet версии 2.0.  
  
- **dbVersion30** создать базу данных с базы данных Microsoft Jet версии 3.0.  
  
 При отсутствии константа Шифрование незашифрованной базы данных создается. Можно указать только одну версию константа. При отсутствии константа версии базы данных, который использует базу данных Microsoft Jet версии 3.0 создается.  
  
> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если вы реализуете безопасности пользователя и пароль, чтобы сразу прочитать двоичное диска, составляющее базы данных.  
  
### <a name="remarks"></a>Примечания  
 **Создание** создает файл базы данных и базового объекта базы данных DAO и инициализирует объект C++. Объект добавляется к коллекции баз данных связанную рабочую область. Объект базы данных находится в открытом состоянии; Не вызывайте **откройте** после **создать**.  
  
> [!NOTE]
>  С **создать**, можно создать только Microsoft Jet (. Базы данных MDB). Не удается создать базам данных ISAM или баз данных ODBC.  
  
##  <a name="createrelation"></a>CDaoDatabase::CreateRelation  
 Вызовите эту функцию-член для установления связи между одно или несколько полей в основной таблице в базе данных и одно или несколько полей во внешней таблице (другой таблицы в базе данных).  
  
```  
void CreateRelation(
    LPCTSTR lpszName,  
    LPCTSTR lpszTable,  
    LPCTSTR lpszForeignTable,  
    long lAttributes,  
    LPCTSTR lpszField,  
    LPCTSTR lpszForeignField);  
  
void CreateRelation(CDaoRelationInfo& relinfo);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Уникальное имя объекта связи. Имя должно начинаться с буквы и может содержать не более 40 знаков. Он может включать цифры и символы подчеркивания, но не может содержать знаки пунктуации и пробелы.  
  
 `lpszTable`  
 Имя главной таблицы в связи. Если таблица не существует, MFC вызывает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 `lpszForeignTable`  
 Имя внешней таблицы в связи. Если таблица не существует, MFC вызывает исключение типа `CDaoException`.  
  
 `lAttributes`  
 Длинное значение, содержащее сведения о типе связи. Для обеспечения ссылочной целостности, помимо прочего, можно использовать это значение. Можно использовать оператор побитового или ( **&#124;**) для объединения любой из следующих значений (при условии, что комбинация имеет смысл):  
  
- **dbRelationUnique** связи один к одному.  
  
- **dbRelationDontEnforce** отношение не будет принудительно (целостность данных).  
  
- **dbRelationInherited** существует связь в долгосрочной базы данных, который содержит две вложенные таблицы.  
  
- **dbRelationUpdateCascade** обновления происходит каскадом (Дополнительные сведения о каскадные см. примечания).  
  
- **dbRelationDeleteCascade** удаления происходит каскадом.  
  
 *lpszField*  
 Указатель на завершающуюся значением null строка, содержащая имя поля в таблице первичного (с именем `lpszTable`).  
  
 *lpszForeignField*  
 Указатель на завершающуюся значением null строка, содержащая имя поля в таблице внешнего (с именем `lpszForeignTable`).  
  
 *relinfo*  
 Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) , содержащий сведения о связи, необходимо создать.  
  
### <a name="remarks"></a>Примечания  
 Связь не может включать в запрос или подключенной таблицы из внешней базы данных.  
  
 Используйте первая версия функции, подразумевающие связь одного поля в каждой из двух таблиц. Используйте второй версии, если отношение включает в себя несколько полей. Максимальное число полей в отношение равно 14.  
  
 Это действие создает базового объекта DAO отношения, но он реализации MFC, поскольку инкапсуляция MFC отношения объектов, содержащихся в классе `CDaoDatabase`. MFC предоставляет класс для связей.  
  
 При установке связи атрибутов объекта, чтобы активировать операции каскадного ядро СУБД автоматически обновляет или удаляет записи из одной или нескольких таблиц, при внесении изменений в связанные таблицы первичного ключа.  
  
 Например предположим, что установить связь каскадного удаления таблицы Customers и Orders, таблица. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другими таблицами, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.  
  
 Дополнительные сведения см. в разделе «Метод CreateRelation» в справке DAO.  
  
##  <a name="deletequerydef"></a>CDaoDatabase::DeleteQueryDef  
 Вызовите эту функцию-член для удаления указанного querydef — сохраненный запрос — из `CDaoDatabase` QueryDefs-коллекция объекта.  
  
```  
void DeleteQueryDef(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя сохраненного запроса для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого запроса больше не определен в базе данных.  
  
 Дополнительные сведения о создании объектов querydef см. класс [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md). Объект querydef становится связанным с конкретным `CDaoDatabase` объекта при создании `CDaoQueryDef` объекта, передавая указатель на объект базы данных.  
  
##  <a name="deleterelation"></a>CDaoDatabase::DeleteRelation  
 Вызовите эту функцию-член для удаления существующей связи из коллекции отношений объекта базы данных.  
  
```  
void DeleteRelation(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя столбца для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого отношения больше не существует.  
  
 Дополнительные сведения см. в разделе «Удаление Method» в справке DAO.  
  
##  <a name="deletetabledef"></a>CDaoDatabase::DeleteTableDef  
 Вызовите эту функцию-член для удаления указанной таблицы и все его данные из `CDaoDatabase` TableDefs-коллекция объекта.  
  
```  
void DeleteTableDef(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Имя tabledef для удаления.  
  
### <a name="remarks"></a>Примечания  
 После этого этой таблицы больше не определен в базе данных.  
  
> [!NOTE]
>  Будьте очень внимательны при удалении системных таблиц.  
  
 Дополнительные сведения о создании объектов tabledef см. класс [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md). Объект tabledef становится связанным с конкретным `CDaoDatabase` объекта при создании `CDaoTableDef` объекта, передавая указатель на объект базы данных.  
  
 Дополнительные сведения см. в разделе «Удаление Method» в справке DAO.  
  
##  <a name="execute"></a>CDaoDatabase::Execute  
 Вызовите эту функцию-член для выполнения запроса или выполнять инструкции SQL в базе данных.  
  
```  
void Execute(
    LPCTSTR lpszSQL,  
    int nOptions = dbFailOnError);
```  
  
### <a name="parameters"></a>Параметры  
 `lpszSQL`  
 Указатель символом null строку, содержащую допустимый команду SQL для выполнения.  
  
 `nOptions`  
 Целое число, указывающее параметры, относящиеся к целостности запроса. Можно использовать оператор побитового или ( **&#124;**) для объединения любой из следующих констант (условии комбинация имеет смысл, — например, не будут объединены **dbInconsistent** с **dbConsistent**):  
  
- **dbDenyWrite** запретить разрешение на запись для других пользователей.  
  
- **dbInconsistent** несогласованных обновлений (по умолчанию).  
  
- **dbConsistent** согласованности обновлений.  
  
- **dbSQLPassThrough** к серверу SQL. Приводит к передаваться источнику данных ODBC для обработки инструкции SQL.  
  
- **dbFailOnError** откат обновления, если произошла ошибка.  
  
- **dbSeeChanges** формирования ошибки во время выполнения, если другой пользователь изменение данных, вы изменяете.  
  
> [!NOTE]
>  Если оба **dbInconsistent** и **dbConsistent** включаются или если ни один не включены, результатом является значение по умолчанию. Объяснение этих констант см. в разделе «Выполнить метод» в справке DAO.  
  
### <a name="remarks"></a>Примечания  
 **Выполнение** работает только с запросы или запросы к серверу, не возвращающие результатов. Он не работает для запросов select, которые возвращают записи.  
  
 Для определения и сведения о запросах действия см. в разделах «Запрос» и «Выполнить метод» в справке DAO.  
  
> [!TIP]
>  Заданы синтаксическую правильность инструкции SQL, а также соответствующие разрешения **Execute** функции-члена не произойдет, даже если не одной строки, которые можно изменить или удалить. Таким образом, всегда используйте **dbFailOnError** параметр при использовании **Execute** функции-члена для выполните обновление или удаление запроса. Этот параметр вызывает MFC для создания исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md) и выполняет откат всех изменений успешно, если любой из записей, затронутых заблокированы и не может обновить или удалить. Обратите внимание, что всегда можно вызвать `GetRecordsAffected` чтобы увидеть, сколько записи были затронуты.  
  
 Вызовите [GetRecordsAffected](#getrecordsaffected) функции-члена объекта базы данных, чтобы определить количество записей, затронутых последней **Execute** вызова. Например `GetRecordsAffected` возвращает сведения о количестве записей удален, обновления или вставки при выполнении запроса. Число, возвращаемое не будет отражать изменения в связанных таблицах, когда cascade, обновляет или удаляет вступают в силу.  
  
 **Выполнение** не возвращает набор записей. С помощью **Execute** на запрос, который выбирает записи вызывает MFC для создания исключения типа `CDaoException`. (Имеется не `ExecuteSQL` аналогично функции-члена `CDatabase::ExecuteSQL`.)  
  
##  <a name="getconnect"></a>CDaoDatabase::GetConnect  
 Вызовите эту функцию-член для получения строки подключения, используемая для подключения `CDaoDatabase` объекта в базе данных ODBC или ISAM.  
  
```  
CString GetConnect();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если строка соединения [откройте](#open) вызван успешно на источник данных ODBC; в противном случае — пустая строка. Для Microsoft Jet (. Базы данных MDB), строка была всегда пуста, если только они задаются для использования с **dbSQLPassThrough** параметр, используемый с [Execute](#execute) функции-члена или используется при открытии набора записей.  
  
### <a name="remarks"></a>Примечания  
 Строка содержит сведения об источнике открытую базу данных или база данных, используемая в запросе к серверу. Строка подключения состоит из спецификатора типа базы данных и ноль или несколько параметров, разделенных точкой с запятой.  
  
> [!NOTE]
>  С помощью классов MFC DAO для подключения к источнику данных через ODBC является менее эффективным, чем подключение через подключенной таблицы.  
  
> [!NOTE]
>  Строка подключения используется для передачи дополнительных сведений ODBC и некоторые драйверы ISAM при необходимости. Он не используется для. Базы данных MDB. Для базовых таблиц базы данных Microsoft Jet, строка подключения — пустая строка ("») за исключением того, при использовании его для запроса к серверу как описано в разделе возвращают значение в списке.  
  
 В разделе [откройте](#open) функции-члена описание способ создания строки подключения. После настройки строки подключения **откройте** вызов, можно позже использовать его проверка параметра, чтобы определить тип, путь, идентификатор, пароль или ODBC источника данных базы данных.  
  
##  <a name="getname"></a>CDaoDatabase::GetName  
 Вызовите эту функцию-член для извлечения имени в настоящее время открытую базу данных, которое является именем существующего файла базы данных или имя зарегистрированного источника данных ODBC.  
  
```  
CString GetName();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Полный путь и имя файла базы данных, в случае успешного выполнения; в противном случае — пустой [CString](../../atl-mfc-shared/reference/cstringt-class.md).  
  
### <a name="remarks"></a>Примечания  
 Если ваша сеть поддерживает универсальный соглашение об именах (UNC), можно также указать сетевой путь — например, «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (В строковые литералы требуются двойную обратную косую черту, так как "\\" escape-символ C++.)  
  
 Например, можно отобразить это имя в заголовке. Если произошла ошибка при получении имени, MFC вызывает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
> [!NOTE]
>  Для повышения производительности при осуществляется внешних баз данных, рекомендуется подключить таблицы внешней базы данных, в базе данных Microsoft Jet (. MDB) вместо непосредственного подключения к источнику данных.  
  
 Тип базы данных указывается файлу или каталогу, путь указывает, как показано ниже:  
  
|Путь указывает на...|Тип базы данных|  
|--------------------------|-------------------|  
|. MDB-файлу|База данных Microsoft Jet (Microsoft Access)|  
|Каталог, содержащий. Файлы DBF|базы данных dBASE|  
|Каталог, содержащий. XLS-файлов|База данных Microsoft Excel|  
|Каталог, содержащий. PDX файлов|Базы данных Paradox|  
|Каталог, содержащий файлы базы данных соответствующим образом форматированный текст|База данных формата текста|  
  
 Для баз данных ODBC, например SQL Server и Oracle строку подключения базы данных определяет имя источника данных (DSN), зарегистрированный с ODBC.  
  
##  <a name="getquerydefcount"></a>CDaoDatabase::GetQueryDefCount  
 Вызовите эту функцию-член для извлечения номера запросы, определенные в базе данных QueryDefs-коллекция.  
  
```  
short GetQueryDefCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число запросов, определенных в базе данных.  
  
### <a name="remarks"></a>Примечания  
 `GetQueryDefCount`полезно, если требуется перебрать все querydefs в QueryDefs-коллекция. Для получения сведений о данного запроса в коллекции, в разделе [GetQueryDefInfo](#getquerydefinfo).  
  
##  <a name="getquerydefinfo"></a>CDaoDatabase::GetQueryDefInfo  
 Вызовите эту функцию-член для получения различную информацию о запросе, определенные в базе данных.  
  
```  
void GetQueryDefInfo(
    int nIndex,  
    CDaoQueryDefInfo& querydefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetQueryDefInfo(
    LPCTSTR lpszName,  
    CDaoQueryDefInfo& querydefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс предопределенного запроса в базе данных QueryDefs-коллекция, для поиска по индексу.  
  
 *querydefinfo*  
 Ссылку на [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) объект, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, определяющие, какой набор записей для извлечения. Ниже перечислены доступные параметры и как они вызвать функцию возврата о набор записей:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя, тип  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения о первичном: Дата создания, Дата последнего обновления, возвращает записи, возможно обновление  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: SQL, соединение, время ожидания ODBC  
  
 `lpszName`  
 Строка, содержащая имя запроса, определенные в базе данных, для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии функции предоставляются, поэтому можно выбрать запрос по индексу в коллекции QueryDefs базы данных или по имени запроса.  
  
 Описание сведений, возвращаемых в *querydefinfo*, в разделе [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. Если пользователь запрашивает один уровень данных, вы получаете все предыдущие уровни подобных сведений.  
  
##  <a name="getquerytimeout"></a>CDaoDatabase::GetQueryTimeout  
 Вызовите эту функцию-член для извлечения текущее количество секунд, по истечении которого истекло в последующих операциях в подключенной базы данных.  
  
```  
short GetQueryTimeout();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Короткое целое число, содержащее значение времени ожидания в секундах.  
  
### <a name="remarks"></a>Примечания  
 Время ожидания операции может истекло из-за проблем доступа к сети, время обработки запроса слишком и т. д. Пока действует параметр, он влияет на все открытые, добавить новые, обновление и удаление операций на любые наборы записей, связанных с этим `CDaoDatabase` объекта. Текущее значение времени ожидания можно изменить с помощью [SetQueryTimeout](#setquerytimeout). Изменение значение времени ожидания запроса для набора записей после открытия не изменяет значение для набора записей. Например, последующие [переместить](../../mfc/reference/cdaorecordset-class.md#move) операций следует использовать новое значение. Значение по умолчанию изначально установлено при инициализации компонент database engine.  
  
 Значение по умолчанию для времени ожидания запросов берется из реестра Windows. Если параметр реестра отсутствует, значение по умолчанию — 60 секунд. Не все базы данных поддерживают возможность задать значение времени ожидания запроса. Если задано значение 0, время ожидания запроса происходит без времени ожидания; и взаимодействия с базой данных может перестать отвечать на запросы. Это поведение может оказаться полезным во время разработки. Если вызов завершается ошибкой, MFC вызывает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.  
  
##  <a name="getrecordsaffected"></a>CDaoDatabase::GetRecordsAffected  
 Вызовите эту функцию-член для определения числа записей, затронутых последней вызов [Execute](#execute) функции-члена.  
  
```  
long GetRecordsAffected();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Длинное целое число, содержащее количество обработанных записей.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение включает число записей удален, обновлении или вставке, запрос на запуск с **Execute**. Число, возвращаемое не будет отражать изменения в связанных таблицах, когда cascade, обновляет или удаляет вступают в силу.  
  
 Дополнительные сведения см. в разделе «Свойство RecordsAffected» в справке DAO.  
  
##  <a name="getrelationcount"></a>CDaoDatabase::GetRelationCount  
 Вызовите эту функцию-член, чтобы получить номер взаимоотношений, определенных между таблицами в базе данных.  
  
```  
short GetRelationCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество связей, определенных между таблицами в базе данных.  
  
### <a name="remarks"></a>Примечания  
 **GetRelationCount** полезно, если необходимо перебрать все отношения, определенные в коллекции связей базы данных. Для получения сведений о данное отношение в коллекции, в разделе [GetRelationInfo](#getrelationinfo).  
  
 Чтобы проиллюстрировать концепцию отношения, рассмотрим таблицу Suppliers и таблицы Products, которую может имеют связь «один ко многим». В этом отношении один поставщик может предоставлять более одного продукта. Другие отношения — одному "и" многие ко многим.  
  
##  <a name="getrelationinfo"></a>CDaoDatabase::GetRelationInfo  
 Вызовите эту функцию-член для получения сведений об указанной связи в коллекции связей базы данных.  
  
```  
void GetRelationInfo(
    int nIndex,  
    CDaoRelationInfo& relinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetRelationInfo(
    LPCTSTR lpszName,  
    CDaoRelationInfo& relinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс в коллекции связей базы данных, для поиска по индексу объект связи.  
  
 *relinfo*  
 Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) объект, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, указывающие, какие сведения о связи для получения. Ниже перечислены доступные параметры и как они вызвать функцию возврата о связи:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя таблицы, внешние таблицы  
  
- `AFX_DAO_SECONDARY_INFO`Атрибуты, сведений о поле  
  
 Сведения о поле — [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) объект, содержащий поля из главной таблицы, участвующие в связи.  
  
 `lpszName`  
 Строка, содержащая имя объекта связи для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии этой функции предоставляют доступ по индексу или по имени. Описание сведений, возвращаемых в *relinfo*, в разделе [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. Если пользователь запрашивает сведения на одном уровне, можно также получить сведения во все предыдущие уровни.  
  
> [!NOTE]
>  Если задать связь атрибутов объекта, чтобы активировать операции каскадного ( **dbRelationUpdateCascades** или **dbRelationDeleteCascades**), автоматически обновляет базы данных Microsoft Jet или Удаляет записи из одной или нескольких таблиц, при внесении изменений в связанные таблицы первичного ключа. Например предположим, что установить связь каскадного удаления таблицы Customers и Orders, таблица. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другими таблицами, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.  
  
##  <a name="gettabledefcount"></a>CDaoDatabase::GetTableDefCount  
 Вызовите эту функцию-член для извлечения нескольких таблиц, определенных в базе данных.  
  
```  
short GetTableDefCount();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число tabledefs, определенные в базе данных.  
  
### <a name="remarks"></a>Примечания  
 `GetTableDefCount`полезно, если необходимо перебрать все tabledefs в TableDefs-коллекция базы данных. Чтобы получить сведения о данной таблицы в коллекции, в разделе [GetTableDefInfo](#gettabledefinfo).  
  
##  <a name="gettabledefinfo"></a>CDaoDatabase::GetTableDefInfo  
 Вызовите эту функцию-член для получения различного рода сведения о таблице, определенные в базе данных.  
  
```  
void GetTableDefInfo(
    int nIndex,  
    CDaoTableDefInfo& tabledefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

 
void GetTableDefInfo(
    LPCTSTR lpszName,  
    CDaoTableDefInfo& tabledefinfo,  
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```  
  
### <a name="parameters"></a>Параметры  
 `nIndex`  
 Индекс объекта tabledef в базе данных TableDefs-коллекция, для поиска по индексу.  
  
 `tabledefinfo`  
 Ссылку на [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) объект, который возвращает запрошенные данные.  
  
 `dwInfoOptions`  
 Параметры, определяющие, какие таблицы для извлечения. Ниже перечислены доступные параметры и как они вызвать функцию возврата о связи:  
  
- `AFX_DAO_PRIMARY_INFO`(По умолчанию) Имя обновляемой, атрибуты  
  
- `AFX_DAO_SECONDARY_INFO`А также сведения о первичном: Дата создания, Дата последнего обновления, имя исходной таблицы, подключение  
  
- `AFX_DAO_ALL_INFO`Основной и дополнительной информации плюс: число записей правила проверки, текст проверки  
  
 `lpszName`  
 Имя объекта tabledef для поиска по имени.  
  
### <a name="remarks"></a>Примечания  
 Две версии функции предоставляются, поэтому можно выбрать таблицу, индекс в коллекции TableDefs базы данных или имя таблицы.  
  
 Описание сведений, возвращаемых в `tabledefinfo`, в разделе [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании `dwInfoOptions`. При запросе информации на одном уровне, вы получаете сведения всех предыдущих уровней.  
  
> [!NOTE]
>  `AFX_DAO_ALL_INFO` Параметр предоставляет сведения, которые могут выполняться медленно для получения. В этом случае подсчет строк в таблице может быть очень много времени, если существует много записей.  
  
##  <a name="getversion"></a>CDaoDatabase::GetVersion  
 Вызовите эту функцию-член для определения версии файла базы данных Microsoft Jet.  
  
```  
CString GetVersion();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию файла базы данных, связанный с объектом.  
  
### <a name="remarks"></a>Примечания  
 Возвращаемое значение представляет номер версии в виде «основной.дополнительный»; например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точку и номер выпуска (0). Версии до даты являются 1.0, 1.1, 2.0 и 3.0.  
  
 Дополнительные сведения см. в разделе «Версии свойство» в справке DAO.  
  
##  <a name="isopen"></a>CDaoDatabase::IsOpen  
 Вызовите эту функцию-член для определения ли `CDaoDatabase` объекта в данный момент открыт в базе данных.  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если `CDaoDatabase` объекта в данный момент открыт; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
  
##  <a name="m_pdaodatabase"></a>CDaoDatabase::m_pDAODatabase  
 Содержит указатель на интерфейс OLE для базового объекта базы данных DAO `CDaoDatabase` объекта.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот указатель, если требуется прямой доступ к интерфейсу DAO.  
  
 Сведения о вызовах DAO напрямую, содержатся [Технические заметки 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  
  
##  <a name="m_pworkspace"></a>CDaoDatabase::m_pWorkspace  
 Содержит указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) , содержащий объект базы данных.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот указатель, если требуется прямой доступ к рабочей области, например, чтобы получить указатели на объекты базы данных в коллекции баз данных рабочей области.  
  
##  <a name="open"></a>CDaoDatabase::Open  
 Необходимо вызвать эту функцию-член для инициализации нового созданного `CDaoDatabase` , представляющий существующей базы данных.  
  
```  
virtual void Open(
    LPCTSTR lpszName,  
    BOOL bExclusive = FALSE,  
    BOOL bReadOnly = FALSE,  
    LPCTSTR lpszConnect = _T(""));
```  
  
### <a name="parameters"></a>Параметры  
 `lpszName`  
 Строковое выражение, которое является именем существующего Microsoft Jet (. Файл базы данных MDB). Если имя файла имеет расширение, оно является обязательным. Ваша сеть поддерживает универсальный соглашение об именах (UNC), можно также указать сетевой путь, например «\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (В строковые литералы требуются двойную обратную косую черту, так как "\\" escape-символ C++.)  
  
 Некоторые рекомендации применимы только при использовании `lpszName`. Если он:  
  
-   Ссылается на базу данных, которая уже открыта для монопольного доступа другим пользователем, MFC выдает исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md). Перехват этого исключения, чтобы пользователь знать, что база данных недоступна.  
  
-   Является пустой строкой ("») и *lpszConnect* — «ODBC;», отображается диалоговое окно со списком всех зарегистрированных имен источников данных ODBC, поэтому пользователь может выбрать базу данных. Следует избегать прямые подключения к источникам данных ODBC; Вместо этого используйте подключенной таблицы.  
  
-   В противном случае не ссылаться на существующую базу данных или допустимый источник данных ODBC, MFC выдает исключения типа `CDaoException`.  
  
> [!NOTE]
>  Дополнительные сведения о кодах ошибок, DAO см. в разделе DAOERR. H-файл. Дополнительные сведения см. в разделе «Перехватываемая ошибками доступа к данным» в справке DAO.  
  
 `bExclusive`  
 Логическое значение, которое является **TRUE** если она будет открыт для монопольного доступа (не являющихся общими) и **FALSE** Если база данных будет открыт для общего доступа. Если этот аргумент опущен, база данных открыта для общего доступа.  
  
 `bReadOnly`  
 Логическое значение, которое является **TRUE** должен быть открыт для доступа только для чтения базы данных и **FALSE** Если база данных будет открыт для чтения и записи. Если этот аргумент опущен, база данных открыта для чтения и записи. Этот атрибут, наследуют все зависимые наборы записей.  
  
 `lpszConnect`  
 Строковое выражение, используемое для открытия базы данных. Эта строка представляет ODBC подключения аргументов. Необходимо указать аргументы счетчика исключающих и только для чтения для предоставления строки источника. Если база данных является базой данных Microsoft Jet (. MDB), эта строка пуста (»»). Синтаксис для значения по умолчанию — **_T**("») — обеспечивает совместимость для Юникода, а также ANSI сборок приложения.  
  
### <a name="remarks"></a>Примечания  
 **Откройте** связывает базу данных с базовым объектом DAO. Объект базы данных нельзя использовать для создания набора записей, tabledef или querydef объектов до его инициализации. **Откройте** добавляет объект базы данных в коллекцию баз данных связанную рабочую область.  
  
 Используйте параметры следующим образом:  
  
-   При открытии Microsoft Jet (. Базы данных MDB), используйте `lpszName` параметр и передайте, пустая строка, для `lpszConnect` параметра или передайте Строка пароля формы «; PWD = пароль», если база данных находится в защищенной паролем (. MDB баз данных только).  
  
-   При открытии источника данных ODBC, передайте допустимую строку соединения ODBC в `lpszConnect` и пустая строка в `lpszName`.  
  
 Дополнительные сведения см. в разделе «Метод OpenDatabase» в справке DAO.  
  
> [!NOTE]
>  Для повышения производительности при обращении к внешних баз данных, включая базам данных ISAM и источники данных ODBC, рекомендуется подключить таблицы внешней базы данных, в базе данных Microsoft Jet Database engine (. MDB) вместо непосредственного подключения к источнику данных.  
  
 Это возможно для попытки подключения к времени ожидания, недоступность, например, узел СУБД. Если попытка соединения завершается неудачно, **откройте** возникло исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).  
  
 Оставшиеся примечания относятся только к базам данных ODBC.  
  
 Если база данных находится в базе данных ODBC и параметры в вашей **откройте** вызова не содержат достаточно сведений для подключения, драйвер ODBC открывает диалоговое окно, чтобы получить необходимые сведения от пользователя. При вызове **откройте**, строки подключения, `lpszConnect`, хранится в частном порядке и по телефону [GetConnect](#getconnect) функции-члена.  
  
 Если вы хотите, можно открыть собственное диалоговое перед вызовом метода **откройте** для получения сведений от пользователя, таких как пароль, затем добавьте эти сведения в строку подключения, передаваемый **откройте**. Или может потребоваться сохранить строку подключения, передайте (возможно, в реестре Windows), ее можно повторно использовать следующий раз приложение вызывает **откройте** на `CDaoDatabase` объекта.  
  
 Также можно использовать строку подключения для нескольких уровней авторизацию входа (каждый из них на другое `CDaoDatabase` объекта) или для передачи сведений о других сведений, относящихся к базе данных.  
  
##  <a name="setquerytimeout"></a>CDaoDatabase::SetQueryTimeout  
 Вызовите эту функцию-член для переопределения по умолчанию число секунд, чтобы разрешить до последующие операции на время ожидания подключенной базы данных.  
  
```  
void SetQueryTimeout(short nSeconds);
```  
  
### <a name="parameters"></a>Параметры  
 `nSeconds`  
 Чтобы разрешить до попытки запроса в секундах время ожидания.  
  
### <a name="remarks"></a>Примечания  
 Время ожидания операции может истекло из-за проблем доступа к сети, время обработки запроса слишком и т. д. Вызовите `SetQueryTimeout` перед открытием набора записей или перед вызовом набора записей [AddNew](../../mfc/reference/cdaorecordset-class.md#addnew), [обновление](../../mfc/reference/cdaorecordset-class.md#update), или [удалить](../../mfc/reference/cdaorecordset-class.md#delete) функций-членов. Если вы хотите изменить запрос значение времени ожидания. Параметр влияет на все последующие [откройте](../../mfc/reference/cdaorecordset-class.md#open), `AddNew`, **обновление**, и **удаление** вызовы все наборы записей, связанных с этим `CDaoDatabase` объекта. Изменение значение времени ожидания запроса для набора записей после открытия не изменяет значение для набора записей. Например, последующие [переместить](../../mfc/reference/cdaorecordset-class.md#move) операций следует использовать новое значение.  
  
 Значение по умолчанию для времени ожидания запросов составляет 60 секунд. Не все базы данных поддерживают возможность задать значение времени ожидания запроса. Если задано значение 0, время ожидания запроса происходит без времени ожидания; взаимодействие с базой данных может перестать отвечать на запросы. Это поведение может оказаться полезным во время разработки.  
  
 Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.  
  
## <a name="see-also"></a>См. также  
 [CObject-класс](../../mfc/reference/cobject-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)   
 [CDaoRecordset-класс](../../mfc/reference/cdaorecordset-class.md)   
 [Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)   
 [Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)   
 [CDatabase-класс](../../mfc/reference/cdatabase-class.md)   
 [Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
