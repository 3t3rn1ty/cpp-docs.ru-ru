---
title: Настройка мыши и клавиатуры | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- customizations [MFC], keyboard and mouse (MFC Extensions)
- keyboard and mouse customizations (MFC Extensions)
ms.assetid: 1f789f1b-5f2e-4b11-b974-e3e2a2e49d82
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 8fda670198dd9bd03a6d944ce4db70542926bf41
ms.sourcegitcommit: 060f381fe0807107ec26c18b46d3fcb859d8d2e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36931584"
---
# <a name="keyboard-and-mouse-customization"></a>Настройка мыши и клавиатуры
MFC пользователь приложения, чтобы настроить способ обработки ввода мыши и клавиатуры. Пользователь может настроить ввод с клавиатуры, назначив сочетания клавиш для команд. Также пользователь может настроить ввода мыши, выбрав команду, который должен быть выполнен, когда пользователь дважды щелкает внутри конкретного окна приложения. В этом разделе объясняется, как настроить входные данные для приложения.  
  
 В **настройки** диалоговое окно, пользователь может изменить пользовательские элементы управления для клавиатуры и мыши. Чтобы отобразить это диалоговое окно предназначено, пользователь указывает **Настройка** на **представление** меню, а затем нажимает **панелей инструментов и закрепление**. В диалоговом окне пользователь щелкает **клавиатуры** вкладка или **мыши** вкладки.  
  
## <a name="keyboard-customization"></a>Настройка клавиатуры  
 На следующем рисунке показана **клавиатуры** вкладке **настройки** диалоговое окно.  
  
 ![Вкладка "Клавиатура" в диалоговом окне настройки](../mfc/media/mfcnextkeyboardtab.png "mfcnextkeyboardtab")  
Вкладка настройки клавиатуры  
  
 Пользователь взаимодействует с вкладка "Клавиатура", чтобы назначить один или несколько сочетаний клавиш команды. Доступные команды отображаются на левой стороне вкладки. Пользователь может выбрать любые доступные команды в меню. Только команды меню можно связать с сочетанием клавиш. После ввода пользователем новый ярлык **назначить** становится доступной кнопка. При нажатии этой кнопки, приложение связывает выбранную команду с помощью этого ярлыка.  
  
 Все в настоящее время назначенных сочетаний клавиш, перечислены в списке в правом столбце. Пользователь также можно выбрать отдельные ярлыки и удалить их или сбросить все сопоставления для приложения.  
  
 Если вы хотите поддерживать эту настройку в приложении, необходимо создать [CKeyboardManager](../mfc/reference/ckeyboardmanager-class.md) объекта. Для создания `CKeyboardManager` объекта, вызовите функцию [CWinAppEx::InitKeyboardManager](../mfc/reference/cwinappex-class.md#initkeyboardmanager). Этот метод создает и инициализирует диспетчер клавиатуры. При создании клавиатуру manager вручную, по-прежнему необходимо вызвать `CWinAppEx::InitKeyboardManager` его инициализации.  
  
 При использовании мастера для создания приложения, мастер будет запущен диспетчер клавиатуры. После инициализации диспетчера клавиатуры приложения среда добавит **клавиатуры** вкладку **настройки** диалоговое окно.  
  
## <a name="mouse-customization"></a>Настройка мыши  
 На следующем рисунке показана **мыши** вкладке **настройки** диалоговое окно.  
  
 ![Вкладка "Мышь" в диалоговом окне настройки](../mfc/media/mfcnextmousetab.png "mfcnextmousetab")  
Вкладка настройки мыши  
  
 Пользователь взаимодействует с на этой вкладке, чтобы назначить это меню команды мыши двойного щелчка. Пользователь выбирает представления с левой стороны окна и затем использует элементы управления на правой стороне для связывания команды с действие двойного щелчка. Когда пользователь щелкает **закрыть**, приложение выполняет связанная команда всякий раз, когда пользователь дважды щелкает любое место в представлении.  
  
 По умолчанию при создании приложения с помощью мастера настройки мыши не включена.  
  
#### <a name="to-enable-mouse-customization"></a>Для включения настройки мыши  
  
1.  Инициализация [CMouseManager](../mfc/reference/cmousemanager-class.md) путем вызова метода [CWinAppEx::InitMouseManager](../mfc/reference/cwinappex-class.md#initmousemanager).  
  
2.  Получить указатель мыши manager с помощью [CWinAppEx::GetMouseManager](../mfc/reference/cwinappex-class.md#getmousemanager).  
  
3.  Добавление представления с помощью мыши диспетчера [CMouseManager::AddView](../mfc/reference/cmousemanager-class.md#addview) метод. Это необходимо сделайте для каждого представления, который вы хотите добавить в диспетчер мыши.  
  
 После инициализации диспетчера мыши приложения среда добавит **мыши** вкладку **Настройка** диалоговое окно. Если вы не добавлять какие-либо представления, доступ к вкладке вызывает необработанное исключение. После создания список представлений, **мыши** вкладка доступна пользователю.  
  
 При добавлении нового представления к диспетчеру мыши ей уникальный идентификатор. Если вы хотите поддерживать настройки мыши для окна, необходимо обработать сообщение WM_LBUTTONDBLCLICK и вызывают функцию [CWinAppEx::OnViewDoubleClick](../mfc/reference/cwinappex-class.md#onviewdoubleclick) функции. При вызове этой функции, один параметр — идентификатор для этого окна. Он является обязанностью программиста для отслеживания номера Идентификаторов и объекты, связанные с ними.  
  
## <a name="security-concerns"></a>Проблемы безопасности  
 Как описано в [определенные пользователем инструменты](../mfc/user-defined-tools.md), пользователь может связать идентификатор определяемый пользователем инструмент с событие двойного щелчка. При двойном щелчке представления, приложение ищет пользовательский инструмент, соответствующий связанный идентификатор. Если приложение находит подходящий инструмент, он выполняет программу. Если приложение не может найти подходящий инструмент, он отправляет сообщение WM_COMMAND с Идентификатором представления, который был дважды щелкнут.  
  
 Измененные параметры хранятся в реестре. Путем редактирования реестра, злоумышленник может заменить произвольную команду средство идентификатор пользователя недопустим. При двойном щелчке представления, представление обрабатывает команду, которая высадки злоумышленник. Это может привести к непредвиденным и потенциально опасное поведение.  
  
 Кроме того такого рода атак может обойти меры безопасности интерфейса пользователя. Например предположим, что приложение имеет печати отключена. То есть в своем пользовательском интерфейсе **печати** меню и кнопки будут недоступны. Обычно это запрещает печать в приложении. Но если злоумышленник изменения в реестр, пользователь может теперь может отправлять команды print непосредственно двойным щелчком представления, обход элементы пользовательского интерфейса, которые недоступны.  
  
 Чтобы защититься от атак этого типа, добавьте код в обработчик команд вашего приложения для проверки допустимости команду перед его выполнением. Не полагайтесь на пользовательский интерфейс, чтобы предотвратить отправку приложению команду.  
  
## <a name="see-also"></a>См. также  
 [Настройка для MFC](../mfc/customization-for-mfc.md)   
 [Класс CKeyboardManager](../mfc/reference/ckeyboardmanager-class.md)   
 [Класс CMouseManager](../mfc/reference/cmousemanager-class.md)   
 [Вопросы безопасности во время настройки](../mfc/security-implications-of-customization.md)

