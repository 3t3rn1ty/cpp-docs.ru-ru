---
title: 'TN048: Написание программ настройки ODBC и администрирования для приложений баз данных MFC | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- vc.mfc.odbc
dev_langs:
- C++
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: a7d89b6c6e05a5baf973abace2c64de3b52754f5
ms.sourcegitcommit: c6b095c5f3de7533fd535d679bfee0503e5a1d91
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2018
ms.locfileid: "36954561"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC
> [!NOTE]
>  Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.  
  
 Приложения, использующие классы баз данных MFC потребуется программу установки, которая устанавливает компоненты ODBC. Также может понадобиться программы администрирования ODBC, который будет извлекать сведения о доступных драйверов, чтобы указать драйверов по умолчанию и настроить источники данных. Эта заметка описывает использование API-интерфейса установщика ODBC для записи этих программ.  
  
##  <a name="_mfcnotes_writing_an_odbc_setup_program"></a> Запись программы установки ODBC  
 Приложения баз данных MFC требуется диспетчер драйверов ODBC (ODBC. Библиотека DLL) и драйверы ODBC, чтобы иметь возможность получить к источникам данных. Многие драйверы ODBC также требуют дополнительных библиотек сети и обмен данными. Большинство драйверы ODBC поставляются с программы установки, которая используется для установки необходимых компонентов ODBC. Разработчики приложений с помощью MFC-классы баз данных можно:  
  
-   Использовать программу установки драйвера для установки компонентов ODBC. Для этого потребуется никаких дальнейших действий со стороны разработчика — можно просто повторно распространить программы установки драйвера.  
  
-   Кроме того можно написать собственные программы установки для установки диспетчера драйверов и драйвер.  
  
 API-интерфейса установщика ODBC можно использовать для написания программы установки приложения. Функции API-интерфейса установщика реализуются с помощью установщика ODBC библиотеки DLL — ODBCINST. Библиотеки DLL на 16-разрядной версии Windows и ODBCCP32. Библиотеки DLL для Win32. Приложение может вызвать `SQLInstallODBC` установщика библиотеки DLL, которая будет установить диспетчер драйверов ODBC, драйверов ODBC и любые необходимые трансляторы. Затем записывает установленных драйверов и трансляторы в ODBCINST. INI-файл (или реестра в NT). `SQLInstallODBC` требуется полный путь к ODBC. INF-файл, который содержит список драйверов должны быть установлены и описывает файлы, которые составляют каждого драйвера. Он также содержит аналогичные сведения о диспетчера драйверов и трансляторы. ODBC. INF-файлов обычно предоставляются разработчиками драйвера.  
  
 Программу можно также установить отдельные компоненты ODBC. Чтобы установить диспетчер драйверов, программа сначала вызывает `SQLInstallDriverManager` установщика DLL получить целевой каталог для диспетчера драйверов. Обычно это каталог, в которой находятся библиотеки DLL Windows. Затем программа использует информацию в разделе [Диспетчер драйверов ODBC] ODBC. INF-файл для копирования диспетчера драйверов и связанные файлы с установочного диска в этот каталог. Чтобы установить отдельным драйвером, программа сначала вызывает `SQLInstallDriver` в DLL, чтобы добавить драйвер спецификации ODBCINST программу установки. INI-файл (или реестра в NT). `SQLInstallDriver` Возвращает целевой каталог драйверов, обычно каталог, в котором находятся библиотек DLL. Затем программа использует информацию в разделе драйверов ODBC. INF-файл для копирования DLL-Библиотека драйвера и связанные файлы с установочного диска в этот каталог.  
  
 Дополнительные сведения о ODBC. INF, ODBCINST. INI и с помощью установщика API, в разделе ODBC SDK *Справочник программиста* Глава 19, установка программного обеспечения ODBC.  
  
##  <a name="_mfcnotes_writing_an_odbc_administrator"></a> Запись администратора ODBC  
 Приложения базы данных MFC можно установить и настроить источники данных ODBC в одном из двух способов, следующим образом:  
  
-   Используйте администратор ODBC (доступно как программа или компонент панели управления).  
  
-   Создайте собственную программу для настройки источников данных.  
  
 Программа, которая служит для настройки источников данных вызывает функцию установщика DLL. Установщик DLL вызов установки библиотеки DLL для настройки источника данных. Имеется один DLL-файлов установки для каждого из драйверов; Возможно, драйвер самой библиотеки DLL или отдельную библиотеку DLL. DLL-файлов установки запрашивает пользователя сведения, необходимые драйверу для подключения к источнику данных и преобразователь по умолчанию, если поддерживается. Затем он вызывает установщик DLL и API-интерфейсы Windows, чтобы записать эти сведения в ODBC. INI-файл (или реестра).  
  
 Чтобы отобразить диалоговое окно, с помощью которого пользователь можно добавлять, изменять и удалять источники данных, программа вызывает `SQLManageDataSources` в программе установки библиотеки DLL. Эта функция вызывается, когда установщик DLL вызывается с помощью панели управления. Чтобы добавить, изменить или удалить источник данных `SQLManageDataSources` вызовы `ConfigDSN` в DLL-файлов установки драйвера, связанного с этого источника данных. Чтобы напрямую добавлять, изменять или удалять данные источники, программа вызывает `SQLConfigDataSource` в программе установки библиотеки DLL. Программа передает имя источника данных и параметр, который указывает действие, предпринимаемое. `SQLConfigDataSource` вызовы `ConfigDSN` в DLL-файлов установки и передает его аргументы из `SQLConfigDataSource`.  
  
 Дополнительные сведения см. в разделе ODBC SDK *Справочник программиста* Глава 23, ссылка на функцию установки библиотеки DLL и Глава 24, ссылка на функцию DLL установщика.  
  
## <a name="see-also"></a>См. также  
 [Технические примечания по номеру](../mfc/technical-notes-by-number.md)   
 [Технические примечания по категории](../mfc/technical-notes-by-category.md)

