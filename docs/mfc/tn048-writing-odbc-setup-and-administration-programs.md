---
title: "TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.mfc.odbc"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "установка ODBC"
  - "MFC - библиотека, приложения баз данных"
  - "ODBC, и MFC"
  - "ODBC, установка"
  - "установка, программы установки ODBC"
  - "TN048"
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
caps.latest.revision: 9
caps.handback.revision: 5
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

> [!NOTE]
>  Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию.  В результате некоторые процедуры и разделы могут быть устаревшими или неверными.  Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.  
  
 Приложения с помощью классов MFC базы данных требует, программа установки установит компоненты ODBC.  Они могут также программу администрирования ODBC, которая получает сведения о доступных драйверов, чтобы определить драйвера по умолчанию и настройки источников данных.  Эта заметка описывается использование api\-интерфейса установщика ODBC запись данных программы.  
  
##  <a name="_mfcnotes_writing_an_odbc_setup_program"></a> При создании программы установки ODBC  
 Приложения баз данных MFC требует диспетчера драйверов ODBC \(ODBC.DLL\) и драйверы ODBC могут обращаться к источникам данных.  Многие драйверы ODBC также требуют дополнительных DLL сети и взаимодействия.  Большинство драйверов ODBC, поставляемых с программой установки установит необходимые компоненты ODBC.  Разработчики приложений с помощью классов MFC базы данных можно:  
  
-   Полагаться на том драйвер\- для установки для установки компонентов ODBC.  Это не требует дальнейших действий с части разработчика — можно просто распространение программа установки драйвера.  
  
-   Кроме того, можно написать собственную программу установки, которая установит диспетчер драйверов и драйвер.  
  
 Api\-интерфейса установщика ODBC могут использоваться для создания конкретного приложения программы установки.  В функции API установщика реализованы DLL установщика ODBC — ODBCINST.DLL на 16 разрядном Windows и ODBCCP32.DLL в Win32.  Приложение может вызвать метод **SQLInstallODBC** в библиотеке DLL установщика, который установит диспетчер драйверов ODBC, драйверы ODBC, и все необходимые переводчики.  Затем пишет установка драйверов и переводчиков в файле ODBCINST.INI \(или в реестре, NT\).  **SQLInstallODBC** требуется полный путь к файлу ODBC.INF, который содержит список драйверов, настройку и описаны файлы, которые состоят из каждого драйвера.  Он также содержит нужную информацию о диспетчере и переводчиках драйвера.  Файлы ODBC.INF обычно предоставляются разработчиками драйвера.  
  
 Программа может также создать отдельные компоненты ODBC.  Настроить диспетчер драйверов, сначала вызывает **SQLInstallDriverManager** программы в библиотеке DLL установщика для получения целевой каталог для диспетчера драйверов.  Обычно это каталог, в котором находятся DLL Windows.  Затем программа использует сведения в разделе диспетчера драйвера \[ODBC\] ODBC.INF файла для копирования диспетчер драйверов и связанные файлы с диска установки в этот каталог.  Установка этому драйвер, сначала вызывает **SQLInstallDriver** программы в библиотеке DLL установщика для добавления спецификация драйвера в файл ODBCINST.INI \(или реестр, на NT\).  **SQLInstallDriver** возвращает целевой каталог драйвера — обычно каталог, в котором находятся DLL Windows.  Затем программа использует сведения в разделе драйвера файла ODBC.INF для копирования DLL драйвера и связанные файлы с диска установки в этот каталог.  
  
 Дополнительные сведения о ODBC.INF, ODBCINST.INI и использованием API\-интерфейса установщика см. в *справочнике программиста* ODBC SDK, глава 19 "Установка программного обеспечения ODBC".  
  
##  <a name="_mfcnotes_writing_an_odbc_administrator"></a> Использовать администратор ODBC  
 Приложения баз данных MFC может установить и настроить источники данных ODBC в одном из 2 способами, следующим образом:  
  
-   Используйте администратор ODBC \(доступны как программа или в качестве элемента панели управления\).  
  
-   Создайте собственную программу для настройки источников данных.  
  
 Программы, настроить источники данных осуществляет вызовы функций в библиотеке DLL установщика.  Библиотека DLL установщика вызывает установки библиотеки DLL для настройки источника данных.  Одно установки библиотеки DLL для каждого драйвера; это может являться dll\-файлом самим драйвером, или отдельной библиотеки DLL.  Библиотека DLL настройки предлагает пользователю для сведений, драйверу для подключения к источнику данных и переводчику по умолчанию, если поддерживается.  Затем он вызывает библиотеку DLL и api\-интерфейса установщика Windows, чтобы записать эти сведения в файле ODBC.INI \(или реестре\).  
  
 Чтобы отобразить диалоговое окно, в котором пользователь может добавлять, изменять и удалять источники данных, вызовы **SQLManageDataSources** программы в библиотеке DLL установщика.  Эта функция вызывается, когда библиотека DLL установщика вызываться на панели управления.  Для добавления изменения или удаления источника данных, функция **SQLManageDataSources** вызывает **ConfigDSN** в установку библиотеки DLL для драйвера, связанного с этим источником данных.  Непосредственно для добавления, изменения или удаления источников данных, программа вызывает **SQLConfigDataSource** в библиотеке DLL установщика.  Программа передает имя источника данных и параметра, который определяет действия, которые следует предпринять.  **SQLConfigDataSource** вызывает **ConfigDSN** в установку библиотеки DLL и передает его аргументы из **SQLConfigDataSource**.  
  
 Дополнительные сведения см. в *справочнике программиста* ODBC SDK, глава 23, "Установка функциональной ссылки на DLL", и глава 24, "Справочник по DLL\-функции установщика".  
  
## См. также  
 [Технические примечания по номеру](../mfc/technical-notes-by-number.md)   
 [Технические примечания по категории](../mfc/technical-notes-by-category.md)