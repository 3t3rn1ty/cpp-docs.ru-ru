---
title: "Буфер обмена. Использование механизма буфера обмена OLE | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "приложения [OLE], буфер обмена"
  - "буфер обмена [C++], OLE - форматы"
  - "форматы [C++], Буфер обмена для OLE"
  - "Буфер обмена OLE"
  - "Буфер обмена OLE, форматы"
ms.assetid: 229cc610-5bb1-435e-bd20-2c8b9964d1af
caps.latest.revision: 11
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Буфер обмена. Использование механизма буфера обмена OLE
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

OLE использует стандартные форматы и некоторые форматы OLE\-, для передачи данных через буфер обмена.  
  
 При вырежете или копировать данные из приложения, данные хранятся в буфере обмена, который будет использоваться далее в операциях ".  Эти данные в различных форматах.  Когда пользователь выбирает вставить данные из буфера обмена, приложение может выбрать, этих форматов, которые требуется использовать.  Приложение должно быть написано, чтобы выбрать формат, в котором содержатся последние данные, если только пользователь не будет просить определенный формат, используя для вставки.  Прежде чем продолжить, может понадобиться прочитать разделы [Объекты данных и источники данных OLE \(\)](../mfc/data-objects-and-data-sources-ole.md).  Они описывают основные принципы передачи данных работают, и способов их реализации в приложениях.  
  
 Windows определяет несколько стандартных форматов, которые можно использовать для передачи данных через буфер обмена.  Они включают метафайлы, текст, растровые изображения и другие.  OLE определяет несколько форматов OLE\- функции, также.  Для приложений, которым требуется больше информации, чем заданное эти стандартные форматы, рекомендуется, регистрация собственные пользовательские форматы обмена.  Выполните [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) функции Win32 API это.  
  
 Например, Microsoft Excel регистрирует пользовательский формат для электронных таблиц.  Этот формат передает значительно больше сведений, чем, например растровое изображение;  Если эти данные — в приложение, поддерживающее формат электронной таблицы, все формулы и значения из электронной таблицы сохраняются и обновляются при необходимости.  Microsoft Excel также помещает данные в буфер обмена в форматы, поэтому он может вставить как элемент OLE.  Любой OLE контейнер документа может вставить эту информацию как вложенный элемент.  Этот вложенный элемент можно изменить с помощью Microsoft Excel.  Обмен также содержит простое растровое изображение образа выделенного диапазона в электронной таблице.  Это также можно вставить в OLE контейнеры документа или в редакторы растрового изображения, как создать.  В случае растрового изображения, однако, не существует способа управления данными в эту таблицу.  
  
 Чтобы получить максимальный объем сведения из буфера обмена, приложения должны проверять наличие этих пользовательских форматов перед вставить данные из буфера обмена.  
  
 Например, чтобы включить команду, можно написать обработчик примерно следующим образом:  
  
 [!code-cpp[NVC_MFCListView#3](../mfc/codesnippet/CPP/clipboard-using-the-ole-clipboard-mechanism_1.cpp)]  
  
## Дополнительные сведения  
  
-   [Копирование и вставящ данные](../Topic/Clipboard:%20Copying%20and%20Pasting%20Data.md)  
  
-   [Добавить другие форматы](../mfc/clipboard-adding-other-formats.md)  
  
-   [С помощью обмена Windows](../mfc/clipboard-using-the-windows-clipboard.md)  
  
-   [OLE](../mfc/ole-background.md)  
  
-   [Объекты OLE данных и источники данных и унифицированная передача данных](../mfc/data-objects-and-data-sources-ole.md)  
  
## См. также  
 [буфер обмена](../mfc/clipboard.md)