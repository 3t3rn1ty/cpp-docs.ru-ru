---
title: "Буфер обмена: Использование механизма буфера обмена OLE | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- applications [OLE], Clipboard
- OLE Clipboard
- Clipboard [MFC], OLE formats
- OLE Clipboard, formats
- formats [MFC], Clipboard for OLE
ms.assetid: 229cc610-5bb1-435e-bd20-2c8b9964d1af
caps.latest.revision: "11"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 68f6c53c091063ab79078fb4a512638263b814bb
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="clipboard-using-the-ole-clipboard-mechanism"></a>Буфер обмена. Использование механизма буфера обмена OLE
OLE использует стандартные форматы и некоторые форматы конкретного OLE для передачи данных через буфер обмена.  
  
 Если вырезать или скопировать данные из приложения, данные хранятся в буфере обмена для использования в операциях вставки. Это данные находятся в различных форматах. Когда пользователь выбирает для вставки данных из буфера обмена, приложения можно выбрать, какой из этих форматов, которые используются. Приложения должны записываться в выберите требуемый формат полезных сведений, если пользователь специально запрашивает определенный формат, с помощью Специальная вставка. Прежде чем продолжить, вы можете прочитать [объектов данных и источники данных (OLE)](../mfc/data-objects-and-data-sources-ole.md) разделы. Они описывают основы работы, как передача данных и способы их реализации в приложениях.  
  
 Windows определяет ряд стандартных форматов, которые могут использоваться для передачи данных через буфер обмена. К ним относятся метафайлы, текст, растровые изображения и другие. OLE определяет количество OLE форматам, а также. Для приложений, требующих больше информации, чем задано этих стандартных форматов рекомендуется зарегистрировать свои собственные пользовательские форматы буфера обмена. Используйте функцию Win32 API [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) это сделать.  
  
 Например Microsoft Excel регистрирует пользовательский формат для электронных таблиц. Этот формат содержит гораздо больше сведений, чем, например, растрового изображения. При этом данные будут вставлены в приложение, поддерживающее формате электронной таблицы, все формулы и значения из электронной таблицы сохраняются и могут быть обновлены при необходимости. Microsoft Excel также помещает данные в буфер обмена в форматах, чтобы его можно вставить как объект OLE. Любой документ OLE-контейнер можно вставить эту информацию как встроенного элемента. Это встроенного элемента можно изменить с помощью Microsoft Excel. Буфер обмена также содержит простой битовой карты изображения для выбранного диапазона на листе. Это можно вставить в документ OLE-контейнеры, либо в редакторах растрового изображения, например Paint. В случае с растровым изображением Однако нет возможности для работы с данными в виде электронной таблицы.  
  
 Для получения максимального объема информации из буфера обмена, приложения должны проверять эти пользовательские форматы перед вставкой данных из буфера обмена.  
  
 Например чтобы команда Вырезать, можно написать обработчик примерно следующим образом:  
  
 [!code-cpp[NVC_MFCListView#3](../atl/reference/codesnippet/cpp/clipboard-using-the-ole-clipboard-mechanism_1.cpp)]  
  
## <a name="what-do-you-want-to-know-more-about"></a>Выберите Дополнительные сведения  
  
-   [Копирование и вставка данных](../mfc/clipboard-copying-and-pasting-data.md)  
  
-   [Добавление других форматов](../mfc/clipboard-adding-other-formats.md)  
  
-   [Использование буфера обмена Windows](../mfc/clipboard-using-the-windows-clipboard.md)  
  
-   [OLE](../mfc/ole-background.md)  
  
-   [Объекты и данные источников данных OLE и универсальный передачи данных](../mfc/data-objects-and-data-sources-ole.md)  
  
## <a name="see-also"></a>См. также  
 [Буфер обмена](../mfc/clipboard.md)

