---
title: "Изоляция библиотеки общих элементов управления MFC | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC - библиотека, Common Controls - функция"
ms.assetid: 7471e6f0-49b0-47f7-86e7-8d6bc3541694
caps.latest.revision: 11
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Изоляция библиотеки общих элементов управления MFC
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Библиотека общих элементов управления теперь изолирована внутри MFC, предоставляя различные модули \(такие как dll\-библиотеки пользователя\) для использования различных версий библиотеки общих элементов управления с указанием версии в своих манифестов.  
  
 Приложение MFC \(или код пользователя с MFC\) выполняют вызовы API библиотеки общих элементов управления с помощью функции с именами программы\-оболочки `Afx`*FunctionName*, где *FunctionName* — имя API общих элементов управления.  Эти функции оболочки определяются в afxcomctl32.h и afxcomctl32.inl.  
  
 Можно использовать макрос [AFX\_COMCTL32\_IF\_EXISTS](../Topic/AFX_COMCTL32_IF_EXISTS.md) и [AFX\_COMCTL32\_IF\_EXISTS2](../Topic/AFX_COMCTL32_IF_EXISTS2.md) \(определенные в afxcomctl32.h\) для указания, реализует ли библиотека общих элементов управления некоторые API вместо вызова [GetProcAddress](../build/getprocaddress.md).  
  
 Технически, при вызове на интерфейсы через этот класс\-оболочку, `CComCtlWrapper` библиотеки общих элементов управления \(указанный в afxcomctl32.h\).  `CComCtlWrapper` также отвечает за загрузки и выгрузки comctl32.dll.  Состояние модуля MFC содержит указатель на экземпляр `CComCtlWrapper`.  Доступ к класс\-оболочка использование макроса `afxComCtlWrapper`.  
  
 Обратите внимание, что при вызове API общих элементов управления непосредственно \(не с помощью функции оболочки MFC\) из приложения MFC DLL или пользователя будет работать в большинстве случаев, поскольку приложение MFC DLL или пользователя привязаны к библиотеке общих элементов управления его спросило в своем манифесте\).  Однако сам код MFC должен использовать оболочки, поскольку код MFC может вызываться из библиотеки DLL пользователя с различными версиями библиотеки общих элементов управления.