---
title: 'Меню и ресурсы: добавление контейнеров | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- IDP_OLE_INIT_FAILED
- IDP_FAILED_TO_CREATE
- VK_ESCAPE
dev_langs:
- C++
helpviewer_keywords:
- application accelerator table [MFC]
- VK_ESCAPE key [MFC]
- IDP_FAILED_TO_CREATE macro [MFC]
- visual editing, application menus and resources
- OLE containers [MFC], menus and resources
- accelerator tables [MFC], container applications
- IDP_OLE_INIT_FAILED macro [MFC]
- CONTAIN tutorial [MFC]
- Links menu item [MFC]
ms.assetid: 425448be-8ca0-412e-909a-a3a9ce845288
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 437b80a0766a07b181a60743e79bdbaf32347de4
ms.sourcegitcommit: 060f381fe0807107ec26c18b46d3fcb859d8d2e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36930550"
---
# <a name="menus-and-resources-container-additions"></a>Меню и ресурсы. Добавление контейнеров
В этой статье описываются изменения, которые должны быть выполнены с меню и другими ресурсами в приложении контейнера визуального редактирования.  
  
 В приложениях контейнера должны быть выполнены изменений двух типов: изменения в существующие ресурсы для поддержки визуального редактирования OLE и добавлять новые ресурсы, используемые для активации на месте. При использовании мастера приложений для создания приложения-контейнера, автоматически выполняются следующие действия, но они могут потребовать некоторые настройки.  
  
 Если не используется в мастере приложений, можно рассмотреть OCLIENT. Версия-Кандидат, сценарий ресурсов для OCLIENT образец приложения, чтобы увидеть, как реализованы следующие изменения. См. Образец MFC OLE [OCLIENT](../visual-cpp-samples.md).  
  
 В этой статье рассматриваются:  
  
-   [Добавление контейнеров меню](#_core_container_menu_additions)  
  
-   [Добавление таблицы сочетаний клавиш](#_core_container_application_accelerator_table_additions)  
  
-   [Строка таблицы дополнения](#_core_string_table_additions_for_container_applications)  
  
##  <a name="_core_container_menu_additions"></a> Добавление контейнеров меню  
 В меню "Правка", необходимо добавить следующие элементы:  
  
|Элемент|Цель|  
|----------|-------------|  
|**Вставка нового объекта**|Открывает диалоговое окно вставки объекта OLE для вставки элемента связанным или внедренным в документ.|  
|**Вставить связь**|Вставляет ссылку на элемент в буфер обмена в документ.|  
|**Команды OLE**|Вызывает первичный глагол выбранного элемента. Текст элемента этого меню изменяется, отражая первичный глагол выбранного элемента.|  
|**Links**|Открытие диалогового окна OLE изменить ссылки для изменения существующих связанных элементов.|  
  
 Помимо изменений, описанных в этой статье исходный файл должен включать AFXOLECL. Версия-Кандидат, необходимый для реализации библиотеки классов Microsoft Foundation. Вставка нового объекта заключается в добавлении только необходимые меню. Можно добавить другие элементы, но перечисленных ниже наиболее распространены.  
  
 Если требуется для поддержки активации по месту вложенные элементы, необходимо создать новое меню для приложения-контейнера. Это меню состоит из того же меню "файл" и окно во всплывающих меню, используемые, когда файлы открыты, но он имеет два разделителя, который располагается между ними. Эти разделители используются для указания, где элемент сервера (компонент) (приложение) следует помещать его меню при активации на месте. Дополнительные сведения об этом приеме слияние меню см. в разделе [меню и ресурсы: слияние меню](../mfc/menus-and-resources-menu-merging.md).  
  
##  <a name="_core_container_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш приложения контейнеров  
 Небольшие изменения в приложение контейнера ресурсами таблиц сочетаний клавиш необходимы, если вы поддерживаете активации на месте. Первое изменение позволяет пользователю клавишу ESC для выхода из режима редактирования по месту. Добавьте следующую запись в таблице сочетаний клавиш основной:  
  
|ID|Ключ|Тип|  
|--------|---------|----------|  
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|  
  
 Второе изменение является создание новой таблицы сочетаний клавиш, которая соответствует новый ресурс меню, созданных для активации на месте. Эта таблица содержит записи для меню «файл» и «окно помимо записи VK_ESCAPE выше. В следующем примере представлен таблицу сочетаний клавиш для активации на месте в образце MFC [КОНТЕЙНЕРА](../visual-cpp-samples.md):  
  
|ID|Ключ|Тип|  
|--------|---------|----------|  
|ID_FILE_NEW|CTRL+N|**VIRTKEY**|  
|ID_FILE_OPEN|CTRL+O|**VIRTKEY**|  
|ID_FILE_SAVE|CTRL + S|**VIRTKEY**|  
|ID_FILE_PRINT|CTRL+P|**VIRTKEY**|  
|ID_NEXT_PANE|VK_F6|**VIRTKEY**|  
|ID_PREV_PANE|SHIFT + VK_F6|**VIRTKEY**|  
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|  
  
##  <a name="_core_string_table_additions_for_container_applications"></a> Строка таблицы дополнения для приложения контейнера  
 Большинство изменений в строку таблицы для приложения контейнера соответствует дополнительных пунктов, упомянутых в [добавления меню контейнера](#_core_container_menu_additions). Они указать текст, отображаемый в строке состояния, при отображении каждым пунктом меню. Например Вот таблица строк записи, которые создает мастер приложений.  
  
|ID|String|  
|--------|------------|  
|IDP_OLE_INIT_FAILED|Не удалось выполнить инициализацию OLE. Убедитесь в наличии правильной версии библиотек OLE.|  
|IDP_FAILED_TO_CREATE|Не удалось создать объект. Убедитесь, что он занесен в системный реестр.|  
  
## <a name="see-also"></a>См. также  
 [Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)   
 [Меню и ресурсы. Добавление серверов](../mfc/menus-and-resources-server-additions.md)

