---
title: "Меню и ресурсы. Добавление контейнеров | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "IDP_OLE_INIT_FAILED"
  - "IDP_FAILED_TO_CREATE"
  - "VK_ESCAPE"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "таблицы сочетаний клавиш [C++], приложения контейнера"
  - "таблица сочетаний клавиш приложения [C++]"
  - "CONTAIN - руководство"
  - "IDP_FAILED_TO_CREATE - макрос"
  - "IDP_OLE_INIT_FAILED - макрос"
  - "Элемент меню ссылок"
  - "OLE - контейнеры, меню и ресурсы"
  - "визуальное редактирование, меню и ресурсы приложений"
  - "VK_ESCAPE - клавиша"
ms.assetid: 425448be-8ca0-412e-909a-a3a9ce845288
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Меню и ресурсы. Добавление контейнеров
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этой статье описывается изменения, которые необходимо выполнить в меню и другим ресурсам в контейнерном приложении визуального редактирования.  
  
 В приложение\-контейнерах, 2 типам изменений необходимо выполнить: изменения в существующие ресурсы для визуального редактирования поддержки OLE и добавлению новых ресурсов, используемых для встроенной активации.  При использовании мастера приложений для создания собственных контейнерное приложение, эти шаги будут, автоматически, но они могут требовать определенной настройки.  
  
 Если мастер не используется приложений, может понадобиться просмотреть OCLIENT.RC скрипт ресурсов, пример приложения OCLIENT, просмотреть их изменений.  В примере MFC [OCLIENT](../top/visual-cpp-samples.md) OLE.  
  
 Разделы описанные в этой статье:  
  
-   [Добавление меню контейнера](#_core_container_menu_additions)  
  
-   [Добавление таблицы сочетаний клавиш](#_core_container_application_accelerator_table_additions)  
  
-   [Добавление строк таблицы](#_core_string_table_additions_for_container_applications)  
  
##  <a name="_core_container_menu_additions"></a> Добавление меню контейнера  
 Необходимо добавить следующие элементы в меню " Правка ":  
  
|Элемент|Назначение|  
|-------------|----------------|  
|**Вставьте новый объект**|Открывает диалоговое окно объекта OLE вставки для вставки или связанный вложенный элемент в документ.|  
|**Ссылки "**|Вставьте ссылку на элемент в буфер обмена в документ.|  
|**Команда OLE**|Вызывает команду выбранного элемента основной.  Текст этого пункта меню изменится, отображая основную команду выбранного элемента.|  
|**Ссылки**|Открывает диалоговое окно OLE ссылок правки для изменения существующих связанные элементы.|  
  
 Помимо изменения перечисленных в этой статье, файл источника должен включать AFXOLECL.RC, что необходимо для реализации библиотеки Microsoft Foundation Class.  Объект вставки нового единственным необходимым добавление меню.  Можно добавить другие элементы, но они перечислены здесь наиболее часто.  
  
 Необходимо создать новое меню для данного приложения при необходимости поддержки встроенной активации, хранимыми в них элементов.  Это меню состоит из одного меню Файл и всплывающие меню окна использовался при файлы открыть, но имеет 2 разделителя помещенного между ними.  Эти разделители используются, чтобы указать, где элемент сервера \(компонента\) \(приложения\) должен установить его меню активированы на месте.  Дополнительные сведения об этом методе возврата слияния см. в разделе [Меню и ресурсы: Слияния меню](../mfc/menus-and-resources-menu-merging.md).  
  
##  <a name="_core_container_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш приложения  
 Небольшие изменения к ресурсам таблицы сочетаний клавиш приложения необходимы, если требуется поддержка встроенной активации.  Первое изменение позволяет пользователю, чтобы нажать клавишу ESC escape\-последовательности \(ключ\) отменить режим редактирования локально.  Добавьте следующую запись в главной таблице сочетаний клавиш.  
  
|Идентификатор|Ключ|Тип|  
|-------------------|----------|---------|  
|**ID\_CANCEL\_EDIT\_CNTR**|VK\_ESCAPE|**VIRTKEY**|  
  
 Второе изменение создание таблицы сочетаний клавиш, соответствующую новый ресурс меню, созданный для встроенной активации.  Эта таблица содержит записи для файла и меню Окна в дополнение к записи **VK\_ESCAPE** выше.  В следующем примере таблицы сочетаний клавиш созданная встроенной активации в примере MFC [КОНТЕЙНЕР](../top/visual-cpp-samples.md).  
  
|Идентификатор|Ключ|Тип|  
|-------------------|----------|---------|  
|`ID_FILE_NEW`|CTRL\+N|**VIRTKEY**|  
|`ID_FILE_OPEN`|CTRL\+O|**VIRTKEY**|  
|**ID\_FILE\_SAVE**|CTRL \+ S|**VIRTKEY**|  
|**ID\_FILE\_PRINT**|CTRL\+P|**VIRTKEY**|  
|**ID\_NEXT\_PANE**|VK\_F6|**VIRTKEY**|  
|**ID\_PREV\_PANE**|SHIFT\+VK\_F6|**VIRTKEY**|  
|**ID\_CANCEL\_EDIT\_CNTR**|VK\_ESCAPE|**VIRTKEY**|  
  
##  <a name="_core_string_table_additions_for_container_applications"></a> Добавление таблицы для приложение\-контейнеров строк  
 Большинство изменений в таблицу строк для приложение\-контейнеров соответствует дополнительным пунктов меню упомянутым в [Добавление меню контейнера](#_core_container_menu_additions).  Они содержат текст, отображаемый в строке состояния при каждом пункт меню.  Например, ниже записи в таблицу строк мастера приложений возникает:  
  
|Идентификатор|Строковое|  
|-------------------|---------------|  
|**IDP\_OLE\_INIT\_FAILED**|Не удалось выполнить инициализацию OLE.  Убедитесь в том, что используются правильные версии библиотек OLE.|  
|**IDP\_FAILED\_TO\_CREATE**|Не удалось создать объект.  Убедитесь, что объект вводятся в системном реестре.|  
  
## См. также  
 [Меню и ресурсы \(OLE\)](../mfc/menus-and-resources-ole.md)   
 [Меню и ресурсы. Добавление серверов](../mfc/menus-and-resources-server-additions.md)