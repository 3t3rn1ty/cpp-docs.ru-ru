---
title: "Контейнеры элементов управления ActiveX. Программирование элементов управления ActiveX в контейнере элементов управления ActiveX | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "контейнер для элементов ActiveX [C++], доступ к элементам управления ActiveX"
  - "контейнер для элементов ActiveX [C++], классы-оболочки"
  - "элементы управления ActiveX [C++], доступ"
  - "элементы управления ActiveX [C++], классы-оболочки"
  - "Confirm Classes - диалоговое окно"
  - "заголовочные файлы [C++], для класса программы-оболочки элемента управления ActiveX"
  - "элементы управления MFC ActiveX [C++], доступ в контейнеры"
  - "классы-оболочки [C++], элементы управления ActiveX"
  - "классы-оболочки [C++], использование"
ms.assetid: ef9b2480-92d6-4191-b16e-8055c4fd7b73
caps.latest.revision: 8
caps.handback.revision: 4
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Контейнеры элементов управления ActiveX. Программирование элементов управления ActiveX в контейнере элементов управления ActiveX
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Этот раздел описывает процесс для получения предоставляется [методы](../mfc/mfc-activex-controls-methods.md) и [свойства](../mfc/mfc-activex-controls-properties.md) внедренных элементов управления ActiveX.  По существу, необходимо выполнить следующие действия.  
  
1.  [Вставьте элемент управления ActiveX в проект контейнера ActiveX](../mfc/inserting-a-control-into-a-control-container-application.md) использование коллекции.  
  
2.  [Определение переменной\-члена](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) \(или другую форму доступа\) того же введите как класс\-оболочка элемента управления ActiveX.  
  
3.  [Программа элемент управления ActiveX](#_core_programming_the_activex_control) использование предопределенных функции\-члены класс\-оболочки.  
  
 Для данного обсуждения предположим, что создан проект на основе диалоговых окон \(\) с поддержкой именованный Контейнер элементов управления ActiveX.  Управление примера CIRC, CIRC, добавляется к полученный проект.  
  
 После того как элемент управления CIRC добавится в проект \(раздел 1\), вставляет экземпляр элемента управления CIRC в диалоговое окно главного приложения.  
  
## Процедуры  
  
#### Добавление элемента управления CIRC в шаблон диалоговых окон  
  
1.  Загрузите проект контейнера элементов управления ActiveX.  Для этого примера выберите проект `Container`.  
  
2.  Выберите вкладку Ресурсы.  
  
3.  Откройте папку **Диалоговое окно**.  
  
4.  Дважды щелкните основного шаблона диалогового окна.  В данном примере используйте **IDD\_CONTAINER\_DIALOG**.  
  
5.  Щелкните Значок элемента управления CIRC для элемента.  
  
6.  Нажмите пятно в диалоговое окно, чтобы вставить элемент управления CIRC.  
  
7.  В меню **Файл** выберите команду **Сохранить все**, чтобы сохранить все изменения в шаблон диалогового окна.  
  
## Изменения в проект  
 Чтобы включить контейнерное приложение получает управление CIRC Visual C\+\+ автоматически добавит файл реализации класс\-оболочки \(`CCirc`\) \(CPP\) в проект контейнера и заголовку класс\-оболочки \(. Файл H\) в файл заголовка диалогового окна:  
  
 [!code-cpp[NVC_MFC_AxCont#1](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_1.h)]  
  
##  <a name="_core_the_wrapper_class_header_28h29_file"></a> Заголовок класс\-оболочки \(. Файл H\)  
 Для получения и свойств \(\) и вызывать методы для управления CIRC класс\-оболочка, `CCirc` предоставляют объявление всех доступных методов и свойств.  В примере эти объявления находятся в CIRC.H.  В следующем примере часть класса `CCirc`, определяющий интерфейсы, предоставляемые элементом управления ActiveX.  
  
 [!code-cpp[NVC_MFC_AxCont#2](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_2.h)]  
[!code-cpp[NVC_MFC_AxCont#3](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_3.h)]  
  
 Затем эти функции можно вызывать из другой из процедур приложения с помощью стандартного синтаксиса C C\+\+.  Дополнительные сведения об использовании данного набора функции\-члена для доступа к методам и свойствам элемента управления см. в разделе [Программирование элементов управления ActiveX](#_core_programming_the_activex_control).  
  
##  <a name="_core_member_variable_modifications_to_the_project"></a> Изменения переменной\-члена в проект  
 После того как элемент управления ActiveX была добавлена в проект и было внедряется в контейнере диалогового окна, он может быть получен доступ другие составляющие проекта.  Самый простой способ доступа к элементу управления в [создайте переменную элемента](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) класса диалогового окна, `CContainerDlg` \(раздел 2\), который имеет тот же тип класс\-оболочка, добавленной в проект Visual C\+\+.  Затем можно использовать переменную\-член получить встроенный элемент управления в любое время.  
  
 В диалоговом окне **Добавление переменной\-члена** добавляет переменную\-член `m_circctl` в проект, она также добавлены следующие линии в файл заголовка \(. H\) класса `CContainerDlg`:  
  
 [!code-cpp[NVC_MFC_AxCont#4](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_4.h)]  
[!code-cpp[NVC_MFC_AxCont#5](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_5.h)]  
  
 Кроме того, вызов метода **DDX\_Control** автоматически добавляется к реализации `CContainerDlg``DoDataExchange`:  
  
 [!code-cpp[NVC_MFC_AxCont#6](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_6.cpp)]  
  
##  <a name="_core_programming_the_activex_control"></a> Программирование элементов управления ActiveX  
 На этом этапе, вставленной элемент управления ActiveX в шаблон диалоговых окон и создания переменную\-член для него.  Теперь можно использовать синтаксис C\+\+ для общего доступа к свойствам и методам внедренного элемента управления.  
  
 Как отмечалось в \( [Заголовок класс\-оболочки \(. Файл H\)](#_core_the_wrapper_class_header_28h29_file)\), файл заголовка \(. H\) для класс\-оболочки `CCirc`, в данном случае CIRC.H, содержит список функций\-членов, которые можно использовать для получения и задания предоставляется любое значение свойства.  Функции\-члены для методов, предоставляемых также доступны.  
  
 Общее место для изменения свойств элемента управления в функции\-члене `OnInitDialog` основного класса диалогового окна.  Эта функция вызывается непосредственно перед вызовом диалогового окна, и используется для инициализации его содержимое, включая ее элементов управления.  
  
 В следующем примере кода используется переменной\-члена `m_circctl`, изменять свойства заголовка и CircleShape внутреннего управления CIRC:  
  
 [!code-cpp[NVC_MFC_AxCont#7](../mfc/codesnippet/CPP/programming-activex-controls-in-a-activex-control-container_7.cpp)]  
  
## См. также  
 [Контейнеры для элементов управления ActiveX](../mfc/activex-control-containers.md)