---
title: "Практическое руководство. Преобразование существующей ленты MFC в ресурс ленты | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "лента MFC, преобразование в ресурс ленты"
  - "ресурс ленты, преобразование из ленты MFC"
ms.assetid: 324b7ff6-58f9-4691-96a9-9836a79d0fb6
caps.latest.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 4
---
# Практическое руководство. Преобразование существующей ленты MFC в ресурс ленты
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Ресурсы ленты легче визуализации, изменения и обслуживания, чем вручную закодированные ленты.  В этом разделе описывается, как преобразовать вручную закодированная ленты в проекте MFC в ресурс ленты.  
  
 Необходимо иметь проект MFC, содержащий код, который использует классы ленты MFC, например [Класс CMFCRibbonBar](../mfc/reference/cmfcribbonbar-class.md).  
  
### Преобразование ленты MFC к ресурсу ленты  
  
1.  В Visual Studio в существующем проекте MFC, откройте файл источника, в котором объект CMFCRibbonBar инициализации.  Как правило, файл mainfrm.cpp.  Добавьте следующий код после кода инициализации для ленты.  
  
    ```  
    m_wndRibbonBar.SaveToXMLFile("RibbonOutput.xml");  
    ```  
  
     Сохраните и закройте файл.  
  
2.  Выполните построение и запустите приложение MFC, а затем в блокноте, откройте RibbonOutput.txt и скопируйте его содержимое.  
  
3.  В меню Visual Studio **Проект**, щелкните **Добавить ресурс**.  В диалоговом окне **Добавить ресурс**, выберите **ribbon** и нажмите кнопку **Создать**.  
  
     Visual Studio создает ресурс ленты и открыть его в представлении конструирования.  Идентификатор ресурса IDR\_RIBBON1 ленты, которое отображается в **Ресурсы**.  Если указана в файле ribbon1.mfcribbon\-ms XML.  
  
4.  В Visual Studio открытые ribbon1.mfcribbon\-ms, удалите его содержимое, а затем вставьте содержимое RibbonOutput.txt, скопированный ранее.  Сохраните и закрыть ribbon1.mfcribbon\-ms.  
  
5.  При этом раскрывайте файл источника, в котором объект CMFCRibbonBar инициализируется \(обычно mainfrm.cpp\) и установите существующего кода ленты.  Добавьте следующий код после кода, который будет закомментирован.  
  
    ```  
    m_wndRibbonBar.LoadFromResource(IDR_RIBBON1);  
    ```  
  
6.  Выполните построение проекта и запустите программу.  
  
## См. также  
 [Конструктор лент \(MFC\)](../mfc/ribbon-designer-mfc.md)