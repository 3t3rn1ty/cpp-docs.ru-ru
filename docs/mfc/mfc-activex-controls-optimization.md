---
title: "Элементы управления ActiveX в MFC. Оптимизация | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "контексты устройств, необрезанный для элементов управления ActiveX MFC"
  - "немерцающие элементы управления ActiveX"
  - "MFC ActiveX - элементы управления, активное и неактивное состояние"
  - "MFC ActiveX - элементы управления, без мерцания"
  - "MFC ActiveX - элементы управления, взаимодействие мыши"
  - "MFC ActiveX - элементы управления, оптимизация"
  - "MFC ActiveX - элементы управления, без окон"
  - "оптимизация, элементы управления ActiveX"
  - "оптимизация производительности, элементы управления ActiveX"
  - "производительность, элементы управления ActiveX"
  - "элементы управления ActiveX MFC без окон"
ms.assetid: 8b11f26a-190d-469b-b594-5336094a0109
caps.latest.revision: 8
caps.handback.revision: 4
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Элементы управления ActiveX в MFC. Оптимизация
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этой статье описывается методы можно оптимизировать использование элементов управления ActiveX для повышения производительности.  
  
 Разделы [Отключение активировать при видимый параметр](../mfc/turning-off-the-activate-when-visible-option.md) и [Обеспечивать взаимодействие с мышью, неактивный](../Topic/Providing%20Mouse%20Interaction%20While%20Inactive.md) обсуждается элементы управления, для создания окна до тех пор, пока не будут активированы.  Раздел [Предоставление безоконную активацию](../mfc/providing-windowless-activation.md) описывает элементы управления, которые никогда не создает окно, даже если они активированы.  
  
 Windows 2 имеет два недостатка для объектов OLE. они препятствуют объекты предотвращает прозрачный или при nonrectangular активными, и они добавляют большая нагрузка на план и отображения элементов управления.  Обычно создание окна принимает процент 60 времени создания элемента управления.  С одним общим контейнером окном \(обычно\) и некоторым подготовить кодом, элемент управления получает те же службы окна, обычно без потери производительности.  Иметь окно в основном лишняя служебные данные для объекта.  
  
 Некоторые виды оптимизации не обязательно повышает производительность, когда этот элемент управления используется в некоторых контейнерах.  Например, контейнеры освобожданные до 1996 не поддержке безоконную активацию, поэтому реализация этой функции не получает преимущество в старых контейнерах.  Однако почти каждый контейнер поддерживает сохранение, поэтому оптимизировать код сохранения элемента управления, повышает его производительность в одном контейнере.  Если элемент управления специально предназначен для использования с одним конкретным типом контейнера, можно изучить, этих оптимизации поддерживается этим контейнером.  Однако в общем случае следует попробовать реализовать столько этих методов как применим в определенному элементу управления, чтобы предоставить элемент управления выполняет насколько хорошо по мере их по возможности может в широком массиве контейнеров.  
  
 Можно реализовать многие из этих оптимизации посредством [Мастер элементов ActiveX MFC](../mfc/reference/mfc-activex-control-wizard.md), на странице [Параметры элементов управления](../mfc/reference/control-settings-mfc-activex-control-wizard.md).  
  
### Параметры оптимизации мастера элементов управления ActiveX MFC OLE  
  
|Параметр элемента управления в мастере элемента управления ActiveX MFC|Действие|Дополнительные сведения|  
|----------------------------------------------------------------------------|--------------|-----------------------------|  
|флажок **Активировать при видимый**|Очистить|[Отключение активировать при видимый параметр](../mfc/turning-off-the-activate-when-visible-option.md)|  
|флажок **Активация без окна**|Select|[Предоставление безоконную активацию](../mfc/providing-windowless-activation.md)|  
|флажок **Unclipped контекст устройства**|Select|[С помощью Unclipped контекст устройства](../mfc/using-an-unclipped-device-context.md)|  
|флажок **свободная от Мерцание активация**|Select|[Защита от свободной Мерцание активацию](../mfc/providing-flicker-free-activation.md)|  
|флажок **Уведомления указателя мыши при неактивный**|Select|[Обеспечивать взаимодействие с мышью, неактивный](../Topic/Providing%20Mouse%20Interaction%20While%20Inactive.md)|  
|флажок **Создание оптимизированного кода**|Select|[Оптимизировать рисование элементов управления](../mfc/optimizing-control-drawing.md)|  
  
 Дополнительные сведения о функциях, которые реализуют эти оптимизации см. в разделе [COleControl](../mfc/reference/colecontrol-class.md).  Функции\-члены перечислены использованием, например [Безоконные операции](http://msdn.microsoft.com/ru-ru/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) и [Неактивный указатель функции.](http://msdn.microsoft.com/ru-ru/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)  
  
 Дополнительные сведения см. в следующих разделах:  
  
-   [Оптимизировать сохранение и инициализация](../mfc/optimizing-persistence-and-initialization.md)  
  
-   [Предоставление безоконную активацию](../mfc/providing-windowless-activation.md)  
  
-   [Отключение активировать при видимый параметр](../mfc/turning-off-the-activate-when-visible-option.md)  
  
-   [Обеспечивать взаимодействие с мышью, неактивный](../Topic/Providing%20Mouse%20Interaction%20While%20Inactive.md)  
  
-   [Защита от свободной Мерцание активацию](../mfc/providing-flicker-free-activation.md)  
  
-   [С помощью Unclipped контекст устройства](../mfc/using-an-unclipped-device-context.md)  
  
-   [Оптимизировать рисование элементов управления](../mfc/optimizing-control-drawing.md)  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)