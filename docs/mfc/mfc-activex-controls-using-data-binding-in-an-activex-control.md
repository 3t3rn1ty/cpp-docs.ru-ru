---
title: "Элементы управления ActiveX в MFC. Использование привязки данных в элементе управления ActiveX | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "bindable"
  - "requestedit"
  - "defaultbind"
  - "displaybind"
  - "dispid"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "элементы управления с привязкой [C++], MFC ActiveX"
  - "элементы управления [MFC], привязка данных"
  - "привязка данных [C++], MFC ActiveX - элементы управления"
  - "элементы управления с привязкой к данным [C++], MFC ActiveX - элементы управления"
  - "MFC ActiveX - элементы управления, привязка данных"
ms.assetid: 476b590a-bf2a-498a-81b7-dd476bd346f1
caps.latest.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 6
---
# Элементы управления ActiveX в MFC. Использование привязки данных в элементе управления ActiveX
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Один из элементов управления ActiveX мощного используется привязка данных, что позволяет свойства элемента управления в привязке с конкретным полем в базе данных.  Когда пользователь изменяет данные в этом свойстве, ограниченном уведомляет элемент управления базу данных и эти запросы были обновлены record поле.  База данных затем уведомляет элемент управления успеха или неудачи запроса.  
  
 Этот раздел охватывает сторону элемента управления данной задачи.  Реализация взаимодействия привязки данных с базой данных за контейнера элементов управления.  Как управлять взаимодействия базы данных в контейнере выходящей за область данной документации.  Как при подготовке элемент управления для привязки данных элементы в остальной части этой статьи.  
  
 ![Концептуальная схема элемента управления с привязкой к данным](../mfc/media/vc374v1.png "vc374V1")  
Концептуальную схема элемента управления с привязкой к данным  
  
 Класс `COleControl` предоставляет 2 функции\-члена, выполняют привязку данных простой процесс для реализации.  Первая функция, [BoundPropertyRequestEdit](../Topic/COleControl::BoundPropertyRequestEdit.md) используется в запрос разрешения на изменение значения свойства.  [BoundPropertyChanged](../Topic/COleControl::BoundPropertyChanged.md), вторая функция, вызывается после того, как успешно значение свойства было изменено.  
  
 Этот раздел охватывает следующее:  
  
-   [Создание элемента стандартное свойство](#vchowcreatingbindablestockproperty)  
  
-   [Создание элемента получает и задать метод](#vchowcreatingbindablegetsetmethod)  
  
##  <a name="vchowcreatingbindablestockproperty"></a> Создание элемента стандартное свойство  
 Можно создать данным привязанное стандартное свойство, хотя более вероятно, что необходимо [связывания get\/set метод](#vchowcreatingbindablegetsetmethod).  
  
> [!NOTE]
>  Стандартные свойства имеют атрибуты **Разрешена привязка** и **Затребовано** по умолчанию.  
  
#### Добавление элемента стандартное свойство с помощью мастера добавления свойства.  
  
1.  Начните проект с помощью [Мастер элементов ActiveX MFC](../mfc/reference/mfc-activex-control-wizard.md).  
  
2.  Щелкните правой кнопкой мыши узел интерфейса для элемента управления.  
  
     Это открывается контекстное меню.  
  
3.  В контекстном меню щелкните **Добавить**, а затем щелкните **Добавить свойство**.  
  
4.  Выделите одну из записей из раскрывающегося списка **Свойство Имя**.  Например, можно выберите **Текст**.  
  
     Поскольку стандартное свойство атрибуты **Текст**, **Разрешена привязка** и **Затребовано** уже проверены.  
  
5.  Выделите следующие флажки на вкладке **Атрибуты IDL**. **Отобразить привязку** и **Привязка по умолчанию**, чтобы добавить атрибуты к определению свойства в файле проекта .IDL.  Эти атрибуты обеспечивают элемент управления видимым для пользователя и делают стандартным свойством по умолчанию элемента свойства.  
  
 На этом этапе, элемент управления может отображать данные из источника данных, но пользователь не сможет полей обновления данных.  Если требуется, чтобы элемент управления также возможности обновления данных, измените функцию `OnOcmCommand` [OnOcmCommand](../mfc/mfc-activex-controls-subclassing-a-windows-control.md), чтобы выглядеть следующим образом:  
  
 [!code-cpp[NVC_MFC_AxData#1](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_1.cpp)]  
  
 Теперь можно выполнить построение проекта, который регистрируется элемент управления.  При вводе элемент управления в диалоговое окно, свойства **Поле данных** и **Источник данных** будут добавлены и теперь choice источника данных и поля для отображения в элементе управления.  
  
##  <a name="vchowcreatingbindablegetsetmethod"></a> Создание элемента получает и задать метод  
 В дополнение к данным привязанное get\/set метод, можно также создать [стандартное свойство элемента](#vchowcreatingbindablestockproperty).  
  
> [!NOTE]
>  В этой процедуре предполагается, что имеется проекта элемента управления ActiveX, который наследуется от класса элемента управления Windows.  
  
#### Добавляет задает, что и задать метод связывания с помощью мастера добавления свойства.  
  
1.  Загрузите проект элемента управления.  
  
2.  На странице **Параметры элементов управления** выберите класс окна элемента управления к вложенному классу.  Например, может потребоваться к вложенному классу элемента управления "Поле ввода".  
  
3.  Загрузите проект элемента управления.  
  
4.  Щелкните правой кнопкой мыши узел интерфейса для элемента управления.  
  
     Это открывается контекстное меню.  
  
5.  В контекстном меню щелкните **Добавить**, а затем щелкните **Добавить свойство**.  
  
6.  Введите его имя в поле **Имя свойства**.  Используйте `MyProp` для данного образца.  
  
7.  Выберите тип данных из раскрывающегося списка **свойство Type**.  Используйте **short** для данного образца.  
  
8.  В поле **Тип реализации**, щелкните **Get\/set методы**.  
  
9. Выделите следующие флажки на вкладке IDL атрибутов: **Разрешена привязка**, **Затребовано**, **Отобразить привязку** и **Привязка по умолчанию**, чтобы добавить атрибуты к определению свойства в файле проекта .IDL.  Эти атрибуты обеспечивают элемент управления видимым для пользователя и делают стандартным свойством по умолчанию элемента свойства.  
  
10. Нажмите кнопку **Готово**.  
  
11. Измените тело функции `SetMyProp` так, чтобы она будет содержать следующий код:  
  
     [!code-cpp[NVC_MFC_AxData#2](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_2.cpp)]  
  
12. Параметр, переданный функции `BoundPropertyChanged` и `BoundPropertyRequestEdit` dispid свойства, переданный параметр атрибуту ID \(\) для свойства в файле .IDL.  
  
13. Измените функцию [OnOcmCommand](../mfc/mfc-activex-controls-subclassing-a-windows-control.md), чтобы она содержит следующий код:  
  
     [!code-cpp[NVC_MFC_AxData#1](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_1.cpp)]  
  
14. Измените функцию `OnDraw` так, чтобы она будет содержать следующий код:  
  
     [!code-cpp[NVC_MFC_AxData#3](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_3.cpp)]  
  
15. Общедоступного раздел файла заголовка файла заголовка для класса элемента управления добавьте следующие определения \(конструкторы\) для переменных\-членов:  
  
     [!code-cpp[NVC_MFC_AxData#4](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_4.h)]  
  
16. Сделайте следующей последней линией линии в функции `DoPropExchange`:  
  
     [!code-cpp[NVC_MFC_AxData#5](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_5.cpp)]  
  
17. Измените функцию `OnResetState` так, чтобы она будет содержать следующий код:  
  
     [!code-cpp[NVC_MFC_AxData#6](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_6.cpp)]  
  
18. Измените функцию `GetMyProp` так, чтобы она будет содержать следующий код:  
  
     [!code-cpp[NVC_MFC_AxData#7](../mfc/codesnippet/CPP/mfc-activex-controls-using-data-binding-in-an-activex-control_7.cpp)]  
  
 Теперь можно выполнить построение проекта, который регистрируется элемент управления.  При вводе элемент управления в диалоговое окно, свойства **Поле данных** и **Источник данных** будут добавлены и теперь choice источника данных и поля для отображения в элементе управления.  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)   
 [Элементы управления, связанные с данными \(ADO и RDO\)](../Topic/Data-Bound%20Controls%20\(ADO%20and%20RDO\).md)