---
title: "Контейнеры: Реализация контейнера | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- applications [OLE], OLE container
- OLE containers [MFC], implementing
ms.assetid: af1e2079-619a-4eac-9327-985ad875823a
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 1e43e1fb1c52413eaae05dcbe8331b1d48dd7e2a
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="containers-implementing-a-container"></a>Контейнеры. Реализация контейнера
В этой статье описаны процедуры для реализации контейнера и указываются на другие статьи, которые содержат более подробные объяснения о реализации контейнеров. Он также перечислены некоторые дополнительные компоненты OLE, которые могут потребоваться для реализации и статей, описывающих эти функции.  
  
#### <a name="to-prepare-your-cwinapp-derived-class"></a>Чтобы подготовить вашего класса, производного от CWinApp  
  
1.  Инициализировать библиотеки OLE, вызвав **AfxOleInit** в `InitInstance` функции-члена.  
  
2.  Вызовите `CDocTemplate::SetContainerInfo` в `InitInstance` для назначения меню и сочетаний клавиш ресурсы, используемые при встроенного элемента активации на месте. Дополнительные сведения по этой теме см. в разделе [активации](../mfc/activation-cpp.md).  
  
 Эти функции предоставляются для вас автоматически при использовании мастера приложений MFC для создания приложения-контейнера. В разделе [создание программы MFC EXE](../mfc/reference/mfc-application-wizard.md).  
  
#### <a name="to-prepare-your-view-class"></a>Чтобы подготовить класс представления  
  
1.  Отслеживания выбранных элементов путем сохранения указателя, или список указателей, если поддерживает выбор нескольких элементов, выбранных элементов. Ваш `OnDraw` функции необходимо нарисовать все элементы OLE.  
  
2.  Переопределить `IsSelected` для проверки, выделен ли в данный момент элемент, переданный в него.  
  
3.  Реализуйте **OnInsertObject** обработчик сообщений для отображения **вставить объект** диалоговое окно.  
  
4.  Реализуйте `OnSetFocus` сообщение обработчика необходимо передать фокус из представления active OLE на месте внедренных элементов.  
  
5.  Реализуйте `OnSize` обработчик сообщений для информирования OLE внедренных элементов, ему необходимо изменить его прямоугольник в соответствии с изменениями в размер его содержащего представления.  
  
 Поскольку реализацию этих функций значительно отличается от одного приложения к другому, мастер приложений предоставляет базовую реализацию. Вероятно, придется настроить эти функции для правильной работы приложения. Пример этого см. в разделе [КОНТЕЙНЕРА](../visual-cpp-samples.md) образца.  
  
#### <a name="to-handle-embedded-and-linked-items"></a>Для обработки внедренные и связанные элементы  
  
1.  Производный класс [COleClientItem](../mfc/reference/coleclientitem-class.md). Объекты этого класса представляют элементы, которые внедрены в, или связанного документа OLE.  
  
2.  Переопределить **OnChange**, `OnChangeItemPosition`, и `OnGetItemPosition`. Эти функции обрабатывают изменения размера, позиционирование и изменение внедренные и связанные элементы.  
  
 В мастере приложений будет наследовать класс для вас, но скорее всего, потребуется переопределить **OnChange** и другие функции перечислены с ним на шаге 2 предыдущей процедуры. Каркас реализации должно быть настроено для большинства приложений, так как эти функции реализованы иным образом из одного приложения к другому. В качестве примера, см. Примеры MFC [ФУНКЦИЙ](../visual-cpp-samples.md) и [КОНТЕЙНЕР](../visual-cpp-samples.md).  
  
 Количество элементов необходимо добавить к структуре меню приложения-контейнера для поддержки OLE. Дополнительные сведения об этом см. в разделе [меню и ресурсы: добавление контейнеров](../mfc/menus-and-resources-container-additions.md).  
  
 Можно также поддерживает некоторые из следующих компонентов в приложении контейнера:  
  
-   Активация на месте при редактировании встроенного элемента.  
  
     Дополнительные сведения см. в разделе [активации](../mfc/activation-cpp.md).  
  
-   Создание объекта OLE элементы с помощью перетаскивания выбор из серверного приложения.  
  
     Дополнительные сведения см. в разделе [перетаскивания и Drop (OLE)](../mfc/drag-and-drop-ole.md).  
  
-   Ссылки на внедренные объекты или сочетание контейнера и сервера приложений.  
  
     Дополнительные сведения см. в разделе [контейнеры: Дополнительные функции](../mfc/containers-advanced-features.md).  
  
## <a name="see-also"></a>См. также  
 [Контейнеры](../mfc/containers.md)   
 [Контейнеры. Элементы клиентов](../mfc/containers-client-items.md)

