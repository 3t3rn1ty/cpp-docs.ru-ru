---
title: "Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "элементы управления ActiveX [C++], страницы свойств"
  - "страницы пользовательского свойства"
  - "элементы управления MFC ActiveX [C++], страницы свойств"
  - "страницы свойств [C++], MFC ActiveX - элементы управления"
ms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Иногда элемент управления ActiveX имеет несколько свойств, чем может достаточно адаптация на одну страницу свойств.  В этом случае можно добавить страницы свойств для элемента управления ActiveX для отображения этих свойств.  
  
 Этот раздел описывает добавлять новые страницы свойств для элемента управления ActiveX, которая уже содержит по крайней мере одну страницу свойств.  Дополнительные сведения о добавлении страницы стандартных свойств \(на рисунке шрифт и цвет\) см. в разделе [Элементы управления ActiveX MFC. С помощью страницы стандартных свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md) статьи.  
  
 Следующие процедуры используют платформу элемент управления ActiveX, созданную с помощью мастера элементов управления ActiveX.  Поэтому имена классов и идентификаторы уникальны для этого примера.  
  
 Дополнительные сведения об использовании страниц свойств в элемент управления ActiveX см. в следующих статьях.  
  
-   [Элементы управления ActiveX MFC. Окна свойств](../mfc/mfc-activex-controls-property-pages.md)  
  
-   [Элементы управления ActiveX MFC. С помощью страницы стандартных свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)  
  
    > [!NOTE]
    >  Настоятельно рекомендуется использовать новые страницы свойств удовлетворяющие стандарту размера для страниц свойств для элементов управления ActiveX.  Страницы свойств фигуры и цвета биржевой отображают единица диалогового окна 250x62 \(ЕДИНИЦА\).  Страница свойств стандартного шрифта 250x110 DLU.  Страница свойств по умолчанию, созданную с помощью мастера элементов управления ActiveX используется стандартный 250x62 ЕДИНИЦА.  
  
### Вставить новый шаблон страницы свойств в проект  
  
1.  С проектом элемента управления открытым, откройте представление ресурсов в рабочей области проекта.  
  
2.  Щелкните правой кнопкой мыши в представлении ресурсов, чтобы открыть контекстное меню, и выберите пункт **Добавить ресурс**.  
  
3.  Разверните узел **Диалоговое окно**, и выделите **IDD\_OLE\_PROPPAGE\_SMALL**.  
  
4.  Нажмите `New`, чтобы добавить ресурс в проект.  
  
5.  Выделите новый шаблон страницы свойств для обновления окно свойств.  
  
6.  Введите новое значение свойства **Идентификатор**.  В этом примере используется **IDD\_PROPPAGE\_NEWPAGE**.  
  
7.  Щелкните значок **Сохранить** на панели инструментов.  
  
### Связывание нового шаблона с классом  
  
1.  Откройте представление классов.  
  
2.  Щелкните правой кнопкой мыши в представлении классов, чтобы открыть контекстное меню.  
  
3.  Выберите в контекстном меню команду **Добавить**, а затем **Добавить класс**.  
  
     Это открывает диалоговое окно [Добавление класса](../ide/add-class-dialog-box.md).  
  
4.  Дважды щелкните шаблон **Класс MFC**.  
  
5.  В поле **Имя класса** в [Мастер классов MFC](../mfc/reference/mfc-add-class-wizard.md), введите имя для нового класса диалогового окна. \(В этом примере, `CAddtlPropPage`\).  
  
6.  Если требуется изменить имена файлов, щелкните **Изменить**.  Введите имена в реализации и файлов заголовков или примите имя по умолчанию.  
  
7.  В поле **Базовый класс** , выберите `COlePropertyPage`.  
  
8.  В поле **Идентификатор диалогового окна** , выберите **IDD\_PROPPAGE\_NEWPAGE**.  
  
9. Нажмите кнопку **Готово** , чтобы создать класс.  
  
 Чтобы разрешить доступ пользователя элемента управления этой новой странице свойств, внесите следующие изменения в раздел макроса идентификатор страницы свойств элемента управления \(расположенному в файле реализации элемента управления\).  
  
 [!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/CPP/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]  
  
 Обратите внимание, что необходимо увеличить второй параметр макроса `BEGIN_PROPPAGEIDS` \(число\) страницы свойств в диапазоне от 1 до 2.  
  
 Необходимо также изменить файл файла реализации \(CPP\) для включения заголовок \(. Файл H\) класса страницы свойств.  
  
 Следующий шаг 2 включает в себя создание новых строкового ресурса, обеспечат имя типа и заголовок новой страницы свойств.  
  
#### Добавить строковые ресурсы на страницу свойств  
  
1.  С проектом элемента управления открытым, откройте представление ресурсов.  
  
2.  Дважды щелкните папку **Таблица строк** и дважды щелкните существующий ресурс строк таблицы, в которую требуется добавить строку.  
  
     Это открытия таблицы строк в окне.  
  
3.  Выделите незаполненная в конец таблицы строк и введите текст или заголовок, строки: например, «дополнительная страница свойств».  
  
     Это открывает страницу **Строковые свойства**, **Заголовок** и **Идентификатор** окна.  Поле **Заголовок** содержит строку вводе.  
  
4.  В окне **Идентификатор** выберите или введите идентификатор для строки.  Нажмите клавишу ВВОД после завершения.  
  
     Этот пример использует **IDS\_SAMPLE\_ADDPAGE** для имени типа новой страницы свойств.  
  
5.  Повторяющийся шаги 3 и 4 с помощью **IDS\_SAMPLE\_ADDPPG\_CAPTION** для идентификатора и дополнительной «страницы свойств» для заголовка.  
  
6.  В cpp\-файле нового класса страницы свойств \(в этом примере, `CAddtlPropPage`\) измените `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` таким образом, чтобы IDS\_SAMPLE\_ADDPAGE будет передан [AfxOleRegisterPropertyPageClass](../Topic/AfxOleRegisterPropertyPageClass.md), как показано в следующем примере:  
  
     [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/CPP/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]  
  
7.  Измените конструктор `CAddtlPropPage`, чтобы **IDS\_SAMPLE\_ADDPPG\_CAPTION** будет передается конструктору `COlePropertyPage` следующим образом:  
  
     [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/CPP/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]  
  
 После того как были сделаны необходимые перестроением изменений проекта и использовать тестовый контейнер для выполнения новой страницы свойств.  Сведения о доступе к тестовому контейнеру см. в разделе [Тестирование свойств и событий при помощи тестового контейнера](../mfc/testing-properties-and-events-with-test-container.md).  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)