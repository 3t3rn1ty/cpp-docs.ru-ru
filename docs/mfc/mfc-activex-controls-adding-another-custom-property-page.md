---
title: "Элементы управления ActiveX MFC: Добавление дополнительной страницы пользовательских свойств | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- property pages [MFC], MFC ActiveX controls
- custom property pages [MFC]
- ActiveX controls [MFC], property pages
- MFC ActiveX controls [MFC], property pages
ms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af
caps.latest.revision: "10"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 3e342df8bee9b69d0d84e3096f727d2c260b7493
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="mfc-activex-controls-adding-another-custom-property-page"></a>Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств
В некоторых случаях элемент управления ActiveX будет больше свойств, чем достаточно может поместиться на одной странице свойств. В этом случае можно добавить страницы свойств в элемент управления ActiveX для отображения этих свойств.  
  
 Добавление новых вкладок свойств в элемент управления ActiveX, который уже имеет по крайней мере одну страницу свойства описаны в этой статье. Дополнительные сведения о добавлении стандартных свойств страниц (шрифт, изображение или цвет), см. в статье [элементы управления MFC ActiveX: использование запасных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md).  
  
 В следующей процедуре используется структура элемента управления ActiveX образца, создаваемые с помощью мастера элементов управления ActiveX. Таким образом имена классов и идентификаторы являются уникальными для этого примера.  
  
 Дополнительные сведения об использовании страницы свойств в элементе управления ActiveX см. в следующих статьях:  
  
-   [Элементы ActiveX в MFC. Страницы свойств](../mfc/mfc-activex-controls-property-pages.md)  
  
-   [Элементы ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)  
  
    > [!NOTE]
    >  Настоятельно рекомендуется, новое свойство, которое страниц соответствовать размеру стандартных вкладок свойств элемента управления ActiveX. Стандартное свойство изображения и цвет страницы диалоговых единицах измерения 250 x 62 (Единица). Стандартные свойства шрифтов — 250 x 110 DLU. Страница свойств по умолчанию, создаваемые с помощью мастера элементов управления ActiveX использует стандартный Единица 250 x 62.  
  
### <a name="to-insert-a-new-property-page-template-into-your-project"></a>Вставка нового шаблона страницы свойств в проекте  
  
1.  Откройте проект элемента управления откройте представление ресурсов в рабочую область проекта.  
  
2.  Щелкните правой кнопкой мыши в представлении ресурсов, чтобы открыть контекстное меню и щелкните **добавить ресурс**.  
  
3.  Разверните **диалоговое окно** , а затем установите **IDD_OLE_PROPPAGE_SMALL**.  
  
4.  Щелкните `New` для добавления ресурса в проект.  
  
5.  Выберите новый шаблон страницы свойств для обновления окна «Свойства».  
  
6.  Введите новое значение для **идентификатор** свойство. В этом примере используется **IDD_PROPPAGE_NEWPAGE**.  
  
7.  Нажмите кнопку **Сохранить** на панели инструментов.  
  
### <a name="to-associate-the-new-template-with-a-class"></a>Чтобы связать новый шаблон с помощью класса  
  
1.  Откройте представление классов.  
  
2.  Щелкните правой кнопкой мыши в представлении классов, чтобы открыть контекстное меню.  
  
3.  В контекстном меню щелкните **добавить** и нажмите кнопку **Добавление класса**.  
  
     При этом откроется [добавить класс](../ide/add-class-dialog-box.md) диалоговое окно.  
  
4.  Дважды щелкните **класса MFC** шаблона.  
  
5.  В **имя класса** поле [мастер классов MFC](../mfc/reference/mfc-add-class-wizard.md), введите имя для нового класса диалогового окна. (В этом примере `CAddtlPropPage`.)  
  
6.  Если вы хотите изменить имена файлов, нажмите кнопку **изменить**. Введите имена для реализации и заголовок файлов или примите имена по умолчанию.  
  
7.  В **базовый класс** выберите `COlePropertyPage`.  
  
8.  В **идентификатор диалогового окна** выберите **IDD_PROPPAGE_NEWPAGE**.  
  
9. Нажмите кнопку **Готово** создание класса.  
  
 Разрешить пользователям элемента управления для этого новую страницу свойств, необходимо внести следующие изменения в элемент управления свойства страницы идентификаторы макрос раздел (находится в файле реализации элемента управления):  
  
 [!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]  
  
 Обратите внимание, что необходимо повысить уровень второго параметра `BEGIN_PROPPAGEIDS` макрос (количество страниц свойств) от 1 до 2.  
  
 Также необходимо изменить файл реализации элемента управления (. Файл .cpp) для включения заголовка (. H) файл нового класса страницы свойств.  
  
 Следующий шаг состоит в создании два новых строковые ресурсы, предоставляющие имени типа и заголовок для новой страницы свойств.  
  
#### <a name="to-add-new-string-resources-to-a-property-page"></a>Для добавления новых ресурсов для страницы свойств  
  
1.  Откройте проект элемента управления откройте представление ресурсов.  
  
2.  Дважды щелкните **таблица строк** папку и дважды щелкните существующую строку таблицы ресурсов, к которому нужно добавить строку.  
  
     В окне откроется таблицу строк.  
  
3.  Выберите пустую строку в конце строки таблицы и введите текст или заголовок строки: например, «дополнительные свойства страница.»  
  
     При этом откроется **свойства строки** отображением страницы **заголовок** и **идентификатор** поля. **Заголовок** поле содержит строку ввода.  
  
4.  В **идентификатор** выберите или введите идентификатор для строки. После завершения нажмите клавишу ВВОД.  
  
     В этом примере используется **IDS_SAMPLE_ADDPAGE** для имени типа новую страницу свойств.  
  
5.  Повторите шаги 3 и 4 с помощью **IDS_SAMPLE_ADDPPG_CAPTION** для идентификатора и «Страница дополнительные свойства» для заголовка.  
  
6.  В. CPP-файл нового класса страницы свойств (в этом примере `CAddtlPropPage`) изменить `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` , чтобы IDS_SAMPLE_ADDPAGE передается по [AfxOleRegisterPropertyPageClass](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), как показано в следующем примере:  
  
     [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]  
  
7.  Измените конструктор элемента `CAddtlPropPage` , чтобы **IDS_SAMPLE_ADDPPG_CAPTION** передается `COlePropertyPage` конструктора, как показано ниже:  
  
     [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]  
  
 После внесения необходимых изменений заново постройте проект и использовать контейнер для тестирования новую страницу свойств. Сведения о том, как получить доступ к Контейнеру для тестирования, см. в разделе [Тестирование свойств и событий в Контейнере для тестирования](../mfc/testing-properties-and-events-with-test-container.md) .  
  
## <a name="see-also"></a>См. также  
 [Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)

