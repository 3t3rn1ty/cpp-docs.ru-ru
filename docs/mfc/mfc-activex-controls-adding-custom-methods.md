---
title: "Элементы управления ActiveX в MFC. Добавление пользовательских методов | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC ActiveX - элементы управления, методы"
  - "PtInCircle - пользовательский метод"
ms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18
caps.latest.revision: 11
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Элементы управления ActiveX в MFC. Добавление пользовательских методов
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Пользовательские методы отличаются от стандартных методов, так как они еще не реализованы `COleControl`.  Необходимо указать реализацию для каждого пользовательского метода добавляется к элементу управления.  
  
 Пользователь элемент управления ActiveX может вызывать пользовательский метод в любое время для выполнения действий для отдельного элемента управления.  Запись схемы подготовки к сообщению для пользовательских методов формы `DISP_FUNCTION`.  
  
##  <a name="_core_adding_a_custom_method_with_classwizard"></a> Чтобы добавить пользовательский метод с помощью мастера добавления метода.  
 В следующей процедуре показано добавление пользовательского PtInCircle метод в код элемента управления ActiveX каркасному.  Определяет, является ли PtInCircle координаты, заданных в элемент управления внутри или вне круга.  Эту одной процедуры можно также использовать для добавления дополнительных пользовательские методы.  Замените имя пользовательского метода и его параметры имени и параметров метода PtInCircle.  
  
> [!NOTE]
>  В данном примере функция `InCircle` из событий статьи.  Дополнительные сведения об этой функции см. в разделе [Элементы управления ActiveX MFC. Добавление пользовательских событий к элементу управления ActiveX](../Topic/MFC%20ActiveX%20Controls:%20Adding%20Custom%20Events.md) статьи.  
  
#### Чтобы добавить пользовательский метод PtInCircle с помощью мастера добавления метода.  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении классов разверните узел библиотеки элемента управления.  
  
3.  Щелкните правой кнопкой мыши узел интерфейса для элемента управления \(второго узла узла библиотеки\), чтобы открыть контекстное меню.  
  
4.  В контекстном меню щелкните **Добавить**, а затем щелкните **Добавить метод**.  
  
     Это будет открыт мастер добавления метода.  
  
5.  В поле **Имя метода** введите `PtInCircle`.  
  
6.  В поле **Внутреннее имя** введите имя функции метода внутренней или примите значение по умолчанию \(в данном случае `PtInCircle`\).  
  
7.  В поле **Возвращаемый тип**, щелкните **VARIANT\_BOOL** для возвращаемого типа метода.  
  
8.  Использование элементов управления **Тип параметра** и **Имя параметра** добавьте параметр с именем `xCoord` \(типом **OLE\_XPOS\_PIXELS**\).  
  
9. Использование элементов управления **Тип параметра** и **Имя параметра** добавьте параметр с именем `yCoord` \(типом **OLE\_YPOS\_PIXELS**\).  
  
10. Нажмите кнопку **Готово**.  
  
##  <a name="_core_classwizard_changes_for_custom_methods"></a> Добавьте мастера изменения метода для пользовательских методов  
 При добавлении пользовательского метода, мастера добавления метода выполняет некоторые изменения в качестве заголовка класса элемента управления \(. H\) и файлы реализации \(CPP\).  В следующей линия добавляется к объявлению схемы подготовки к отправке в заголовке \(класса элемента управления. Файл H\).  
  
 [!code-cpp[NVC_MFC_AxUI#18](../mfc/codesnippet/CPP/mfc-activex-controls-adding-custom-methods_1.h)]  
  
 Этот код объявляет метод `PtInCircle` диспетчеризации вызывается обработчиком.  Эта функция может быть вызвана пользователем элемента управления с помощью внешнего имени PtInCircle.  
  
 В следующей линия добавляется в файл .IDL элемента управления:  
  
 [!code-cpp[NVC_MFC_AxUI#19](../mfc/codesnippet/CPP/mfc-activex-controls-adding-custom-methods_2.idl)]  
  
 Эта линия присвоить метод PtInCircle определенный идентификатор, позиция метода в методах мастера добавления метода и свойства перечислены.  Поскольку мастера добавления метода использовался для добавления пользовательский метод, запись для ее была добавлена .IDL автоматически в файл проекта.  
  
 Кроме того, следующая линия, расположенная в файле реализации \(CPP\) класса элемента управления, добавляется в схеме подготовки к отправке элемента управления:  
  
 [!code-cpp[NVC_MFC_AxUI#20](../mfc/codesnippet/CPP/mfc-activex-controls-adding-custom-methods_3.cpp)]  
  
 Макрос `DISP_FUNCTION` сопоставляет метод PtInCircle функции обработчика элемента управления, `PtInCircle`, следует объявить тип возвращаемого значения, возвратят значение **VARIANT\_BOOL**, и объявляет 2 параметров типа **VTS\_XPOS\_PIXELS**  и **VTS\_YPOSPIXELS**, передаваемые `PtInCircle`.  
  
 Наконец, мастера добавления метода функциональность `CSampleCtrl::PtInCircle` заглушки в конце файла реализации элемента управления \(CPP\).  Для `PtInCircle` к функции, как показано выше, его необходимо изменить следующим образом:  
  
 [!code-cpp[NVC_MFC_AxUI#21](../mfc/codesnippet/CPP/mfc-activex-controls-adding-custom-methods_4.cpp)]  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)   
 [Значки представления классов и обозревателя объектов](../Topic/Class%20View%20and%20Object%20Browser%20Icons.md)