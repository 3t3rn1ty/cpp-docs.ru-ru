---
title: 'Элементы управления ActiveX MFC: Добавление пользовательских методов | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- MFC ActiveX controls [MFC], methods
- PtInCircle custom method [MFC]
ms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 6b20d649bc89d9d66103f258ebdfdac767f431b5
ms.sourcegitcommit: 060f381fe0807107ec26c18b46d3fcb859d8d2e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36930052"
---
# <a name="mfc-activex-controls-adding-custom-methods"></a>Элементы управления ActiveX в MFC. Добавление пользовательских методов
Настраиваемые методы отличаются от стандартных методов, что они уже не реализуются с `COleControl`. Вы должны предоставить реализацию для каждого пользовательского метода, который можно добавить в элемент управления.  
  
 Пользователь элемента управления ActiveX можно вызвать пользовательский метод в любое время для выполнения действий, определяемых элементом управления. Запись сопоставления диспетчеризации для пользовательских методов имеет форму DISP_FUNCTION.  
  
##  <a name="_core_adding_a_custom_method_with_classwizard"></a> Добавление пользовательского метода с мастер добавления метода  
 Ниже показано, как добавить пользовательский метод PtInCircle каркас код элемента управления ActiveX. PtInCircle определяет внутри или вне круга координаты, передаются в элемент управления. Такую же процедуру можно также добавить другие настраиваемые методы. Замените имя пользовательского метода и его параметры для PtInCircle имя метода и параметров.  
  
> [!NOTE]
>  В этом примере используется `InCircle` функции из статьи события. Дополнительные сведения о данной функции см. в статье [элементы управления MFC ActiveX: Добавление пользовательских событий для элемента управления ActiveX](../mfc/mfc-activex-controls-adding-custom-events.md).  
  
#### <a name="to-add-the-ptincircle-custom-method-using-the-add-method-wizard"></a>Чтобы добавить PtInCircle-пользовательский метод, с помощью мастера добавления метода  
  
1.  Загрузите проект элемента управления.  
  
2.  В представлении класса разверните узел библиотеки элемента управления.  
  
3.  Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.  
  
4.  В контекстном меню щелкните **добавить** и нажмите кнопку **добавить метод**.  
  
     Откроется мастер добавления метода.  
  
5.  В **имя метода** введите *PtInCircle*.  
  
6.  В **внутреннее имя** введите имя метода внутренней функции или использовать значение по умолчанию (в этом случае *PtInCircle*).  
  
7.  В **тип возвращаемого значения** щелкните **VARIANT_BOOL** для типа возвращаемого значения метода.  
  
8.  С помощью **тип параметра** и **имя параметра** элементы управления, добавьте параметр с именем *xCoord* (тип *OLE_XPOS_PIXELS*).  
  
9. С помощью **тип параметра** и **имя параметра** элементы управления, добавьте параметр с именем *yCoord* (тип *OLE_YPOS_PIXELS*).  
  
10. Нажмите кнопку **Готово**.  
  
##  <a name="_core_classwizard_changes_for_custom_methods"></a> Добавьте метод мастер изменения для пользовательских методов  
 При добавлении настраиваемого метода, мастер добавления метода вносит некоторые изменения в заголовке класса элемента управления (. (H) и реализации (. Файлы CPP). Следующая строка добавляется к объявлению карты распределения в заголовке класса элемента управления (. H) файла.  
  
 [!code-cpp[NVC_MFC_AxUI#18](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_1.h)]  
  
 Этот код объявляет обработчик метод распределения, который называется `PtInCircle`. Эта функция может вызываться пользователем элемента управления с помощью внешнего имени `PtInCircle`.  
  
 Следующая строка добавляется к элементу управления. IDL-файла:  
  
 [!code-cpp[NVC_MFC_AxUI#19](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_2.idl)]  
  
 Эта строка назначает `PtInCircle` метод с определенным номером идентификатора, метод позицию в списке мастера добавления метода методы и свойства. Поскольку мастер добавления метода был использован для добавления пользовательского метода, была автоматически добавлена запись для него в проект. IDL-файл.  
  
 Кроме того, следующая строка находится в реализации (. Файл .cpp) класса элемента управления, добавляется элемент управления карты распределения:  
  
 [!code-cpp[NVC_MFC_AxUI#20](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_3.cpp)]  
  
 DISP_FUNCTION-макрос сопоставляет метод `PtInCircle` к функции обработчика элемента управления, `PtInCircle`, объявляет тип возвращаемого значения для **VARIANT_BOOL**и объявляет двумя параметрами типа **VTS_XPOS_PIXELS** и **VTS_YPOSPIXELS** должен быть передан `PtInCircle`.  
  
 Наконец, мастер добавления метода добавляет функцию заглушки `CSampleCtrl::PtInCircle` в нижнюю часть реализации элемента управления (. Файл CPP). Для `PtInCircle` функционировать как уже говорилось ранее, его необходимо изменить следующим образом:  
  
 [!code-cpp[NVC_MFC_AxUI#21](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_4.cpp)]  
  
## <a name="see-also"></a>См. также  
 [Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)   
 [Значки представления классов и обозревателя объектов](/visualstudio/ide/class-view-and-object-browser-icons)

