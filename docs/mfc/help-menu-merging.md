---
title: "Слияние меню \"Справка\" | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
caps.latest.revision: "11"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 218493b6346858d33df042ec5754775272b1d788
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2017
---
# <a name="help-menu-merging"></a>Слияние меню "Справка"
При включенном в контейнере объекта слияние протокола OLE документов меню предоставляет объект полный контроль над **справки** меню. В результате разделы справки контейнера недоступны, если пользователь отключает объект. Архитектура вложения активного документа расширяет правила для слияния для контейнера и активного документа, которая является активной в то же меню меню на месте. Новые правила, просто дополнительных соглашения о какой компонент, которому принадлежит какой-либо части меню и создание общего меню.  
  
 Новое соглашение проста. В активных документах **справки** меню содержит два элемента меню верхнего уровня, следующую структуру:  
  
 `Help`  
  
 `Container Help >`  
  
 `Object Help    >`  
  
 Например, когда активна раздела Word в Office Binder, то **справки** меню будет выглядеть следующим образом:  
  
 `Help`  
  
 `Binder Help >`  
  
 `Word Help   >`  
  
 И элементы меню, вложенные меню, при которых все пункты меню, относящиеся к контейнеру и объект предоставляются пользователю. Какие элементы будут отображаться здесь зависит от контейнеров и объектов участвующих.  
  
 Для создания слияние **справки** меню, архитектура вложения активного документа изменяет обычные процедуры OLE-документы. Согласно документов OLE, объединенные меню могут иметь шесть группы меню, а именно **файл**, **изменить**, **контейнера**, `Object`, **окна**, **Справки**в указанном порядке. В каждой группе может быть ноль или более меню. Группы **файл**, **контейнера**, и **окна** принадлежать к контейнеру и групп **изменить**, **объект,** и **справки** принадлежит объекту. При объект хочет выполнить слияние меню, создается пустой меню и передает его в контейнер. Контейнер, затем вставляет его меню путем вызова **IOleInPlaceFrame::InsertMenus**. Объект также передает структуру, которая является массивом из шести ДЛИННЫЕ значения (**OLEMENUGROUPWIDTHS**). После вставки меню, контейнер помечает сколько меню, оно будет добавлено в каждом из них его группы, а затем возвращает. Затем объект вставляет его меню, обращая внимание на число меню в каждой группе контейнера. Наконец объект передает слияния меню и массив (который содержит число меню в каждой группе) OLE, который возвращает значение непрозрачный «дескриптор меню» обрабатывать. Позднее объект передает этот дескриптор и слияние меню в контейнер через **IOleInPlaceFrame::SetMenu**. В настоящее время контейнер отображает объединенные меню и также передает дескриптор OLE, позволяя OLE можно сделать правильной диспетчеризации сообщений меню.  
  
 В процедуре изменения активного документа, сначала необходимо инициализировать объект **OLEMENUGROUPWIDTHS** элементы до нуля перед передачей его в контейнер. Затем контейнер выполняет вставку обычного меню с одним исключением: вставок контейнера **справки** меню как последний элемент и сохраняет значение 1 в последней записи (шестой) **OLEMENUGROUPWIDTHS** массива (т. е ширина [5], который принадлежит группе справки объекта). Это **справки** меню будет иметь только один элемент, который является подменю «**контейнера справки** >» меню cascade как описано выше.  
  
 Объект затем выполняет свой код вставки обычного меню, за исключением того, перед вставкой его **справки** меню, он проверяет ввод шестой **OLEMENUGROUPWIDTHS** массива. Если значение равно 1, а последнее меню называется **справки** (или соответствующие локализованные строки), а затем вставляет объект его **справки** меню в виде подменю контейнера **справки** меню.  
  
 Объект, затем устанавливает на шестой элемент **OLEMENUGROUPWIDTHS** нулю и увеличивает на единицу пятого элемента. Таким образом, чтобы знать, что OLE **справки** меню принадлежит к контейнеру и меню сообщения, соответствующие соответствующее меню (и его подменю) должно быть направлено в контейнер. Возлагается затем контейнера для пересылки `WM_INITMENUPOPUP`, **WM_SELECT**, **WM_COMMAND**и других сообщений, связанных с меню, относящиеся к части объекта **справки**  меню. Это достигается с помощью `WM_INITMENU` Снимите флаг, который указывает контейнеру ли пользователь перешел в объект **справки** меню. Затем отслеживает контейнер `WM_MENUSELECT` для записи в или выход из любой элемент **справки** меню, в котором сам не добавить контейнер. Операции, значит пользователь перешел в меню объекта, поэтому контейнер устанавливает флаг «в "меню Справка" объекта» и использует состояние флага для перенаправления любые `WM_MENUSELECT`, `WM_INITMENUPOPUP`, и **WM_COMMAND** сообщений, как минимум, с окна объекта. (При выходе контейнер снимает флаг и затем обрабатывает эти же сообщения себя.) Контейнер должен использовать окна, возвращенные из объекта **IOleInPlaceActiveObejct::GetWindow** работать в качестве назначения для этих сообщений.  
  
 Если объект определяет нуль в шестой элемент **OLEMENUGROUPWIDTHS**, оно проходит согласно обычным правилам OLE-документы. Эта процедура охватывает контейнеры, которые участвуют в **справки** слияния, а также те, которые не меню.  
  
 При вызове объекта **IOleInPlaceFrame::SetMenu**, прежде чем ли отображение объединенной строки меню, проверки контейнера **справки** меню содержит дополнительные подменю, помимо контейнер имеет Вставить. Если таким образом, контейнер остается его **справки** меню в объединенное меню окна. Если **справки** меню не имеет дополнительных подменю, приведет к удалению контейнера его **справки** меню из панели объединенное меню. Эта процедура охватывает объектов, участвующих в **справки** слияния, а также те, которые не меню.  
  
 Наконец, при дизассемблировать меню объекта удаляются inserted **справки** меню в дополнение к удалить оставшиеся вставлено меню. Когда контейнер удаляет его меню, будут удалены его **справки** меню в дополнение к другим меню, которые она была вставлена.  
  
## <a name="see-also"></a>См. также  
 [Контейнеры активных документов](../mfc/active-document-containers.md)

