---
title: "Буфер обмена. Использование буфера обмена Windows | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "буфер обмена [C++], команды"
  - "буфер обмена [C++], API буфера обмена Windows"
  - "Команды буфера обмена"
  - "Команды буфера обмена, реализация"
  - "команды [C++], реализация правки"
  - "функции обработчика команд вырезки, копирования и вставки"
  - "функции обработчика, команды вырезки, копирования и вставки"
  - "Буфер обмена Windows [С++]"
ms.assetid: 24415b42-9301-4a70-b69a-44c97918319f
caps.latest.revision: 10
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Буфер обмена. Использование буфера обмена Windows
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

В этом разделе описывается, как использовать стандартное API обмена Windows в приложении MFC.  
  
 Большинство приложений для Windows поддерживают вырезывание или копировать данные в буфер обмена Windows и вставьте данные из буфера обмена.  Форматы данных обмена зависят от приложений.  Платформа поддерживает только ограниченное число форматов обмена для ограниченного числа классов.  Обычно при реализации Обмен\- связанные команды — вырезать, копировать и вставлять — в меню " Правка " для данного представления.  Библиотека классов определяет идентификаторы команд для следующих команд: **ID\_EDIT\_CUT**, **ID\_EDIT\_COPY** и **ID\_EDIT\_PASTE**.  Их запросы сообщение\-линии также определены.  
  
 [Сообщения и команды в платформе .NET Framework](../mfc/messages-and-commands-in-the-framework.md) описывается обработка команды меню в приложении путем сопоставления команды меню в функции обработчика.  Если приложение не определяет функции обработчиков команд для обмена в меню " Правка ", они остаются отключенными.  Для написания функции обработчика для копирования и вырезания команд реализуйте выделение в приложении.  Для написания функции обработчика для команд вставить запрос и просмотреть содержит ли он данные в формате, приложение может принять.  Например, чтобы включить команду копирования, можно написать обработчик примерно следующим образом:  
  
 [!code-cpp[NVC_MFCListView#2](../mfc/codesnippet/CPP/clipboard-using-the-windows-clipboard_1.cpp)]  
  
 Команды вырезать, копировать и вставлять значения только в определенных контекстах.  Вырежьте и команды копирования должны быть разрешены только в том случае, если было выбрано, а команда " только при любой текст в буфер обмена.  Это свойство предоставляет расширение функциональности путем определения функции обработчика обновления, включающих или запретят эти команды в зависимости от контекста.  Дополнительные сведения см. в разделе [Процесс обновления объектов пользовательского интерфейса](../mfc/how-to-update-user-interface-objects.md).  
  
 Библиотеки Microsoft Foundation Class обеспечивает поддержку обмена для редактирования текста с классами `CEdit` и `CEditView`.  Класс OLE также упрощают реализации операции с буфером обмена, включающих элемент OLE.  Дополнительные сведения о класс OLE см. в разделе [Буфер обмена. Использование OLE механизм буфера обмена](../mfc/clipboard-using-the-ole-clipboard-mechanism.md).  
  
 Реализация другие команды меню " Правка, например откат \(**ID\_EDIT\_UNDO**\) и повтор \(**ID\_EDIT\_REDO**\), также является производным вам.  Если приложение не поддерживает эти команды, можно легко удалите их из файла ресурсов с помощью редакторов ресурсов Visual C\+\+.  
  
## Дополнительные сведения  
  
-   [Копирование и вставящ данные](../Topic/Clipboard:%20Copying%20and%20Pasting%20Data.md)  
  
-   [Использование OLE механизм буфера обмена](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)  
  
## См. также  
 [буфер обмена](../mfc/clipboard.md)