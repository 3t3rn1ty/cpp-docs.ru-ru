---
title: "Элементы управления ActiveX в MFC. Создание сервера автоматизации | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "элементы управления ActiveX [C++], Сервер автоматизации"
  - "Серверы автоматизации [C++], MFC ActiveX - элементы управления"
  - "элементы управления MFC ActiveX [C++], Сервер автоматизации"
ms.assetid: e0c24ed2-d61c-49ad-a4fa-4e1098d1d39b
caps.latest.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# Элементы управления ActiveX в MFC. Создание сервера автоматизации
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Можно разработать элемент управления ActiveX MFC в качестве сервера автоматизации для программным образом внедрить этот элемент управления в другом приложении и вызывать методы в элементе управления из приложения.  Такой элемент управления по\-прежнему будет иметь доступны размещаться в контейнере элементов управления ActiveX.  
  
### Создание элемента управления в качестве сервера автоматизации  
  
1.  [Создать](../mfc/reference/mfc-activex-control-wizard.md) элемент управления.  
  
2.  [Добавьте методы](../mfc/mfc-activex-controls-methods.md).  
  
3.  Переопределение [IsInvokeAllowed](../Topic/COleControl::IsInvokeAllowed.md).  Дополнительные сведения см. в статье Q146120 информационной базы данных.  
  
4.  Сборка элемента управления.  
  
### Программный доступ к методам в сервере автоматизации  
  
1.  Создание приложения, например [EXE MFC](../Topic/MFC%20Application%20Wizard.md).  
  
2.  В начале функции `InitInstance` добавьте следующую линия:  
  
     [!code-cpp[NVC_MFC_AxCont#17](../mfc/codesnippet/CPP/mfc-activex-controls-creating-an-automation-server_1.cpp)]  
  
3.  В представлении классов щелкните правой кнопкой мыши узел проекта и выберите **Добавление класса в библиотеку типов**, чтобы импортировать библиотеку типов.  
  
     Это добавит файлы с расширениями имени файла h и cpp\-файл в проект.  
  
4.  В файле заголовка класса, в котором вызывается один или несколько методов в элемент управления ActiveX, добавьте следующую линия: `#include filename.h`, где имя файла — имя файла заголовка, который был создан при импортированный библиотеки типов.  
  
5.  В функции, в котором будет сделан вызов метода в элемент управления ActiveX, добавьте код, который создает объект класс\-оболочки элемента управления и создайте объект ActiveX.  Например, следующий код создает элемент управления MFC `CCirc`, получает свойство заголовка, и отображает результат нажатия кнопки " ОК " нажато в диалоговом окне.  
  
     [!code-cpp[NVC_MFC_AxCont#18](../mfc/codesnippet/CPP/mfc-activex-controls-creating-an-automation-server_2.cpp)]  
  
 Если добавить методы в элемент управления ActiveX, после использования его в приложении, вы можете использовать последнюю версию элемента управления в приложении путем удаления файлов, которые были созданы при импортированный библиотеки типов.  Затем следует импортировать библиотеку типов снова.  
  
## См. также  
 [Элементы управления ActiveX MFC](../mfc/mfc-activex-controls.md)