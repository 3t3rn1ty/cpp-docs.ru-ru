---
title: "Общие сведения о MSBuild (Visual C++) | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MSBuild - обзор"
ms.assetid: dd258f6f-ab51-48d9-b274-f7ba911d05ca
caps.latest.revision: 17
caps.handback.revision: 17
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
---
# Общие сведения о MSBuild (Visual C++)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

MSBuild — стандартный система сборки для проектов Visual C++. При построении проекта в среде разработки Visual Studio (IDE), он использует средство msbuild.exe, XML файла проекта и файлы дополнительных параметров. Несмотря на то, что с помощью msbuild.exe и файл проекта в командной строке, интегрированная среда Разработки предоставляет пользовательский интерфейс, чтобы пользователь мог легко настроить параметры и построить проект. В этом обзоре описывается использование системы MSBuild в Visual C++.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Прочитайте следующие документы о MSBuild.  
  
 [MSBuild](MSBuild1.md)  
 Обзор понятий MSBuild.  
  
 [Справочные сведения о MSBuild](../Topic/MSBuild%20Reference.md)  
 Справочные сведения о системе MSBuild.  
  
 [Справочник по схеме файла проекта](../Topic/MSBuild%20Project%20File%20Schema%20Reference.md)  
 Список элементов схемы XML MSBuild, и их атрибутов и родительских и дочерних элементов. Обратите внимание, особенно [ItemGroup](../Topic/ItemGroup%20Element%20\(MSBuild\).md), [PropertyGroup](../Topic/PropertyGroup%20Element%20\(MSBuild\).md), [целевой](../Topic/Target%20Element%20\(MSBuild\).md), и [задачи](../Topic/Task%20Element%20\(MSBuild\).md) элементы.  
  
 [Справочник по командной строке](../Topic/MSBuild%20Command-Line%20Reference.md)  
 Описывает аргументы командной строки и параметры, которые можно использовать с помощью msbuild.exe.  
  
 [Справочные сведения о задачах](../Topic/MSBuild%20Task%20Reference.md)  
 Описывает задачи MSBuild. Особое внимание уделите эти задачи, которые относятся к Visual C++: [Задача BscMake](../Topic/BscMake%20Task.md), [CL-задача](../Topic/CL%20Task.md), [CPPClean-задача](../Topic/CPPClean%20Task.md), [LIB-задача](../Topic/LIB%20Task.md), [связывания задачи](../Topic/Link%20Task.md), [задача MIDL](../Topic/MIDL%20Task.md), [MT-задача](../Topic/MT%20Task.md), [Задача RC](../Topic/RC%20Task.md), [Задача SetEnv](../Topic/SetEnv%20Task.md), [VCMessage-задача](../Topic/VCMessage%20Task.md), [Задача XDCMake](../Topic/XDCMake%20Task.md), [XSD-задача](../Topic/XSD%20Task.md).  
  
## <a name="msbuild-on-the-command-line"></a>MSBuild в командной строке  
 Следующий отрывок из [Справочник по командной строки](../Topic/MSBuild%20Command-Line%20Reference.md) документ показывает, что средство msbuild.exe принимает явный или неявный `project file` аргумент (VCXPROJ-файл для проектов Visual C++) и ноль или более командной строки `options`.  
  
 **msbuild.exe [** `project file` **] [** `options` **]**  
  
 Используйте **/target-** (или **/t**) и **/property** (или **/p**) параметры командной строки для переопределения свойств и целей, указанных в файле проекта.  
  
 Важная функция файла проекта является указание *целевой*, который является конкретной операцией, применяемой для проекта и входов и выходов, которые требуются для выполнения этой операции. Файл проекта можно указать один или несколько целевых объектов, включая целевой объект по умолчанию.  
  
 Каждый целевой объект состоит из последовательности из одной или нескольких *задачи*. Каждая задача представляется классом .NET Framework, содержащим одну исполняемую команду. Например [CL-задача](../Topic/CL%20Task.md) содержит [cl.exe](../build/reference/compiling-a-c-cpp-program.md) команды.  
  
 A *параметр задачи* свойство класса задачи, обычно представляет параметр командной строки исполняемой команды. Например `FavorSizeOrSpeed` параметр `CL` Задача соответствует **/Os** и **/Ot** Параметры компилятора.  
  
 Дополнительные параметры задачи поддерживают инфраструктуру MSBuild. Например `Sources` параметр задачи указывает набор задач, которые могут быть использованы другими задачами. Дополнительные сведения о задачах MSBuild см. в разделе [Справочные сведения о задачах](../Topic/MSBuild%20Task%20Reference.md).  
  
 Для большинства задач требуются входные и выходные данные, такие как имена файлов, пути и строки, числовые или логические параметры. Например часто к входным данным — имя исходного CPP-файла для компиляции. Важные входного параметра является строка, указывающая конфигурации сборки и платформы, например, «отладка &#124; Win32». Входные и выходные данные задаются один или несколько определяемых пользователем XML `Item` элементов, содержащихся в `ItemGroup` элемент.  
  
 Файл проекта можно также указать пользовательские *Свойства* и *группу определения элементов**элементы*. Свойства и элементы формируют пары имя/значение, которые можно использовать в качестве переменных при построении. Компонент имени пары определяет *макрос*, а компонент значения объявляет *значение макроса*. Макрос свойств осуществляется с помощью $(*имя*) нотации и макрос элемента осуществляется с помощью %(*имя*) нотации.  
  
 Другие элементы XML в файле проекта можно тестировать макросы и затем условно значение любого макроса или контролировать выполнение построения. Имена макросов и строковые литералы можно сцепить для создания конструкций, таких как путь и имя файла. В командной строке **/property** Задает или переопределяет свойства проекта. Элементы нельзя ссылаться в командной строке.  
  
 Система MSBuild может условно выполнить целевой объект до или после другого целевого объекта. Кроме того эта система может построить целевой объект на основании ли целевой объект использует файлы новее, чем выдаваемые им файлы.  
  
## <a name="msbuild-in-the-ide"></a>Использование MSBuild в Интегрированной среде разработки  
 При задании свойств проекта в Интегрированной среде разработки и сохраните проект Visual C++ записывает параметры проекта в файл проекта. Файл проекта содержит параметры, уникальные для данного проекта, но не содержит все параметры, необходимые для построения проекта. Файл проекта содержит `Import` элементы, включающие в себя набор дополнительных *файлы поддержки.* Файлы поддержки содержат оставшиеся свойства, целевые объекты и параметры, необходимые для построения проекта.  
  
 Большинство целевых объектов и свойств в файлах поддержки существуют исключительно для реализации системы построения. В следующем разделе описываются некоторые полезные целевые объекты и свойства, которые можно указать в командной строке MSBuild. Чтобы найти дополнительные целевые объекты и свойства, просмотрите файлы в каталогах файлов поддержки.  
  
### <a name="support-file-directories"></a>Каталоги файлов поддержки  
 По умолчанию основные файлы поддержки Visual C++ расположены в следующих каталогах.  
  
|Каталог|Описание|  
|---------------|-----------------|  
|*диск*: \Program Files\MSBuild\Microsoft.Cpp\v4.0\\*версии*\|Содержит основные файлы целевых (с расширением TARGETS) и файлы свойств (с расширением PROPS), используемые целевыми объектами. По умолчанию макрос $(VCTargetsPath) ссылается на этот каталог.|  
|*диск*: \Program Files\MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\|Содержит файлы цель и свойство платформы, которые переопределяют целевые объекты и свойства в родительском каталоге. Этот каталог также содержит DLL-файл, который определяет задачи, которые используются целевыми объектами в данном каталоге.<br /><br />  *Платформы* Заполнитель `ARM`, `Win32`, или `x64` подкаталог.|  
|*диск*: \Program Files\MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\PlatformToolsets\\*набора инструментов*\|Содержит каталоги, которые обеспечивают построение приложений Visual C++ с указанным *версии* набора инструментов.<br /><br />  *Платформы* Заполнитель `ARM`, `Win32`, или `x64` подкаталог.  *Набор инструментов* заполнитель представляет подкаталог набора средств для создания приложений Windows, Windows XP или Windows Phone.|  
|*диск*: \Program Files\MSBuild\Microsoft.Cpp\v4.0\Platforms\\*платформы*\PlatformToolsets\\*набора инструментов*\|Содержит каталоги, которые обеспечивают построение версии 9.0 или Visual C++ 10.0 приложений.<br /><br />  *Платформы* Заполнитель `Itanium`, `Win32`, или `x64` подкаталог.  *Набор инструментов* Заполнитель `v90` или `v100` подкаталог набора средств.|  
  
### <a name="support-files"></a>Файлы поддержки  
 Каталоги файлов поддержки содержат файлы с расширениями.  
  
|Расширение|Описание|  
|---------------|-----------------|  
|.targets|Содержит `Target` элементы XML, которые задают задачи, выполняемые целевым объектом. Может также содержать `Property Group`, `Item Group`, `Item Definition Group`, и определяемых пользователем `Item` элементов, используемых для назначения параметров задачи файлы и параметры командной строки.<br /><br /> Дополнительные сведения см. в разделе [элемент Target (MSBuild)](../Topic/Target%20Element%20\(MSBuild\).md).|  
|.props|Содержит `Property Group` и определяемых пользователем `Property` XML-элементов, укажите файл и параметры, которые используются во время построения.<br /><br /> Может также содержать `Item Definition Group` и определяемых пользователем `Item` XML-элементы, задающие Дополнительные параметры. Элементы, определенные в группу определений элемента напоминают свойства, но нельзя получить доступ из командной строки. Файлы проекта Visual C++ часто вместо свойств используются элементы для представления параметров.<br /><br /> Дополнительные сведения см. в разделе [элемент ItemGroup (MSBuild)](../Topic/ItemGroup%20Element%20\(MSBuild\).md), [элемент ItemDefinitionGroup (MSBuild)](../Topic/ItemDefinitionGroup%20Element%20\(MSBuild\).md), и [элемент Item (MSBuild)](../Topic/Item%20Element%20\(MSBuild\).md).|  
|XML|Содержит XML-элементы, объявления и инициализации элементов пользовательского интерфейса интегрированной среды Разработки, например вкладки свойств и страницы свойств и поле и список текстовых полей.<br /><br /> XML-файлы непосредственно поддерживают интегрированную среду Разработки, не MSBuild. Тем не менее присваиваются значения свойств интегрированной среды Разработки для создания свойств и элементов.<br /><br /> Большинство XML-файлы хранятся в подкаталоге языковому стандарту. Например, файлы для региона английский (США) находятся в $(VCTargetsPath) \1033\\.|  
  
## <a name="user-targets-and-properties"></a>Пользовательские целевые объекты и свойства  
 Для наиболее эффективного использования MSBuild в командной строке, полезно знать, какие свойства и целевые объекты являются полезным и нужным. Большинство свойств и целевых объектов упрощают реализацию системы построения Visual C++ и поэтому не связаны с пользователем. В этом разделе описаны некоторые оправданной свойства, ориентированные на пользователей и целевых объектов.  
  
### <a name="platformtoolset-property"></a>Свойство PlatformToolset  
  `PlatformToolset` Свойство определяет, какой набор инструментов Visual C++, используемых в построении. Значение свойства сцепляется со строковыми литералами для формирования пути к каталогу, содержащему файлы свойств и целевых объектов, которые необходимы для построения проекта для определенной платформы.  
  
 Задать `PlatformToolset` Свойства `v110` использовать [!INCLUDE[cpp_dev11_long](../build/includes/cpp_dev11_long_md.md)] инструменты и библиотеки для построения приложения.  
  
 `msbuild myProject.vcxproj /p:PlatformToolset=v110`  
  
 Задать `PlatformToolset` Свойства `v100` использовать [!INCLUDE[cpp_dev10_long](../Token/cpp_dev10_long_md.md)] инструменты и библиотеки для построения приложения.  
  
 `msbuild myProject.vcxproj /p:PlatformToolset=v100`  
  
 Задать `PlatformToolset` Свойства `v90` использовать инструменты Visual C++ 2008 и библиотеки для построения приложения. Набор инструментов Visual C++ 2008 должна быть установлена на компьютере, для данного свойства.  
  
 `msbuild myProject.vcxproj /p:PlatformToolset=v90`  
  
### <a name="preferredtoolarchitecture-property"></a>Свойство PreferredToolArchitecture  
  `PreferredToolArchitecture` Свойство определяет 32-разрядной или 64-разрядных компилятора и средств, используются ли в сборке. Это свойство не влияет на вывод архитектура платформы или конфигурации. По умолчанию MSBuild использует x86 версии компилятора и инструментов, если это свойство не задано или имеет значение любое значение, отличное от `x64`.  
  
 Задать `PreferredToolArchitecture` Свойства `x64` использовать 64-разрядный компилятор и средства для построения приложения.  
  
 `msbuild myProject.vcxproj /p:PreferredToolArchitecture=x64`  
  
### <a name="useenv-property"></a>UseEnv-свойство  
 По умолчанию параметры платформы для текущего проекта переопределение переменных среды PATH, INCLUDE, LIB, LIBPATH, КОНФИГУРАЦИИ и ПЛАТФОРМЫ. Задать `UseEnv` Свойства `true` гарантировать, что переменные среды не переопределен.  
  
 `msbuild myProject.vcxproj /p:UseEnv=true`  
  
### <a name="targets"></a>Целевые объекты  
 Существуют сотни целевых объектов в файлах поддержки Visual C++. Однако большинство являются целевых объектов, ориентированных на системы, пользователь может их игнорировать. Большинство целевых объектов системы имеют префикс в виде символа подчеркивания (_) или иметь имя, которое начинается с «PrepareFor», «Вычисления», «До», «После», «Pre» или «Post».  
  
 В следующей таблице перечислены несколько оправданной целевых объектов, ориентированных на пользователя.  
  
|целевого объекта|Описание|  
|------------|-----------------|  
|BscMake|Выполняет программу Microsoft Обзор программы управления информацией bscmake.exe.|  
|Построить|Выполняет построение проекта.<br /><br /> Это является целевым объектом по умолчанию для проекта.|  
|ClCompile|Выполняет программу Visual C++ компилятор cl.exe.|  
|Очистить|Удаляет временные и промежуточные файлы сборки.|  
|LIB|Выполняет программу Microsoft 32-разрядной библиотеки диспетчера lib.exe.|  
|Ссылка|Запускает средство компоновщик Visual C++ link.exe.|  
|ManifestResourceCompile|Извлекает список ресурсов из манифеста и затем запускает средство компилятор ресурсов Microsoft Windows rc.exe.|  
|MIDL|Запускает средство компилятора Microsoft интерфейс определения языка MIDL midl.exe.|  
|Перестроить|Выполняет очистку, а затем выполняет построение проекта.|  
|ResourceCompile|Запускает средство компилятор ресурсов Microsoft Windows rc.exe.|  
|Программа XdcMake|Выполняет программу XML-документации xdcmake.exe.|  
|XSD|Запускает средство определения схемы XML xsd.exe.|  
  
## <a name="see-also"></a>См. также  
 [MSBuild (Visual C++)](../Topic/MSBuild%20\(Visual%20C++\).md)