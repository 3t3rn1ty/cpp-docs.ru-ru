---
title: "Импортирование и экспортирование | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "__declspec(dllimport) - ключевое слово [C++]"
  - "DLL-библиотеки [C++], экспортирование из"
  - "DLL-библиотеки [C++], импорт"
  - "экспорт библиотек DLL [C++]"
  - "импорт библиотек DLL [C++]"
ms.assetid: 7c44c2aa-2117-4cec-9615-a65bfd3f8f7b
caps.latest.revision: 8
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
caps.handback.revision: 8
---
# Импортирование и экспортирование
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

Импортировать открытые символы в приложение или экспортировать функции из библиотеки DLL можно с помощью двух методов.  
  
-   С помощью файла определения модуля \(DEF\) во время построения библиотеки DLL  
  
-   Используйте ключевые слова **\_\_declspec\(dllimport\)** или **\_\_declspec\(dllexport\)** в определении функции ведущего приложения.  
  
## C помощью DEF\-файла  
 Файл определения модуля \(DEF\-файл\) — это текстовый файл, содержащий один или несколько операторов модуля, описывающих различные атрибуты библиотеки DLL.  Если **\_\_declspec\(dllimport\)** или **\_\_declspec\(dllexport\)** не используются для экспортирования функций библиотеки DLL, то библиотека требует наличие DEF\-файла.  
  
 Можно использовать файлы с расширением DEF для [импортирования в приложение](../build/importing-using-def-files.md) или [экспортирования из библиотеки DLL](../build/exporting-from-a-dll-using-def-files.md).  
  
## Использование \_\_declspec  
 Visual C\+\+ использует **\_\_declspec\(dllimport\)** и **\_\_declspec\(dllexport\)**, чтобы заменить ключевое слово **\_\_export**, ранее применявшееся в 16\-битных версиях Visual C\+\+.  
  
 Нет необходимости использовать **\_\_declspec\(dllimport\)** для правильной компиляции кода, однако, его применение позволяет компилятору создать код лучшего качества.  Компилятор способен создавать улучшенный код, так как может определять наличие функции в библиотеке DLL. Это позволяет компилятору создавать код, который обходит уровень косвенного обращения, обычно присутствующий при вызове функции в перекрестных границах библиотеки DLL.  Однако для импортирования переменных, используемых библиотекой DLL, необходимо применять **\_\_declspec\(dllimport\)**.  
  
 Файл с расширением DEF в секции EXPORTS не требует наличия **\_\_declspec\(dllexport\)**.  **\_\_declspec\(dllexport\)** был добавлен, чтобы упростить процесс экспортирования функций из файлов EXE или DLL в существующий DEF\-файл.  
  
 Формат переносимого исполняемого \(PE\) файла Win32 разработан для уменьшения до минимума количества страниц, предназначенных для отладки импортов.  Чтобы выполнить эту операцию, определите все адреса импорта под названием "Таблица с адресами импорта" в одно расположение какой\-либо программы.  Это позволить загрузчику модифицировать только одну или несколько страниц во время доступа к данным импортам.  
  
## Выберите действие.  
  
-   [Импорт данных в приложение](../build/importing-into-an-application-using-declspec-dllimport.md)  
  
-   [Экспорт из DLL](../build/exporting-from-a-dll.md)  
  
## См. также  
 [DLL в Visual C\+\+](../build/dlls-in-visual-cpp.md)