---
title: Переменные среды для профильной оптимизации | Документы Microsoft
ms.custom: ''
ms.date: 03/14/2018
ms.technology:
- cpp-tools
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- profile-guided optimizations, environment variables
ms.assetid: f95a6d1e-49a4-4802-a144-092026b600a3
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 19edc9c8a2702e5b7ac9ae4a49364718f19d3900
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="environment-variables-for-profile-guided-optimizations"></a>Переменные среды для профильной оптимизации

Существует три переменные среды, которые влияют на тестовые сценарии в образе, созданном с **/LTCG: PGI** для профильной оптимизации:

- **PogoSafeMode** указывает, следует ли использовать быстром режиме или безопасном режиме для профилирования приложения.

- **VCPROFILE_ALLOC_SCALE** добавляет дополнительную память для использования профилировщиком.

- **VCPROFILE_PATH** позволяет указать папку для файлов .pgc.

**Переменные среды PogoSafeMode и VCPROFILE_ALLOC_SCALE являются устаревшими, начиная с Visual Studio 2015.** Параметры компоновщика [/genprofile или/fastgenprofile](genprofile-fastgenprofile-generate-profiling-instrumented-build.md) и [параметром/useprofile](useprofile.md) определяют аналогичное поведение компоновщика, как эти переменные среды.

## <a name="pogosafemode"></a>PogoSafeMode

Эта переменная среды является устаревшим. Используйте **EXACT** или **NOEXACT** аргументы **/genprofile** или **/fastgenprofile** чтобы контролировать это поведение.

Установите или снимите **PogoSafeMode** переменную среды, чтобы указать, следует ли использовать быстром режиме или безопасном режиме для профилирования приложения на x86 систем.

Профильная оптимизация (PGO) имеет два возможных режима во время фазы профилирования: *быстрый режим* и *безопасный режим*. При профилировании в быстром режиме, она использует **INC** инструкции для увеличения счетчиков данных. **INC** инструкция выполняется быстрее, но не является потокобезопасной. При профилировании в безопасном режиме, она использует **LOCK INC** инструкции для увеличения счетчиков данных. **LOCK INC** инструкция имеет ту же функциональность, что **INC** инструкция имеет и является потокобезопасной, но работает медленнее, чем **INC** инструкции.

По умолчанию профилирование вероятностного Оптимизатора работает в быстром режиме. **PogoSafeMode** — требуется, только если вы хотите использовать безопасный режим.

Чтобы выполнить профилирование вероятностного Оптимизатора в безопасном режиме, необходимо использовать переменную среды **PogoSafeMode** или параметр компоновщика **/PogoSafeMode**, в зависимости от системы. Если вы выполняете профилирование на x64 компьютера, необходимо использовать параметр компоновщика. Если вы выполняете профилирование на x86 компьютера, вы можете использовать компоновщик переключения или задать **PogoSafeMode** переменной среды любое значение перед началом процесса оптимизации.

### <a name="pogosafemode-syntax"></a>Синтаксис PogoSafeMode

> **задать PogoSafeMode**[**=**_значение_]

Задать **PogoSafeMode** любое значение, чтобы включить в безопасном режиме. Задайте без значения для очистки предыдущее значение и повторно включить быстрый режим.

## <a name="vcprofileallocscale"></a>VCPROFILE_ALLOC_SCALE

Эта переменная среды является устаревшим. Используйте **MEMMIN** и **MEMMAX** аргументы **/genprofile** или **/fastgenprofile** чтобы контролировать это поведение.

Изменить **VCPROFILE_ALLOC_SCALE** переменную среды, чтобы изменить объем памяти, выделенной для хранения данных профиля. В редких случаях не будет достаточно памяти для сбора данных профиля при выполнении сценариев тестирования. В таких случаях можно увеличить объем памяти, установив **VCPROFILE_ALLOC_SCALE**. Если появляется сообщение об ошибке во время выполнения теста, указывающее, что имеется недостаток памяти, назначьте большее значение для **VCPROFILE_ALLOC_SCALE**, пока не завершить без ошибок нехватки памяти.

### <a name="vcprofileallocscale-syntax"></a>Синтаксис VCPROFILE_ALLOC_SCALE

> **задать VCPROFILE_ALLOC_SCALE**[__=__*scale_value*]

*Scale_value* параметр имеет коэффициент масштабирования объема памяти, необходимой для запуска сценариев тестирования.  Значение по умолчанию — 1. Например эта командная строка задает коэффициент масштабирования 2:

`set VCPROFILE_ALLOC_SCALE=2`

## <a name="vcprofilepath"></a>VCPROFILE_PATH

Используйте **VCPROFILE_PATH** переменной среды для указания каталога, чтобы создать PGC-файлы. По умолчанию PGC-файлы создаются в каталоге, где профилируемый двоичный файл. Однако если абсолютный путь двоичный файл не существует, как может иметь место при запуске сценариев профиля на другом компьютере, из которой был создан двоичный файл, можно установить **VCPROFILE_PATH** путь, который существует на целевом компьютере.

### <a name="vcprofilepath-syntax"></a>Синтаксис VCPROFILE_PATH

> **задать VCPROFILE_PATH**[**=**_путь_]

Задать *путь* параметра путь к каталогу, в которое нужно добавить PGC-файлы. Например эта команда задает папку для C:\profile:

`set VCPROFILE_PATH=c:\profile`

## <a name="see-also"></a>См. также

[Профильная оптимизация](../../build/reference/profile-guided-optimizations.md)<br/>
[/ GENPROFILE и/fastgenprofile](genprofile-fastgenprofile-generate-profiling-instrumented-build.md)<br/>
[/ ПАРАМЕТР USEPROFILE](useprofile.md)<br/>
