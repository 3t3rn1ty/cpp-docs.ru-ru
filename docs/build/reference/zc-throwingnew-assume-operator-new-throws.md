---
title: /Zc:throwingNew (предположим, что оператор новый возникает исключение) | Документы Microsoft
ms.custom: ''
ms.date: 03/01/2018
ms.technology:
- cpp-tools
ms.topic: reference
f1_keywords:
- throwingNew
- /Zc:throwingNew
dev_langs:
- C++
helpviewer_keywords:
- -Zc compiler options (C++)
- throwingNew
- Assume operator new Throws
- /Zc compiler options (C++)
- Zc compiler options (C++)
ms.assetid: 20ff0101-9677-4d83-8c7b-8ec9ca49f04f
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: f446e5c71e88be86c31e5a83ca7d23f611683af4
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="zcthrowingnew-assume-operator-new-throws"></a>/Zc:throwingNew (создает новый оператор Предположим, что)

Когда **/Zc:throwingNew** параметр указан, компилятор оптимизирует вызовы `operator new` для пропуска проверок для возвращаемого указателя null. Этот параметр предписывает компилятору считать, что все связанные реализации `operator new` и пользовательских механизмов выделения памяти соответствует стандарту C++ и вызывать при сбое выделения. По умолчанию в Visual Studio, компилятор создает pessimistically проверок значений null (**/Zc:throwingNew-**) для этих вызывает, поскольку пользователи могут переходить с реализацией не создающие `operator new` или написать пользовательский распределитель процедуры которые возвращают указатели null.

## <a name="syntax"></a>Синтаксис

> **/Zc:throwingNew**[**-**]

## <a name="remarks"></a>Примечания

С момента ISO C ++ 98 стандартный был задан, по умолчанию [оператор new](../../standard-library/new-operators.md#op_new) вызывает `std::bad_alloc` при сбое выделения памяти. Версии Visual C++ до Visual Studio 6.0 возвращается указатель null на ошибки выделения. Начиная с Visual Studio 2002 `operator new` соответствует стандарту и возникает исключение при сбое. Для поддержки кода, использующего старого стиля распределения, Visual Studio предоставляет реализацию ссылок на основе `operator new` в nothrownew.obj, возвращающая указатель null в случае ошибки. По умолчанию компилятор создает также защитного проверок значений null, чтобы предотвратить эти Распределители старого стиля из-за сбоя немедленно при сбое. **/Zc:throwingNew** указывает компилятору оставлять этих проверок значений null, предполагается, что все связанные памяти Распределители соответствует стандарту. Это не относится к явной не создающие `operator new` перегрузок, которые объявлены с помощью дополнительный параметр типа `std::nothrow_t` и иметь явный `noexcept` спецификации.

По существу, чтобы создать объект в свободном хранилище, компилятор создает код для выделения памяти и затем вызывать его конструктор для инициализации память. Так как компилятор Visual C++ обычно не может определить, если этот код будет связан с несоответствующих, не создающие распределителя, по умолчанию он также создает проверка значения null перед вызовом конструктора. Это предотвращает указатель null разыменования в вызове конструктора, если выделение, не создающие завершается с ошибкой. В большинстве случаев эти проверки не нужны, так как значение по умолчанию `operator new` Распределители вызывать вместо возвращения указатели null. Проверки также имеют нежелательным побочные эффекты. Они Раздувание объем кода, они переполнить прогнозирующих ветви и они препятствовать другие оптимизации полезные компилятора, например devirtualization или const распространения инициализированный объект. Проверки существует только в коде поддержки, ссылающуюся на *nothrownew.obj* или имеет пользовательские несоответствующих `operator new` реализации. Если вы не используете несоответствующих `operator new`, рекомендуется использовать **/Zc:throwingNew** для оптимизации кода.

**/Zc:throwingNew** параметр выключен по умолчанию и не зависит от [/ разрешительным-](permissive-standards-conformance.md) параметр.

Если компиляция выполняется с помощью создание кода во время компоновки (LTCG), необходимо указать **/Zc:throwingNew**. Когда код компилируется с использованием LTCG, компилятор может обнаружить, если значение по умолчанию, соответствующий `operator new` реализация используется. В этом случае компилятор автоматически оставляет out проверок значений null. Компоновщик будет искать **/ThrowingNew** флаг, чтобы определить, если реализация `operator new` предписаниям. Этот флаг компоновщику можно указать, включив эту директиву источника для новой реализации пользовательского оператора:

```cpp
#pragma comment(linker, "/ThrowingNew")
```

Дополнительные сведения о вопросах соответствия в Visual C++ см. в статье [Nonstandard Behavior](../../cpp/nonstandard-behavior.md).

## <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [работа со свойствами проекта](../../ide/working-with-project-properties.md).

1. Из **конфигурации** раскрывающееся меню, выберите **все конфигурации**.

1. Выберите **свойства конфигурации** > **C/C++** > **командной строки** страницу свойств.

1. Изменить **Дополнительные параметры** включив **/Zc:throwingNew** или **/Zc:throwingNew-** и выберите **ОК**.

## <a name="see-also"></a>См. также

[Параметры компилятора](../../build/reference/compiler-options.md)<br/>
[Настройка параметров компилятора](../../build/reference/setting-compiler-options.md)<br/>
[/Zc (соответствие)](../../build/reference/zc-conformance.md)<br/>
[noexcept (C++)](../../cpp/noexcept-cpp.md)<br/>
[Спецификации исключений (throw) (C++)](../../cpp/exception-specifications-throw-cpp.md)<br/>
[Завершение (exception)](../../standard-library/exception-functions.md#terminate)<br/>
