---
title: "С помощью библиотеки импорта и файла экспорта | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-tools
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- circular exports
- import libraries, using
- export files
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
caps.latest.revision: "7"
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 37d77fdc4df7d2e7239b8bba652d8cf8f4bbc997
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="using-an-import-library-and-export-file"></a>Использование библиотеки импорта и файла экспорта
Если программа (исполняемый файл или DLL) экспортирует в другую программу, которая импортирует из или если более чем двумя программами экспортировать и импортировать друг от друга, команды, чтобы связать эти программы необходимо учесть циклические экспорты.  
  
 При компоновке программы, использующий экспортирует из другой программы, в случае без циклические экспорты, необходимо указать библиотеку импорта экспортирующей программы. Библиотека импорта экспортирующей программы создается при компоновке этой программы. Таким образом необходимо связать экспортирующей программы перед импортирующей программой. Например, если TWO.dll импортирует функции из библиотеки ONE.dll, необходимо сначала скомпоновать ONE.dll, получив библиотеку импорта ONE.lib. Укажите ONE.lib компоновки TWO.dll. Когда компоновщик создает TWO.dll, он также создает импортированную библиотеку TWO.lib. Используйте TWO.lib при компоновке программы, которые импортируют функции из TWO.dll.  
  
 Однако в случае циклического экспорта не Невозможно скомпоновать все взаимозависимые программы с помощью библиотек импорта других программ. В примере, уже было сказано ранее, если TWO.dll также экспортирует ONE.dll, библиотека импорта для TWO.dll еще не будет существовать при компоновке ONE.dll. Если существуют циклические экспорты, необходимо использовать LIB для создания библиотеки импорта и экспорта файла для одного из приложений.  
  
 Чтобы начать, выберите один из программ, для которой будет запускаться LIB. В команде LIB выводит список всех объектов и библиотек для программы и укажите параметр/DEF. Если программа использует DEF-файл или спецификации/export, задавать их.  
  
 После создания библиотеки импорта (LIB) и файл экспорта (.exp) для программы, используйте библиотеку импорта при компоновке программы или программ. LINK создает библиотеку импорта для каждой экспортирующей программы выполнении построения. Например при запуске программы LIB для объектов и экспортирует для ONE.dll создать ONE.lib и ONE.exp. Теперь вы можете использовать ONE.lib компоновки TWO.dll; Этот шаг также создает библиотеку импорта TWO.lib.  
  
 Наконец выполните компоновку программы, который начинается с. В команде LINK укажите объектов и библиотек для программы, EXP-файл, созданный для программы и библиотеку импорта LIB или библиотек для экспорта, используемой программой. Чтобы продолжить работу в примере, команде LINK для библиотеки ONE.dll содержит ONE.exp и TWO.lib, а также объектов и библиотек, в библиотеке ONE.dll. Не следует указывать DEF-файл или спецификации/Export в команде LINK; Это не требуется, так как определения экспорта находятся в EXP-файл. При связывании с помощью EXP-файл, связь не создает библиотеку импорта, так как она предполагает, что была создана при создании EXP-файл.  
  
## <a name="see-also"></a>См. также  
 [Работа с библиотеками импорта и файлами экспорта](../../build/reference/working-with-import-libraries-and-export-files.md)