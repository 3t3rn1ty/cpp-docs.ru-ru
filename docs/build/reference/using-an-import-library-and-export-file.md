---
title: "Использование библиотеки импорта и файла экспорта | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "циклические экспорты"
  - "файлы - экспорт"
  - "библиотеки - импорт, использование"
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
caps.latest.revision: 7
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
caps.handback.revision: 7
---
# Использование библиотеки импорта и файла экспорта
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Если программа \(исполняемый файл или библиотека DLL\) экспортирует функции в другую программу, из которой она также импортирует функции, или же более чем две программы экспортируют и импортируют функции друг у друга, то команды компоновки таких программ должны быть способны справляться с циклическим экспортом.  
  
 В ситуации, когда циклический экспорт отсутствует, при компоновке программы, использующей экспорты из другой программы, необходимо указать библиотеку импорта экспортирующей программы.  Библиотека импорта экспортирующей программы создается при компоновке этой программы.  Поэтому экспортирующую программу необходимо компоновать перед импортирующей программой.  Например, если библиотека TWO.dll импортирует функции из библиотеки ONE.dll, необходимо сначала скомпоновать ONE.dll, получив библиотеку импорта ONE.lib.  Затем при компоновке библиотеки TWO.dll необходимо указать библиотеку ONE.lib.  Когда компоновщик создает библиотеку TWO.dll, он также создает ее библиотеку импорта — TWO.lib.  Библиотеку импорта TWO.lib следует использовать при компоновке программ, которые импортируют функции из TWO.dll.  
  
 Тем не менее, в ситуации циклического экспорта невозможно скомпоновать все взаимозависимые программы с помощью библиотек импорта других программ.  Если в рассмотренном выше примере библиотека TWO.dll также будет экспортировать функции в библиотеку ONE.dll, то при компоновке ONE.dll библиотека импорта для TWO.dll еще не будет существовать.  В случае циклического импорта необходимо использовать программу LIB для создания библиотеки импорта и файла экспорта одной из программ.  
  
 Вначале выберите ту из программ, для которой будет запускаться LIB.  В командной строке LIB перечислите все необходимые программе объектные файлы и библиотеки и укажите параметр \/DEF.  Если программа использует DEF\-файл или спецификации \/EXPORT, также укажите их.  
  
 После того, как будет создан файл экспорта \(EXP\-файл\) и библиотека импорта \(LIB\-файл\), для компоновки других программ необходимо будет использовать эту библиотеку импорта.  Программа LINK создает библиотеку импорта для каждой экспортирующей программы, построение которой она выполняет.  Например, при запуске программы LIB для объектных файлов и экспортируемых символов библиотеки ONE.dll будут созданы файлы ONE.lib и ONE.exp.  Теперь можно использовать библиотеку импорта ONE.lib для выполнения компоновки TWO.dll; при этом также будет создана библиотека импорта TWO.lib.  
  
 Наконец, выполните компоновку программы, с которой началась эта процедура.  В командной строке LINK укажите объектные файлы и библиотеки, необходимые для программы, EXP\-файл, который программа LIB создала для программы, и библиотеку или библиотеки импорта, используемые программой.  В продолжение примера: командная строка LINK для библиотеки ONE.dll содержит файлы ONE.exp и TWO.lib, равно как и объектные файлы и библиотеки, используемые в библиотеке ONE.dll.  Не следует указывать DEF\-файл или спецификации \/EXPORTS в командной строке LINK — они не нужны, поскольку определения экспорта находятся в EXP\-файле.  Если компоновка выполняется с помощью EXP\-файла, программа LINK не создает библиотеку импорта, потому что она предполагает, что эта библиотека была создана при создании EXP\-файла.  
  
## См. также  
 [Работа с библиотеками импорта и файлами экспорта](../../build/reference/working-with-import-libraries-and-export-files.md)