---
title: "-ядра (создать ядра двоичный режим) | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-tools
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- /kernel
- /kernel-
dev_langs: C++
ms.assetid: 6d7fdff0-c3d1-4b78-9367-4da588ce8b05
caps.latest.revision: "11"
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: b0e20df59788577acb680cbd18b737f7ec2d7822
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="kernel-create-kernel-mode-binary"></a>/kernel (создание двоичного режима ядра)
Создает двоичный файл, который может выполняться в ядре Windows.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
/kernel[-]  
```  
  
## <a name="arguments"></a>Аргументы  
 **/ kernel**  
 Код в текущий проект компилируется и компонуется с помощью набора правил языка C++, относящиеся к коду, который будет выполняться в режиме ядра.  
  
 **/kernel-**  
 Код в текущем проекте компиляции и компоновки без использования правила языка C++, относящиеся к коду, который будет выполняться в режиме ядра.  
  
## <a name="remarks"></a>Примечания  
 Имеется не `#pragma` эквивалентное значению этого параметра.  
  
 Указание **/kernel** сообщает о том, компилятор и компоновщик, могут решать, какие возможности языка допустимы в режиме ядра и убедитесь в том, что у вас есть достаточные выразительных возможностей во избежание нестабильной работе среды выполнения, уникальные для C++ в режиме ядра. Это можно сделать, запретив использование возможностей языка C++, которые нарушают работу в режиме ядра, а также предоставляя предупреждения для возможности языка C++, которые потенциально нарушают работу, но не может быть отключена.  
  
 **/Kernel** параметр применяется к компилятор и компоновщик этапы построения и устанавливается на уровне проекта. Передайте **/kernel** переключатель, чтобы указать компилятору, что выходной двоичный файл после связывания, должны быть загружены в ядре Windows. Компилятор будет уменьшаться спектр возможностей языка C++ к подмножеству, совместимый с ядром.  
  
 В следующей таблице перечислены изменения в поведении компилятора при **/kernel** указано.  
  
|Тип поведения|**/ kernel** поведения|  
|-------------------|---------------------------|  
|Обработка исключений С++|Отключено. Все экземпляры `throw` и `try` ключевые слова выдавать ошибку компилятора (за исключением спецификацией исключений `throw()`). Не **/EH** параметры совместимы с **/kernel**, за исключением **/EH-**.|  
|RTTI|Отключено. Все экземпляры `dynamic_cast` и `typeid` ключевые слова выдавать ошибку компилятора, если не `dynamic_cast` используется статически.|  
|`new` и `delete`.|Необходимо явно определить `new()` или `delete()` оператор; компилятор ни среда выполнения предоставляет определение default.|  
  
 Пользовательские соглашения о вызовах, [/GS](../../build/reference/gs-buffer-security-check.md) параметр построения и все оптимизации разрешены при использовании **/kernel** параметр. Встраивание не во многом зависит от **/kernel**, с той же семантикой, компилятор. Если вы хотите убедиться, что `__forceinline` учитывается встраивания квалификатор, убедитесь, что предупреждение [C4714](../../error-messages/compiler-warnings/compiler-warning-level-4-c4714.md) включена, чтобы знать, когда определенный `__forceinline` функция не является встроенной.  
  
 При передаче компилятор **/kernel** переключения, она есть стандартные макрос препроцессора, которая называется `_KERNEL_MODE` и имеет значение **1**. Это можно использовать для условной компиляции кода на наличие среды выполнения в пользовательском режиме или в режиме ядра. Например следующий код указывает, что класс должен быть в сегмент невыгружаемой памяти, при компиляции для выполнения режима ядра.  
  
```cpp  
#ifdef _KERNEL_MODE  
#define NONPAGESECTION __declspec(code_seg("$kerneltext$"))  
#else  
#define NONPAGESECTION  
#endif  
  
class NONPAGESECTION MyNonPagedClass  
{  
   // ...
};  
```  
  
 Некоторые следующие сочетания целевой архитектуры и **/arch** параметр сообщает об ошибке, если они используются с **/kernel**:  
  
-   **/ arch: {SSE &#124; SSE2 &#124; AVX}** x86 не поддерживаются. Только **/arch:IA32** поддерживается с **/kernel** на x86.  
  
-   **/ arch: AVX** не поддерживается с **/kernel** на x64.  
  
 Построение с **/kernel** передает **/kernel** в компоновщик. Ей является, как это влияет на поведение компоновщика:  
  
-   Последовательная компоновка отключена. При добавлении **/ incremental** в командную строку, компоновщик выдает это Неустранимая ошибка:  
  
     **СВЯЗИ: Неустранимая ошибка LNK1295: «/ INCREMENTAL» не совместим с "/ ЯДРА" Спецификация; связать без «/ INCREMENTAL»**  
  
-   Компоновщик проверяет каждый объектный файл (или любой член включены архива из статических библиотек), чтобы увидеть, является ли он может были скомпилированы с помощью **/kernel** параметра, однако не. Если какие-либо экземпляры отвечающие этому критерию, компоновщик будет успешно ссылки, но выдается предупреждение, как показано в следующей таблице.  
  
    ||**/ kernel** obj|**/kernel-** obj MASM obj или cvtresed|Сочетание **/kernel** и **/kernel-** objs|  
    |-|----------------------|-----------------------------------------------|-------------------------------------------------|  
    |**/ kernel ссылку**|Да|Да|Да, с помощью предупреждение LNK4257|  
    |**ссылка**|Да|Да|Да|  
  
     **Связующий объект LNK4257 не компилируется с параметром/kernel; образ нельзя запустить**  
  
 **/Kernel** параметр и **/Driver** параметр друг от друга и не влияет на другое.  
  
### <a name="to-set-the-kernel-compiler-option-in-visual-studio"></a>Установка параметра компилятора/kernel в Visual Studio  
  
1.  Откройте **страницы свойств** диалоговое окно для проекта. Дополнительные сведения см. в разделе [работа со свойствами проекта](../../ide/working-with-project-properties.md).  
  
2.  Выберите **C/C++** папки.  
  
3.  Выберите **командной строки** страницу свойств.  
  
4.  В **Дополнительные параметры** добавьте `/kernel` или `/kernel-`.  
  
## <a name="see-also"></a>См. также  
 [Параметры компилятора](../../build/reference/compiler-options.md)   
 [Настройка параметров компилятора](../../build/reference/setting-compiler-options.md)