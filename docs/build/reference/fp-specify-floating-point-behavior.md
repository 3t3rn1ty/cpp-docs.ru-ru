---
title: "-fp (определение поведения с плавающей запятой) | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-tools
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- VC.Project.VCCLCompilerTool.floatingPointModel
- VC.Project.VCCLWCECompilerTool.FloatingPointExceptions
- /fp
- VC.Project.VCCLWCECompilerTool.floatingPointModel
- VC.Project.VCCLCompilerTool.FloatingPointExceptions
dev_langs:
- C++
helpviewer_keywords:
- -fp compiler option [C++]
- /fp compiler option [C++]
ms.assetid: 10469d6b-e68b-4268-8075-d073f4f5d57e
caps.latest.revision: 
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 0f4a86c7bbbd38887944080a5a5c8124310fdd4a
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="fp-specify-floating-point-behavior"></a>/fp (Определение поведения с плавающей запятой)
Определяет поведение для чисел с плавающей запятой в файле исходного кода.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
/fp:[precise | except[-] | fast | strict ]  
```  
  
## <a name="flags"></a>Флаги  
 **точный**  
 По умолчанию.  
  
 Улучшает согласованность проверок на равенство и неравенство для значений с плавающей запятой путем отключения оптимизаций, которые могут повлиять на точность вычислений с плавающей запятой. (Поддержка определенной точности необходима для строгого соответствия стандарту ANSI.) По умолчанию в коде для архитектуры x86 компилятор использует 80-разрядный сопроцессор для хранения промежуточных результатов вычислений с плавающей запятой. Это увеличивает быстродействие программы и уменьшает ее объем. Однако, так как в вычислениях используются типы данных с плавающей запятой, которые занимают в памяти менее 80 битов, поддержание дополнительных битов точности вычислений (80 битов минус количество битов в более коротких типах с плавающей запятой) во время длительных вычислений может приводить к недостоверным результатам.  
  
 С **/fp: точный** на x86 процессоров, компилятор выполняет округление переменных типа `float` до требуемой точности для назначения и приведения типов и при передаче параметров в функцию. Такое округление гарантирует, что количество значащих разрядов данных не будет превышать разрядность их типа. Программа скомпилирована с **/fp: точный** может работать медленнее и больше, чем скомпилированная без **/fp: точный**. **/ fp: точный** отключает встроенные функции; стандартную библиотеку времени выполнения, вместо них используются процедуры. Дополнительные сведения см. в разделе [/Oi (создание встроенных функций)](../../build/reference/oi-generate-intrinsic-functions.md).  
  
 Следующие поведения с плавающей запятой включен с **/fp: точный**:  
  
-   Сокращение — т. е., использование составной операции, при которой вместо нескольких операций выполняется только одно округление в конце вычислений.  
  
-   Не допускаются оптимизации выражений, которые недопустимы для специальных значений (NaN, +бесконечность, -бесконечность, +0, -0). Оптимизация x-x = > 0 x * 0 = > 0, x-0 = > x, x + 0 = > x и 0 x = > - x недействительны по разным причинам. (См. стандарты IEEE 754 и C99).  
  
-   Компилятор правильно обрабатывает сравнения с участием значений NaN. Например, x! = x, результатом которого является **true** Если `x` является NaN и заказанные сравнения, включающие NaN вызова исключения.  
  
-   Вычисление выражений производится в соответствии в методом FLT_EVAL_METHOD=2 стандарта C99 со следующим исключением: при программировании для процессоров x86 в связи с тем, что для сопроцессора FPU задана точность 53 бита, это рассматривается как точность long-double.  
  
-   Умножение ровно на 1,0 преобразуется в использование другого множителя. x * y\*1.0 преобразуется в x\*y. Аналогичным образом x\*1.0\*y преобразуется в x\*y.  
  
-   Деление ровно на 1,0 преобразуется в использование делимого. x * y/1.0 преобразуется в x\*y. Аналогичным образом, x / 1.0\*y преобразуется в x\*y.  
  
 С помощью **/fp: точный** при [fenv_access](../../preprocessor/fenv-access.md) включен отключает оптимизацию, например во время компиляции оценки выражений с плавающей запятой. Например, если вы используете [_control87, _controlfp, \__control87_2](../../c-runtime-library/reference/control87-controlfp-control87-2.md) Чтобы изменить режим округления, а компилятор выполняет вычисления с плавающей запятой, заданный режим округления не действует Если `fenv_access`имеет значение ON.  
  
 **/ fp: точный** заменяет **/Op** параметр компилятора.  
  
 **Быстрый**  
 В большинстве случаев создает наиболее быстрый код, ослабляя правила оптимизации операций с плавающей запятой. Это позволяет компилятору оптимизировать код с плавающей запятой для повышения быстродействия за счет точности и правильности. Когда **/fp:fast** указан, компилятор не может правильно округление в операторах присваивания, приведении типов или вызовы функций и может не производить округление промежуточных выражений. Компилятор может изменять порядок операций или выполнять алгебраические преобразования (например, в соответствии с условиями ассоциативности и дистрибутивности) без учета влияния на конечную точность результатов. Компилятор может заменять операции и операнды на значения одинарной точности вместо применения правил повышения типа в C++. Оптимизация сокращением конкретных с-плавающей запятой всегда включены ([fp_contract](../../preprocessor/fp-contract.md) имеет значение ON). Исключения с плавающей запятой и доступа к среде Выполнения отключены (**/fp: except-** подразумевается и [fenv_access](../../preprocessor/fenv-access.md) имеет значение OFF).  
  
 **/fp:fast** не может использоваться с **/fp: strict** или **/fp: точный**. Используется последний параметр, указанный в командной строке. Совместное указание **/fp:fast** и **/fp: except** приводит к ошибке компилятора.  
  
 Указание [/Za, /Ze (отключить расширения языка)](../../build/reference/za-ze-disable-language-extensions.md) (совместимости с ANSI) и **/fp:fast** может привести к непредвиденному поведению. Например, операции с плавающей запятой одиночной точности могут не округляться до одинарной точности.  
  
 **за исключением [-]**  
 Надежная модель исключений с плавающей точкой. Исключения вызываются незамедлительно после запуска. По умолчанию этот параметр выключен. При добавление знака "минус" к параметру он в явном виде выключается.  
  
 **Strict**  
 Самая строгая модель вычислений с плавающей точкой. **/ fp: strict** вызывает [fp_contract](../../preprocessor/fp-contract.md) значение OFF и [fenv_access](../../preprocessor/fenv-access.md) должен быть включен. **/ fp: за исключением** подразумевается и может быть отключен путем явного указания **/fp: except-**. При использовании с **/fp: except-**, **/fp: strict** обеспечивает строгую семантику с плавающей запятой, но без учета исключительных событий.  
  
## <a name="remarks"></a>Примечания  
 Несколько **/FP** параметры могут быть указаны в одной компиляции.  
  
 Управлять поведением с плавающей запятой, функции, в разделе [float_control](../../preprocessor/float-control.md) pragma. Это значение переопределяет **/FP** параметр компилятора. Рекомендуется сохранять и восстанавливать локальное поведение вычислений с плавающей точкой:  
  
```cpp  
#pragma float_control(precise, on, push)  
// Code that uses /fp:precise mode  
#pragma float_control(pop)  
```  
  
 Большинство оптимизаций плавающей запятой относятся к **/fp: strict**, **/fp: except** (и соответствующими директивами pragma) и `fp_contract` pragma зависят от оборудования. **/ fp: strict** и **/fp: except** не совместимы с **/CLR**.  
  
 **/ fp: точный** удовлетворяет большинству требований, приложения с плавающей запятой. Можно использовать **/fp: except** и **/fp: strict**, но возможно некоторое снижение производительности. Если производительность является наиболее важным, рассмотрите возможность использования **/fp:fast**.  
  
 **/ fp: strict**, **/fp:fast**, и **/fp: точный** режимы точности (правильности). Одновременно можно использовать только один из них. Если оба **/fp: strict** и **/fp: точный** указаны, компилятор использует тот, который обрабатывается последним. Оба **/fp: strict** и **/fp:fast** не может быть указан.  
  
 Дополнительные сведения см. в разделе [Microsoft Visual C++ с плавающей запятой оптимизации](http://msdn.microsoft.com/library/aa289157.aspx).  
  
### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio  
  
1.  Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [работа со свойствами проекта](../../ide/working-with-project-properties.md).  
  
2.  Разверните **свойства конфигурации** узла.  
  
3.  Разверните **C/C++** узла.  
  
4.  Выберите **создания кода** страницу свойств.  
  
5.  Изменить **модель с плавающей запятой** свойство.  
  
### <a name="to-set-this-compiler-option-programmatically"></a>Установка данного параметра компилятора программным способом  
  
-   См. раздел <xref:Microsoft.VisualStudio.VCProjectEngine.VCCLCompilerTool.floatingPointModel%2A>.  
  
## <a name="see-also"></a>См. также  
 [Параметры компилятора](../../build/reference/compiler-options.md)   
 [Настройка параметров компилятора](../../build/reference/setting-compiler-options.md)   
 [Microsoft Visual C++ с плавающей точкой оптимизации](http://msdn.microsoft.com/library/aa289157.aspx)