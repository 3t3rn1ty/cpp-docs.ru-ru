---
title: "Понятие вспомогательной функции | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "__delayLoadHelper - функция"
  - "__delayLoadHelper2 - функция"
  - "отложенная загрузка библиотек DLL, вспомогательная функция"
  - "delayhlp.cpp"
  - "delayimp.h"
  - "delayimp.lib"
  - "вспомогательные функции"
ms.assetid: 6279c12c-d908-4967-b0b3-cabfc3e91d3d
caps.latest.revision: 8
caps.handback.revision: 8
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
---
# Понятие вспомогательной функции
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Вспомогательная функция для отложенной загрузки, поддерживаемой компоновщиком, фактически загружает библиотеки DLL во время выполнения.  Вспомогательную функцию можно изменять, чтобы настроить ее поведение. Для этого вместо того, чтобы использовать вспомогательную функцию, предоставленную в файле Delayimp.lib, следует написать собственную функции и выполнить ее привязку к программе.  Одна вспомогательная функция обслуживает все отложенные загрузки библиотек DLL.  
  
 Можно создать собственную версию вспомогательной функции, если необходимо выполнить специальную обработку на основе имен библиотек DLL или импортированных частей.  
  
 Вспомогательная функция выполняет следующие действия:  
  
-   Сопоставление хранимого дескриптора с библиотекой на предмет завершения загрузки библиотеки  
  
-   Вызов метода **LoadLibrary** для загрузки библиотеки DLL  
  
-   Вызов метода **GetProcAddress** для получения адреса процедуры  
  
-   Возврат к преобразователю отложенной загрузки импортированных частей для вызова загружаемой в данный момент точки ввода  
  
 Вспомогательная функция может выполнять обратный вызов перехватчика уведомлений в программе после выполнения любого из следующих действий:  
  
-   При запуске вспомогательной функции  
  
-   Перед вызовом метода **LoadLibrary** вспомогательной функции  
  
-   Перед вызовом метода **GetProcAddress** вспомогательной функции  
  
-   При сбое вызова метода **LoadLibrary** вспомогательной функции  
  
-   При сбое вызова **GetProcAddress** вспомогательной функции  
  
-   После того как вспомогательная функция завершила обработку  
  
 Каждая из данных точек перехвата может возвращать значение, которое способно изменить стандартную обработку вспомогательной программой; за исключением возврата к преобразователю отложенной загрузки импортированных частей.  
  
 Вспомогательный код по умолчанию находится в файлах Delayhlp.cpp и Delayimp.h \(в папке vc\\include\) и компилируется в Delayimp.lib \(в папке vc\\lib\).  Данную библиотеку необходимо включать в компиляции, если только не используется собственная вспомогательная функция.  
  
 Описание вспомогательной функции приведено в следующих подразделах:  
  
-   [Изменения вспомогательной функции отложенной загрузки библиотек DLL по сравнению с Visual C\+\+ версии 6.0](../../build/reference/changes-in-the-dll-delayed-loading-helper-function-since-visual-cpp-6-0.md)  
  
-   [Соглашения о вызове, параметры и тип возвращаемого значения](../../build/reference/calling-conventions-parameters-and-return-type.md)  
  
-   [Определение структуры и константы](../../build/reference/structure-and-constant-definitions.md)  
  
-   [Вычисление необходимых значений](../../build/reference/calculating-necessary-values.md)  
  
-   [Выгрузка библиотеки DLL, загруженной с задержкой](../../build/reference/explicitly-unloading-a-delay-loaded-dll.md)  
  
## См. также  
 [Поддержка компоновщика для DLLs, загружаемых с задержкой](../../build/reference/linker-support-for-delay-loaded-dlls.md)