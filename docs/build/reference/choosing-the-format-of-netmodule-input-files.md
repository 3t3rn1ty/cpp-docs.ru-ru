---
title: "Выбор формата .netmodule входные файлы | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-tools
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
ms.assetid: 4653d1bd-300f-4083-86f5-d1a06f44e61c
caps.latest.revision: "9"
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: a46c2fa9ce553948c03cd2ab6ad20001d0021bed
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="choosing-the-format-of-netmodule-input-files"></a>Выбор формата входных файлов netmodule
OBJ-файле MSIL (скомпилированный с [/CLR](../../build/reference/clr-common-language-runtime-compilation.md)) также могут использоваться как NETMODULE-файл.  OBJ-файлы содержат метаданные и собственные символы.  netmodules-файлы содержат только метаданные.  
  
 Можно передать OBJ-файле MSIL в другом компиляторе Visual Studio через параметр компилятора/addmodule (но имейте в виду, что OBJ-файл становится частью результирующую сборку и должны прилагаться к сборке).  Например Visual C# и Visual Basic имеют параметр компилятора/addmodule.  
  
> [!NOTE]
>  В большинстве случаев необходимо передать в компоновщик OBJ-файл из компиляции, создавшей модуль .net.  Единственным исключением является Если netmodule не был создан с [/CLR: pure](../../build/reference/clr-common-language-runtime-compilation.md).  Передача модуля файл .dll или .netmodule MSIL в компоновщик может привести к LNK1107.  
  
 OBJ-файлы, а также их связанных h-файлами, которые ссылаются через #include в источнике, разрешают приложениям C++ использовать собственные типы в модулях, тогда как в файле NETMODULE приложение C++ могут использоваться только управляемые типы.  При попытке передать OBJ-файл для #using, сведения о собственных типах будет недоступен; # Вместо include h-файла OBJ-файле.  
  
 Другие компиляторы Visual Studio можно использовать только управляемые типы из модуля.  
  
 Используйте следующие параметры для определения, следует ли использовать файлов NETMODULE или OBJ-файл в качестве входного модуля в компоновщик Visual C++.  
  
-   При построении с помощью компилятора Visual Studio, отличных от Visual C++, создайте NETMODULE и используйте его в качестве входных данных компоновщика.  
  
-   Если вы используете компилятор Visual C++ для создания модулей и если модули будут использоваться для построения нечто, отличное от библиотеки, используйте OBJ-файлы, созданные компилятором, в качестве входного модуля в компоновщик; не используйте NETMODULE-файл в качестве входного.  
  
-   Если модули будут использоваться для построения машинный код (неуправляемой) библиотеки, используйте в качестве входного модуля в компоновщик OBJ-файлы и создайте файл библиотеки LIB.  
  
-   Если модули будут использоваться для создания управляемой библиотеки, и если все входные модули в компоновщик будут проверяемыми (созданными с помощью/CLR: safe), используйте OBJ-файлы в качестве входного модуля для компоновщика и создайте DLL (сборку) или файл библиотеки (модуль) NETMODULE.  
  
-   Если модули будут использоваться для создания управляемой библиотеки, и если все входные модули в компоновщик будут созданы с **/CLR: pure** или **/CLR: safe**, используйте в качестве входного модуля в компоновщик OBJ-файлы и создать (.dll) сборки) или NETMODULE-файл (модуль), если вы хотите предоставить управляемые типы из библиотеки. Параметры компилятора **/CLR: pure** и **/CLR: safe** в Visual Studio 2015 не рекомендуется использовать. Если вы хотите предоставлять управляемые типы из библиотеки, и если вы хотите приложениям C++ использовать собственные типы в библиотеке, библиотека будет состоять из OBJ-файлов для модулей компонентов библиотек (также требуется поставлять h-файлы для каждого модуля Поэтому к ним могут обращаться с #include из исходного кода).  
  
-   Если модули будут использоваться для построения управляемой библиотеки и если один или несколько входных модулей в компоновщик будут созданы с помощью только/CLR, используйте OBJ-файлы в качестве входного модуля для компоновщика и создайте DLL (сборку).  Если вы хотите предоставлять управляемые типы из библиотеки, и если вы хотите приложениям C++ использовать собственные типы в библиотеке, библиотека будет состоять из OBJ-файлов для модулей компонентов библиотек (также требуется поставлять h-файлы для каждого модуля Поэтому к ним могут обращаться с #include из исходного кода).  
  
## <a name="see-also"></a>См. также  
 [NETMODULE-файлы в качестве входных файлов компоновщика](../../build/reference/netmodule-files-as-linker-input.md)