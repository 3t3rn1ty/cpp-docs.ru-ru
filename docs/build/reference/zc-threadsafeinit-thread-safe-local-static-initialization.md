---
title: /Zc:threadSafeInit (потокобезопасной локальной статичной инициализации) | Документы Microsoft
ms.custom: ''
ms.date: 03/14/2018
ms.technology:
- cpp-tools
ms.topic: reference
f1_keywords:
- threadSafeInit
- /Zc:threadSafeInit
dev_langs:
- C++
helpviewer_keywords:
- -Zc compiler options (C++)
- threadSafeInit
- Thread-safe Local Static Initialization
- /Zc compiler options (C++)
- Zc compiler options (C++)
ms.assetid: a0fc4b34-2cf0-45a7-a642-b8afc4ca19f2
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 438ce5ba783f646e9c8e61d9b82999ea936532b4
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32381152"
---
# <a name="zcthreadsafeinit-thread-safe-local-static-initialization"></a>/Zc:threadSafeInit (потокобезопасной локальной статичной инициализации)

**/Zc:threadSafeInit** компилятора указывает компилятору для инициализации статических локальных (область видимости функции) переменных потокобезопасным способом, устраняя необходимость в синхронизации вручную. Только инициализация является потокобезопасной. Использование и изменение статических локальных переменных в нескольких потоках необходимо по-прежнему выполнять синхронизацию вручную. Этот параметр доступен, начиная с Visual Studio 2015. По умолчанию Visual Studio включает этот параметр.

## <a name="syntax"></a>Синтаксис

> **/Zc:threadSafeInit**[**-**]

## <a name="remarks"></a>Примечания

В C ++ 11 standard переменных области видимости блока со статическим или длительности хранилища потока должен быть нулями перед любой другой инициализация выполняется. Инициализация происходит, когда элемент управления сначала проходит через объявления переменной. Если исключение создается во время инициализации, переменная считается не инициализирована и инициализации повторена к следующему элементу управления время проходит через объявление. Если элемент управления входит объявление параллельно с инициализации блоки параллельного выполнения во время выполнения инициализации. Если элемент управления повторно входит в объявлении рекурсивно во время инициализации, поведение не определено. По умолчанию Visual Studio, начиная с Visual Studio 2015 реализует это стандартное поведение. Это поведение может быть явно указано, задав **/Zc:threadSafeInit** параметр компилятора.

**/Zc:threadSafeInit** включен параметр компилятора по умолчанию. [/ Разрешительным-](permissive-standards-conformance.md) параметр не влияет на **/Zc:threadSafeInit**.

Код, реализованный в библиотеке времени выполнения универсальной C (UCRT) использует поточно ориентированного инициализации статических локальных переменных. Чтобы избежать создания зависимости UCRT или сохранить поведение не потокобезопасной инициализации версий Visual Studio до Visual Studio 2015, используйте **/Zc:threadSafeInit-** параметр. Если известно, что поток уровня безопасности не требуется, используйте этот параметр для создания кода немного меньше, чтобы повысить вокруг объявления статической локальной переменной.

Статические локальные переменные поточно ориентированного внутренним образом используют локальное хранилище потока (TLS) чтобы обеспечить эффективное выполнение, если статический уже инициализирован. Реализация этой функции, зависит от функции поддержки операционной системы Windows в Windows Vista и более поздних операционных системах. Windows XP, Windows Server 2003 и более старых операционных систем нет такая поддержка, они не получают более эффективно использовать имеющиеся. Эти операционные системы также иметь нижний предел на число разделов TLS, которые могут быть загружены. Превышение TLS предел раздел может вызвать сбой. Если это проблема в коде, особенно в код, который должен выполняться в старых операционных системах, используйте **/Zc:threadSafeInit-** отключение код инициализации потокобезопасной.

Дополнительные сведения о вопросах соответствия в Visual C++ см. в статье [Nonstandard Behavior](../../cpp/nonstandard-behavior.md).

### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [работа со свойствами проекта](../../ide/working-with-project-properties.md).

1. Из **конфигурации** раскрывающееся меню, выберите **все конфигурации**.

1. Выберите **свойства конфигурации** > **C/C++** > **командной строки** страницу свойств.

1. Изменить **Дополнительные параметры** включив **/Zc:threadSafeInit** или **/Zc:threadSafeInit-** и выберите **ОК**.

## <a name="see-also"></a>См. также

[Параметры компилятора](../../build/reference/compiler-options.md)<br/>
[Настройка параметров компилятора](../../build/reference/setting-compiler-options.md)<br/>
[/Zc (соответствие)](../../build/reference/zc-conformance.md)<br/>
