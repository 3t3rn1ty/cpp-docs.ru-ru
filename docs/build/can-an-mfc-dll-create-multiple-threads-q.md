---
title: "Допускается ли создание в библиотеке DLL MFC нескольких потоков? | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "DLL-библиотеки [C++], многопоточность"
  - "библиотеки DLL MFC [C++], многопоточность"
  - "многопоточность [C++], библиотеки DLL"
  - "работа с потоками [MFC], библиотеки DLL"
ms.assetid: 41d5b5e6-a7d3-42bf-b641-f1245abd1c59
caps.latest.revision: 8
caps.handback.revision: 8
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
---
# Допускается ли создание в библиотеке DLL MFC нескольких потоков?
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

За исключением периода инициализации в библиотеке DLL MFC допускается создание нескольких потоков, поскольку в ней используются функции локальной памяти потока Win32 \(например, **TlsAlloc**\) для выделения локальной памяти потока.  Однако если в библиотеке DLL MFC для выделения локальной памяти потока используется функция **\_\_declspec\(thread\)**, клиентское приложение должно быть неявно связано с библиотекой DLL.  Если клиентское приложение явно связано с библиотекой DLL, при вызове функции **LoadLibrary** загрузка библиотеки DLL завершится с ошибкой.  Дополнительные сведения о создании нескольких потоков в библиотеках DLL см. в статье базы знаний Майкрософт "PRB. Вызов функции LoadLibrary\(\) для загрузки библиотеки DLL со статической TLS" \(Q118816\).  
  
 При загрузке приложением библиотека DLL MFC, которая создает новый поток MFC при запуске, перестает отвечать.  Это относится к созданию потока с помощью вызова как функции `AfxBeginThread`, так и `CWinThread::CreateThread` внутри:  
  
-   `InitInstance` объекта, производного от `CWinApp` в обычной библиотеке DLL;  
  
-   предоставленной функции `DllMain` или **RawDllMain** в обычной библиотеке DLL;  
  
-   предоставленной функции `DllMain` или **RawDllMain** в библиотеке DLL расширения.  
  
 Дополнительные сведения о создании потоков во время инициализации см. в статье базы знаний Майкрософт "PRB. Не удается создать поток MFC при запуске библиотеки DLL" \(Q142243\).  
  
## См. также  
 [Вопросы и ответы по библиотекам DLL](../build/dll-frequently-asked-questions.md)