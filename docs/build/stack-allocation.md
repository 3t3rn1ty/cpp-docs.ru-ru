---
title: Выделение стека | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 098e51f2-eda6-40d0-b149-0b618aa48b47
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: caa6d435db98c7177cbf55b866bb8e5a4a110c1d
ms.sourcegitcommit: 6e479e33e8fd8e30ea32801edbff2e3415f31bf7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/14/2018
ms.locfileid: "32380606"
---
# <a name="stack-allocation"></a>Выделение памяти в стеке
В прологе функции отвечает за выделение памяти в стеке для локальных переменных, сохраняемые регистры, параметров стека и регистра.  
  
 Область параметров всегда выполняется в нижней части стека (даже если используется функция alloca), чтобы всегда будет иметь смежные по обратному адресу, при вызове функции. Содержит по крайней мере четыре записи, но всегда требуется достаточно места для хранения всех параметров для любой функции, который может быть вызван. Обратите внимание, что всегда распределения пространства для параметров, даже если самих параметров, они никогда не размещаются в стеке. Вызываемый объект гарантируется, что места, выделенного для всех параметров. Домашние адреса являются обязательными для аргументов регистра, поэтому непрерывную область доступен в случае, если необходимо получить адрес списка аргументов (va_list) или отдельного аргумента вызываемой функции. В этой области также предоставляет удобное место для сохранения аргументами регистра во время выполнения преобразователя и как средство отладки (например, он упрощает аргументы для поиска во время отладки, если они хранятся в свои домашние адреса кода пролога). Даже если эта функция имеет менее 4 параметры, четыре ячейки стека, фактически принадлежат вызываемой функции и может использоваться для других целей, помимо хранения значений регистра параметров вызываемой функцией.  Поэтому вызывающая сторона не может сохранять данные в этой области стека во время вызова функции.  
  
 Если пространство динамически выделяется (alloca) в функции, затем защищенный регистр должен использоваться в качестве указателя фрейма для пометки основание фиксированной части стека и этого регистра нужно сохранить и инициализируется в начале документа. Обратите внимание, что при использовании alloca вызовы же вызываемый объект из одного вызывающего объекта могут иметь различные домашние адреса для параметров регистра.  
  
 Стек всегда используется 16-байтовое значение aligned, за исключением пролога (например, после возвращаемого адреса) и других случаев, как показано в [типы функций](../build/function-types.md) для конкретных классов или функций кадра.  
  
 Далее приведен пример макета стека, где функция A вызывает неконечных функцию в прологе функции б A уже выделена память для всех регистра и стека параметров, необходимых В нижней части стека. Вызов передает обратный адрес и B пролога выделяет место для ее локальных переменных, неизменяемые регистры и места, необходимого для вызова функции. Если Б использует alloca, пространство, выделенное между локальных переменных или защищенного регистра областью для хранения и параметра области стека.  
  
 ![Пример преобразования AMD](../build/media/vcamd_conv_ex_5.png "vcAmd_conv_ex_5")  
  
 Когда функция B вызывает другую функцию, обратный адрес помещается непосредственно под домашний адрес для RCX.  
  
## <a name="see-also"></a>См. также  
 [Использование стека](../build/stack-usage.md)