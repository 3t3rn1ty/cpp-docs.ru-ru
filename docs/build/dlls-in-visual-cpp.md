---
title: "Библиотеки DLL в Visual C++ | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-tools
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- executable files [C++]
- dynamic linking [C++]
- linking [C++], dynamic vs. static
- DLLs [C++]
- DLLs [C++], about DLLs
ms.assetid: 5216bca4-51e2-466b-b221-0e3e776056f0
caps.latest.revision: 
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 14f8a0914b1bb7f2d3a16681a3a66091eda71d73
ms.sourcegitcommit: a5a69d2dc3513261e9e28320e4e067aaf40d2ef2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2018
---
# <a name="dlls-in-visual-c"></a>DLL в Visual C++  
  
В Windows библиотеки динамической компоновки (DLL) представляет собой исполняемый файл, который выступает в качестве общей библиотеки функций и ресурсов. Динамическая компоновка имеет возможность операционной системы, которая позволяет исполняемому файлу вызывать функции или использовать ресурсы, хранящиеся в отдельном файле. Эти функции и ресурсы можно компилировать и развертывать отдельно от использующих их исполняемых файлов. Библиотеки DLL не отдельный исполняемый файл; он выполняется в контексте приложения, которое его вызывает. Операционная система может загрузить библиотеку DLL в памяти приложения при загрузке приложения (*неявное связывание*), либо по запросу во время выполнения (*явное связывание*). Библиотеки DLL также упрощают совместное использование функций и ресурсов различными исполняемыми файлами. Несколько приложений могут осуществлять одновременный доступ к содержимому одной копии библиотеки DLL в памяти.  
  
## <a name="differences-between-dynamic-linking-and-static-linking"></a>Различия между динамическое связывание и статическое связывание  
  
Статическое связывание копирует объектного кода в статическую библиотеку в исполняемые файлы, используйте его, если они создаются. Динамическая компоновка включает только сведения, необходимые для Windows во время выполнения для обнаружения и загрузки библиотеки DLL, которая содержит элемент данных или функцию. При создании библиотеки DLL, можно также создать библиотеку импорта, который содержит эти данные. При создании исполняемого файла, который вызывает библиотеку DLL, компоновщик использует экспортированные символы в библиотеке импорта для хранения этой информации о загрузчик Windows. Когда загрузчик загружает библиотеку DLL, библиотеки DLL сопоставляется области памяти приложения. При его наличии, специальные функции в DLL, `DllMain`, вызывается для выполнения любой необходимой библиотеке DLL инициализации.  
  
<a name="differences-between-applications-and-dlls"></a>  
  
## <a name="differences-between-applications-and-dlls"></a>Различия между приложениями и библиотеками DLL  
  
Хотя библиотеки DLL и приложения являются оба исполняемого модуля, они отличаются несколькими способами. Конечному пользователю Очевидное различие — библиотеки DLL не являются приложения, которые могут быть выполнены непосредственно. С точки зрения системы существует две основные различия между приложениями и библиотеками DLL.  
  
-   Приложение может иметь несколько экземпляров одновременно, работающих в системе, в то время как библиотека DLL может иметь только один экземпляр.  
  
-   Приложения могут загружаться как процесс, который может быть владельцем такие элементы, как стек, потоки выполнения, глобальная память, дескрипторы файлов и очередь сообщений, но не библиотеку DLL.  
  
<a name="advantages-of-using-dlls"></a>  
  
## <a name="advantages-of-using-dlls"></a>Преимущества использования библиотек DLL  
  
Динамическая компоновка статического кода и ресурсов предоставляет несколько преимуществ. При использовании библиотек DLL можно сохранить область памяти и уменьшить объем переключений. Если несколько приложений могут использовать одну копию библиотеки DLL, можно сэкономить место на диске и пропускную способность для скачивания. Библиотеки DLL можно развертывать и обновлять по отдельности, что позволяет предоставлять послепродажную поддержку и обновления программного обеспечения без необходимости перестроения и отправки всего кода. Библиотеки DLL — удобный способ для предоставления ресурсов под определенный языковой стандарт, которые могут поддерживать многоязычные программы и упрощают создание международных версий приложений. Явное связывание может разрешить приложению обнаружить и загрузить DLL во время выполнения, такие как расширения, предоставляющие новые возможности.  
  
Динамическая компоновка имеет следующие преимущества:  
  
-   Динамическая компоновка сохраняет в памяти и уменьшение объема выгрузки. Несколько процессов могут использовать библиотеку DLL одновременно, совместное использование одной копии части библиотеки DLL в памяти только для чтения. Напротив каждое приложение, построенное с помощью статически скомпонованной библиотекой имеет полную копию код библиотеки, Windows необходимо загрузить в память.  
  
-   Динамическая компоновка экономит место на диске и пропускную способность. Многие приложения могут совместно использовать одну копию библиотеки DLL на диске. Напротив каждое приложение, построенное с помощью статической библиотеки имеет код библиотеки, связанный в исполняемый образ, использующий больше места на диске и использует больше пропускной способности для передачи.  
  
-   Обслуживание, исправления безопасности и обновления будет проще. Если приложения используют общие функции в DLL, затем при условии, что аргументы функций и возвращаемые значения не изменяются, можно реализовать исправления ошибок и развертывание обновлений для библиотеки DLL. При обновлении библиотеки DLL, приложения, использующие их не обязательно должны быть перекомпилированы или повторно связать, и их использования новой библиотеки DLL сразу же после его развертывания. В отличие от этого исправления, внесенные в коде статически связанного объекта требуется перекомпоновка и повторно развернуть все приложения, которые его используют.  
  
-   Библиотеки DLL можно использовать для предоставляют вторичную поддержку. Например можно изменить видеодрайвер DLL для поддержки отображения, которые не были доступны, если на момент поставки приложения. Можно использовать явное связывание для загрузки расширения приложений как библиотеки DLL и добавлять новые функциональные возможности приложения без перестройки или ее повторного развертывания.  
  
-   Динамическая компоновка упрощает для поддержки приложений, написанных на разных языках программирования. Программы, написанные на разных языках программирования можно вызвать той же функции DLL, при условии, что программы выполните соглашение о вызовах функции. Программы и функции DLL должны быть совместимы с одним из следующих способов: порядок, в которой функция ожидает аргументов в помещается в стек, находится ли функция или приложение ответственного за очистку стека, и того, являются ли все аргументы переданных в регистрах.  
  
-   Динамическая компоновка представляет способ расширения классов библиотеки MFC. Можно создавать производные классы от существующих классов MFC и поместите их в DLL расширений MFC для использования в приложениях MFC.  
  
-   Динамическая компоновка упрощает создание международных версий приложения. Поместив в библиотеке DLL ресурсов определенного языкового стандарта, гораздо проще Создание международных версий приложений. Вместо доставки многих локализованных версий приложения, можно поместить в отдельную Библиотеку ресурсов строк и изображения для каждого языка, и затем приложение можно загрузить нужные ресурсы для данного языкового стандарта, во время выполнения.   
  
 С помощью библиотеки DLL потенциальных недостаток заключается в том, приложение не является самодостаточным; Это зависит от наличия отдельный модуль DLL, необходимо развернуть или проверка самостоятельно как часть установки.  
  
  
## <a name="more-information-on-how-to-create-and-use-dlls"></a>Дополнительные сведения о том, как создание и использование библиотеки DLL  
  
Следующие разделы предоставляют подробные сведения о программировании библиотек DLL в Visual C++.  
  
 [Пошаговое руководство. Создание и использование библиотеки DLL (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)  
 Описывает создание и использование библиотек DLL при помощи Visual Studio.  
  
 [Типы библиотек DLL](../build/kinds-of-dlls.md)  
 Предоставляет сведения о различных типах библиотек DLL, которые доступны для сборки.  
  
 [Вопросы и ответы по библиотекам DLL](../build/dll-frequently-asked-questions.md)  
 Ответы на часто задаваемые вопросы о библиотеках DLL.  
  
 [Связывание исполняемого файла с библиотекой DLL](../build/linking-an-executable-to-a-dll.md)  
 Описание явного и неявного соединения с библиотекой DLL.  
  
 [Инициализация библиотеки DLL](../build/run-time-library-behavior.md#initializing-a-dll)  
 Процесс инициализации кода, необходимый для выполнения загрузки библиотеки DLL.  
  
 [Библиотеки DLL и поведение библиотеки времени выполнения Visual C++](../build/run-time-library-behavior.md)  
 Выполнение библиотекой времени выполнения функции запускаемой последовательности DLL.  
  
 [Функции LoadLibrary и AfxLoadLibrary](../build/loadlibrary-and-afxloadlibrary.md)  
 Описывает использование **LoadLibrary** и `AfxLoadLibrary` явной ссылкой на библиотеку DLL во время выполнения.  
  
 [Функция GetProcAddress](../build/getprocaddress.md)  
 Описывает использование **GetProcAddress** для получения адреса экспортированной функции в DLL.  
  
 [Функции FreeLibrary и AfxFreeLibrary](../build/freelibrary-and-afxfreelibrary.md)  
 Описывает использование **FreeLibrary** и `AfxFreeLibrary` при модуль DLL больше не нужен.  
  
 [Путь поиска, используемый Windows для обнаружения библиотеки DLL](../build/search-path-used-by-windows-to-locate-a-dll.md)  
 Описание пути поиска, который операционная система Windows использует для поиска библиотеки DLL в системе.  
  
 [Состояния модулей обычной DLL-библиотеки MFC, динамически связанной с MFC](../build/module-states-of-a-regular-dll-dynamically-linked-to-mfc.md)  
 Описание состояния модулей обычной, MFC DLL, динамически компонуемые с MFC.  
  
 [Библиотеки DLL расширений MFC](../build/extension-dlls-overview.md)  
 Наличие библиотек DLL, которые обычно реализуют классы многократного использования в существующих библиотеках классов Microsoft Foundation Class.  
  
 [Создание библиотек DLL, содержащих только ресурсы](../build/creating-a-resource-only-dll.md)  
 Библиотека DLL, содержащая только ресурсы, например значки, растровые изображения, строки и диалоговые окна.  
  
 [Локализованные ресурсы в приложениях MFC: вспомогательные библиотеки DLL](../build/localized-resources-in-mfc-applications-satellite-dlls.md)  
 Расширенная поддержка библиотек спутниковой связи DLL и содержит возможность, которая позволяет создавать приложения, локализированные на различные языки.  
  
 [Импортирование и экспортирование](../build/importing-and-exporting.md)  
 Импортирование открытых символов в приложение или экспортирование функций из библиотеки DLL  
  
 [Технология Active и библиотеки DLL](../build/active-technology-and-dlls.md)  
 Размещение серверов объектов внутри библиотеки DLL.  
  
 [Автоматизация в библиотеке DLL](../build/automation-in-a-dll.md)  
 Параметр автоматизации в решениях мастера библиотек DLL MFC.  
  
 [Соглашения об именовании библиотек DLL MFC](../mfc/mfc-library-versions.md#mfc-static-library-naming-conventions)  
 Способ встраивания библиотек DLL в MFC, опираясь на четко структурированное соглашение об именовании.  
  
 [Вызов функций библиотек DLL из приложений Visual Basic](../build/calling-dll-functions-from-visual-basic-applications.md)  
 Способ вызова функций DLL из приложений Visual Basic.  
  
## <a name="related-sections"></a>Связанные разделы  
  
 [Использование MFC как часть библиотеки DLL](../mfc/tn011-using-mfc-as-part-of-a-dll.md)  
 Описывает обычные библиотеки DLL MFC, которые позволяют использовать библиотеку MFC как часть библиотеки динамической компоновки Windows.  
  
 [Версия библиотеки DLL MFC](../mfc/tn033-dll-version-of-mfc.md)  
 Описывает, как можно использовать MFCxx.dll и MFCxxD.dll (где x является номером версии MFC) библиотек динамической компоновки с приложениями MFC и библиотека DLL-расширения MFC.  
