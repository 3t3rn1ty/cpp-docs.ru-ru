---
title: Статически компонуемые с MFC библиотеки DLL MFC регулярного | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- regular MFC DLLs [C++]
- DLLs [C++], regular
- USRDLLs
- USRDLLs, statically linked to MFC
- statically linked DLLs [C++]
- regular MFC DLLs [C++], statically linked to MFC
ms.assetid: 2eed531c-726a-4b8a-b936-f721dc00a7fa
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: c48fdfb0b10541c1643ec49038e29cfa60c633d9
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32383752"
---
# <a name="regular-mfc-dlls-statically-linked-to-mfc"></a>Регулярные MFC библиотеки DLL, статически компонуемые с MFC
Обычный, MFC DLL, статически компонуемые с MFC является библиотекой DLL, внутренне использует MFC, а экспортированные функции в DLL может быть вызван MFC или не MFC исполняемых файлов. Как из названия, этот вид библиотек DLL построен с использованием статическая компоновка версии библиотеки MFC. Функции обычно экспортируются из библиотеки DLL MFC, с помощью стандартного интерфейса C обычного. Пример того, как записи, создания и использования регулярных DLL MFC, см. в образце [DLLScreenCap](https://github.com/Microsoft/VCSamples/tree/master/VC2010Samples/MFC/advanced/DllScreenCap).  
  
 Обратите внимание, что термин USRDLL больше не используются в документации по Visual C++. Обычной MFC DLL, статически компонуемые с MFC имеет те же характеристики, как бывшая USRDLL.  
  
 Обычной MFC DLL, статически компонуемые с MFC, имеет следующие особенности:  
  
-   Исполняемый файл клиента может быть написан на любом языке, поддерживающем использование библиотек DLL (C, C++, Pascal, Visual Basic и т. д.); оно не обязательно должно приложение MFC.  
  
-   Библиотеки DLL можно связать с одной статической компоновки библиотеки MFC, используемых приложениями. Больше не существует отдельная версия библиотеки статической компоновки для библиотеки DLL.  
  
-   До версии MFC 4.0 библиотеки USRDLL обеспечивали тот же тип, возможности, что обычные библиотеки DLL MFC, статически компонуемые с MFC. Начиная с Visual C++ версии 4.0, термин USRDLL устарел.  
  
 Обычной MFC DLL, статически компонуемые с MFC, необходимо соблюдать следующие требования:  
  
-   Этот тип из библиотеки DLL, необходимо создать экземпляр класса, производного от `CWinApp`.  
  
-   Этот тип DLL-Библиотека использует `DllMain` предоставляемая MFC. Поместите весь код инициализации зависящей от DLL в `InitInstance` код функции и завершение элемента в `ExitInstance` как обычного приложения MFC.  
  
-   Несмотря на то, что термин USRDLL устарел, необходимо определить "**_USRDLL**» в командной строке компилятора. Это определение указывает, какие объявления должны выбираться из файлов заголовков MFC.  
  
 обычные библиотеки DLL MFC должен иметь `CWinApp`-производного класса, а также один объект этого класса приложений, как в приложении MFC. Тем не менее `CWinApp` объект библиотеки DLL не имеет цикла обработки сообщений, как и в `CWinApp` приложения.  
  
 Обратите внимание, что `CWinApp::Run` механизм не применяется к библиотеке DLL, поскольку приложение, которому принадлежит основной конвейер сообщений. Если DLL открывает немодальные диалоговые окна или имеет собственный фрейм окна, приложения цикла обработки сообщений должен вызывать процедуру экспорта DLL, в свою очередь вызывает `CWinApp::PreTranslateMessage` функции-члена объекта приложения библиотеки DLL.  
  
 Пример этой функции см. в образце DLLScreenCap.  
  
 Символы, обычно экспортируются из обычного библиотеки DLL MFC, с помощью стандартного интерфейса C. Объявление функции, экспортированные из обычной MFC DLL будет выглядеть примерно следующим образом:  
  
```  
extern "C" __declspec(dllexport) MyExportedFunction( );  
```  
  
 Всех операций выделения памяти в обычной MFC DLL должна использоваться только внутри этой DLL. библиотеки DLL не следует передавать или получать из вызывающего исполняемого модуля следующие:  
  
-   Указатели на объекты MFC  
  
-   Указатели памяти, выделенной библиотекой MFC.  
  
 Если необходимо выполнять какие-либо из перечисленных выше или передавать объекты, производные от вызывающего исполняемый файл и библиотека DLL, необходимо построить DLL расширений MFC.  
  
 Можно безопасно передавать указатели памяти, выделенной в библиотеках времени выполнения C между приложением и библиотеку DLL только в том случае, если создать копию данных. Нельзя удалять или изменять размеры этих указателей или использовать их без создания копии памяти.  
  
 Библиотека DLL, статически компонуемые с MFC также динамически нельзя связать с общей библиотеки DLL MFC. Библиотека DLL, статически компонуемые с MFC динамически привязан к приложению так же, как и любой другой DLL; приложение связывается с ней так же, как и любой другой DLL.  
  
 Стандартные библиотеки статической компоновки MFC присваиваются в соответствии с соглашением, описанным в [соглашения об именовании библиотек DLL MFC](../mfc/mfc-library-versions.md#mfc-static-library-naming-conventions). Тем не менее с MFC версии 3.0 и более поздней версии, он больше не требуется вручную указывать компоновщику версии библиотеки MFC, необходимые в. Вместо этого, файлы заголовков MFC автоматически определять определяет правильную версию библиотеки MFC на основе препроцессора, таких как  **\_отладки** или **_UNICODE**. Файлы заголовков MFC добавьте/DEFAULTLIB директивы для ссылок в определенной версии библиотеки MFC.  
  
## <a name="what-do-you-want-to-do"></a>Выберите действие  
  
-   [Инициализация обычных библиотек DLL MFC](../build/run-time-library-behavior.md#initializing-regular-dlls)  
  
## <a name="what-do-you-want-to-know-more-about"></a>Дополнительные сведения  
  
-   [Использование MFC как часть библиотеки DLL](../mfc/tn011-using-mfc-as-part-of-a-dll.md)  
  
-   [Использование библиотек DLL расширений MFC для баз данных, OLE и сокетов в обычных DLL-библиотеках MFC](../build/using-database-ole-and-sockets-extension-dlls-in-regular-dlls.md)  
  
-   [Создание библиотеки DLL MFC](../mfc/reference/mfc-dll-wizard.md)  
  
-   [Обычные DLL-библиотеки MFC, динамически связанные с MFC](../build/regular-dlls-dynamically-linked-to-mfc.md)  
  
-   [Библиотеки DLL расширений MFC](../build/extension-dlls-overview.md)  
  
## <a name="see-also"></a>См. также  
 [Типы библиотек DLL](../build/kinds-of-dlls.md)