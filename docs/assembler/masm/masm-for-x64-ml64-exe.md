---
title: MASM для x64 (ml64.exe) | Документы Microsoft
ms.custom: ''
ms.date: 06/08/2018
ms.technology:
- cpp-masm
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- ml64
- ml64.exe
- masm for x64
ms.assetid: 89059103-f372-4968-80ea-0c7f90bb9c91
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 42edd255b3f8730263bba9ff683ce16da6fc59b5
ms.sourcegitcommit: 1c2e035f98fb55d9b3c08ec3bb562179a368d0d1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35253806"
---
# <a name="masm-for-x64-ml64exe"></a>MASM для x64 (ml64.exe)

Visual Studio включает 32-разрядных и 64-разрядные размещенные версии Microsoft Assembler (MASM) для целевого x64 кода. С именем ml64.exe, это код на языке ассемблера, принимающий x64 языка ассемблера. Средства командной строки MASM устанавливаются при выборе рабочей нагрузки C++ во время установки Visual Studio. Как отдельный загружаемый MASM средства недоступны. Инструкции о том, как загрузить и установить копию Visual Studio см. в разделе [установите Visual Studio](/visualstudio/install/install-visual-studio). Если вы не хотите устанавливать полный IDE Visual Studio, но требуется только средства командной строки, загрузите [Build Tools для Visual Studio 2017 г](https://go.microsoft.com/fwlink/p/?linkid=840931).

Использование MASM для создания кода для x64 обращается в командной строке, необходимо использовать командную строку разработчика для x64 целевых объектов, которые задает необходимый путь и других переменных среды. Сведения о том, как запустить командную строку разработчика см. в разделе [кода C/C++ на сборки в командной строке](../../build/building-on-the-command-line.md).

Сведения о параметрах командной строки, ml64.exe см. в разделе [ML и ML64 Справочник по командной строке](../../assembler/masm/ml-and-ml64-command-line-reference.md).  
  
Встроенный ассемблер или использование ключевого слова ассемблерного кода не поддерживается для x64 или ARM целевых объектов. Перенос вашей x86 кода, используется встроенный код ассемблера для x64 или ARM, можно преобразовать кода C++, используйте встроенные функции компилятора или создания исходных файлов на языке ассемблера. Компилятор Visual C++ поддерживает встроенные функции, чтобы можно было использовать инструкции специальные функции для работы в привилегированном режиме, примере бит проверки и тестирования, блокируемые и т. д, в качестве близко к межплатформенным способом, как можно. Сведения о доступных встроенных функций см. в разделе [встроенные объекты компилятора](../../intrinsics/compiler-intrinsics.md).  

## <a name="add-an-assembler-language-file-to-a-visual-c-project"></a>Добавьте файл языка ассемблера в проект Visual C++  
  
Система проектов Visual Studio поддерживает файлы языка ассемблера, построенные с помощью MASM в проектах C++. Можно создать x64 файлы и создавать их в файлы объектов с помощью MASM, который полностью поддерживает x64 исходный код на языке ассемблера. Затем можно связать эти файлы объектов в код C++, созданного для x64 целевых объектов. Это один из способов решения отсутствие x64 встроенный код ассемблера.  

### <a name="to-add-an-assembler-language-file-to-an-existing-visual-c-project"></a>Чтобы добавить файл языка ассемблера в существующий проект Visual C++

1. Выберите проект в **обозревателе решений**. В строке меню выберите **проекта**, **сборки настройки**.

1. В **файлы настройки сборки для Visual C++** диалогового окна поле, установите флажок рядом с **masm(.targets,.props)**. Выберите **ОК** чтобы сохранить выбранное значение и закрыть диалоговое окно.

1. В строке меню выберите **проекта**, **Добавление нового элемента**. 

1. В **Добавление нового элемента** выберите **файл C++ (.cpp)** в центральной области. В **имя** элемента управления edit, введите новое имя файла, который имеет **.asm** расширение вместо .cpp. Выберите **добавить** добавьте файл в проект и закрыть диалоговое окно.

Создайте код языка ассемблера в ASM-файл, который вы добавили. При построении решения, код на языке ассемблера MASM вызывается можно собрать ASM-файл в объектный файл, то связан в проект. Для упрощения доступа символ как ассемблер функции необходимо объявлять `extern "C"` в исходный код C++, вместо того чтобы использовать C++ имя соглашения о дополнении на вашем языке ассемблер исходных файлов.
  
## <a name="ml64-specific-directives"></a>Директивы ML64  

Можно использовать следующие директивы ml64 в исходном коде языка ассемблера, предназначенного x64:  
  
-   [.ALLOCSTACK](../../assembler/masm/dot-allocstack.md)  
  
-   [.ENDPROLOG](../../assembler/masm/dot-endprolog.md)  
  
-   [.PUSHFRAME](../../assembler/masm/dot-pushframe.md)  
  
-   [.PUSHREG](../../assembler/masm/dot-pushreg.md)  
  
-   [.SAVEREG](../../assembler/masm/dot-savereg.md)  
  
-   [.SAVEXMM128](../../assembler/masm/dot-savexmm128.md)  
  
-   [.SETFRAME](../../assembler/masm/dot-setframe.md)  
  
Кроме того [PROC](../../assembler/masm/proc.md) директива был обновлен для использования с ml64.exe.  
  
## <a name="32-bit-address-mode-address-size-override"></a>32-разрядный адрес режим (адрес размер переопределения).  

MASM выдает переопределение размер 0x67 адрес, если операнде памяти включает 32-разрядные регистры. Например следующие примеры вызывает переопределение размер адрес для выдачи.  
  
```MASM  
mov rax, QWORD PTR [ecx]  
mov eax, DWORD PTR [ecx*2+r10d]  
mov eax, DWORD PTR [ecx*2+r10d+0100h]  
prefetch [eax]  
movnti rax, QWORD PTR [r8d]  
```  
  
MASM предполагается, что если 32-разрядное смещение указано только как операнде памяти, 64-разрядную адресацию предназначен. В настоящее время не поддерживается для 32-разрядную адресацию с такой операндами.  
  
Наконец смешивание размеры регистра в операнде памяти, как показано в следующем коде возникает ошибка.  
  
```MASM  
mov eax, DWORD PTR [rcx*2+r10d]  
mov eax, DWORD PTR [ecx*2+r10+0100h]  
```  
  
## <a name="see-also"></a>См. также  

[Справочные материалы по ассемблеру Microsoft Macro Assembler](../../assembler/masm/microsoft-macro-assembler-reference.md)