---
title: "Рекомендации по начальной странице | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "начальная страница, советы"
  - "начальная страница, рекомендации"
  - "начальная страница, макет"
ms.assetid: f6ce1ce0-746e-4004-a37f-6f176f6f5851
caps.latest.revision: 16
caps.handback.revision: 16
manager: "douge"
---
# Рекомендации по начальной странице
Начальная страница может получить доступ к командам Visual Studio и открывается при каждой загрузке Visual Studio. Поэтому рекомендуем убедиться в стабильной работе собственных начальных страниц, прежде чем использовать или распределять их. В этом разделе предлагаются рекомендации по разработке надежного макета начальной страницы и инструкции по созданию полезного пользовательского интерфейса.  
  
## Рекомендации по стабильности  
  
### Доступность ресурсов  
 При создании надежной собственной начальной страницы в первую очередь необходимо убедиться, что все требуемые ресурсы доступны:  
  
-   все необходимые пакеты установлены;  
  
-   пакеты являются предварительно загружаемыми;  
  
-   все необходимые сборки находятся в папке \\PrivateAssemblies\\;  
  
-   каждый компонент, использующий сеть или подключение к Интернету, имеет альтернативные пути для сценариев автономной работы и в случаях прерванных соединений.  
  
### Производительность  
 Если начальная страница требует большой объем памяти или загружает много ресурсов, следует внимательно рассмотреть влияние на производительность при запуске. Создавайте подобные начальные страницы так, чтобы компоненты загружались по требованию или в фоновом режиме, если это целесообразно, чтобы избежать длительного запуска.  
  
### Процесс разработки  
 При непосредственном изменении активной начальной страницы вы можете случайно привнести ошибки, приводящие к сбою Visual Studio. Начальная страница открывается при каждом открытии Visual Studio, поэтому сбой начальной страницы сложно исправить. Поэтому для надежности рекомендуется изменять копии файлов начальной страницы и тестировать их в экспериментальном экземпляре Visual Studio. Если новая начальная страница стабильна, настройте ее запуск в основном экземпляре Visual Studio.  
  
> [!NOTE]
>  Рекомендуется также тестировать любые сторонние начальные страницы в экспериментальном экземпляре Visual Studio, прежде чем использовать их в основном экземпляре.  
  
##### Тестирование начальной страницы в экспериментальном экземпляре Visual Studio  
  
1.  Если вы используете шаблон проекта начальной страницы, нажмите клавишу F5. В противном случае:  
  
    1.  Скопируйте XAML\-файл и весь сопутствующий текст или разметку в папку \\%USERPROFILE%\\My Documents\\Visual Studio *\<версия\>*\\StartPages\\.  
  
    2.  Скопируйте все необходимые сборки в папку *\<Путь установки Visual Studio\>*\\Common7\\IDE\\PrivateAssemblies\\.  
  
    3.  Откройте экспериментальный экземпляр Visual Studio, введя следующую команду в командной строке Visual Studio.  
  
         **Devenv \/rootsuffix exp**  
  
2.  В меню **Сервис** выберите пункт **Параметры**. Разверните узел **Среда**, а затем выберите пункт **Запуск**. В списке **настройки начальной страницы** выберите переименованный файл StartPage.xaml и нажмите кнопку **ОК**.  
  
3.  В меню **Вид** выберите пункт **Начальная страница**.  
  
     Откроется настраиваемая начальная страница. Если происходит сбой начальной страницы, которую вы изменяете, можно перезапустить основной экземпляр Visual Studio, внести необходимые исправления, а затем открыть другой экспериментальный экземпляр, чтобы продолжить изменение вашей настраиваемой начальной страницы.  
  
 Если ваша начальная страница привела к сбою основного экземпляра Visual Studio, можно временно отключить настраиваемые начальные страницы, задав в разделе реестра HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\14.0\\StartPage\\Default\\CustomizationEnabled значение 0. Кроме того, вы можете временно переименовать XAML\-файл для текущей начальной страницы по умолчанию. Любое из этих действий позволит вам открыть Visual Studio на время, достаточное для устранения ошибки.  
  
### Отладка  
 Окно инструментов начальной страницы перехватывает исключения при первой загрузке начальной страницы, но не перехватывает исключения после этого. Можно указать Visual Studio, что следует отображать все необработанные исключения, задав значение "1" в следующем разделе реестра:  
  
 HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\14.0\\General\\EnableUnhandledExceptionDisplay  
  
 Сведения об исключении будут отображаться в окне сообщений, что позволит вам отлаживать элементы управления на начальной странице или в других необработанных местах, даже в основном экземпляре Visual Studio. Если не удается выполнить отладку после возникновения исключения, можно перезапустить Visual Studio с помощью команды "devenv \/safemode", вернуться к предыдущей начальной странице и продолжить отладку в экспериментальном экземпляре.  
  
### Относительные пути  
 При ссылке на пути к файлам из начальной страницы всегда используйте относительные пути, чтобы предусмотреть разные конфигурации системы. Но корень всех относительных путей для домашней страницы касается не папки \\StartPages\\, а папки …\\*папка установки Visual Studio*\\Common7\\IDE, где находится файл devenv.exe. Чтобы задать путь относительно папки \\StartPages\\, используйте относительный преобразователь начальной страницы VS \(VS Start Page Relative Converter\). Это можно сделать, задав для свойства `Source` объекта значение `vs:StartPageRelative`, как показано в следующем примере.  
  
 XAML  
  
```  
<Image Source="{vs:StartPageRelative myImage.png}" .../>  
```  
  
 При доступе к ресурсам, входящим в состав Visual Studio, или к файлам, включенным в другие пакеты, используйте стандартный синтаксис относительного пути.  
  
### Развертывание  
 При развертывании настраиваемой начальной страницы для других пользователей воспользуйтесь следующими рекомендациями.  
  
#### Параметры пользователя  
  
-   Не изменяйте параметры пользователя. Не перезаписывайте существующие параметры начальной страницы.  
  
#### VSIX  
 Эти рекомендации относятся к развертыванию VSIX.  
  
-   Используйте элемент [GettingStartedGuide](http://msdn.microsoft.com/ru-ru/261bb1fd-abae-4ed6-80a8-90d5fc3bb8c6) в манифесте VSIX, чтобы указать инструкции по установке начальной страницы по умолчанию.  
  
-   Используйте элементы [Name](http://msdn.microsoft.com/ru-ru/d99d38d1-060b-401a-9b9f-ede2c6213a11) и [Description](http://msdn.microsoft.com/ru-ru/24ddc57e-e991-4a43-b0c9-0e76da293e99) манифеста VSIX для четкого определения расширения как начальной страницы и описания его назначения.  
  
-   Убедитесь, что манифест VSIX не содержит абсолютные пути.  
  
-   При отправке на веб\-сайт [коллекции Visual Studio](http://go.microsoft.com/fwlink/?LinkID=123847) включите соответствующие теги, чтобы пользователи могли определить расширение как начальную страницу.  
  
#### MSI  
 При создании начальной страницы как части большего расширения, которое развертывается в пакете установщика Windows \(MSI\), можно задать установку начальной страницы в качестве начальной страницы по умолчанию на целевом компьютере. Для этого запишите имя XAML\-файла начальной страницы в значение Uri этого раздела реестра: HKCU\\Software\\Microsoft\\VisualStudio\\14.0\\StartPage\\Default\\. При установке этого значения реестра следуйте приведенным ниже рекомендациям.  
  
-   Предоставьте в установщике пользовательский интерфейс, дающий пользователю возможность выбрать, нужно ли делать новую начальную страницу страницей по умолчанию.  
  
-   Если пользователь удаляет расширение, восстанавливайте предыдущее значение реестра.  
  
### Windows Presentation Foundation \(WPF\)  
 Ваша разметка XAML должна соответствовать рекомендациям WPF. Сведения о рекомендациях [!INCLUDE[TLA#tla_winclient](../misc/includes/tlasharptla_winclient_md.md)] и [!INCLUDE[TLA#tla_netframewk](../misc/includes/tlasharptla_netframewk_md.md)] для разработки приложений см. в следующих разделах.  
  
|Область|Раздел|  
|-------------|------------|  
|Специальные возможности|[Accessibility Best Practices](../Topic/Accessibility%20Best%20Practices.md)|  
|Локализация|[Общие сведения о глобализации и локализации WPF](../Topic/WPF%20Globalization%20and%20Localization%20Overview.md)|  
|Производительность|[Улучшение производительности приложений WPF](../Topic/Optimizing%20WPF%20Application%20Performance.md)|  
|Безопасность|[Безопасность \(WPF\)](../Topic/Security%20\(WPF\).md)|  
  
## Рекомендации по пользовательскому интерфейсу  
 Чтобы обеспечить удобное и интуитивно понятное взаимодействие пользователей на начальной странице, следуйте приведенным ниже рекомендациям по пользовательскому интерфейсу, где это возможно.  
  
### Верхняя строка  
  
#### Баннер  
  
-   Высота изображения баннера должна быть такой же, как и высота определения строки, содержащей его.  
  
-   Чтобы учесть различные размеры окон и всевозможные разрешения экрана, сделайте изображение баннера визуально привлекательным при любой ширине.  
  
-   Не загромождайте область баннера. Не перекрывайте логотип дополнительными кнопками или рисунками.  
  
### Левый столбец  
  
#### Область кнопок  
  
-   Поместите в область кнопок только наиболее часто используемые элементы управления, чтобы оставить место для отображения имен последних проектов. Рекомендуется размещать не более пяти кнопок.  
  
#### Последние проекты  
  
-   С помощью этого элемента управления пользователь может обращаться к последним проектам. Можно задать число отображаемых проектов от 0 до 24. Это — наиболее часто используемый раздел начальной страницы, рекомендуется не удалять его.  
  
#### Параметры начальной страницы  
  
-   Убедитесь, что на начальной странице отображаются параметры **Закрыть страницу после загрузки проекта** и **Отображать страницу при запуске**.  
  
-   Для дополнительных элементов управления в этой области рекомендуется использовать флажки и переключатели и проверять, что эти элементы управления связаны с параметрами начальной страницы.  
  
### Область содержимого  
  
#### Вкладки верхнего уровня  
  
-   Избегайте добавления слишком большого числа вкладок, чтобы набор вкладок не переносился при типичной ширине экрана.  
  
-   Используйте для вкладок короткие описательные имена.  
  
-   Убедитесь, что вкладки представляют сгруппированные области содержимого.  
  
#### Вкладки подуровней  
  
-   Используйте навигацию по подуровням только при наличии более двух подразделов.  
  
-   Избегайте добавления слишком большого числа вкладок, чтобы набор вкладок не переносился при типичной ширине экрана.  
  
-   Используйте для вкладок короткие описательные имена.  
  
#### Содержимое вкладок подуровней  
  
-   Отображайте на вкладке подуровня не более пяти элементов содержимого.  
  
#### Содержимое элемента  
  
-   Отображайте в элементе содержимого не более четырех ссылок.  
  
-   Если вы связываете изображения с элементами содержимого, убедитесь, что размер каждого изображения составляет не более 175 на 125 пикселей.  
  
-   Используйте короткие, описательные заголовки для элементов содержимого.  
  
-   При создании описания элемента содержимого ограничьтесь одним\-двумя предложениями.  
  
### Общие правила  
  
#### Анимации  
  
-   Используйте анимации длительностью не более 0,5 секунд, чтобы не возникало ни малейшего ощущения плохой производительности.  
  
#### Цвета среды  
  
-   Сохраняйте системные настройки для шрифтов и цветов.  
  
-   Используйте светлый фон.  
  
-   Используйте обнаружение удаленного рабочего стола, чтобы гарантировать корректное снижение цветности в удаленных сеансах.  
  
## См. также  
 [Архитектура начальной страницы](../Topic/Start%20Page%20Architecture.md)   
 [Развертывание пользовательской начальной страницы](../Topic/Deploying%20Custom%20Start%20Pages.md)   
 [Добавление команд Visual Studio на начальной странице](../Topic/Adding%20Visual%20Studio%20Commands%20to%20a%20Start%20Page.md)