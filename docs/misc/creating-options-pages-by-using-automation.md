---
title: "Создание страниц &quot;Параметры&quot; с помощью автоматизации | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "страницы "Параметры средств" [Visual Studio SDK], создание"
  - "автоматизация [Visual Studio SDK], создание страниц "Параметры средств""
ms.assetid: 05ec0337-58fe-4746-8e85-7fb97f285522
caps.latest.revision: 12
caps.handback.revision: 12
manager: "douge"
---
# Создание страниц &quot;Параметры&quot; с помощью автоматизации
Управляемое VSPackages может использовать автоматизацию для расширения [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] интегрированная среда разработки \(ide\), добавляя  **Параметры** страницы до  **Сервис** меню.  
  
 A **"Сервис параметры "** страница фундаментально пользовательского элемента управления и закодирована точно так же, как любой другой пользовательский элемент управления.  Обычно использовался бы одно из [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] Конструкторы интегрированной среды разработки для создания объекта и добавление пользовательских элементов управления.  
  
> [!NOTE]
>  **"Сервис параметры "** страницы, реализованные как диалоговое окно, используя a  `DialogProc` обрабатывать сообщения windows, безрежимное быть диалоговыми окнами и вызывать  `EndDialog` функция.  
  
 Следует использовать объект автоматизации, VSPackage предоставляет среду со свойствами пользовательского элемента управления.  
  
## Поддержка автоматизации для страниц Параметры средств, реализованных с сборками взаимодействия  
 Для поддержки модели автоматизации VSPackage должно создать и зарегистрировать объект автоматизации.  Дополнительные сведения см. в разделе [Предоставляет сведения об автоматизации VSPackages](../Topic/Providing%20Automation%20for%20VSPackages.md).  
  
 Если код, который использует модель автоматизации вызывает `DTE.Properties` для коллекции свойств заданным  **"Сервис параметры "** страница интегрированная среда разработки автоматизации использует объект, предоставленный реализацией VSPackage  <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage.GetAutomationObject%2A> возвращает коллекцию и разрешить доступ к своему составу  <xref:EnvDTE.Property> объекты.  
  
 **Примечание.** Объект автоматизации, возвращаемый by  <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage.GetAutomationObject%2A> зависит от предоставленный GUID \(например VSPackage может поддерживать несколько объект автоматизации\).  Дополнительные сведения о реализации см. объекты автоматизации. [Поддержка модели автоматизации для страницы параметров](../Topic/Automation%20Support%20for%20Options%20Pages.md).  
  
 A **"Сервис параметры "** страница указана 2 идентификаторами.  Первый идентификатор является строкой, которая отображает папку, содержащую элемент **Параметры** раздел   **Сервис** меню.  Второй идентификатор строка, которая указывает конкретный элемент в папке.  Дополнительные сведения см. в разделе [Использование страниц параметров](../misc/using-options-pages.md).  
  
 Для регистрации записи реестра. объект автоматизации: 2  
  
-   В разделе HKEY\_LOCAL\_MACHINE \\ software \\ microsoft \\ VisualStudio \\*\<Версия* \\ Packages \\*\<PackageGUID\>*\\ Автоматизация  
  
-   В разделе HKEY\_LOCAL\_MACHINE \\ software \\ microsoft \\ VisualStudio \\*\<Версия\>*\\ AutomationProperties  
  
     где *\<Версия\>* версия   [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] \(например, 8,0\).  *\<PackageGUID\>* идентификатор GUID VSPackage, реализующий объект автоматизации.  
  
 В зависимости от конфигурации в записи реестра AutomationProperties, состояние a **"Сервис параметры "** страница может автоматически сохранять и восстанавливается до  [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] механизм параметров, когда пользователь выбирает  **Параметры импорта\-экспорта** команда на  **Сервис** меню.  Дополнительные сведения о сбережениях **"Сервис параметры "** настройки страницы см. в разделе  [Регистрация пользовательских страниц параметров](../misc/registering-custom-options-pages.md).  
  
 Приложение не может использовать модель автоматизации для реализации поддержки a **"Сервис параметры "** свойства и параметры страницы.  
  
 Это может быть желательно по нескольким причинам:  
  
-   Параметры обработки **"Сервис параметры "** страница более сложна в структуре, чем относительно плоская модель автоматизации поддерживает свойства.  
  
-   Необходимость предотвратить программно управлять его от других приложений **"Сервис параметры "** страница.  
  
-   Специальные управления доступом или средства безопасности требуются.  
  
 В этих случаях VSPackages может реализовать **"Сервис параметры "** поддержка страницы в любом случае, подходящей.  Однако они:  
  
-   Настройте параметр **"Сервис параметры "** свойства страницы.  
  
-   Сохраняемость управления  **"Сервис параметры "** состояние страницы до  [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] параметры.  
  
-   Обеспечьте API, при необходимости, для других приложений, применять **"Сервис параметры "** страница.  
  
 Свойства  **Шрифты и цвета** диалоговое окно " пример а  **"Сервис параметры "** страница, которая не может быть изменен с помощью модели автоматизации.  Вместо этого обеспечивается отдельно на основе API <xref:Microsoft.VisualStudio.Shell.Interop.IVsFontAndColorDefaults> интерфейс, чтобы программное управление  **Шрифты и цвета"Сервис параметры "** страница.  Дополнительные сведения о наблюдение **Шрифты и цвета"Сервис параметры "** страница см. в разделе  [Шрифты и цвета](../Topic/Using%20Fonts%20and%20Colors.md).  
  
## Поддержка автоматизации для страниц " сервис Параметры " в управляемом пакет .NET Framework  
 Установка <xref:Microsoft.VisualStudio.Shell.ProvideOptionPageAttribute.SupportsAutomation%2A> свойство регистрация реализации  <xref:Microsoft.VisualStudio.Shell.ProvideOptionPageAttribute> экземпляр, чтобы указать, что управляемая реализация .NET Framework\-основания пакета a  **"Сервис параметры "** страница поддерживает автоматизацию.  
  
 **"Сервис параметры "** страницы, производные от  <xref:Microsoft.VisualStudio.Shell.DialogPage> предоставьте с объектом автоматизации по умолчанию, который можно переопределить.  
  
 Если набор узлов a **"Сервис параметры "** реализация страницы не поддерживает автоматизацию реализация должна предоставить собственное API, чтобы разрешить программный доступ к  **"Сервис параметры "** страница.  
  
> [!NOTE]
>  Интегрированной среды разработки **Шрифты и цвета** страница " пример а  **"Сервис параметры "** страница, которая не поддерживает автоматизацию, но предоставляет доступ к  **"Сервис параметры "** страница с помощью собственного api\-интерфейса.  Дополнительные сведения см. в разделе [Шрифты и цвета](../Topic/Using%20Fonts%20and%20Colors.md).  
  
## См. также  
 [Расширение среды Visual Studio](../Topic/Extending%20the%20Visual%20Studio%20Environment.md)   
 [Создание страниц "Параметры" с помощью сборок взаимодействия](../Topic/Creating%20Options%20Pages%20By%20Using%20Interop%20Assemblies.md)   
 [Создание страницы параметров](../Topic/Creating%20Options%20Pages.md)   
 [Практическое руководство. Создание пользовательских страниц параметров](../Topic/How%20to:%20Create%20Custom%20Options%20Pages.md)   
 [Creating Registrar Scripts](../Topic/Creating%20Registrar%20Scripts.md)   
 [Поддержка модели автоматизации для страницы параметров](../Topic/Automation%20Support%20for%20Options%20Pages.md)   
 [Использование страниц параметров](../misc/using-options-pages.md)