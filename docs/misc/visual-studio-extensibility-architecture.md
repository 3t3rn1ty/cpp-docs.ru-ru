---
title: "Архитектура расширения Visual Studio | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Visual Studio, модель среды"
  - "модель среды, Visual Studio"
ms.assetid: 280fdb55-3e70-41fd-8da0-4039bf5d4894
caps.latest.revision: 17
caps.handback.revision: 17
manager: "douge"
---
# Архитектура расширения Visual Studio
[!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] интегрированная среда разработки \(ide\) границы для размещения VSPackages, и для него более удобным обмениваться общие службы.  Пример такого, как среда разработки реализует интерфейс пользователя\).  Интегрированная среда разработки предоставляет окна и контейнера по умолчанию панели инструментов и меню.  Она также предоставляет богатую инфраструктуру модели COM, который делает пользовательский интерфейс программируемых.  Полная обработка команды и схему маршрутизации позволяет пользователям открытые границы, которые обеспечивают простой доступ и к существующим наборам и устанавливанным команды.  
  
## Архитектура расширяемости  
 На следующей иллюстрации показана [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] архитектура расширяемости.  Обратите внимание, что отсутствует понятие программного приложения.  Вместо этого узлы, называемые программные компоненты интегрированной среды разработки, VSPackages, которые предоставляют функциональность приложения.  Эту функциональность, в свою очередь, совместно с помощью интегрированной среды разработки в качестве службы.  Службы предложения VSPackages, а другая использование VSPackages.  Стандартная интегрированная среда разработки также предлагает широкий выбор служб, например <xref:Microsoft.VisualStudio.Shell.Interop.SVsUIShell>, предоставляющие доступ к функциональности над окнами среды разработки.  
  
 ![График архитектуры среды](../misc/media/environment.png "environment")  
Обобщенное представление архитектуры Visual Studio  
  
 Обратите внимание, что связь между службами и для двунаправленной VSPackages.  Хотя службы использования VSPackages предложили другими, они также могут предложить службы их с помощью <xref:Microsoft.VisualStudio.Shell.Interop.IProfferService> интерфейс.  Эта услуга\-основанная архитектура росла из реализаций конструктора microsoft ActiveX, в которой служба группа в составе связанные интерфейсы, которые выполняют задачи.  Из строгой точки зрения модели COM, все интерфейсы указанной службы должны быть реализованы в рамках одного com\-класса.  
  
 Стандартная интегрированная среда разработки предоставляет важные службы, например <xref:Microsoft.VisualStudio.Shell.Interop.SVsShell>"  <xref:Microsoft.VisualStudio.Shell.Interop.SVsUIShell>и  <xref:Microsoft.VisualStudio.Shell.Interop.SVsSolution>, используемые VSPackages.  В следующей таблице перечислены и описаны некоторые из этих служб.  Дополнительные сведения см. в разделе [Использование и предоставления услуг](../Topic/Using%20and%20Providing%20Services.md).  
  
|Служба интегрированной среды разработки|Описание|  
|---------------------------------------------|--------------|  
|<xref:Microsoft.VisualStudio.Shell.Interop.SVsShell>|Предоставляет доступ к службам среды разработки при работе с базовой функциональностью, VSPackages, и реестре.|  
|<xref:Microsoft.VisualStudio.Shell.Interop.SVsUIShell>|Предоставляет основной над окнами и Пользовательский интерфейс\-родственную функциональность в интегрированной среде разработки, например возможность создания средств и окна документа.|  
|<xref:Microsoft.VisualStudio.Shell.Interop.SVsSolution>|Предоставляет базовую решение\-родственную функциональные возможности, такие как возможность перечисления проекты, создания новых проектов, а проект монитора изменений.|  
  
 Из\-за их плотной integration services через взаимодействие общих служб, [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] Интегрированная среда разработки и VSPackages ближайшего взаимозависимы.  Однако несмотря на их взаимодействие они имеют различные обязанности like.  
  
 [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] Интегрированная среда разработки отвечает за следующих задач:  
  
-   Защита важных службы для использования внешними VSPackages.  
  
-   Предоставляет программируемые интерфейс, который включает участие со стандартными элементами пользовательского интерфейса.  
  
-   Создание экземпляров VSPackages в соответствии с требованиями действий пользователя или другие VSPackages при запросе службы.  
  
-   Защита службы, которые делают возможным сообщения и координации между VSPackages.  
  
-   Управление решениями и их необходимые файлы.  
  
-   Защита управление окнами.  
  
-   Защита маршрутизации и панели команд команды, например, меню, панели инструментов и контекстные меню.  
  
-   Координирующий выделение в контекст и валюта.  
  
 VSPackages отвечает за следующих задач:  
  
-   Выполнять определенные процедуры инициализации и завершения.  
  
-   Данные записи в реестр, интегрированная среда разработки используется для загрузки соответствующее VSPackages в нужное время.  
  
-   Предлагающ служб, необходимых для взаимодействия с другим VSPackages.  
  
-   Предоставления реализаций для новых типов проектов, редакторов и конструкторов.  
  
-   Предоставляет расширения для встроенных элементов пользовательского интерфейса, такие как элементы задачи, элементы панели инструментов, а диалоговое окно параметры.  
  
## См. также  
 [Visual Studio \(оболочка\)](../Topic/Visual%20Studio%20Shell.md)   
 [Пакеты VSPackage](../Topic/VSPackages.md)   
 [Использование и предоставления услуг](../Topic/Using%20and%20Providing%20Services.md)   
 [Практическое руководство: Получение службы](../Topic/How%20to:%20Get%20a%20Service.md)