---
title: Функции-члены файлового потока вывода | Документы Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-standard-libraries
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- output streams [C++], member functions
ms.assetid: 38aaf710-8035-4a34-a0c4-123a5327f28a
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 7a1cba80b18f94d5a833b238e19be8190a442146
ms.sourcegitcommit: d55ac596ba8f908f5d91d228dc070dad31cb8360
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2018
---
# <a name="output-file-stream-member-functions"></a>Функции-члены потока выходного файла

Функции-члены потока вывода делятся на три типа: эквивалентные манипуляторам, выполняющие неформатированные операции записи и изменяющие состояние потока другим образом и при этом не имеющие эквивалентных манипуляторов или операторов вставки. Для последовательного форматированного вывода можно использовать только операторы вставки и манипуляторы. Для двоичного дискового вывода с произвольным доступом следует использовать другие функции-члены с операторами вставки или без них.

## <a name="the-open-function-for-output-streams"></a>Функция open для потоков вывода

Для использования файлового потока вывода ([ofstream](../standard-library/basic-ofstream-class.md)) следует связать этот поток с конкретным файлом на диске в конструкторе или в функции **open**. При использовании функции **open** можно повторно использовать один и тот же объект-поток с рядом файлов. В любом случае аргументы, описывающие файл, одни и те же.

При открытии файла, связанного с потоком вывода, обычно указывается флаг **open_mode**. Эти флаги, определенные как перечислители в классе `ios`, можно комбинировать с помощью побитового оператора OR (&#124;). Список перечислителей приведен в разделе [ios_base::openmode](../standard-library/ios-base-class.md#openmode).

Три типовые ситуации для потока вывода используют параметры режима:

- Создание файла. Если файл уже существует, старая версия удаляется.

   ```cpp
   ostream ofile("FILENAME");
   // Default is ios::out

   ofstream ofile("FILENAME", ios::out);
   // Equivalent to above
   ```

- Добавление записей к существующему файлу или создание нового, если он не существует.

   ```cpp
   ofstream ofile("FILENAME", ios::app);
   ```

- Открытие двух файлов в одном и том же потоке, по одному за раз.

   ```cpp
   ofstream ofile();
   ofile.open("FILE1", ios::in);
   // Do some output
   ofile.close();    // FILE1 closed
   ofile.open("FILE2", ios::in);
   // Do some more output
   ofile.close();    // FILE2 closed
   // When ofile goes out of scope it is destroyed.
   ```

## <a name="the-put"></a>Put

Функция **put** записывает в поток вывода один символ. Следующие две конструкции по умолчанию одинаковы, но вторая зависит от аргументов формата потока:

```cpp
cout.put('A');

// Exactly one character written
cout <<'A'; // Format arguments 'width' and 'fill' apply
```

## <a name="the-write"></a>Запись

Функция **write** записывает блок памяти в файловый поток вывода. Аргумент length указывает количество записанных байт. Следующий пример создает файловый поток вывода и записывает в него двоичное значение структуры `Date`:

```cpp
// write_function.cpp
// compile with: /EHsc
#include <fstream>
using namespace std;

struct Date
{
   int mo, da, yr;
};

int main( )
{
   Date dt = { 6, 10, 92 };
   ofstream tfile( "date.dat" , ios::binary );
   tfile.write( (char *) &dt, sizeof dt );
}
```

Функция **write** не останавливается при достижении символа null, поэтому записывается полная структура класса. Функция имеет два аргумента: указатель `char` и количество символов для записи. Обратите внимание на необходимость преобразования в тип **char\*** перед адресом объекта-структуры.

## <a name="the-seekp-and-tellp-functions"></a>Функции seekp и tellp

Файловый поток вывода хранит внутренний указатель на позицию следующей записи данных. Функция-член `seekp` устанавливает этот указатель, предоставляя тем самым вывод произвольного доступа в дисковый файл. Функция-член `tellp` возвращает позицию в файле. Примеры использования эквивалентов входного потока для `seekp` и `tellp` см. в разделе [Функции seekg и tellg](../standard-library/input-stream-member-functions.md).

## <a name="the-close-function-for-output-streams"></a>Функция close для потоков вывода

Функция-член **close** закрывает дисковый файл, связанный с файловым потоком вывода. Для завершения всех операций вывода на диск файл должен быть закрыт. При необходимости деструктор `ofstream` закрывает файл, но можно использовать функцию **close**, если нужно открыть другой файл для того же объекта-потока.

Деструктор потока вывода автоматически закрывает файл потока, только если файл был открыт конструктором или функцией-членом **open**. Если конструктору передается дескриптор для уже открытого файла или используется функция-член **attach**, необходимо явно закрыть файл.

## <a name="vclrferrorprocessingfunctionsanchor10"></a> Функции обработки ошибок

Используйте эти функции-члены для проверки на ошибки при записи в поток:

|Функция|Возвращаемое значение|
|--------------|------------------|
|[bad](http://msdn.microsoft.com/Library/4038d331-e9c9-48b0-bf49-c6505744469c)|Возвращает значение **true** в случае неустранимой ошибки.|
|[fail](http://msdn.microsoft.com/Library/619f1b36-1e72-4551-8b48-888ae4e370d2)|Возвращает значение **true** при неустранимой ошибке или "ожидаемом" условии, например при ошибке преобразования или если файл не найден. Обработку часто можно возобновить после вызова **clear** с нулевым аргументом.|
|[good](http://msdn.microsoft.com/Library/77f0aa17-2ae1-48ae-8040-592d301e3972)|Возвращает значение **true**, если нет ошибок (неустранимых или других) и флаг конца файла не установлен.|
|[eof](http://msdn.microsoft.com/Library/3087f631-1268-49cd-86cf-ff4108862329)|Возвращает значение **true** при достижении конца файла.|
|[clear](http://msdn.microsoft.com/Library/dc172694-1267-45f8-8f5c-e822e16fc271)|Устанавливает внутреннее состояние ошибки. Если вызывается с аргументами по умолчанию, он очищает все биты ошибок.|
|[rdstate](http://msdn.microsoft.com/Library/e235e4e2-7e95-4777-a160-3938d263dd9c)|Возвращает текущее состояние ошибки.|

Оператор **!** перегружается для выполнения тех же действий, что и функция **fail**. Таким образом выражение:

```cpp
if(!cout)...
```

эквивалентно выражению:

```cpp
if(cout.fail())...
```

Оператор **void\*()** перегружается, чтобы быть противоположностью оператора **!**; таким образом выражение:

```cpp
if(cout)...
```

эквивалентно:

```cpp
if(!cout.fail())...
```

Оператор **void\*()** не эквивалентен **good**, так как он не выполняет проверку на достижение конца файла.

## <a name="see-also"></a>См. также

[Потоки вывода](../standard-library/output-streams.md)<br/>
